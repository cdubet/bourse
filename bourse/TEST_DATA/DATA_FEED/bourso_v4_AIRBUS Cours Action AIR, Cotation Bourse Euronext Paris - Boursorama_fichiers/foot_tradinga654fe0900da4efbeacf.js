(self.webpackChunkweb_fr_portal_20=self.webpackChunkweb_fr_portal_20||[]).push([[3985],{536:function(tt,Ue,ie){"use strict";var he=ie(4692);function V(K){if(Array.isArray(K)){for(var le=0,X=Array(K.length);le<K.length;le++)X[le]=K[le];return X}else return Array.from(K)}(function(K,le,X){"use strict";var W=le.Raven?function(){var f;return(f=le.Raven).captureException.apply(f,arguments)}:function(){},S="brsOrderFrame",b=!1,I=!1,ae=!1,Z=!1;K.fn[S]=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},L=arguments;return this.each(function(){if(K.data(this,"plugin_"+S))K.type(f)==="string"&&K.data(this,"plugin_"+S)[f].apply(K.data(this,"plugin_"+S),Array.prototype.slice.call(L,1));else{var c=K.extend({},K.fn[S].defaults,f);Re(c.orderframeCSSPath,c.orderframeJSPath),K.data(this,"plugin_"+S,N(this,c))}})},K.fn[S].defaults={orderframeCSSPath:"",orderframeJSPath:"",config:{}};var N=function(L,c){var v=K.extend(!0,{},K.fn[S].defaults,c),p=void 0,o=K(L),h=[],g={getApp:function(){return p},onApp:function(C){p?C(p):h.push(C)},appOn:function(C,P){var G=!1,H=function(){G=!0};return this.onApp(function($){G||(H=$.on(C,P))}),H},appCommand:function(C){for(var P=arguments.length,G=Array(P>1?P-1:0),H=1;H<P;H++)G[H-1]=arguments[H];this.onApp(function($){return $[C].apply($,V(G))})}};return r(function(){p=new BrsOrderFrame({elt:L,config:v.config}),setTimeout(function(){o.trigger("brsOrderFrame:loaded",g),h.forEach(function(_){return _(p)}),h=void 0})}),g},Re=function(L,c){var v=S+"-async-css";if(!(Z||X.getElementById(v))){if(!L)throw new Error("Invalid orderframeCSSPath: "+L);Z=!0,te(v,L),b=!0,K("head").trigger(S+":cssLoaded")}le.BrsOrderFrame!==void 0&&(I=!0),!I&&!ae&&(ae=!0,j(c,function(p){if(p)throw p;I=!0,K("head").trigger(S+":jsLoaded")}))},te=function(L,c){var v=X.getElementsByTagName("head")[0],p=X.createElement("link");p.id=L,p.rel="stylesheet",p.type="text/css",p.href=c,p.media="all",v.appendChild(p)},j=function(L,c){K.ajax({cache:!0,url:L,dataType:"script",success:function(){return c()},error:function(p,o,h){return W("Error while loading orderframe with textStatus="+o+" and errorThrown="+h),c(new Error(h))}})},r=function(L){var c=K("head");c.on(S+":cssLoaded",v),c.on(S+":jsLoaded",v),v();function v(p){I&&b&&(L(),c.off(S+":cssLoaded",v),c.off(S+":jsLoaded",v))}}})(he,window,document)},9604:function(tt,Ue,ie){"use strict";var he=ie(8700),V=ie.n(he),K=ie(8154),le=ie.n(K),X=ie(9374),W=ie.n(X),S=ie(9290),b=ie.n(S),I=ie(5829),ae=ie.n(I),Z=ie(4741),N=ie.n(Z),Re=ie(7960),te=ie.n(Re),j=ie(5668),r=ie.n(j),f=ie(3104),L=ie.n(f),c=ie(6278),v=ie.n(c),p=ie(7578),o=ie.n(p),h=ie(4330),g=ie.n(h),_=ie(9828),C=ie.n(_),P=ie(2785),G=ie.n(P),H=ie(5568),$=ie.n(H),ue=ie(3454),ee=ie.n(ue),me=ie(1386),Te=ie.n(me),ye=ie(7454),ke=ie.n(ye),rt=ie(536),nt=ie.n(rt),lt=ie(9830),se=ie.n(lt)},5668:function(tt,Ue,ie){var he=ie(4692);/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Further changes, comments: @evaisse
 * Licensed under the MIT license
 * @see
 */(function(V,K,le){"use strict";var X="currenciesParity";V.fn[X]=function(S){var b=arguments;return this.each(function(){V.data(this,"plugin_"+X)?V.type(S)==="string"&&V.data(this,"plugin_"+X)[S].apply(V.data(this,"plugin_"+X),Array.prototype.slice.call(b,1)):V.data(this,"plugin_"+X,new W(this,S))})},V.fn[X].defaults={refreshableLoader:!1};function W(S,b){this.$element=V(S),this.options=V.extend({},V.fn[X].defaults,this.$element.data(),b),this._name=X,this.method="GET",this.init()}W.prototype.instance=function(){return this},W.prototype.init=function(){var S=this;S.$selectedCurrency="EUR",S.$selectedLetter="",S.$element.find("[data-currency-change]").change(function(){var b=V(this).val().split("#");S.$selectedCurrency=b[0],S.$selectedLetter=S.$element.find("[data-brs-custom-select-letter].is-selected").data("brsCustomSelectLetter"),S.refresh()}),S.$element.find("[data-brs-custom-select-letter]").click(function(){S.$selectedLetter=V(this).data("brsCustomSelectLetter"),S.$selectedCurrency=S.$element.find("[data-currency-change]").val().split("#")[0],S.refresh()})},W.prototype.refresh=function(){var S=this,b=S.$element.find("[data-currency-change]").data("urlCurrenciesParity");b+="/"+S.$selectedCurrency,b+=S.$selectedLetter?"/"+S.$selectedLetter:"";var I=S.$element.find("[data-loader]").brsLoader();I.data("plugin_brsLoader").showLoader(),S.$element.load(b,function(ae,Z,N){if(Z=="error"){var Re="Aucune information disponible pour ces valeurs";S.$element.find("[data-parity-table]").empty(),S.$element.find("[data-alert-parity]").find("[data-alert-text]").text(Re),S.$element.find("[data-alert-parity]").data("plugin_brsAlertEffect").showAlertBox()}V(le).trigger("load",S.$element)})}})(he,window,document)},2785:function(tt,Ue,ie){var he=ie(4692);(function(V,K,le){"use strict";var X="brsDerivativeForm";V.fn[X]=function(S){var b=arguments;return this.each(function(){V.data(this,"plugin_"+X)?V.type(S)==="string"&&V.data(this,"plugin_"+X)[S].apply(V.data(this,"plugin_"+X),Array.prototype.slice.call(b,1)):V.data(this,"plugin_"+X,new W(this,S))})},V.fn[X].defaults={};function W(S,b){this.$element=V(S),this.$turboRowType=this.$element.find("[data-turbos-form-row-type]"),this.$turboRowMaturity=this.$element.find("[data-turbos-form-row-maturity]"),this.$turboRowMaturitySeparateFilterPlugin=this.$turboRowMaturity.find("[data-separate-filter]").data("plugin_brsSeparateFilter"),this.$leverageShortRowUnderlyingType=this.$element.find("[data-leverage-shorts-form-row-underlying-type]"),this.$leverageShortRowUnderlyingTypeSeparateFiltePlugin=this.$leverageShortRowUnderlyingType.find("[data-separate-filter]").data("plugin_brsSeparateFilter"),this.$leverageShortRowUnderlyingName=this.$element.find("[data-leverage-shorts-form-row-underlying-name]"),this.$leverageShortRowMostUsedUnderlying=this.$element.find("[data-leverage-shorts-form-row-most-used-underlying]"),this.init()}W.prototype.init=function(){var S=this;this.$turboRowType.find("input").change(function(){S.checkTurboTypeConsistency()}),this.$leverageShortRowMostUsedUnderlying.find("input").change(function(){S.checkLeverageShortFieldsConsistency()})},W.prototype.checkLeverageShortFieldsConsistency=function(){var S=!1;this.$leverageShortRowMostUsedUnderlying.find("input").each(function(){V(this).is(":checked")&&(S=!0)}),S?(this.$leverageShortRowUnderlyingType.addClass("u-hidden"),this.$leverageShortRowUnderlyingName.addClass("u-hidden"),this.$leverageShortRowUnderlyingType.find("input").prop("checked",!1).trigger("change"),this.$leverageShortRowUnderlyingTypeSeparateFiltePlugin.sortFilters(),this.$leverageShortRowUnderlyingTypeSeparateFiltePlugin.showHideSeparator(),this.$leverageShortRowUnderlyingName.find("select").val([]).trigger("change")):(this.$leverageShortRowUnderlyingType.removeClass("u-hidden"),this.$leverageShortRowUnderlyingName.removeClass("u-hidden"))},W.prototype.checkTurboTypeConsistency=function(){var S=this,b="all";switch(this.$turboRowType.find("input").each(function(){V(this).is(":checked")&&(this.value==="2210"||this.value==="2205")?b="infinite":V(this).is(":checked")&&this.value==="2200"&&(b="finite")}),b){case"all":this.$turboRowMaturity.removeClass("u-hidden"),this.$turboRowMaturity.find("[data-filter-id=5]").removeClass("u-hidden"),this.$turboRowMaturitySeparateFilterPlugin!==void 0&&(this.$turboRowMaturitySeparateFilterPlugin.sortFilters(),this.$turboRowMaturitySeparateFilterPlugin.showHideSeparator());break;case"infinite":this.$turboRowMaturity.addClass("u-hidden"),this.$turboRowMaturity.find("input").prop("checked",!1),this.$turboRowMaturitySeparateFilterPlugin.sortFilters(),this.$turboRowMaturitySeparateFilterPlugin.showHideSeparator();break;case"finite":this.$turboRowMaturity.find("[data-filter-id=5]").addClass("u-hidden").find("input").prop("checked",!1),this.$turboRowMaturity.removeClass("u-hidden"),this.$turboRowMaturitySeparateFilterPlugin.sortFilters(),this.$turboRowMaturitySeparateFilterPlugin.showHideSeparator()}}})(he,window,document)},3104:function(tt,Ue,ie){var he=ie(4692);/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Further changes, comments: @evaisse
 * Licensed under the MIT license
 * @see
 */(function(V,K,le){"use strict";var X="updateUnderlying";V.fn[X]=function(S){var b=arguments;return this.each(function(){V.data(this,"plugin_"+X)?V.type(S)==="string"&&V.data(this,"plugin_"+X)[S].apply(V.data(this,"plugin_"+X),Array.prototype.slice.call(b,1)):V.data(this,"plugin_"+X,new W(this,S))})},V.fn[X].defaults={underlyingId:void 0,underlyingElem:void 0,ajaxUrl:"",defaultOptions:[],brsDerivUnderlyingRadio:!1};function W(S,b){this.element=V(S),this.options=V.extend(!0,{},V.fn[X].defaults,this.element.data(),b),this._name=X,this.lastSelected=[],this.options.brsDerivUnderlyingRadio&&(this.element=this.element.find("input[type=radio]")),this.init()}W.prototype.instance=function(){return this},W.prototype.saveDefaultOptions=function(){var S=this;S.options.defaultOptions=this.options.underlyingElem.contents().clone()},W.prototype.restoreDefaultOptions=function(){var S=this;this.clearSelect(),this.options.defaultOptions.each(function(){S.lastSelected.includes(this.value)?V(this).prop("selected",!0):V(this).prop("selected",!1)}),this.options.underlyingElem.html(this.options.defaultOptions),this.options.brsDerivUnderlyingRadio||this.options.underlyingElem.siblings(".c-select").children(".c-select__listbox-container").children(".c-select__textbox").children("input").val("Tous les sous-jacents")},W.prototype.setOptions=function(S){var b=[];this.clearSelect();for(var I in S.underlyingName)I===""&&!this.options.brsDerivUnderlyingRadio||this.lastSelected.includes(I)?b.push(V('<option value="'+I+'">'+S.underlyingName[I]+"</option>").prop("selected",!0)):I!==""&&b.push(V('<option value="'+I+'">'+S.underlyingName[I]+"</option>"));var ae=this.options.underlyingElem.siblings(".c-select").hasClass("is-expanded");ae&&this.options.underlyingElem.selectability("closeCombobox"),this.options.underlyingElem.html(b),this.options.underlyingElem.siblings(".c-select").children(".c-select__listbox-container").children(".c-select__textbox").children("input").val(S.underlyingName[""]),ae&&this.options.underlyingElem.selectability("openCombobox")},W.prototype.clearSelect=function(){var S=this.options.underlyingElem.siblings(".c-select").children(".c-select__listbox-container"),b=this;this.lastSelected=[],this.options.underlyingElem.find("option").each(function(){V(this).is(":selected")&&b.lastSelected.push(this.value)}),S.children(".c-select__textbox").children("input").val(""),S.children(".c-select__listbox").empty()},W.prototype.updateUnderlyingElem=function(){this.options.underlyingElem=V("[data-brs-deriv-underlying-target="+this.options.underlyingId+"]")},W.prototype.init=function(){this.element.trigger(X+":"),this.updateUnderlyingElem(),this.saveDefaultOptions(),this.handleTypeChange(!1);var S=this;this.element.on("change",function(){S.handleTypeChange(!0)})},W.prototype.handleTypeChange=function(S){var b=this,I,ae,Z;b.options.brsDerivUnderlyingRadio?(I=b.element.filter(":checked"),Z=I&&I.val()!==""&&I.is(":checked")):(I=V(b.element).children("option:selected"),Z=I&&I.val()!==""),I&&(b.options.underlyingElem.prop("disabled","disabled"),Z?(b.options.brsDerivUnderlyingRadio?ae=I.siblings("label").text().trim():ae=I.text(),V.ajax({url:b.options.ajaxUrl,method:"GET",data:{underlyingType:ae}}).done(function(N){b.setOptions(JSON.parse(N)),b.options.underlyingElem.prop("disabled",!1),S&&b.options.underlyingElem.trigger("change")}).catch(function(N){b.restoreDefaultOptions(),b.options.underlyingElem.prop("disabled",!1),S&&b.options.underlyingElem.trigger("change")})):(b.restoreDefaultOptions(),b.options.underlyingElem.prop("disabled",!1),S&&b.options.underlyingElem.trigger("change")))}})(he,window,document)},9828:function(tt,Ue,ie){var he=ie(4692);(function(V,K,le){"use strict";var X="brsHomeTabsChart";V.fn[X]=function(S){var b=arguments;return this.each(function(){V.data(this,"plugin_"+X)?V.type(S)==="string"&&V.data(this,"plugin_"+X)[S].apply(V.data(this,"plugin_"+X),Array.prototype.slice.call(b,1)):V.data(this,"plugin_"+X,new W(this,S))})},V.fn[X].defaults={};function W(S,b){this.element=V(S),this.tabFocus=0,this.$items=this.element.find("[data-brs-home-chart-tabs]"),this.options=V.extend({},V.fn[X].defaults,b),this._name=X,this.init()}W.prototype.instance=function(){return this},W.prototype.init=function(){this.$items.on("click",function(S){this.selectChart(S)}.bind(this)),this.element.on("keydown",function(S){this.setKeyboardFocus(S)}.bind(this))},W.prototype.keys={enter:13,space:32,end:35,home:36,left:37,right:39},W.prototype.selectChart=function(S){var b=V(S.currentTarget),I=V("[data-homepage-chart]"),ae=b.data("brsHomeChartTabs"),Z=V('[data-homepage-chart="'+ae+'"]');I.css("opacity",0),Z.css("opacity",1),this.$items.removeClass("is-active"),this.$items.attr("aria-selected","false"),this.$items.attr("tabindex","-1"),b.addClass("is-active"),b.attr("aria-selected","true"),b.attr("tabindex","0")},W.prototype.setKeyboardFocus=function(S){if(S.keyCode===this.keys.right||S.keyCode===this.keys.left||S.keyCode===this.keys.home||S.keyCode===this.keys.end){switch(S.preventDefault(),V(this.$items[this.tabFocus]).removeClass("is-active"),V(this.$items[this.tabFocus]).attr("tabindex",-1),S.keyCode){case this.keys.right:this.tabFocus++,this.tabFocus>=this.$items.length&&(this.tabFocus=0);break;case this.keys.left:this.tabFocus--,this.tabFocus<0&&(this.tabFocus=this.$items.length-1);break;case this.keys.home:this.tabFocus=0;break;case this.keys.end:this.tabFocus=this.$items.length-1;break}V(this.$items[this.tabFocus]).attr("tabindex",0),V(this.$items[this.tabFocus]).addClass("is-active"),V(this.$items[this.tabFocus]).focus()}else(S.keyCode===this.keys.space||S.keyCode===this.keys.enter)&&(S.preventDefault(),this.$items.attr("aria-selected","false"),V(this.$items[this.tabFocus]).attr("aria-selected","true"),this.$items[this.tabFocus].click())}})(he,window,document)},3454:function(tt,Ue,ie){var he=ie(4692);(function(V,K){"use strict";var le="brsMyList";V.fn[le]=function(W){var S=arguments;return this.each(function(){V.data(this,"plugin_"+le)?V.type(W)==="string"&&V.data(this,"plugin_"+le)[W].apply(V.data(this,"plugin_"+le),Array.prototype.slice.call(S,1)):V.data(this,"plugin_"+le,new X(this,W))})},V.fn[le].defaults={lastSymbolsToAdd:[],historySize:10,localStorageKey:"web_fr_portal_20.last_viwed_symbols",lastViewedSymbolsListId:"lastViewed",listRoute:"/listes/listes",listDropDownListSelector:"select",listBodySelector:".c-block__body",listTableSelector:".c-my-list__table",listErrorSelector:".c-my-list__error"};function X(W,S){this.$element=V(W),this.options=V.extend({},V.fn[le].defaults,this.$element.data(),S),this._name=le,this.listDropDownListElement=V(this.$element.find(this.options.listDropDownListSelector)),this.listBodyElement=V(this.$element.find(this.options.listBodySelector)),this.listTableElement=V(this.$element.find(this.options.listTableSelector)),this.listErrorElement=V(this.$element.find(this.options.listErrorSelector)),!(!this.listDropDownListElement||!this.listBodyElement||!this.listTableElement||!this.listErrorElement)&&(this.listErrorDefaultHtml=this.listErrorElement.html(),this.init())}X.prototype.instance=function(){return this},X.prototype.init=function(){this.symbols=this.getFullHistory(),K.BRS_USER_CONFIG&&K.BRS_USER_CONFIG.USER_HASH&&(this.options.listRoute+="/"+K.BRS_USER_CONFIG.USER_HASH),this.options.lastSymbolsToAdd.length>0&&(this.symbols=this.symbols.concat(this.options.lastSymbolsToAdd),this.symbols.length>this.options.historySize&&(this.symbols=this.symbols.slice(-this.options.historySize)),this.saveFullHistory(this.symbols)),this.listDropDownListElement&&this.listDropDownListElement.val()===this.options.lastViewedSymbolsListId&&this.symbols.length>0&&this.loadList(this.options.lastViewedSymbolsListId,!0);var W=this;this.listDropDownListElement.change(function(){W.loadList(W.listDropDownListElement.val())})},X.prototype.loadList=function(W,S){var b=this.options.listRoute+"?listId="+W;W==="lastViewed"&&this.symbols.length>0&&(b+="&"+this.symbols.map(function(ae){return"symbols[]="+encodeURIComponent(ae)}).join("&"),S&&(b+="&pageLoading=1")),this.listBodyElement.addClass("is-loading");var I=this;V.ajax({url:b}).done(function(ae){var Z=V(V.parseHTML(ae));I.listTableElement.html(Z.find(I.options.listTableSelector).html()),I.listErrorElement.html(Z.find(I.options.listErrorSelector).html()),V(document).trigger("load",I.$element);var N=!Z.find(I.options.listTableSelector)||!Z.find(I.options.listErrorSelector).hasClass("u-hidden");I.listTableElement[N?"addClass":"removeClass"]("u-hidden"),I.listErrorElement[N?"removeClass":"addClass"]("u-hidden")}).fail(function(){I.listErrorElement.html(I.listErrorDefaultHtml),I.listErrorElement.removeClass("u-hidden"),I.listTableElement.addClass("u-hidden")}).always(function(){I.listBodyElement.removeClass("is-loading"),V("body").trigger("brsListLoaded")})},X.prototype.saveFullHistory=function(W){K.localStorage&&K.localStorage.setItem(this.options.localStorageKey,JSON.stringify(W))},X.prototype.getFullHistory=function(){if(K.localStorage){try{var W=JSON.parse(K.localStorage.getItem(this.options.localStorageKey))}catch(S){return[]}return W=Array.isArray(W)?W:[],W.filter(function(S){return typeof S=="string"&&S.length>0})}else return[]}})(he,window,document)},5568:function(tt,Ue,ie){var he=ie(4692);/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Further changes, comments: @evaisse
 * Licensed under the MIT license
 * @see
 */(function(V,K,le){"use strict";var X="brsNewsletterSubscription";V.fn[X]=function(S){var b=arguments;return this.each(function(){V.data(this,"plugin_"+X)?V.type(S)==="string"&&V.data(this,"plugin_"+X)[S].apply(V.data(this,"plugin_"+X),Array.prototype.slice.call(b,1)):V.data(this,"plugin_"+X,new W(this,S))})},V.fn[X].defaults={};function W(S,b){this.element=V(S),this.actionUrl=this.element.attr("action"),this.$alert=V("[data-alert-newsletter]"),this.$icon=this.$alert.find("i"),this.successMessage="Votre demande a bien \xE9t\xE9 prise en compte.",this.fromType=this.toType="",this.options=V.extend({},V.fn[X].defaults,V(S).data(),b),this._name=X,this.init()}W.prototype.instance=function(){return this},W.prototype.init=function(){var S=this;V.fn.replaceClass=function(b,I){return this.removeClass(b).addClass(I)},this.element.on("submit",function(b){b.preventDefault();var I=V(this);V.ajax({method:"POST",url:S.actionUrl,data:I.serialize()}).done(function(ae){ae.response.error?(S.fromType="success",S.toType="warning",S.$alert.find("[data-alert-text]").html(ae.response.error.join("<br />"))):(S.fromType="warning",S.toType="success",S.$alert.find("[data-alert-text]").text(S.successMessage))}).fail(function(){S.fromType="success",S.toType="warning",S.$alert.find("[data-alert-text]").text("Une erreur est survenue")}).always(function(){I.addClass("o-vertical-interval-bottom"),S.$icon.replaceClass("c-icon--alert-"+S.fromType,"c-icon--alert-"+S.toType),S.$alert.replaceClass("c-alert--"+S.fromType,"c-alert--"+S.toType),S.$alert.data("plugin_brsAlertEffect").showAlertBox()})})}})(he,window,document)},6278:function(tt,Ue,ie){var he=ie(4692);/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Further changes, comments: @evaisse
 * Licensed under the MIT license
 * @see
 */(function(V,K,le){"use strict";var X="brsOrderframeBroker";V.fn[X]=function(S){var b=arguments;return this.each(function(){V.data(this,"plugin_"+X)?V.type(S)==="string"&&V.data(this,"plugin_"+X)[S].apply(V.data(this,"plugin_"+X),Array.prototype.slice.call(b,1)):V.data(this,"plugin_"+X,new W(this,S))})},V.fn[X].defaults={};function W(S,b){this.$element=V(S),this.options=V.extend({},V.fn[X].defaults,this.$element.data(),b),this._name=X,V(K).on("brsOrderframeBroker:launch",this.init)}W.prototype.instance=function(){return this},W.prototype.init=function(S,b){var I=null,ae=V("[data-brs-order-frame-app-id]"),Z=ae.parents("[data-off-canvas]").data("plugin_brsOffCanvas");Z.open(),typeof ae.data("plugin_brsOrderFrame")=="undefined"&&(I=Z.$element.find("[data-off-canvas-content]").brsLoader().data("plugin_brsLoader"),I.showLoader(),ae.on("brsOrderFrame:loaded",function(N,Re){I.hideLoader(),Re.getApp().on("exit:app",function(){Z.close()})}),ae.brsOrderFrame()),ae.data("plugin_brsOrderFrame").appCommand("goToOrder",b)}})(he,window,document)},7578:function(tt,Ue,ie){var he=ie(4692);(function(V,K,le){"use strict";var X="brsQuoteChart";V.fn[X]=function(S){var b=arguments;return this.each(function(){V.data(this,"plugin_"+X)?V.type(S)==="string"&&V.data(this,"plugin_"+X)[S].apply(V.data(this,"plugin_"+X),Array.prototype.slice.call(b,1)):V.data(this,"plugin_"+X,new W(this,S))})},V.fn[X].defaults={elements:{pointerMenu:"[data-brs-quote-chart-pointer-menu]",periodMenu:"[data-brs-quote-chart-period-menu]",indicatorMenu:"[data-brs-quote-chart-indicator-menu]",styleMenu:"[data-brs-quote-chart-style-menu]",newsMenu:"[data-brs-quote-chart-news-menu]",saveMenu:"[data-brs-quote-chart-save-menu]",drawMenu:"[data-brs-quote-chart-draw-menu]",indicatorBtn:"[data-brs-quote-chart-indicator-btn]",periodBtn:"[data-brs-quote-chart-period-btn]",pointerBtn:"[data-brs-quote-chart-pointer-btn]",saveBtn:"[data-brs-quote-chart-save-btn]",shareBtn:"[data-brs-quote-chart-share-btn]",styleBtn:"[data-brs-quote-chart-style-btn]",newsBtn:"[data-brs-quote-chart-news-btn]",drawBtn:"[data-brs-quote-chart-draw-btn]",drawListBtn:"[data-brs-quote-chart-draw-list-btn]",fullscreenBtn:"[data-brs-quote-chart-fullscreen-btn]",bigFullscreenBtnContainer:"[data-brs-quote-chart-fullscreen-big-btn-container]",fullFeatures:"[data-brs-quote-chart-full-feature]",quickCommands:"[data-brs-quote-chart-quick-commands]",bigFullscreenBtn:"[data-brs-quote-chart-fullscreen-big-btn]",eodContainer:"[data-brs-quote-chart-eod-container]",durations:"[data-brs-quote-chart-durations]",commands:"[data-brs-quote-chart-commands]",compareTrigger:"[data-brs-quote-chart-compare-trigger]",settingsTrigger:"[data-brs-quote-chart-settings-trigger]",saveDrawingTrigger:"[data-brs-quote-chart-save-drawing-trigger]",indexCompareBtn:"[data-brs-quote-chart-index-compare]",symbolCompareBtn:"[data-brs-quote-chart-symbol-compare]",twoSymbolsCompareBtn:"[data-brs-quote-chart-two-symbols-compare]",compareFirstSymbol:"[data-brs-quote-chart-compare-first-symbol]",compareSecondSymbol:"[data-brs-quote-chart-compare-second-symbol]",sectorCompareBtn:"[data-brs-quote-chart-sector-compare]",orderBtn:"[data-brs-quote-chart-order-btn]",compareBtn:"[data-brs-quote-chart-compare-btn]",settingsBtn:"[data-brs-quote-chart-settings-btn]",saveImageAsBtn:"[data-brs-quote-chart-save-image-as-btn]",downloadBtn:"[data-brs-quote-chart-download-btn]",orderBtnGroup:"[data-brs-quote-chart-order-btn-group]",orderSendBtn:"[data-brs-quote-chart-order-send-btn]",orderQuantity:"[data-brs-quote-chart-order-quantity]",orderLevel:"[data-brs-quote-chart-order-level]",orderType:"[data-brs-quote-chart-order-type]",infoArea:"[data-brs-quote-chart-info-area]",showFiveDaysLink:"[data-brs-show-five-days]",hideFiveDaysLink:"[data-brs-hide-five-days]",fiveDaysHistory:"[data-brs-five-days-history]",fiveDaysBlock:"[data-brs-five-days-block]",templateSelect:"[data-brs-quote-chart-template]",templateForm:"[data-brs-quote-chart-template-form]",templateInputName:"[data-brs-quote-chart-template-input-name]",templateSaveBtn:"[data-brs-quote-chart-template-save]",templateSaveSuccess:"[data-brs-quote-chart-template-save-success]",templateSaveFailure:"[data-brs-quote-chart-template-save-failure]",templateDeleteBtn:"[data-brs-quote-chart-template-delete]",templateDeleteSuccess:"[data-brs-quote-chart-template-delete-success]",templateSaveListBtn:"[data-brs-quote-chart-template-list-save]",templateTable:"[data-brs-quote-chart-template-table]",defaultTemplateRadio:"[data-brs-quote-chart-default-template-radio]",noTemplateAlert:"[data-brs-quote-chart-no-template-alert]",drawingSelect:"[data-brs-quote-chart-drawing]",drawingForm:"[data-brs-quote-chart-drawing-form]",drawingInputName:"[data-brs-quote-chart-drawing-input-name]",openDrawingSaveBtn:"[data-brs-quote-chart-open-drawing-save]",drawingSaveBtn:"[data-brs-quote-chart-drawing-save]",drawingSaveSuccess:"[data-brs-quote-chart-drawing-save-success]",drawingSaveWarning:"[data-brs-quote-chart-drawing-save-warning]",drawingSaveFailure:"[data-brs-quote-chart-drawing-save-failure]",drawingDeleteBtn:"[data-brs-quote-chart-drawing-delete]",drawingDeleteSuccess:"[data-brs-quote-chart-drawing-delete-success]",drawingSaveListBtn:"[data-brs-quote-chart-drawing-list-save]",drawingTable:"[data-brs-quote-chart-drawing-table]",drawingExistsAlert:"[data-brs-quote-chart-drawing-exists-alert]"},stickyMarketValue:"[data-sticky-market-value]",stickyMarketValueBreakPoint:1e3,fullscreenBackground:"[data-fullscreen-background]",rchartMobileMaxWidth:767};function W(S,b){this.element=V(S),this.options=V.extend({},V.fn[X].defaults,b),this._name=X,this.init(b)}W.prototype.instance=function(){return this},W.prototype.init=function(S){var b=this;this.VGP=S.VGP,Object.keys(this.options.elements).forEach(function(I){b["$"+I]=V(b.element).find(b.options.elements[I])}),this.$pointerMenuItem=this.$pointerMenu.find("[data-pointer]"),this.$periodMenuItem=this.$periodMenu.find("[data-period]"),this.$styleMenuItem=this.$styleMenu.find("[data-style]"),this.$newsMenuItem=this.$newsMenu.find("[data-news-type]"),this.$mainIndicatorItem=this.$indicatorMenu.find("[data-main-indicator]"),this.$secondaryIndicatorItem=this.$indicatorMenu.find("[data-secondary-indicator]"),this.$detectIndicatorItem=this.$indicatorMenu.find("[data-detect-indicator]"),this.$stickyMarketValue=V(this.options.stickyMarketValue),this.stickyMarketValueBreakPoint=this.options.stickyMarketValueBreakPoint,this.$fullscreenBackground=V(this.options.fullscreenBackground),this.rchartMobileMaxWidth=this.options.rchartMobileMaxWidth,this.isFullscreen=!1,this.resizeChart=S.resizeChart||!0,this.defaultTemplate=S.defaultTemplate,this.candleTemplate=S.candleTemplate,this.lineTemplate=S.lineTemplate,this.barcolorTemplate=S.barcolorTemplate,this.userTemplates=[],this.userTemplatesToDelete=[],this.selectedDefaultTemplate=void 0,this.userDrawings=[],this.userDrawingsToDelete=[],this.currentUserTemplate="",this.currentUserDrawing=void 0,this.showDrawing=S.showDrawing,this.quoteDownloadUrl="",this.isCanvasSupported()&&(this.VGP.graph=new RODGraph({callID:this.$eodContainer.attr("id"),symbol:this.VGP.symbol}),this.VGP.userID="42",S.enableRemoteSave?V.when(V.ajax(b.VGP.urlWS+"template"),V.ajax(b.VGP.urlWS+"drawing")).done(function(I,ae){for(var Z=I[0],N=0;N<Z.length;N++){var Re={Layers:Z[N].Layers,Parametres:Z[N].Parametres,isDefault:parseInt(Z[N].isDefault)};b.userTemplates[Z[N].configname]=Re,Z[N].isDefault&&(b.currentUserTemplate=Re)}for(var te=ae[0],N=0;N<te.length;N++){var j={name:te[N].name,symbol:te[N].symbol,instrumentName:te[N].instrumentName};VGP.drawings[te[N].symbol]=0,b.userDrawings.push(j),te[N].symbol===VGP.symbol&&(b.toggleDrawingExistsAlert(),b.currentUserDrawing={Symbol:VGP.symbol,Traces:te[N].content,Parametres:te[N].parameters,Layers:te[N].layers})}b.loadChart()}).fail(function(){b.loadChart()}):this.loadChart()),V("body").on("touchmove",function(){b.VGP.dragging=!0}),V("body").on("touchstart",function(){b.VGP.dragging=!1}),this.resizeChart&&V(K).on("resize",function(){b.isFullscreen?b.enterFullscreen():b.resize()}),this.$fullscreenBtn.bind(this.VGP.clickHandler,function(I){I.preventDefault(),b.isFullscreen?b.leaveFullscreen():b.enterFullscreen()}),this.$bigFullscreenBtn.bind(this.VGP.clickHandler,function(I){b.leaveFullscreen()}),V(".navig_trace li").bind(this.VGP.clickHandler,function(I){I.preventDefault(),I.stopPropagation();var ae=V(this),Z=ae.data("drawingTool");if(!Z)return!1;try{b.selectDrawingTool(Z)}catch(Re){console.error(Re)}if(Z!=="e"&&Z!=="hst"){var N=ae.data("icon");b.$drawBtn.removeClass().addClass("spg eod_b3 eodi_oblic tipt "+N+" c-quote-chart__menu-button")}b.closeMenus()}),this.$periodBtn.bind(this.VGP.clickHandler,function(I){b.openMenu(I,b.$periodMenu)}),this.$styleBtn.bind(this.VGP.clickHandler,function(I){b.openMenu(I,b.$styleMenu)}),this.$newsBtn.bind(this.VGP.clickHandler,function(I){b.openMenu(I,b.$newsMenu)}),this.$pointerBtn.bind(this.VGP.clickHandler,function(I){b.openMenu(I,b.$pointerMenu)}),this.$indicatorBtn.bind(this.VGP.clickHandler,function(I){b.openMenu(I,b.$indicatorMenu)}),this.$saveBtn.bind(this.VGP.clickHandler,function(I){b.openMenu(I,b.$saveMenu)}),this.$drawBtn.bind(this.VGP.clickHandler,function(I){if(b.endEraser(),I.preventDefault(),b.stopFunctions())return!1;b.closeToolsParams();try{b.selectDrawingTool(V(this).attr("name"))}catch(ae){console.error(ae)}}),this.$pointerMenuItem.bind(this.VGP.clickHandler,function(I){I.preventDefault(),I.stopPropagation();var ae=V(this).data("pointer");if(ae){var Z=V(this).data("pointerIcon");try{b.VGP.graph.tools_menu(ae)!=!1&&V(this).parent().parent().removeClass().addClass("spg eod_b2 tipt "+Z+" c-quote-chart__menu-button")}catch(N){console.error(N)}b.closeMenus()}}),this.$periodMenuItem.bind(this.VGP.clickHandler,function(I){I.preventDefault(),I.stopPropagation();var ae=V(this).data("period");if(typeof ae!="undefined"){try{b.VGP.graph.period_menu(ae)}catch(Z){console.error(Z)}b.updateDownloadLink(ae),b.closeMenus()}}),this.$styleMenuItem.bind(this.VGP.clickHandler,function(I){I.preventDefault(),I.stopPropagation();var ae=V(this).data("style");if(ae){ae==="candle"?b.applyTemplate(b.candleTemplate):ae==="line"?b.applyTemplate(b.lineTemplate):ae==="barcolor"&&b.applyTemplate(b.barcolorTemplate),b.applyStyle(ae);var Z=V(this).data("styleIcon");b.$styleBtn.filter(".c-quote-chart__menu-button").removeClass().addClass("spg eod_b2 tipt "+Z+" c-quote-chart__menu-button"),b.$styleBtn.filter(".c-quote-chart__quick-command").removeClass().addClass("spg eod_b2 tipt "+Z+" c-quote-chart__quick-command c-quote-chart__quick-command--style"),b.closeMenus()}}),this.$newsMenuItem.bind(this.VGP.clickHandler,function(I){I.preventDefault(),I.stopPropagation();var ae=V(this).data("newsType");if(ae){var Z=b.VGP.graph.get_parametres().newsConfig;if(V(this).hasClass("is-selected")){V(this).removeClass("is-selected"),Z!=null&&Z.indexOf(ae)!==-1&&Z.splice(Z.indexOf(ae),1);try{b.VGP.graph.setNews(Z)}catch(N){console.error(N)}}else{V(this).addClass("is-selected"),Z==null?(Z=[],Z.push(ae)):Z.indexOf(ae)===-1&&Z.push(ae);try{b.VGP.graph.setNews(Z)}catch(N){console.error(N)}}b.closeMenus()}}),this.$compareBtn.bind(this.VGP.clickHandler,function(I){b.endEraser(),I.preventDefault(),b.closeMenus();var ae=b.getChartParameters();if(b.closeToolsParams(),b.stopFunctions())return!1;b.$compareTrigger.click()}),this.$settingsBtn.bind(this.VGP.clickHandler,function(I){if(b.endEraser(),I.preventDefault(),b.closeMenus(),b.closeToolsParams(),b.stopFunctions())return!1;b.initSettingsPopin(),b.$settingsTrigger.click()}),this.$drawListBtn.bind(this.VGP.clickHandler,function(I){b.openMenu(I,b.$drawMenu)}),V(".eodi_zoom").bind(this.VGP.clickHandler,function(I){I.preventDefault();try{b.VGP.graph.tools_menu("z")}catch(ae){console.error(ae)}}),V(".eodi_zp").bind(this.VGP.clickHandler,function(I){I.preventDefault();try{b.VGP.graph.zoom(!0)}catch(ae){console.error(ae)}}),V(".eodi_zm").bind(this.VGP.clickHandler,function(I){I.preventDefault();try{b.VGP.graph.zoom(!1)}catch(ae){console.error(ae)}}),V("[data-brs-quote-chart-duration-length]").on("click",function(){b.selectDuration(V(this)),b.changeDuration(V(this).data("brs-quote-chart-duration-length"))}),this.$showFiveDaysLink.on("click",function(){b.$fiveDaysHistory.removeClass("u-hidden"),b.$showFiveDaysLink.addClass("u-hidden"),b.$hideFiveDaysLink.removeClass("u-hidden")}),this.$hideFiveDaysLink.on("click",function(){b.$fiveDaysHistory.addClass("u-hidden"),b.$showFiveDaysLink.removeClass("u-hidden"),b.$hideFiveDaysLink.addClass("u-hidden")}),this.$templateSaveBtn.on("click",function(){if(b.$templateInputName.get(0).checkValidity()){var I=b.$templateInputName.val().toUpperCase(),ae=Object.keys(b.userTemplates).length;if(!b.userTemplates[I]&&ae>=5){b.$templateSaveFailure.removeClass("u-hidden"),setTimeout(function(){b.$templateSaveFailure.addClass("u-hidden")},3e3);return}b.$templateSaveBtn.prop("disabled",!0);try{VGP.graph.saveTemplate(I)}catch(Z){console.error(Z)}b.$noTemplateAlert.hide(),setTimeout(function(){b.$templateSaveBtn.prop("disabled",!1)},1e3),b.$templateSaveSuccess.removeClass("u-hidden"),setTimeout(function(){b.$templateSaveSuccess.addClass("u-hidden"),b.refreshTemplate(I)},3e3)}}),this.$templateDeleteBtn.on("click",function(){var I=String(V(this).data("templateName"));I&&b.prepareDeleteTemplate(I)}),this.$templateSaveListBtn.on("click",function(){b.$templateSaveListBtn.prop("disabled",!0);for(var I=0;I<b.userTemplatesToDelete.length;I++)b.deleteTemplate(b.userTemplatesToDelete[I]);b.userTemplatesToDelete=[],setTimeout(function(){b.$templateSaveListBtn.prop("disabled",!1),b.$templateDeleteSuccess.removeClass("u-hidden"),setTimeout(function(){b.$templateDeleteSuccess.addClass("u-hidden")},3e3),b.selectedDefaultTemplate!=null&&(b.changeDefaultTemplate(b.selectedDefaultTemplate,function(){location.reload()}),b.selectedDefaultTemplate=void 0)},1e3)}),this.$templateSelect.on("click",function(){b.selectTemplate(V(this).data("templateName"))}),this.$defaultTemplateRadio.on("change",function(){b.selectedDefaultTemplate=V(this).data("templateName")}),this.$openDrawingSaveBtn.on("click",function(){var I=b.getChartParameters();if(!I||I.isIntraday){K.DisplayAlert("Les sauvegardes d'analyses techniques ne sont pas possibles en mode intraday (1 et 5 jours)");return}b.$saveDrawingTrigger.click()}),this.$drawingSelect.on("click",function(){b.selectDrawing(V(this).data("drawingName"))}),this.$drawingSaveBtn.on("click",function(){if(b.$drawingInputName.get(0).checkValidity()){for(var I=b.$drawingInputName.val().toUpperCase(),ae=b.userDrawings.length,Z=!1,N=0;N<ae;N++)if(b.userDrawings[N].symbol===b.VGP.symbol){Z=!0,b.userDrawings[N].name=I;break}if(!Z&&ae>=10){b.$drawingSaveWarning.removeClass("u-hidden"),setTimeout(function(){b.$drawingSaveWarning.addClass("u-hidden")},3e3);return}b.$drawingSaveBtn.prop("disabled",!0);try{var Re=b.VGP.graph.saveTraceFull()}catch(te){console.error(te),b.$drawingSaveFailure.removeClass("u-hidden"),setTimeout(function(){b.$drawingSaveFailure.addClass("u-hidden")},3e3),setTimeout(function(){b.$drawingSaveBtn.prop("disabled",!1)},1e3);return}Re.name=I,b.currentUserDrawing=Re,V.ajax({type:"POST",url:b.VGP.urlWS+"drawing/"+escape(b.VGP.symbol),data:JSON.stringify(Re),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){b.$drawingSaveSuccess.removeClass("u-hidden"),setTimeout(function(){if(b.closePopin(),b.$drawingSaveSuccess.addClass("u-hidden"),!Z)b.userDrawings.push({symbol:b.VGP.symbol,name:I}),b.refreshDrawing(I,b.VGP.symbol);else{var te=b.$drawingTable.find("[data-drawing-symbol='"+b.VGP.symbol+"']").parent().parent().children();te.get(0).textContent=I,te.get(2).textContent=b.formatDate(new Date),b.$drawingSelect.data("drawingName",I),b.$drawingSelect.text(I)}b.$drawingSaveBtn.prop("disabled",!1)},3e3),setTimeout(function(){b.toggleDrawingExistsAlert()},4e3)},error:function(){b.$drawingSaveFailure.removeClass("u-hidden"),setTimeout(function(){b.$drawingSaveFailure.addClass("u-hidden")},3e3),setTimeout(function(){b.$drawingSaveBtn.prop("disabled",!1)},1e3)}})}}),this.$drawingDeleteBtn.on("click",function(){b.prepareDeleteDrawing(V(this).data("drawingSymbol"))}),this.$drawingSaveListBtn.on("click",function(){b.$drawingSaveListBtn.prop("disabled",!0);for(var I=0;I<b.userDrawingsToDelete.length;I++)b.deleteDrawing(b.userDrawingsToDelete[I]);b.userDrawingsToDelete=[],setTimeout(function(){b.$drawingSaveListBtn.prop("disabled",!1),b.$drawingDeleteSuccess.removeClass("u-hidden"),setTimeout(function(){b.$drawingDeleteSuccess.addClass("u-hidden")},3e3)},1e3)}),this.$mainIndicatorItem.bind(this.VGP.clickHandler,function(I){if(I.stopPropagation(),I.preventDefault(),!b.VGP.dragging){var ae=V(this).data("mainIndicator");if(b.$indicatorMenu.hide(),ae==="actu"){var Z=b.getChartParameters();if(b.resizeFullScreen(),Z&&Z.isIntraday){K.DisplayAlert("Les actualit\xE9s ne sont pas disponibles en intraday.");return}}try{b.VGP.graph.indic1_menu(ae)}catch(N){console.error(N)}b.resizeFullScreen()}}),this.$secondaryIndicatorItem.bind(this.VGP.clickHandler,function(I){if(I.stopPropagation(),I.preventDefault(),!b.VGP.dragging){var ae=V(this).data("secondaryIndicator");b.$indicatorMenu.hide();try{b.VGP.graph.indics_menu(ae)}catch(Z){console.error(Z)}}}),this.$detectIndicatorItem.bind(this.VGP.clickHandler,function(I){if(I.stopPropagation(),I.preventDefault(),!b.VGP.dragging){var ae=V(this);if(b.$indicatorMenu.hide(),ae.hasClass("is-selected")){ae.removeClass("is-selected");try{b.VGP.graph.removeSearch()}catch(Z){console.error(Z)}}else{b.$detectIndicatorItem.removeClass("is-selected"),ae.addClass("is-selected");try{b.VGP.graph.addSearch(ae.data("detectIndicator"))}catch(Z){console.error(Z)}}}}),this.$indexCompareBtn.on("click",function(){var I=V("[data-select-comparable-index]").val();b.compare(I)}),this.$sectorCompareBtn.on("click",function(){var I=V("[data-select-sector]").val();b.compare(I)}),this.$symbolCompareBtn.on("click",function(){var I=V("[data-autocomplete]").data("autocompleteValue");b.compare(I)}),this.$twoSymbolsCompareBtn.on("click",function(){var I=b.$compareFirstSymbol.val(),ae=b.$compareSecondSymbol.val();b.VGP.symbol!=I?(b.VGP.symbol=I,b.VGP.graph=new RODGraph({callID:b.$eodContainer.attr("id"),symbol:b.VGP.symbol}),b.defaultTemplate.isCompare=ae,b.loadChart()):b.compare(ae)}),this.$orderBtn.bind(this.VGP.clickHandler,function(I){b.endEraser(),I.preventDefault(),b.closeMenus(),b.currentOrderSide="sell",V(this).data("brsQuoteChartBuyBtn")&&(b.currentOrderSide="buy"),V(".eod_order_left").removeClass().addClass("eod_order_left "+b.currentOrderSide+"_order_left"),V(".eod_order_right").removeClass().addClass("eod_order_right "+b.currentOrderSide+"_order_right"),V(".eod_order_middle").removeClass().addClass("eod_order_middle "+b.currentOrderSide+"_order_middle");try{b.VGP.graph.order_level(b.currentOrderSide)}catch(ae){console.error(ae)}}),this.$orderSendBtn.bind(this.VGP.clickHandler,function(I){if(I.preventDefault(),!!b.$orderQuantity.val()){var ae=V("#ordertype").attr("order"),Z="";ae==="limit"?Z="LIM":ae==="stop"&&(Z="STP");var N=b.$orderLevel.val()?parseFloat(b.$orderLevel.val()):void 0;b.element.trigger("order",{order:{symbol:b.VGP.symbol,side:b.currentOrderSide,quantity:parseFloat(b.$orderQuantity.val()),limPx:Z==="LIM"?N:void 0,stopPx:Z==="STP"?N:void 0,orderType:Z}})}}),this.$shareBtn.bind(this.VGP.clickHandler,function(I){b.endEraser(),I.preventDefault(),b.closeMenus(),b.closeToolsParams();var ae=b.screenCapture();if(ae){var Z=b.VGP.tabCache.symbol;Z||(Z=b.VGP.symbol),V.ajax({type:"POST",url:b.VGP.urlWS+"SendCapture",data:'{"symbol": "'+Z+'", "image": "'+ae+'"}',contentType:"application/json; charset=utf-8",dataType:"json",success:function(N){N.url&&(K.location=N.url,K.DisplayAlert("Vous allez \xEAtre redirig\xE9s vers la cr\xE9ation de votre analyse technique."))},error:function(N){N&&N.responseJSON&&N.responseJSON.errorMessage?K.DisplayAlert(N.responseJSON.errorMessage):K.DisplayAlert("Service temporairement indisponible.")}})}}),this.$saveImageAsBtn.bind(this.VGP.clickHandler,function(I){b.endEraser(),I.preventDefault(),b.closeMenus(),b.closeToolsParams();var ae=b.screenCapture();if(ae){var Z="analyse.png";if(typeof K.navigator.msSaveBlob=="function"){for(var N=atob(ae),Re=new Array(N.length),te=0;te<N.length;te++)Re[te]=N.charCodeAt(te);var j=new Uint8Array(Re),r=new Blob([j]);K.navigator.msSaveBlob(r,Z)}else{if(V("html").hasClass("lt-ie10"))return;var f=le.createElement("a"),L="data:image/png;base64,"+ae;f.setAttribute("href",L),f.setAttribute("download",Z),f.style.display="none",le.body.appendChild(f),f.click(),le.body.removeChild(f)}}}),this.$downloadBtn.bind(this.VGP.clickHandler,function(I){b.endEraser(),I.preventDefault(),b.closeMenus(),b.closeToolsParams(),b.quoteDownloadUrl&&K.open(b.quoteDownloadUrl)}),V("[data-brs-quote-chart-defaultSet]").bind(VGP.clickHandler,function(I){return I.preventDefault(),I.stopPropagation(),b.settingsReset(),b.closePopin(),!1}),V("[data-brs-quote-chart-rbaxisyleft]").change(function(){b.settingsSetAxis("left")}),V("[data-brs-quote-chart-rbaxisyright]").change(function(){b.settingsSetAxis("right")}),V("[data-brs-quote-chart-rbaxisylinear]").change(function(){b.settingsSetAxisLog(!1)}),V("[data-brs-quote-chart-rbaxisylog]").change(function(){b.settingsSetAxisLog(!0)}),V("[data-brs-quote-chart-chkSticky]").change(function(){b.settingsSetSticky(!V(this).prop("checked"))}),V("[data-brs-quote-chart-rbgridContinu]").change(function(){b.settingsSetGrid(V(this).prop("checked"))}),V("[data-brs-quote-chart-rbgridPoint]").change(function(){b.settingsSetGrid(!V(this).prop("checked"))}),V("[data-brs-quote-chart-chkGridH]").change(function(){b.settingsSetGridH(V(this).prop("checked"))}),V("[data-brs-quote-chart-chkGridV]").change(function(){b.settingsSetGridV(V(this).prop("checked"))}),V("[data-brs-quote-chart-chkEncadre]").change(function(){b.settingsSetEncadre(V(this).prop("checked"))}),V("[data-brs-quote-chart-chkIndicValues]").change(function(){b.settingsSetIndicsValues(V(this).prop("checked"))}),this.updateDownloadLink(-2)},W.prototype.loadChart=function(){this.currentUserDrawing&&this.showDrawing?(this.loadTemplate(this.currentUserDrawing,!0),this.showDrawing=!1):this.currentUserTemplate?this.loadTemplate(this.currentUserTemplate):(this.VGP.graph.loadDefautChart(this.defaultTemplate),this.refreshPeriodState(this.defaultTemplate.histoLength)),this.refreshParametersModal()},W.prototype.selectTemplate=function(S){var b=this.userTemplates[S];if(b&&b.Parametres&&b.Layers){var I=JSON.parse(b.Parametres);I.indicators||(I.indicators=[],b.Parametres=JSON.stringify(I)),this.currentUserTemplate=b,this.loadTemplate(b)}},W.prototype.reloadWith=function(S){var b=this;b.VGP.symbol=S,b.VGP.graph=new RODGraph({callID:b.$eodContainer.attr("id"),symbol:b.VGP.symbol}),b.loadChart()},W.prototype.selectDrawing=function(){if(this.currentUserDrawing)if(this.currentUserDrawing.Parametres&&this.currentUserDrawing.Layers){var S=JSON.parse(this.currentUserDrawing.Parametres),b=V("[data-brs-quote-chart-duration-length="+S.histoLength+"]");b.length>0&&this.selectDuration(b);try{this.VGP.graph.loadTemplate(this.currentUserDrawing),this.VGP.graph.readTraceFull(this.currentUserDrawing)}catch(I){console.error(I)}}else try{this.VGP.graph.readTrace(this.currentUserDrawing)}catch(I){console.error(I)}},W.prototype.loadTemplate=function(S,b){var I=JSON.parse(S.Parametres),ae=V("[data-brs-quote-chart-duration-length="+I.histoLength+"]");if(ae.length>0)this.selectDuration(ae);else{var Z=V("[data-brs-quote-chart-duration-length].is-selected").data("brsQuoteChartDurationLength");I.histoLength=Z,S.Parametres=JSON.stringify(I),this.refreshPeriodState(Z)}try{this.VGP.graph.loadTemplate(S)}catch(N){console.error(N)}if(b===!0)try{this.VGP.graph.readTraceFull(S)}catch(N){console.error(N)}},W.prototype.openMenu=function(S,b){this.endEraser(),S.stopPropagation(),S.preventDefault(),b.is(":visible")?b.hide():(this.closeToolsParams(),this.closeMenus(),b.show())},W.prototype.refreshTemplate=function(S){var b=this;V.ajax({type:"GET",url:this.VGP.urlWS+"template/"+escape(S),contentType:"application/json; charset=utf-8",dataType:"json",success:function(I){if(I){var ae=!!b.userTemplates[I.configname],Z=String(I.configname);if(b.userTemplates[Z]={Layers:I.Layers,Parametres:I.Parametres},!ae){var N=le.createElement("div");N.setAttribute("class","c-quote-chart__submenu-item"),N.setAttribute("data-brs-quote-chart-template",""),N.setAttribute("data-template-name",Z),N.textContent=Z,b.$saveMenu.find(".c-quote-chart__menu-title")[0].after(N),N.onclick=function(){b.selectTemplate(Z)};var Re=le.createElement("tr");Re.setAttribute("class","c-table__row");var te=le.createElement("td");te.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),te.textContent=Z;var j=b.$defaultTemplateRadio.parent().closest("td").get(0).cloneNode(!0),r=Math.floor(Math.random()*1e6);j.childNodes[1].removeAttribute("checked"),j.childNodes[1].setAttribute("data-template-name",Z),j.childNodes[1].setAttribute("id",r),j.childNodes[2].setAttribute("for",r),j.childNodes[2].setAttribute("title",Z),j.onchange=function(){b.selectedDefaultTemplate=Z};var f=le.createElement("td");f.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-right");var L=le.createElement("i");L.setAttribute("class","c-table__icon c-table__icon--right u-cursor-pointer u-color-cerulean c-icon c-icon--cross"),L.setAttribute("data-brs-quote-chart-template-delete",""),L.setAttribute("data-template-name",Z),L.onclick=function(){b.prepareDeleteTemplate(Z)},f.appendChild(L),Re.appendChild(te),Re.appendChild(j),Re.appendChild(f);var c=b.$templateTable.find("tr");V(c).get(c.length-1).after(Re)}}}})},W.prototype.refreshDrawing=function(S,b){var I=this,ae=le.createElement("tr");ae.setAttribute("class","c-table__row");var Z=le.createElement("td");Z.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),Z.textContent=S;var N=le.createElement("td");N.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),N.textContent=V(".c-faceplate__company-link").text();var Re=le.createElement("td");Re.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),Re.textContent=I.formatDate(new Date);var te=le.createElement("td");te.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-right");var j=le.createElement("i");j.setAttribute("class","c-table__icon c-table__icon--right u-cursor-pointer u-color-cerulean c-icon c-icon--cross"),j.setAttribute("data-brs-quote-chart-drawing-delete",""),j.setAttribute("data-drawing-name",S),j.setAttribute("data-drawing-symbol",b),j.onclick=function(){I.prepareDeleteDrawing(b)},te.appendChild(j),ae.appendChild(Z),ae.appendChild(N),ae.appendChild(Re),ae.appendChild(te);var r=this.$drawingTable.find("tr");V(r).get(r.length-1).after(ae);var f=le.createElement("div");f.setAttribute("class","c-quote-chart__submenu-item"),f.setAttribute("data-brs-quote-chart-drawing",""),f.setAttribute("data-drawing-name",S),f.textContent=S,I.$saveMenu.find(".c-quote-chart__menu-title")[1].after(f),f.onclick=function(){I.selectDrawing(S)}},W.prototype.formatDate=function(S){var b=function(j){return j<10?"0"+j:j},I=b(S.getHours()),ae=b(S.getMinutes()),Z=b(S.getDate()),N=b(S.getMonth()),Re=S.getFullYear(),te="le "+Z+"/"+N+"/"+Re+" \xE0 "+I+"h"+ae;return te},W.prototype.prepareDeleteTemplate=function(S){delete this.userTemplates[S],this.userTemplatesToDelete.push(S),this.$templateTable.find("[data-template-name='"+S.replace("'","\\'")+"']").closest("tr").fadeOut()},W.prototype.deleteTemplate=function(S){var b=this;V.ajax({type:"DELETE",url:this.VGP.urlWS+"template/"+escape(S),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){b.$templateSelect.each(function(){V(this).data("templateName")===S&&V(this).remove()})}})},W.prototype.changeDefaultTemplate=function(S,b){var I="",ae="";S?(I="template/"+escape(S),ae="PUT"):(I="template/reset-default/",ae="POST"),V.ajax({type:ae,url:this.VGP.urlWS+I,contentType:"application/json; charset=utf-8",dataType:"json",success:b})},W.prototype.prepareDeleteDrawing=function(S){this.userDrawingsToDelete.push(S),this.$drawingTable.find("[data-drawing-symbol="+S+"]").closest("tr").fadeOut()},W.prototype.deleteDrawing=function(S){var b=this;V.ajax({type:"DELETE",url:this.VGP.urlWS+"drawing/"+escape(S),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){for(var I=0;I<b.userDrawings.length;I++)if(b.userDrawings[I].symbol===S){b.userDrawings.splice(I,1);break}b.toggleDrawingExistsAlert(),b.$drawingSelect.each(function(){V(this).remove()})}})},W.prototype.toggleDrawingExistsAlert=function(){for(var S=0;S<this.userDrawings.length;S++)if(this.userDrawings[S].symbol===this.VGP.symbol){this.$drawingExistsAlert.removeClass("u-hidden");return}this.$drawingExistsAlert.addClass("u-hidden")},W.prototype.isCanvasSupported=function(){var S=le.createElement("canvas");return!!(S.getContext&&S.getContext("2d"))},W.prototype.stopFunctions=function(S){try{var b=this.VGP.graph.get_chartType()}catch(I){return console.error(I),!1}return S==2&&b=="perf"?!1:b=="perf"||b=="renko"||b=="line break"||b=="kagi"},W.prototype.closeMenus=function(){this.$pointerMenu.hide(),this.closeToolsParams(),this.$periodMenu.hide(),this.$styleMenu.hide(),this.$newsMenu.hide(),this.$indicatorMenu.hide(),this.$saveMenu.hide(),this.$drawMenu.hide()},W.prototype.selectDuration=function(S){S.hasClass("is-selected")||(V(".c-quote-chart__length.is-selected").removeClass("is-selected"),S.addClass("is-selected"),this.isFullscreen||(S.data("brsQuoteChartDurationLength")==5?(this.$fiveDaysHistory.removeClass("u-hidden"),this.$showFiveDaysLink.addClass("u-hidden"),this.$hideFiveDaysLink.removeClass("u-hidden")):(this.$fiveDaysHistory.addClass("u-hidden"),this.$showFiveDaysLink.removeClass("u-hidden"),this.$hideFiveDaysLink.addClass("u-hidden"))),this.refreshPeriodState(S.data("brsQuoteChartDurationLength")))},W.prototype.endEraser=function(){if(this.$pointerBtn.hasClass("eodi_gomme")){this.$pointerBtn.removeClass().addClass("spg eod_b2 tipt eodi_cross");try{this.VGP.graph.stopGomme()}catch(S){console.error(S)}}},W.prototype.initSettingsPopin=function(){var S=this;V(".colorPicker-palette").remove(),V(".colorPicker-picker").remove();var b=[{selector:"[data-brs-quote-chart-colorBK]",setColor:function(I){S.settingsSetBackColor(I)}},{selector:"[data-brs-quote-chart-colorTXT]",setColor:function(I){S.settingsSetTextColor(I)}},{selector:"[data-brs-quote-chart-colorGRID]",setColor:function(I){S.settingsSetGridColor(I)}},{selector:"[data-brs-quote-chart-colorRETIC]",setColor:function(I){S.settingsSetReticuleColor(I)}},{selector:"[data-brs-quote-chart-colorCADRE]",setColor:function(I){S.settingsSetCadreColor(I)}},{selector:"[data-brs-quote-chart-colorTRACE]",setColor:function(I){S.settingsChangeTraceColor(I)}}];b.forEach(function(I){var ae=V(I.selector);new ColorPicker({wrapperEl:I.selector,value:ae.val(),onChange:function(Z){I.setColor(Z),ae.val(Z)}})})},W.prototype.closePopin=function(){V("[data-modal-back]").click()},W.prototype.getChartRefresh=function(){var S=this;V.ajax({type:"GET",url:this.VGP.urlWS+"UpdateCharts",data:{symbol:this.VGP.tabCache.symbol,period:this.VGP.tabCache.period},contentType:"application/json; charset=utf-8",dataType:"json",success:function(b){if(b.d==null)return K.stopTimers(),!1;if(b.d[0]!=null)if(S.VGP.tabCache.period<0)try{S.VGP.graph.updateQuoteIntraRefresh(b.d[0])}catch(I){console.error(I)}else try{S.VGP.graph.updateQuoteEODrefresh(b.d[0])}catch(I){console.error(I)}},error:function(){K.stopTimers()}})},W.prototype.enterFullscreen=function(){this.isFullscreen=!0,this.$fullscreenBackground.addClass("eod_fullscreen_background"),this.$bigFullscreenBtn.removeClass("u-hidden"),this.$fullscreenBtn.removeClass("eodi_fullscreen").addClass("eodi_fullscreenout"),this.$fullscreenBtn.attr("data-original-title","Quitter"),this.$fiveDaysBlock.hide(),this.$fullFeatures.removeClass("u-hidden"),this.$quickCommands.addClass("u-hidden"),this.resizeFullScreen(),V("[data-brs-quote-chart]").addClass("eod_fullscreen_mode");var S=this;V(le).on("click","[data-authentication-required]",function(){S.leaveFullscreen()}),this.resize()},W.prototype.resizeFullScreen=function(){if(this.isFullscreen){var S=this.$durations.outerHeight()+this.$commands.outerHeight()+this.$infoArea.outerHeight();K.innerWidth>992&&(S=S+this.$bigFullscreenBtnContainer.outerHeight()),K.innerWidth<this.stickyMarketValueBreakPoint&&(S=S+this.$stickyMarketValue.outerHeight());var b=K.innerHeight-S-60;this.$eodContainer.height(b+"px"),K.innerWidth<this.stickyMarketValueBreakPoint&&V("[data-brs-quote-chart]").css({bottom:this.$stickyMarketValue.outerHeight()}),this.resize()}},W.prototype.leaveFullscreen=function(){this.isFullscreen=!1,this.$fullscreenBackground.removeClass(),this.$bigFullscreenBtn.addClass("u-hidden"),this.$fullscreenBtn.removeClass("eodi_fullscreenout").addClass("eodi_fullscreen"),this.$fullscreenBtn.attr("data-original-title","Graphique dynamique"),K.innerWidth<this.stickyMarketValueBreakPoint&&V("[data-brs-quote-chart]").css({bottom:"auto"}),this.$fiveDaysBlock.show(),this.$eodContainer.height(""),V("[data-brs-quote-chart]").removeClass("eod_fullscreen_mode"),this.$fullFeatures.addClass("u-hidden"),this.$quickCommands.removeClass("u-hidden"),this.resize()},W.prototype.resize=function(){try{this.VGP.graph.set_screenSize()}catch(S){console.error(S)}},W.prototype.closeToolsParams=function(){try{this.VGP.graph.closeToolsParams()}catch(S){console.error(S)}},W.prototype.selectDrawingTool=function(S){try{S==="hst"?(this.VGP.graph.hideShowTrace(),this.VGP.graph.tools_menu("r")):this.VGP.graph.trace_menu(S)}catch(b){console.error(b)}},W.prototype.applyStyle=function(S){try{this.VGP.graph.style_menu(S)}catch(b){console.error(b)}},W.prototype.applyTemplate=function(S){this.VGP.graph.style_menu_template(S)},W.prototype.getChartParameters=function(){try{return this.VGP.graph.get_parametres()}catch(S){console.error(S)}return null},W.prototype.screenCapture=function(){try{return this.VGP.graph.screenCapture("brs")}catch(S){console.error(S)}return null},W.prototype.updateDownloadLink=function(S){var b=V(".c-quote-chart__length.is-selected").data("brs-quote-chart-duration-length"),I=-1;S?I=S:this.VGP.CCparam.chartPeriod?I=this.VGP.CCparam.chartPeriod:this.VGP.CCparam.histoLength&&this.VGP.CCparam.histoLength>5&&(I=0),this.quoteDownloadUrl=this.VGP.urlWS+"download?length="+b+"&period="+I+"&symbol="+this.VGP.symbol},W.prototype.changeDuration=function(S){this.VGP.graph.duree_menu(S),this.updateDownloadLink(!1),V(".c-quote-chart__error").hide(),V(".eod_chart").show(),K.launchTimers()},W.prototype.compare=function(S){try{this.VGP.graph.compare(S)}catch(b){console.error(b)}this.closePopin()},W.prototype.settingsReset=function(){try{this.VGP.graph.settings_setdefaut()}catch(S){console.error(S)}this.refreshParametersModal()},W.prototype.refreshParametersModal=function(){this.VGP.CCparam=this.getChartParameters(),V("[data-brs-quote-chart-colorBK]").val(this.VGP.CCparam.set.bkcolor).change(),V("[data-brs-quote-chart-colorTXT]").val(this.VGP.CCparam.set.txtColor).change(),V("[data-brs-quote-chart-colorGRID]").val(this.VGP.CCparam.set.gridColor).change(),V("[data-brs-quote-chart-colorRETIC]").val(this.VGP.CCparam.set.reticColor).change(),V("[data-brs-quote-chart-colorCADRE]").val(this.VGP.CCparam.set.cadreColor).change(),V("[data-brs-quote-chart-colorTRACE]").val(this.settingsGetTraceColor()).change(),V("[data-brs-quote-chart-chkGridH]").prop("checked",this.VGP.CCparam.set.gridH),V("[data-brs-quote-chart-chkGridV]").prop("checked",this.VGP.CCparam.set.gridV),V("[data-brs-quote-chart-chkEncadre]").prop("checked",this.VGP.CCparam.set.isEncadre),V("[data-brs-quote-chart-chkIndicValues]").prop("checked",this.VGP.CCparam.set.indicValues),V("[data-brs-quote-chart-rbgridContinu]").prop("checked",this.VGP.CCparam.set.gridLine),V("[data-brs-quote-chart-rbgridPoint]").prop("checked",!this.VGP.CCparam.set.gridLine),V("[data-brs-quote-chart-rbaxisyright]").prop("checked",!this.VGP.CCparam.set.yaxis),V("[data-brs-quote-chart-rbaxisyleft]").prop("checked",this.VGP.CCparam.set.yaxis),V("[data-brs-quote-chart-rbaxisylinear]").prop("checked",!this.VGP.CCparam.set.semilog),V("[data-brs-quote-chart-rbaxisylog]").prop("checked",this.VGP.CCparam.set.semilog),V("[data-brs-quote-chart-chkSticky]").prop("checked",!this.VGP.CCparam.set.nosticky)},W.prototype.refreshPeriodState=function(S){S>5?this.$periodMenuItem.each(function(){V(this).data("period")<0?V(this).addClass("is-disabled"):V(this).removeClass("is-disabled")}):this.$periodMenuItem.each(function(){V(this).data("period")<0?V(this).removeClass("is-disabled"):V(this).addClass("is-disabled")})},W.prototype.settingsSetAxis=function(S){try{this.VGP.graph.settings_setAxis(S)}catch(b){console.error(b)}},W.prototype.settingsSetAxisLog=function(S){try{this.VGP.graph.settings_setAxisLog(S)}catch(b){console.error(b)}},W.prototype.settingsSetSticky=function(S){try{this.VGP.graph.settings_setSticky(S)}catch(b){console.error(b)}},W.prototype.settingsSetGrid=function(S){try{this.VGP.graph.settings_setGridlineShow(S)}catch(b){console.error(b)}},W.prototype.settingsSetBackColor=function(S){try{this.VGP.graph.settings_setBackColor(S)}catch(b){console.error(b)}},W.prototype.settingsSetGridColor=function(S){try{this.VGP.graph.settings_setGridColor(S)}catch(b){console.error(b)}},W.prototype.settingsSetCadreColor=function(S){try{this.VGP.graph.settings_setCadreColor(S)}catch(b){console.error(b)}},W.prototype.settingsSetTextColor=function(S){try{this.VGP.graph.settings_setTextColor(S)}catch(b){console.error(b)}},W.prototype.settingsSetReticuleColor=function(S){try{this.VGP.graph.settings_setReticuleColor(S)}catch(b){console.error(b)}},W.prototype.settingsChangeTraceColor=function(S){try{this.VGP.graph.settings_setTraceColor(S)}catch(b){console.error(b)}},W.prototype.settingsGetTraceColor=function(){try{return this.VGP.graph.settings_getTraceColor()}catch(S){console.error(S)}return""},W.prototype.settingsSetGridH=function(S){try{this.VGP.graph.settings_setGridlineH(S)}catch(b){console.error(b)}},W.prototype.settingsSetGridV=function(S){try{this.VGP.graph.settings_setGridlineV(S)}catch(b){console.error(b)}},W.prototype.settingsSetIndicsValues=function(S){try{this.VGP.graph.settings_setIndicValues(S)}catch(b){console.error(b)}},W.prototype.settingsSetEncadre=function(S){try{this.VGP.graph.settings_setEncadreShow(S)}catch(b){console.error(b)}}})(he,window,document)},1386:function(tt,Ue,ie){var he=ie(4692);(function(V,K,le){"use strict";var X="brsSelectChipsAutocomplete";V.fn[X]=function(S){var b=arguments;return this.each(function(){V.data(this,"plugin_"+X)?V.type(S)==="string"&&V.data(this,"plugin_"+X)[S].apply(V.data(this,"plugin_"+X),Array.prototype.slice.call(b,1)):V.data(this,"plugin_"+X,new W(this,S))})},V.fn[X].defaults={brsChipsAutocompletePlaceholder:""};function W(S,b){this.$element=V(S),this.options=V.extend({},V.fn[X].defaults,this.$element.data(),b),this.init()}W.prototype.init=function(){function S(b){return b.id?'<span class="c-filter is-selected">'+b.text+"</span>":b.text}this.$element.select2({formatSelection:S,containerCssClass:"c-select-chips-autocomplete",dropdownCssClass:"c-select-chips-autocomplete-dropdown",placeholder:this.options.brsChipsAutocompletePlaceholder,minimumInputLength:1,formatInputTooShort:"Saisissez un premier caract\xE8re pour commencer la recherche"})}})(he,window,document)},4330:function(tt,Ue,ie){var he=ie(4692);(function(V,K,le){"use strict";var X="brsTabsChart";V.fn[X]=function(S){var b=arguments;return this.each(function(){V.data(this,"plugin_"+X)?V.type(S)==="string"&&V.data(this,"plugin_"+X)[S].apply(V.data(this,"plugin_"+X),Array.prototype.slice.call(b,1)):V.data(this,"plugin_"+X,new W(this,S))})},V.fn[X].defaults={};function W(S,b){this.element=V(S),this.tabs=this.element.find("[data-tabs]"),this.options=V.extend({},V.fn[X].defaults,b),this._name=X,this.init()}W.prototype.instance=function(){return this},W.prototype.init=function(){this.tabs.find("[data-tabs-link]").on("click",function(S){S.preventDefault(),V(V(S.currentTarget).attr("href")).css("min-height","20rem"),V(S.currentTarget).addClass("is-active"),V(V(S.currentTarget).attr("href")).addClass("is-active");var b=V(V(S.currentTarget)).attr("href"),I=V(b).find("div[id^=eod_container]")[0],ae={symbol:V(I).data("brsQuoteChartSymbol"),$graph:[],urlWS:"/bourse/action/graph/ws/",saveTrace:!1,drawings:[],noCommand:!0,callType:"GET",chartSimple:!1};K.VGP=ae;var Z={resizeChart:!1,VGP:ae,defaultTemplate:{histoLength:365,paddingTop:0,paddingLeft:0,paddingBottom:20,paddingRight:45,mainChart:{type:"line",typedef:{color2:"rgba(53,170,227,1)",color3:"rgba(51,99,160,1)",v1:!0}},indicators:[],set:{nohighlow:!0,veilleColor:"#f94aa6",veilleWidth:2,bkcolor:"rgba(0,0,0,0)",txtColor:"#000000",gridV:!1,gridH:!1,gridLine:!0,gridColor:"#263c53",cadreColor:"transparent",nosticky:!0}}};V(I).brsQuoteChart(Z)}.bind(this))}})(he,window,document)},9830:function(tt,Ue,ie){var he=ie(4692);he(document).on("load",function(V,K){he(K).find("[data-brs-deriv-underlying]").updateUnderlying(),he(K).find("[data-parity]").currenciesParity(),he(K).find("[data-brs-letter]").click(function(){var le=he(K).find(he(this).data("brsLetterInputSelector"));le.val(he(this).data("brsLetter")),le.closest("form").submit()}),he(K).find("[data-brs-tabs-chart]").brsTabsChart(),he(K).find("[data-brs-home-chart-tabpanel]").brsHomeTabsChart(),he(K).find("[data-partners-newsletter-form]").brsNewsletterSubscription(),he(K).find("[data-brs-chips-autocomplete]").brsSelectChipsAutocomplete(),he.fn.brsOrderFrame.defaults=he.extend(!0,{},he.fn.brsOrderFrame.defaults,{config:{apiEnv:window.BRS_CONFIG.API_ENV,apiHost:window.BRS_CONFIG.API_HOST,apiPath:window.BRS_CONFIG.API_PATH,enableProfiler:window.BRS_CONFIG.ENABLE_PROFILER,portalHost:window.location.host,env:window.BRS_CONFIG.DEBUG?"development":"production",customerWebsiteHost:window.BRS_CONFIG.app_customer_website_host,logLvl:window.BRS_CONFIG.DEBUG?"trace":"error",crashReport:window.BRS_CONFIG.CRASH_REPORT_AGENT},orderframeJSPath:window.BRS_CONFIG.orderframeJSPath,orderframeCSSPath:window.BRS_CONFIG.orderframeCSSPath}),he(K).find("[data-brs-order-frame-app-id]").brsOrderframeBroker(),he(K).find("[data-order-frame-trigger]").click(function(){he(window).trigger("brsOrderframeBroker:launch",[{side:he(this).data("orderFrameTriggerOrderWay"),symbol:he(this).data("orderFrameTriggerOrderSymbol")}])}),he(K).find("[data-brs-quote-chart]").on("order",function(le,X){he(window).trigger("brsOrderframeBroker:launch",[X.order])})}),he(function(){var V=[];he(document).find("[data-faceplate-symbol]").each(function(K,le){V.push(he(le).data("faceplateSymbol"))}),he(document).find(".c-my-list").brsMyList({lastSymbolsToAdd:V}),he(document).find("[data-tabs-link]").on("tab:click",function(K){K.preventDefault();var le=he(he(K.currentTarget).attr("href")).find("[data-table-flip]");if(le.length>0){var X=le.data("plugin_tableFlip");typeof X!="undefined"&&(X.unshapeTable(),X.init())}})})},7454:function(tt,Ue,ie){var he=ie(4692);window.lang={l_cross:"RETICULE",l_pointer:"POINTEUR",l_eraser:"GOMME",l_1d:"1 JOUR",l_2d:"2 JOURS",l_5d:"5 JOURS",l_10d:"10 JOURS",l_15d:"15 JOURS",l_3m:"3 MOIS",l_6m:"6 MOIS",l_1y:"1 AN",l_2y:"2 ANS",l_5y:"5 ANS",l_10y:"10 ANS",l_15y:"15 ANS",l_20y:"20 ANS",l_25y:"25 ANS",l_1min:"1 MINUTE",l_2min:"2 MINUTES",l_5min:"5 MINUTES",l_10min:"10 MINUTES",l_15min:"15 MINUTES",l_30min:"30 MINUTES",l_1h:"1 HEURE",l_2h:"2 HEURES",l_4h:"4 HEURES",l_day:"JOUR",l_week:"HEBDO",l_month:"MENSUEL",l_area:"AIRE",l_bcc:"BAR CHART COLOR\xC9S",l_candle:"BOUGIES",l_line:"LIGNE",l_season:"SAISONNALIT\xC9",l_mainind:"INDICATEURS PRINCIPAUX",l_boll:"BANDES DE BOLLINGER",l_keltner:"BANDES DE KELTNER",l_donchian:"CANAL DE DONCHIAN",l_regcurve:"COURBE REGRESSION LINEAIRE",l_regline:"DROITE REGRESSION LINEAIRE",l_envmm:"ENVELOPPE MOYENNE MOBILE",l_fievt:"EVENEMENTS FINANCIERS",l_actus:"ACTUALITES",l_mm:"MOYENNE MOBILE",l_mme:"MOYENNE MOBILE EXPO.",l_mmp:"MOYENNE MOBILE PONDEREE",l_mmt:"MOYENNE TRIANGULAIRE",l_sar:"PARABOLIQUE SAR",l_pivots:"POINTS PIVOTS",l_secind:"INDICATEURS SECONDAIRES",l_coppock:"COURBE DE COPPOCK",l_macdh:"MACD HISTOGRAMME",l_linearo:"OSCILL. REGRESSION LINEAIRE",l_moonphase:"PHASES DE LUNE",l_stoch:"STOCHASTIQUE",l_stochm:"STOCHASTIQUE MOMENTUM",l_stochr:"STOCHASTIQUE RSI",t_volume:"VOLUMES",l_fiboa:"ARCS DE FIBONACCI",l_fiboc:"CYCLES DE FIBONACCI",l_fibof:"FANIONS DE FIBONACCI",l_fiboe:"EXTENSIONS FIBONACCI",l_fibor:"RETRACEMENTS FIBONACCI",l_figures:"FIGURES",l_circle:"ELLIPSE - CERCLE",l_arrup:"FLECHE ACHAT",l_arrdw:"FLECHE VENTE",l_arrrt:"FLECHE DROITE",l_arrlt:"FLECHE GAUCHE",l_icones:"ICONES",l_arrow:"FLECHE",l_pitchf:"FOURCHETTE D'ANDREWS",l_ganng:"GRILLE DE GANN",l_ganna:"ANGLES DE GANN",l_horiz:"HORIZONTALE",l_verti:"VERTICALE",l_mesure:"MESURE",l_mesurev:"MESURE VERTICALE",l_mesureh:"MESURE HORIZONTALE",l_oblic:"OBLIQUE",l_para:"PARALLELES",l_eraseall:"TOUT EFFACER",l_detect:"DETECTIONS",l_marteau:"MARTEAUX",l_pendu:"PENDUS",l_pinces:"PINCES",l_maru:"MARUBOZU",l_soldiers:"3 SOLDATS",l_englob:"ENGLOBANTES",l_compare:"COMPARER",l_thclair:"THEME CLAIR",l_thfonce:"THEME FONCE",l_1g:"1 GRAPHIQUE",l_2g:"2 GRAPHIQUES",l_3g:"3 GRAPHIQUES",l_4g:"4 GRAPHIQUES",l_save:"Enregistrer",l_savenew:"Nouveau...",l_gerer:"G\xE9rer",l_modeles:"Vos mod\xE8les de graphiques",l_interface:"Vos interfaces",l_modify:"Modifier",l_infos:"INFOS",l_btnlog:"Connectez-vous pour sauver vos personnalisations",l_mode:"Mode",l_duree:"Dur\xE9e",l_period:"P\xE9riode",l_style:"Style des cours",l_indics:"Indicateurs",l_tracet:"Outils de trac\xE9s",l_patterns:"Recherche de figures techniques",l_comparer:"Comparer avec une autre valeur",l_capture:"Capturer l'\xE9cran et partager",l_reglages:"R\xE9glages",l_dispo:"Disposition de l'\xE9cran",l_help:"Aide en ligne",l_backt:"Strat\xE9gies",l_alert:"Alertes SMS",l_fullscreen:"Plein \xE9cran",l_save2:"Mise \xE0 jour du mod\xE8le en cours",l_savenew2:"Enregistre un nouveau mod\xE8le",l_gerer2:"G\xE9rer vos mod\xE8les",l_save3:"Mise \xE0 jour de l'interface en cours",l_savenew3:"Enregistre une nouvelle interface",l_gerer3:"G\xE9rer vos interfaces",l_searchsym:"Recherche valeur",l_msg1:"Vous pouvez placer 4 indicateurs au maximum sous le graphique",l_msg2:"Vous pouvez placer 6 indicateurs au maximum sous le graphique",l_msg3:"Graphique indisponible",l_msg4:"Graphique indisponible",l_ptpivot:"Points Pivots",l_fievents:"EVENEMENTS",l_mm2:"MM",l_mmt2:"MM Triang.",l_mmp2:"MM Pond\xE9r\xE9e",l_regcurve2:"LINEAR REG",l_regline2:"DROITE Reg. Lin.",l_mme2:"MM Expo",l_envmm2:"ENVELOPPE MM",l_seasonleg:"Pourcentage et performance des mois haussiers et baissiers des 10 derni\xE8res ann\xE9es",l_months:["Janv.","F\xE9vr.","Mars","Avril","Mai","Juin","Juill.","Ao\xFBt","Sept.","Oct.","Nov.","D\xE9c."],l_up:"Hausse",l_down:"Baisse",l_moy:"Moy.",l_cours:"COURS",l_b:"B",l_m:"M",l_p:"P",l_s:"S",l_varperiod:"VAR.",l_automatic:"Automatique",l_upperb:"Seuil haut",l_lowerb:"Seuil bas",l_zone:"Zone",l_traitfi:"Trait fin",l_traitep:"Trait \xE9pais",l_moymob:"Moyenne mobile",l_datasource:'<div class="clearfix pad5">Source de donn\xE9es <select id="datasource"><option value="c">Cl\xF4ture</option><option value="o">Ouverture</option><option value="h">Plus haut</option><option value="l">Plus bas</option><option value="m">(Haut + Bas)/2</option><option value="m2">(Haut + Bas + Cl\xF4t)/3</option><option value="m3">(Ouv + Haut + Bas + Cl\xF4t)/4</option></select></div>',l_suppindic:"Supprimer cet indicateur",l_resultat:"R\xE9sultat ",l_chifaff:"Chiffre d'affaires ",l_dividend:"D\xE9tachement dividende</b></br>Montant: ",l_split:"Division du nominal</b></br>Division par: ",l_supprimer:"Supprimer",l_dupliquer:"Dupliquer",l_createalert:"Cr\xE9er une alerte",l_barres:" barres",l_jours:" jours",l_prd:"P\xE9riode",l_ec:"Ecart-type",l_trace:"Trac\xE9",l_remplis:"Remplissage",l_droitereg:"Droite r\xE9gression",l_barrep:"Barre (%)",l_hausses:"Hausses",l_baisses:"Baisses",l_moyenne:"Moyenne",l_moymobile:"Moyenne mobile",l_variation:"Variation (%)",l_moymobp:"Moyenne mob. P",l_moymobe:"Moyenne mob. E",l_moymobt:"Moyenne mob. T",l_ecart:"Ecart(%)",l_coeff:"Coefficient",l_ecart2:"Ecart",l_atrperiod:"P\xE9riode ATR",l_ombres:"Ombres",l_tboite:"Taille boite",l_border:"Encadr\xE9s",l_lines:"Lignes",l_histogram:"Histogramme",l_ascend:"Ascendant",l_descend:"Descendant",l_acheteur:"Acheteur",l_vendeur:"Vendeur",l_neutre:"Neutre",l_stok:"Lissage %K",l_stod:"Lissage %D",l_lissage:"Lissage",l_stochastic:"Stochastique",l_accel:"Acc\xE9l\xE9ration",l_lineareg:"Regression lin\xE9aire",l_nomvaleur:"Nom de valeur",l_comparewith:"Comparer cette valeur",l_indice:"Avec un indice ",l_aucun:"Aucun",l_titresect:"Avec un titre du secteur ",l_autrevaleur:"Avec une autre valeur "},window.VGP={$graph:[],clickHandler:"click",urlWS:"/bourse/action/graph/ws/",drawings:[],tabCache:[],callType:"GET",noCommand:!1},window.launchTimers=function(K,le,X){window.stopTimers(),!(VGP.CCparam&&VGP.CCparam.histoLength>5)&&(VGP.tabCache={symbol:X,period:le},VGP.timer1=setInterval(function(){he("[data-brs-quote-chart]").brsQuoteChart("getChartRefresh",{})},3e4))},window.stopTimers=function(){clearInterval(VGP.timer1)},window.DisplayAlert=function(K,le){if(he("[data-brs-quote-chart-error] .c-alert__text").text(K),le===3||le===4){var X=function(W){var S=he(W);if(S&&S[0]){var b=S[0].getContext("2d");b.clearRect(0,0,S.width(),S.height())}};X("#main-eod_container1"),X("#overlay-eod_container1"),X("#trace-eod_container1"),X("#rodgraph-eod_container1"),he(".eod_mainchartinfos").empty(),he(".c-quote-chart__error").show(),he(".eod_chart").hide(),window.stopTimers()}else he(".c-quote-chart__error").fadeIn(500).delay(3e3).fadeOut(500)},window.setVariationColor=function(K,le){var X="#2cc357",W="#f11c3a",b=X,S=((le.l-le.o)*100).toFixed(1);window.VGP.shouldVariationBeInPercent?le.var<0?b=W:I="+":S<0?b=W:I="+";var b="#2cc357",I="";le.var<0?b="#f11c3a":I="+",K.each(function(ae,Z){he(Z).css("color",b),window.VGP.shouldVariationBeInPercent===!1?he(Z).children().length?he(Z).children().text(I+V(S)+" BP"):he(Z).text(I+V(S)+" BP"):he(Z).children().length?he(Z).children().text(I+V(le.var)+"%"):he(Z).text(I+V(le.var)+"%")})},window.extGetQuotesHover=function(K){if(K){var le="";if(window.VGP.showPercentChartInfo===!0&&(le+="%"),!!he("[data-brs-quote-chart-info-last]").length){if(he("[data-brs-quote-chart-info-last]").text(V(K.c)+le),he("[data-brs-quote-chart-info-open]").length&&he("[data-brs-quote-chart-info-open]").text(V(K.o)+le),he("[data-brs-quote-chart-info-high]").length&&he("[data-brs-quote-chart-info-high]").text(V(K.h)+le),he("[data-brs-quote-chart-info-low]").length&&he("[data-brs-quote-chart-info-low]").text(V(K.l)+le),he("[data-brs-quote-chart-info-vol]").length){var X=K.v,W=!1;X>1e5&&(X=Math.round(X/1e3),W=!0),typeof toLocaleString=="function"&&(X=X.toLocaleString(),W&&(X=X+" K")),he("[data-brs-quote-chart-info-vol]").text(V(X))}if(he("[data-brs-quote-chart-info-var]").length){var S=he("[data-brs-quote-chart-info-var]");window.setVariationColor(S,K)}}}};function V(K){return typeof K=="string"?parseFloat(K).toLocaleString(void 0,{maximumFractionDigits:5}):K.toLocaleString(void 0,{maximumFractionDigits:5})}window.extIndicatorsList=function(K){var le,X,W,S,b,I=document.getElementById("indicList");if(I){if(I.innerHTML="",K.ind1)for(le=0;le<K.ind1.length;le++)K.ind1[le]!=null&&(X=document.createElement("div"),X.setAttribute("class","c-quote-chart-info-area__indicator indicItem"),X.id="mainIndic_"+K.ind1[le].id,K.ind1[le].name!=="compare"?X.textContent=K.ind1[le].name.toUpperCase()+K.ind1[le].param:X.textContent=K.ind1[le].param,X.style.color=K.ind1[le].color,S=document.createElement("span"),S.setAttribute("class","manageind1"),S.setAttribute("aria-label",K.ind1[le].name+"_"+K.ind1[le].id),X.appendChild(S),b=document.createElement("span"),b.setAttribute("class","closeind1"),b.setAttribute("aria-label",K.ind1[le].name+"_"+K.ind1[le].id),X.appendChild(b),W=document.createElement("span"),W.setAttribute("class","value1"),X.appendChild(W),I.appendChild(X));if(K.ind2)for(le=0;le<K.ind2.length;le++)K.ind2[le]!=null&&(X=document.createElement("div"),X.setAttribute("class","c-quote-chart-info-area__indicator indicItem"),X.id="secondIndic_"+K.ind2[le].id,X.textContent=K.ind2[le].name.toUpperCase()+K.ind2[le].param,X.style.color=K.ind2[le].color,S=document.createElement("span"),S.setAttribute("class","manageind2"),X.appendChild(S),b=document.createElement("span"),b.setAttribute("class","closeind2"),X.appendChild(b),W=document.createElement("span"),W.setAttribute("class","value2"),X.appendChild(W),I.appendChild(X))}},he(function(){if(window.quoteChartTemplates){window.VGP.symbol=quoteChartTemplates.symbol,window.VGP.shouldVariationBeInPercent=!!quoteChartTemplates.shouldVariationBeInPercent,window.VGP.showPercentChartInfo=!!quoteChartTemplates.showPercentChartInfo,window.VGP.noAutoSaveTrace=!0,window.VGP.noAutoReadTrace=!0;var K={VGP,showDrawing:!!quoteChartTemplates.showDrawing,defaultTemplate:quoteChartTemplates.default,enableRemoteSave:quoteChartTemplates.enableRemoteSave,lineTemplate:quoteChartTemplates.line,candleTemplate:quoteChartTemplates.candle,barcolorTemplate:quoteChartTemplates.barcolor};he("[data-brs-quote-chart]").brsQuoteChart(K)}})},8700:function(){/*! rChart - 92b - 14/03/2022
 * version Boursorama
* Copyright (c) 2016-2020 - Rodolphe Vialles */function tt(j){var r=j.which?j.which:j.keyCode;return r==44||r==46?!0:!(r>31&&(r<48||r>57))}function Ue(j){if(!j.getClientRects().length)return{top:0,left:0};var r,f;return r=j.getBoundingClientRect(),f=j.ownerDocument.defaultView,{top:r.top+f.pageYOffset,left:r.left+f.pageXOffset}}function ie(j){var r={x:0,y:0},f;return j.type=="touchstart"||j.type=="touchmove"||j.type=="touchend"?(f=j.touches[0]||j.changedTouches[0],r.x=f.pageX,r.y=f.pageY):(r.x=j.pageX,r.y=j.pageY),r}function he(j){var r=j.which?j.which:j.keyCode;return!(r>31&&(r<48||r>57))}function V(j){var r=j.which?j.which:j.keyCode;return r==44||r==46||r==45?!0:!(r>31&&(r<48||r>57))}function K(j){return j=j.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),j&&j.length==4?"#"+("0"+parseInt(j[1],10).toString(16)).slice(-2)+("0"+parseInt(j[2],10).toString(16)).slice(-2)+("0"+parseInt(j[3],10).toString(16)).slice(-2):""}function le(j){return j=j.replace(/^rgba?\(|\s+|\)$/g,"").split(","),parseFloat(j[3])}function X(j,r){var f;return j=j.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(L,c,v,p){return c+c+v+v+p+p}),f=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(j),"rgba("+parseInt(f[1],16)+","+parseInt(f[2],16)+","+parseInt(f[3],16)+","+r+")"}function W(j,r){return j=""+j,r.substring(0,r.length-j.length)+j}function S(j,r){j=j.toFixed(r)+"";for(var f=/(\d+)(\d{3})/;f.test(j);)j=j.replace(f,"$1 $2");return j}function b(j,r){if(r)return j.toFixed(1)+" %";var f=Math.abs(j);return f>1e3?S(j,0):f>100?j.toFixed(1):f>2?j.toFixed(2):j.toFixed(3)}function I(j,r){j=j+"";var f=parseInt(j.substr(6));return r==1?W(Math.floor(f/60),"00")+":"+W(f%60,"00"):r==2?j.substring(4,6)+"/"+j.substring(2,4)+"/20"+j.substring(0,2):j.substring(4,6)+"/"+j.substring(2,4)+" "+W(Math.floor(f/60),"00")+":"+W(f%60,"00")}function ae(j){return j<60?j+" min":Math.floor(j/60)+"h "+j%60+"min"}function Z(j,r){var f=new Date(j*864e5);switch(r){case 1:return W(f.getDate(),"00")+"/"+W(f.getMonth()+1,"00")+"/"+f.getFullYear().toString();case 2:return W(f.getDate(),"00")+"/"+W(f.getMonth()+1,"00")+"/"+f.getFullYear().toString().substring(2,4);case 3:return W(f.getDate(),"00")+"/"+W(f.getMonth()+1,"00");case 4:return W(f.getMonth()+1,"00")+"/"+f.getFullYear().toString()}}function N(j,r){switch(r){case"c":case"o":case"h":case"l":case"v1":return j[r];case"m":return(j.h+j.l)/2;case"m2":return(j.h+j.l+j.c)/3;case"m3":return(j.o+j.h+j.l+j.c)/4;default:return j.c}}var Re,te;(function(){function j(g){for(var _="rgba(255,0,0,1)",C="rgba(0,0,192,1)",P="rgba(0,0,255,1)",G="rgba(61,68,241,0.9)",H="rgba(61,68,241,0.5)",$="rgba(192,0,0,1)",ue="rgba(192,0,0,0.9)",ee="rgba(192,0,0,0.5)",me="rgba(192,0,0,0.8)",Te="rgba(0,0,0,1)",ye="rgba(0,140,0,1)",ke="rgba(0,128,0,0.5)",rt="rgba(0,128,0,0.8)",nt="rgba(51,153,102,1)",lt="rgba(96,96,96,1)",se=[{type:"actu",params:{},color:ee},{type:"evt",params:{},color:ee},{type:"evenements",params:{},color:ee},{type:"line",color:"rgba(17,66,87,0.9)",color2:"rgba(24, 106, 142,0.8)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw"]}},{type:"line2",color:"rgba(17,66,87,1)",params:{c:[lang.l_trace],w:["sw"]}},{type:"candle",color:"rgba(0,255,0,1)",color2:_,color3:lt,params:{c:[lang.l_hausses,lang.l_baisses,lang.l_ombres]}},{type:"mm",color:_,param1:20,params:{p:[lang.l_prd],c:[lang.l_moymobile],w:["sw"]}},{type:"cmoy",color:_,w1:2,params:{c:["Cours moyen"],w:["sw"]}},{type:"barcolor",color:P,color2:_,params:{c:[lang.l_hausses,lang.l_baisses]}},{type:"bar",color:"rgba(17,66,87,1)",params:{c:["Bar Chart"]}},{type:"perf",color:"rgba(17,66,87,0.9)",color2:"rgba(24, 106, 142,0.8)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw"]}},{type:"volume",color:"rgba(3,170,2,0.75)",color2:"rgba(255,0,0,0.75)",params:{c:[lang.l_hausses,lang.l_baisses],w:["o","o"]}},{type:"boll",color:"rgba(244,143,0,0.7)",color2:"rgba(244,143,0,0.15)",param1:20,param2:2,params:{p:[lang.l_prd,lang.l_ec],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"volumecash",color:"rgba(3,170,2,0.75)",color2:"rgba(255,0,0,0.75)",params:{c:[lang.l_hausses,lang.l_baisses],w:["o","o"]}},{type:"rsi",color:C,param1:14,sh:70,sb:30,params:{c:["RSI"],p:[lang.l_prd],w:["sw"]}},{type:"fr",color:G,color2:H,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"cmo",color:C,param1:10,sh:50,sb:-50,params:{c:["CMO"],p:[lang.l_prd],w:["sw"]}},{type:"cci",color:C,param1:20,sh:100,sb:-100,params:{c:["CCI"],p:[lang.l_prd],w:["sw"]}},{type:"mom",color:ue,color2:ee,param1:12,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"macd",color:C,color2:$,color3:ke,param1:12,param2:26,param3:9,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["MACD","Signal",lang.l_histogram],w:["sw","sw"]}},{type:"sto",color:P,color2:_,param1:14,param2:3,param3:3,sh:9999,sb:9999,params:{p:[lang.l_prd,lang.l_stok,lang.l_stod],c:["%K","%D"],w:["sw","sw"]}},{type:"ichimoku",color:P,color2:"rgba(210,0,0,1)",color3:ye,color4:"rgba(64,64,255,1)",color5:"rgba(64,64,255,1)",color6:"rgba(64,64,255,0.3)",param1:26,param2:9,params:{c:["Kijun-Sen","Tenkan-Sen","Chikou-Span","Senkou A","Senkou B","Kumo"],p:["Kijun-Sen","Tenkan-Sen"],w:["sw","sw","sw","sw","sw","o"]}},{type:"phpb",color:ye,color2:"rgba(210,0,0,1)",param1:20,params:{c:[lang.l_hausses,lang.l_baisses],p:[lang.l_prd]}},{type:"lineard",param1:30,param2:1,color:Te,color2:"rgba(0,128,128,1)",color3:$,params:{p:[lang.l_prd,lang.l_ec],c:[lang.l_droitereg,"Resistance","Support"],w:["w","w","w"]}},{type:"supres",param1:5,color:ke,color2:"rgba(255,0,0,0.4)",params:{p:[lang.l_barrep],c:[lang.l_hausses,lang.l_baisses],w:["o","o"]}},{type:"coppock",param1:11,param2:14,param3:10,color:"rgba(0,0,128,0.8)",color2:"rgba(0,0,128,0.3)",params:{p:["ROC 1","ROC2",lang.l_moyenne],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"compare",color:_,params:{c:["Style"],w:["sw"]}},{type:"pivots",color:"rgba(0,0,0,0.7)",color2:"rgba(255,0,0,0.7)",color3:"rgba(0,128,0,0.7)",params:{c:["Pivot","Supports","Resistances"]}},{type:"zig zag",color:_,param1:3,params:{p:[lang.l_variation],c:["Zig Zag"],w:["sw"]}},{type:"mmp",color:"rgba(180,0,0,1)",param1:15,params:{p:[lang.l_prd],c:[lang.l_moymobp],w:["sw"]}},{type:"mmh",color:"rgba(180,0,0,1)",param1:9,params:{p:[lang.l_prd],c:[lang.l_mmh2],w:["sw"]}},{type:"double EMA",color:_,param1:20,params:{p:[lang.l_prd],c:["Double EMA"],w:["sw"]}},{type:"triple EMA",color:P,param1:20,params:{p:[lang.l_prd],c:["Triple EMA"],w:["sw"]}},{type:"alligator",color:P,color2:_,color3:ye,param1:13,param2:8,param3:5,params:{p:["Jaw","Teeth","Lips"],c:["Jaw","Teeth","Lips"],w:["sw","sw","sw"]}},{type:"mme",color:P,param1:30,params:{p:[lang.l_prd],c:[lang.l_moymobe],w:["sw"]}},{type:"mmt",color:P,param1:20,params:{p:[lang.l_prd],c:[lang.l_moymobt],w:["sw"]}},{type:"evmm",color:"rgba(192,0,0,0.7)",color2:"rgba(192,0,0,0.15)",param1:20,param2:2,params:{p:[lang.l_prd,lang.l_ecart],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"donchian",color:"rgba(0,128,0,0.7)",color2:"rgba(0,128,0,0.15)",param1:20,params:{p:[lang.l_prd],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"gmma",color:ye,color2:$,params:{c:["Fast","Slow"],w:["sw","sw"]}},{type:"supertrend",color:$,color2:ye,param1:10,param2:3,params:{p:[lang.l_prd,lang.l_coeff],c:["Resistance","Support"],w:["w","w"]}},{type:"keltner",color:"rgba(0,128,0,0.7)",color2:"rgba(0,128,0,0.20)",param1:20,param2:2,param3:10,params:{p:[lang.l_prd,lang.l_ecart2,lang.l_atrperiod],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"heikin ashi",color:nt,color2:"rgba(255,64,64,1)",color3:lt,params:{c:[lang.l_hausses,lang.l_baisses,lang.l_ombres]}},{type:"renko",color:nt,color2:_,color3:lt,params:{p:[lang.l_tboite],c:[lang.l_hausses,lang.l_baisses,lang.l_border]},nolinearX:!0},{type:"point figure",color:nt,color2:_,param2:3,params:{p:["Box","Reverse"],c:[lang.l_hausses,lang.l_baisses]},nolinearX:!0},{type:"kagi",color:"rgba(51,102,255,1)",color2:"rgba(255,64,64,1)",params:{p:[lang.l_tboite],c:["Yang","Yin"]},nolinearX:!0},{type:"equivolume",color:"rgba(51,102,255,1)",color2:"rgba(255,64,64,1)",params:{c:[lang.l_hausses,lang.l_baisses]},nolinearX:!0},{type:"line break",color:nt,color2:_,color3:lt,params:{p:[lang.l_lines],c:[lang.l_hausses,lang.l_baisses,lang.l_border]},nolinearX:!0},{type:"hollow",color:"rgba(7,103,69,1)",color2:_,color3:lt,params:{c:[lang.l_hausses,lang.l_baisses,lang.l_ombres]}},{type:"accDist",color:ue,color2:ee,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"obv",color:G,color2:H,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"forceindex",color:G,color2:H,param1:13,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"ulcer",color:P,param1:14,params:{c:["Ulcer Index"],p:[lang.l_prd],w:["sw"]}},{type:"perfi",color:G,color2:H,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"kvo",color:"rgba(0,0,128,1)",color2:ye,params:{c:["KVO","Signal"],w:["sw","sw"]}},{type:"ultimate",color:C,param1:7,param2:14,param3:28,sh:70,sb:30,params:{c:["Ultimate Osc."],p:[lang.l_mm2+" 1",lang.l_mm2+" 2",lang.l_mm2+" 3"],w:["sw"]}},{type:"bollb",color:C,param1:20,sh:100,sb:0,params:{c:["Bollinger %B"],p:[lang.l_prd],w:["sw"]}},{type:"bollw",color:"rgba(255,102,0,1)",param1:20,param2:2,params:{c:[lang.l_trace],p:[lang.l_prd,lang.l_ec],w:["sw"]}},{type:"atr",color:C,param1:14,params:{c:["ATR"],p:[lang.l_prd],w:["sw"]}},{type:"eom",color:ue,color2:ee,param1:14,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"cmf",color:ue,color2:ee,param1:21,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"dpo",color:ue,color2:ee,param1:20,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"asi",color:ue,color2:"rgba(192,0,0,0.4)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"nvi",color:$,params:{c:["NVI"],w:["sw"]}},{type:"pvi",color:C,params:{c:["PVI"],w:["sw"]}},{type:"macdzl",color:C,color2:$,color3:ke,param1:12,param2:26,param3:9,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["MACD Z\xE9ro Lag","Signal",lang.l_histogram],w:["sw","sw"]}},{type:"wto",color:C,color2:$,color3:ke,param1:10,param2:21,sh:60,sb:-60,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2"],c:["Wave Trend Osc","Signal",lang.l_histogram],w:["sw","sw"]}},{type:"macdh",color:"rgba(0,0,192,0.8)",color2:me,param1:12,param2:26,param3:9,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["MACD > Signal","MACD < Signal"]}},{type:"awesome",color:rt,color2:me,param1:5,param2:34,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2"],c:[lang.l_ascend,lang.l_descend]}},{type:"bop",color:rt,color2:me,color3:"rgba(128,128,128,0.8)",params:{c:[lang.l_acheteur,lang.l_vendeur,lang.l_neutre]}},{type:"qstick",color:rt,color2:me,param1:5,params:{p:[lang.l_prd],c:[lang.l_hausses,lang.l_baisses]}},{type:"elderbear",color:$,color2:$,param1:13,params:{p:[lang.l_prd],c:[lang.l_hausses,lang.l_baisses]}},{type:"elderbull",color:ye,color2:ye,param1:13,params:{p:[lang.l_prd],c:[lang.l_hausses,lang.l_baisses]}},{type:"dmi",color:ye,color2:$,color3:Te,param1:14,params:{p:[lang.l_prd],c:["DI+","DI-","ADX"],w:["sw","sw","sw"]}},{type:"aroon",color:ye,color2:$,param1:14,params:{p:[lang.l_prd],c:["Aroon up","Aroon down"],w:["sw","sw"]}},{type:"adx",color:Te,color2:$,param1:14,sh:9999,sb:9999,params:{p:[lang.l_prd],c:["ADX","ADXR"],w:["sw","sw"]}},{type:"vortex",color:ye,color2:$,param1:14,params:{p:[lang.l_prd],c:["+VI","-VI"],w:["sw","sw"]}},{type:"roc",color:C,param1:10,sh:9999,sb:9999,params:{c:["Rate of change"],p:[lang.l_prd],w:["sw"]}},{type:"std",color:C,param1:10,params:{c:["Std Deviation"],p:[lang.l_prd],w:["sw"]}},{type:"di",color:P,param1:10,params:{c:["Demand Index"],p:[lang.l_prd],w:["sw"]}},{type:"sto rsi",color:P,color2:_,param1:14,param2:3,param3:3,param4:14,sh:80,sb:20,params:{p:[lang.l_prd+" Sto.",lang.l_stok,lang.l_stod,lang.l_prd+" RSI"],c:["%K","%D"],w:["sw","sw"]}},{type:"smi",color:"rgba(128,128,128,1)",color2:_,param1:14,param2:3,param3:5,param4:3,sh:9999,sb:9999,params:{p:[lang.l_prd,lang.l_lissage+" 1",lang.l_lissage+" 2","Signal"],c:[lang.l_stochastic,"Signal"],w:["sw","sw"]}},{type:"tsi",color:Te,color2:_,param1:25,param2:13,param3:13,sh:9999,sb:9999,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["True Strength","Signal"],w:["sw","sw"]}},{type:"kst",color:P,color2:_,param1:10,param2:15,param3:20,param4:30,params:{p:["ROC 1","ROC 2","ROC 3","ROC 4"],c:["KST","Signal"],w:["sw","sw"]}},{type:"trix",color:C,param1:12,params:{c:["TRIX"],p:[lang.l_prd],w:["sw"]}},{type:"mass index",color:C,param1:25,params:{c:["Mass Index"],p:[lang.l_prd],w:["sw"]}},{type:"vroc",color:C,param1:10,params:{c:["Volume ROC"],p:[lang.l_prd],w:["sw"]}},{type:"moonphase",color:"rgba(255,153,0,0.9)",color2:"rgba(255,204,0,0.5)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw"]}},{type:"ac will",color:"rgba(61,68,241,0.9)",color2:"rgba(61,68,241,0.5)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"will r",color:$,param1:14,sh:-20,sb:-80,params:{c:["Williams %R"],p:[lang.l_prd],w:["sw"]}},{type:"mfi",color:$,param1:14,sh:80,sb:20,params:{c:["Money flow idx"],p:[lang.l_prd],w:["sw"]}},{type:"sar",color:"rgba(210,0,0,1)",color2:ye,param1:.02,param2:.2,params:{c:[lang.l_baisses,lang.l_hausses],p:[lang.l_accel]}},{type:"linearc",color:"rgba(255,0,255,1)",param1:10,params:{c:[lang.l_lineareg],p:[lang.l_prd],w:["sw"]}},{type:"linearo",color:ue,color2:ee,param1:10,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}}],St=se.length,Mt=0;Mt<St;Mt++)if(se[Mt].type==g)return se[Mt]}function r(){for(var g,_=1;_<arguments.length;_++)for(g in arguments[_])arguments[_].hasOwnProperty(g)&&(typeof arguments[0][g]=="object"&&typeof arguments[_][g]=="object"?r(arguments[0][g],arguments[_][g]):arguments[0][g]=arguments[_][g]);return arguments[0]}function f(g){return g=g.replace(/'/g,"%27"),g.replace(/"/g,"%22")}function L(){var g="test";try{return localStorage.setItem(g,g),localStorage.removeItem(g),!0}catch(_){return!1}}function c(g){try{return JSON.parse(JSON.stringify(g))}catch(_){}}function v(g,_,C){var P=g.QuoteTab,G,H=0,$=999999,ue=P.length;for(_||(_=0),C?C>ue&&(C=ue):C=ue,G=_;G<C;G++)P[G].h>H&&(H=P[G].h),P[G].l<$&&($=P[G].l);return g.High=H,g.Low=$,g}function p(){return{bkcolor:"#fff",txtColor:"#606060",gridV:!0,gridH:!0,gridLine:!0,gridColor:"#e0e0e0",isEncadre:!0,yaxis:!1,nosticky:!1,reticColor:"#114257",semilog:!1,cadreColor:"#e0e0e0",traceColor:null,noVeilleIntra:!1,veilleStyle:!1,veilleColor:"#fe0000",fontSize:11,splitStyle:"band",splitColor:"rgba(153,153,153,1)"}}var o,h;Math.log10=Math.log10||function(g){return Math.log(g)/Math.LN10},o=new function(){this.gi=function(g){return document.getElementById(g)},this.qsa=function(g){return document.querySelectorAll(g)},this.qs=function(g){return document.querySelector(g)},this.qsga=function(g,_){var C=this.qs(g);if(C!=null)return C.getAttribute(_)},this.idempty=function(g){var _=this.gi(g);_!=null&&(_.innerHTML="")},this.qsaempty=function(g){var _=this.qsa(g);[].forEach.call(_,function(C){C.innerHTML=""})},this.clrem=function(g){for(var _,C,P=0;P<g.length;P++)for(_=document.getElementsByClassName(g[P]),C=_.item(0);C;)C.parentNode.removeChild(C),C=_.item(0)},this.idrem=function(g){var _=this.gi(g);_!=null&&_.parentNode.removeChild(_)},this.qsarem=function(g){var _=this.qsa(g);[].forEach.call(_,function(C){C.parentNode.removeChild(C)})},this.qsarclass=function(g,_){var C=this.qsa(g);[].forEach.call(C,function(P){P.classList.remove(_)})},this.qsaaclass=function(g,_){var C=this.qsa(g);[].forEach.call(C,function(P){P.classList.add(_)})},this.clcss=function(g,_,C){for(var P=document.getElementsByClassName(g),G=0;G<P.length;G++)P[G].style[_]=C},this.idst=function(g,_){var C=this.gi(g);C!=null&&(C.textContent=_)},this.idhtml=function(g,_){var C=this.gi(g);C!=null&&(C.innerHTML=_)},this.idcss=function(g,_,C){var P=this.gi(g);P!=null&&(P.style[_]=C)},this.gigt=function(g){var _=this.gi(g);return _!=null?_.textContent:""},this.qstxt=function(g,_){var C=this.qs(g);C!=null&&(C.textContent=_)},this.qshtml=function(g,_){var C=this.qs(g);C!=null&&(C.innerHTML=_)},this.clhide=function(g){for(var _=document.getElementsByClassName(g),C=0;C<_.length;C++)_[C].style.display="none"}},h=function(g){function _(){if(d.hideTrace){var e=document.createElement("div");e.id=ge("hst-"),e.setAttribute("class","spg hst_icon"),e.setAttribute("style","top:"+(d.paddingTop+3)+"px;right:"+(d.paddingRight+5)+"px"),O.doc.appendChild(e),O.clickHandler.forEach(function(t){o.gi(ge("hst-")).addEventListener(t,O.hideShowTrace)})}else o.idrem(ge("hst-"))}function C(e){var t="default";switch(e){case"c":t="crosshair";break;case"p":t="pointer";break;case"m":t="move";break;case"n":t="ns-resize";break;case"zi":t="zoom-in";break;default:t="default"}O.doc.style.cursor=t}function P(){C("zi"),O.doc.addEventListener("mousedown",H),O.doc.addEventListener("touchstart",H),fe("mousedown",H),fe("touchstart",H),O.doc.addEventListener("touchmove",$),O.doc.addEventListener("mousemove",$),fe("touchmove",$),fe("mousemove",$)}function G(){J.tmp1=null,je(),ee()}function H(e){e.preventDefault();var t=Ue(o.gi(ge("rodgraph-"))),a=ie(e),i=parseInt(a.x-t.left),l=parseInt(a.y-t.top),s=d;i<s.innerWidth+s.paddingLeft&&i>s.paddingLeft&&l>s.paddingTop&&l<R[0].HeightPx+s.paddingTop&&(J.tmp1=i,O.doc.addEventListener("mouseup",ue),O.doc.addEventListener("touchend",ue),fe("mouseup",ue),fe("touchend",ue))}function $(e){var t,a,i;e.preventDefault();var l=Ue(o.gi(ge("rodgraph-"))),s=ie(e),n=parseInt(s.x-l.left),u=d,m=o.gi(ge("overlay-")),y=m.getContext("2d");if(!J.tmp1){y.strokeStyle=u.set.reticColor,y.clearRect(0,0,m.width,m.height),y.beginPath(),y.moveTo(n+.5,u.paddingTop),y.lineTo(n+.5,R[0].HeightPx+u.paddingTop),y.stroke(),t=new Ae(n,0),y.fillStyle=u.set.reticColor,y.fillText(u.chartPeriod>=0?Z(t.x,1):I(t.x),t.mx,R[0].HeightPx+u.paddingTop-3);return}J.tmp2=n,y.fillStyle="rgba(255,106,0,0.3)",y.clearRect(0,0,m.width,m.height),y.fillRect(J.tmp1,u.paddingTop,n-J.tmp1,R[0].HeightPx),a=new Ae(Math.min(J.tmp1,J.tmp2),0),i=new Ae(Math.max(J.tmp1,J.tmp2),0),y.fillStyle=u.set.reticColor,y.fillText(u.chartPeriod>=0?Z(a.x,1):I(a.x),a.mx,R[0].HeightPx),y.fillText(u.chartPeriod>=0?Z(i.x,1):I(i.x),i.mx,R[0].HeightPx+u.paddingTop-3)}function ue(e){var t,a;e.preventDefault();for(var i=new Ae(Math.min(J.tmp1,J.tmp2),0),l=new Ae(Math.max(J.tmp1,J.tmp2),0),s=B.QuoteTab.length,n=0;n<s;n++)if(B.QuoteTab[n].d==i.x&&(U.minX=n),B.QuoteTab[n].d==l.x){U.maxX=n;break}t=o.gi(ge("overlay-")),a=t.getContext("2d"),a.clearRect(0,0,t.width,t.height),zt(),Ee(),G(),typeof extResetTools=="function"&&extResetTools()}function ee(){var e,t;J.eventsActive||(e=o.gi(ge("overlay-")).getContext("2d"),e.font=d.set.fontSize+"px Arial",e.strokeStyle=d.set.reticColor,e.lineWidth=1,e.setLineDash&&e.setLineDash([3]),J.lineNumber=999,J.cursorState=!1,VGP.noCommand&&o.clrem(["mci-p","closelayericon","eodmovedown","eodmoveup"]),O.doc.addEventListener("mousewheel",Kt),O.doc.addEventListener("DOMMouseScroll",Kt),O.doc.addEventListener("mouseleave",ke),O.doc.addEventListener("touchmove",nt),O.doc.addEventListener("mousemove",nt),O.doc.addEventListener("mouseup",St),O.doc.addEventListener("touchend",St),O.doc.addEventListener("mousedown",se),O.doc.addEventListener("touchstart",se),t=o.gi("indicList"),t&&(t.addEventListener("mousedown",lt),t.addEventListener("touchstart",lt)),J.eventsActive=!0)}function me(e,t){var a,i,l,s;for(d=r(d,e),a=j(d.mainChart.type),a=r(a,d.mainChart.typedef),d.mainChart.typedef=a,l=d.mainChart.indicators.length,i=0;i<l;i++)a=j(d.mainChart.indicators[i].type),a=r(a,d.mainChart.indicators[i]),d.mainChart.indicators[i]=a;s=d.set.fontSize-11,d.set.yaxis?(e.paddingRight!=null?d.paddingRight+=s*4:d.paddingRight=10+s*4,e.paddingLeft!=null?d.paddingLeft+=s*4:d.paddingLeft=45+s*4):(e.paddingRight!=null?d.paddingRight+=s*4:d.paddingRight=45+s*4,e.paddingLeft!=null?d.paddingLeft+=s*4:d.paddingLeft=10+s*4),d.paddingTop+=s,d.paddingBottom+=s,d.innerWidth=d.widthGraph-d.paddingRight-d.paddingLeft,d.marginInter=3,d.usableHeight=d.heightGraph-d.paddingTop-d.paddingBottom-d.indicators.length*d.marginInter,Bt(t)}function Te(e){var t,a=e.mainChart.indicators.length,i;if(e.isCompare!=null&&e.isCompare!=!0&&e.isCompare!=!1){for(t=0;t<a;t++)e.mainChart.indicators[t].type=="compare"&&(e.mainChart.indicators[t].symbol=e.isCompare,e.isCompare=!0,i=1);i||(e.isCompare=!1)}e.isCompare==null&&(e.isCompare=!1)}function ye(e){for(var t=p(),a=Object.keys(t),i=a.length,l=0;l<i;l++)e.set[a[l]]==t[a[l]]&&delete e.set[a[l]];return e}function ke(){var e=o.gi(ge("overlay-")),t=e.getContext("2d"),a,i,l,s,n,u,m,y;if(t.clearRect(0,0,e.width,e.height),a=d,!a.mainChart.typedef.nolinearX){if(i=0,a.mainChart.type!="perf"&&(i=Rr(a.chartPeriod<0).toFixed(2)),l=R[0].Bars[0][0],l!=null&&(a.chartPeriod<0?(s=B.qd,s.dt=I(l.d,2)):(s=B.QuoteTab[l.i],s.dt=Z(l.d,1)),s.var=i,a.mainChart.type!="perf",typeof extGetQuotesHover=="function"&&extGetQuotesHover(s)),a.mainChart.type!="perf")for(u=a.mainChart.indicators.length,n=0;n<u;n++)m=a.mainChart.indicators[n].type,m!="lineard"&&m!="pivots"&&m!="gmma"&&o.qstxt("#mainIndic_"+n+" .value1",rt(R[0].Bars[n+1][0]));if(l!=null)for(y=R.length,n=1;n<y;n++)R[n].type!="volume"&&o.qstxt("#secondIndic_"+n+" .value2",rt(R[n].Bars[l.d]))}}function rt(e){if(e==null)return"";var t,a=e.length,i="";if(a==null)return Math.abs(e)<2?e.toFixed(3):e.toFixed(2);for(t=0;t<a;t++)i=Math.abs(e[t])<2?i+e[t].toFixed(3)+" - ":i+e[t].toFixed(2)+" - ";return i.substring(0,i.length-3)}function nt(e){var t,a,i,l,s,n,u,m,y,x,T,M,A,D,k,E,Y,F,q,Q,ce,de,_e,Me,Ye,Qe;if(J.isPinchZoom){e.preventDefault(),e.touches.length==2&&(t=Math.hypot(e.touches[0].pageX-e.touches[1].pageX,e.touches[0].pageY-e.touches[1].pageY),a=.33,J.distPinchZoom>0&&(t>J.distPinchZoom?Pa(a):Ca(a)),J.distPinchZoom=t);return}if(d.cursor!="b"){e.preventDefault();var Oe=Ue(o.gi(ge("rodgraph-"))),Xe=ie(e),we=parseInt(Xe.x-Oe.left),qe=parseInt(Xe.y-Oe.top),Pe,pe=d;if(J.moveLayer){if(J.activeLayer==null)return;Mt(qe,J.activeLayer);return}if(J.moveZoomX!=0&&J.moveZoomY!=0){oo(we,qe);return}if(J.isVerticalZoom){var ve=qe-J.moveZoomY,Le=(U.maxY-U.minY)/pe.heightGraph,be=ve*Le*2;U.minY=U.minY-be,U.maxY=U.maxY+be,J.moveZoomY=qe,Be(0);return}if(i=Va(we,qe),pe.mainChart.type=="perf"||pe.mainChart.typedef.nolinearX||(J.lineNumber=Ta(we,qe,i)),d.mainChart.type!="perf"&&qe>pe.paddingTop&&(!pe.set.yaxis&&we>pe.widthGraph-pe.paddingRight||pe.set.yaxis&&we<pe.paddingLeft)){C("n");return}if(l=o.gi(ge("overlay-")),s=l.getContext("2d"),we<l.width-pe.paddingRight&&we>pe.paddingLeft&&qe>pe.paddingTop&&qe<l.height-pe.paddingBottom){if(s.clearRect(0,0,l.width,l.height),i!=null){if(Ie[we]!=null){for(n=pe.chartPeriod>=0?Z(Ie[we],1):I(Ie[we]),O.lastdatehover=n,u=R[0].Bars,u[0][Ie[we]]!=null&&(m=u[0][Ie[we]].i,y=0,m>0&&(x=B.QuoteTab[m-1+U.minX].c,y=pe.mainChart.type=="perf"?parseFloat(u[0][Ie[we]].c):pe.chartPeriod<0?(u[0][Ie[we]].c-B.qv.c)*100/B.qv.c:(u[0][Ie[we]].c-x)*100/x),y=y.toFixed(2),T=B.QuoteTab[m+U.minX],T.dt=n,T.var=y,pe.mainChart.type=="perf"?u[0][Ie[we]]&&(M=xe(u[0][Ie[we]].c,pe.logData)+pe.paddingTop):M=xe(T.c,pe.logData)+pe.paddingTop,O.lastCloseHover={x:we,y:M,c:T.c},typeof extGetQuotesHover=="function"&&extGetQuotesHover(T)),O.hoverIndics=[],A=R.length,Pe=1;Pe<A;Pe++)R[Pe].type!="volume"&&o.qstxt("#secondIndic_"+Pe+" .value2",rt(R[Pe].Bars[Ie[we]])),D=R[Pe].RealY+R[Pe].V0-R[Pe].PxPointY*R[Pe].Bars[Ie[we]],O.hoverIndics.push({x:we,y:D,c:R[Pe].Indicator.color});if(pe.mainChart.type!="perf"){for(A=pe.mainChart.indicators.length,Pe=0;Pe<A;Pe++)if(k=pe.mainChart.indicators[Pe].type,k!="lineard"&&u[Pe+1]!=null)if(o.qstxt("#mainIndic_"+Pe+" .value1",rt(u[Pe+1][Ie[we]])),k=="boll"||k=="keltner"||k=="evmm"||k=="donchian"||k=="ichimoku"||k=="alligator")u[Pe+1][Ie[we]]!=null&&(Y=u[Pe+1][Ie[we]],Y[0]!=null&&(E=xe(Y[0],pe.logData)+pe.paddingTop,O.hoverIndics.push({x:we,y:E,c:pe.mainChart.indicators[Pe].color})),Y[1]!=null&&(E=xe(Y[1],pe.logData)+pe.paddingTop,k=="ichimoku"||k=="alligator"?O.hoverIndics.push({x:we,y:E,c:pe.mainChart.indicators[Pe].color2}):O.hoverIndics.push({x:we,y:E,c:pe.mainChart.indicators[Pe].color})),Y[2]!=null&&(E=xe(Y[2],pe.logData)+pe.paddingTop,O.hoverIndics.push({x:we,y:E,c:pe.mainChart.indicators[Pe].color3})));else if(k=="compare"){if(pe.mainChart.indicators[Pe].datas2){var Ve=B.QuoteTab[U.minX].c,ne=pe.mainChart.indicators[Pe].datas2.QuoteTab[U.minX].c,Dt=u[Pe+1][Ie[we]],Wt=(Dt-ne)/ne,ct=R[0].PxPointY*Ve,gt=Math.round((R[0].V0-Ve)*R[0].PxPointY),re=R[0].V0-(gt-Wt*ct)/R[0].PxPointY;E=xe(re,pe.logData)+pe.paddingTop,O.hoverIndics.push({x:we,y:E,c:pe.mainChart.indicators[Pe].color})}}else E=xe(u[Pe+1][Ie[we]],pe.logData)+pe.paddingTop,O.hoverIndics.push({x:we,y:E,c:pe.mainChart.indicators[Pe].color})}}else we-pe.paddingLeft>ze.length-1?(F=Math.round((we-pe.paddingLeft-(ze.length-1))/R[0].PxPointX),q=La(F),n=pe.chartPeriod>=0?Z(q,1):I(q)):n=O.lastdatehover;if(s.fillStyle=pe.set.reticColor,O.lastCloseHover&&!pe.mainChart.typedef.nolinearX&&(s.beginPath(),s.arc(O.lastCloseHover.x,O.lastCloseHover.y,5,0,2*Math.PI),s.fill()),O.lastCloseHover&&(s.beginPath(),Q=pe.set.fontSize-11,pe.cursor=="r"&&O.lastCloseHover.x&&(pe.isCompare||d.mainChart.typedef.nolinearX||(s.moveTo(pe.paddingLeft,O.lastCloseHover.y+.5),s.lineTo(l.width-pe.paddingRight,O.lastCloseHover.y+.5)),s.moveTo(O.lastCloseHover.x+.5,pe.paddingTop),s.lineTo(O.lastCloseHover.x+.5,l.height-pe.paddingBottom),s.stroke()),ce=68+Q*2,de=we-ce/2,de<pe.paddingLeft&&(de=pe.paddingLeft),s.fillRect(de,l.height-pe.paddingBottom+1,ce,pe.paddingBottom-1),s.fillRect(de,-2,ce,pe.paddingTop+2),s.fillStyle=Yt(pe.set.reticColor),_e=Math.round(s.measureText(n).width),s.fillText(n,Math.round(de+(ce-_e)/2),l.height-6),s.fillText(n,Math.round(de+(ce-_e)/2),11+Q),pe.chartPeriod>=0&&!pe.isCompare&&!pe.mainChart.typedef.nolinearX&&(Ye=B.QuoteTab[U.minX]!=null?B.QuoteTab[U.minX].c:B.QuoteTab[0].c,Me=(O.lastCloseHover.c-Ye)*100/Ye,s.fillStyle=Me>=0?"#008000":"#fe0000",pe.set.yaxis?s.fillRect(0,O.lastCloseHover.y-8,pe.paddingLeft,17+Q):s.fillRect(pe.widthGraph-pe.paddingRight,O.lastCloseHover.y-8,pe.paddingRight,18+Q)),pe.chartPeriod>=0&&!pe.isCompare&&!pe.mainChart.typedef.nolinearX&&(Qe=pe.set.yaxis?2:l.width-pe.paddingRight+5,Me=Me>0?"+"+Me.toFixed(1)+"%":Me.toFixed(1)+"%",s.fillStyle="#ffffff",s.fillText(Me,Qe-2,O.lastCloseHover.y+5+Q))),O.hoverIndics)for(Pe=0;Pe<O.hoverIndics.length;Pe++)s.fillStyle=O.hoverIndics[Pe].c,s.beginPath(),s.arc(O.hoverIndics[Pe].x,O.hoverIndics[Pe].y,5,0,2*Math.PI),s.fill()}}else s.clearRect(0,0,l.width,l.height);J.activeLayer=yo(qe),J.activeLayer!=null?(C("n"),J.cursorState=!0):J.cursorState&&(J.cursorState=!1,C())}}function lt(e){var t,a,i,l,s,n,u,m;switch(e.preventDefault(),t=e.target,t.className){case"manageind2":J.flagSave=!0,We(),a=t.parentNode.id.slice(-1),Na(null,null,a);break;case"manageind1":J.flagSave=!0,We(),s=t.getAttribute("aria-label").split("_"),i=s.length>1?s[1]:null,Na(i,s[0],null);break;case"closeind1":if(J.flagSave=!0,We(),s=t.getAttribute("aria-label").split("_"),n=s[0],i=s[1],d.mainChart.indicators.splice(i,1),R[0].Bars.splice(parseInt(i)+1,1),n=="compare"){for(u=d.mainChart.indicators.length,m=0,l=0;l<u;l++)d.mainChart.indicators[l].type=="compare"&&m++;if(m==0)for(d.isCompare=!1,l=1;l<R.length;l++)R[l].Indicator.type=="fr"&&Qt(l)}d.newsConfig&&(J.fiEvt=[],o.clrem(["svginfofi"])),Be(0);break;case"closeind2":J.flagSave=!0,We(),a=t.parentNode.id.slice(-1),Qt(a)}}function se(e){var t,a,i,l,s,n;if(!J.isPinchZoom){if(e.touches&&e.touches.length==2){J.isPinchZoom=!0,J.distPinchZoom=0;return}if(d.cursor!="b"){if(t=e.target,e.preventDefault(),a=o.gi(ge("overlay-")),i=a.getContext("2d"),i.clearRect(0,0,a.width,a.height),t.tagName.toUpperCase()!="A"&&Yr(),!VGP.noCommand)switch(t.className){case"closelayericon":e.stopPropagation(),l=t.parentNode.id.slice(-1),Qt(l);return;case"eodmoveup":e.stopPropagation(),Qr("up",t);return;case"eodmovedown":e.stopPropagation(),Qr("down",t);return;case"eod_param":case"mci-p":J.flagSave=!0,We(),s=t.className=="mci-p"?t.parentNode.getAttribute("data-name").split("_"):t.getAttribute("data-name").split("_"),n=s.length>1?s[1]:null,Na(n,s[0],null);return}if(e.type!="touchstart"||d.cursor=="t")if(J.lineNumber!=999)at(J.lineNumber);else{if(J.cursorState){J.moveLayer=!0;return}var u=ie(e),m=Ue(o.gi(ge("rodgraph-"))),y=parseInt(u.x-m.left),x=parseInt(u.y-m.top);if(d.mainChart.type!="perf"&&x>d.paddingTop&&(!d.set.yaxis&&y>d.widthGraph-d.paddingRight||d.set.yaxis&&y<d.paddingLeft)){J.isVerticalZoom=!0,J.moveZoomY=x;return}C("m"),J.moveZoomX=y,J.moveZoomY=x,J.initMaxY=U.maxY,J.initMinY=U.minY,J.initViewBegin=U.minX,J.initViewEnd=U.maxX}}}}function St(e){if(J.isPinchZoom){J.isPinchZoom=!1;return}if(J.isVerticalZoom){J.isVerticalZoom=!1;return}if(e.type=="touchend"&&!d.mainChart.typedef.nolinearX){var t=e.touches[0]||e.changedTouches[0],a=Ue(o.gi(ge("rodgraph-"))),i=parseInt(t.pageX-a.left),l=parseInt(t.pageY-a.top);if(J.lineNumber=Ta(i,l,Va(i,l)),J.lineNumber!=999){at(J.lineNumber);return}}J.moveLayer=!1,J.activeLayer=null,J.moveZoomX=0,J.moveZoomY=0,C()}function Mt(e,t){var a=R[t].RealY-e,i;if(!(R[t].HeightPx+a<30)&&!(R[t-1].HeightPx-a<30)){R[t].Move(e,a,t),R[t].DrawEncadre(),o.idcss(ge("infoindic-")+t,"top",e+5+"px"),R[t-1].Move(R[t-1].RealY,-a,t-1),R[t-1].DrawEncadre(),J.activeLayer==1&&(i=o.gi(ge("trace-")),i.height=i.height-a),Be(t);return}}function oo(e,t){var a=J.initViewBegin,i=t-J.moveZoomY,l=i/R[0].PxPointY,s,n,u;Math.abs(i)<7&&(l=0),s=Math.round((e-J.moveZoomX)/R[0].PxPointX),(s!=0||l!=0)&&(n=!0,u=!0,(d.mainChart.type=="perf"||d.set.semilog||t>R[0].RealY+R[0].HeightPx)&&(l=0),l==0&&(u=!1),U.maxY=J.initMaxY+l,U.minY=J.initMinY+l,a-U.minX==s&&(n=!1),ze.length<=200&&s<0&&(n=!1),a-s<0&&(n=!1),n&&(U.minX=a-s,U.maxX=J.initViewEnd-s),n||u)&&Ee(!0)}function Ta(e,t,a){var i;if(a!=0||d.hideTrace)return C(),999;for(var l=t-d.paddingTop,s=e-d.paddingLeft,n=z.length,u,m=0;m<n;m++)switch(u=z[m],u.type){case"c":if(hl(s,l,u))return C("p"),m;break;case"t":case"wf":if(ml(s,l,u))return C("p"),m;break;case"ewi":case"ewc":if(pl(s,l,u))return C("p"),m;break;case"arrup":case"arrdw":case"arrrt":case"arrlt":case"sm1":case"sm2":if(dl(s,l,u))return C("p"),m;break;default:if(s>=Math.min(u.RealX0,u.RealX1)-2&&s<Math.max(u.RealX0,u.RealX1)+2)switch(u.type){case"r":case"rf":case"m":if(i=u.type=="rf"?Math.ceil(u.RealY0+(u.RealY0-u.RealY1)*.618):u.RealY0,l<i+4&&l>i-4||l<u.RealY1+4&&l>u.RealY1-4||s>=u.RealX0-2&&s<=u.RealX0+2||s>=u.RealX1-2&&s<=u.RealX1+2)return C("p"),m;break;case"sr":case"h":if(l>u.RealY0-3&&l<u.RealY0+3)return C("p"),m;break;case"mv":if(l>Math.min(u.RealY0,u.RealY1)-3&&l<Math.max(u.RealY0,u.RealY1)+3)return C("p"),m;break;default:var y=Sr(u,s,l),x=s-y.x,T=l-y.y,M=Math.abs(Math.sqrt(x*x+T*T));if(M<5)return C("p"),m}}return C(),999}function Pa(e){if(B==null||ze.length==0||ze[ze.length-1].i<25||U.maxX-U.minX<25)return!0;var t=U.maxX-U.minX,a=Math.round((-75e-7*t*t+.025*t+7.8)*e);U.minX=U.minX+a,zt(),Ee(!0,!1)}function Ca(e){var t,a,i;if(B!=null){if(t=U.maxX-U.minX,a=Math.round((-75e-7*t*t+.025*t+7.8)*e),d.mainChart.typedef.nolinearX)U.minX>0?(U.minX=U.minX-a,U.minX<0&&(U.minX=0)):U.maxX=U.maxX+a,U.maxX>U.maxNL&&U.minX==0&&(U.maxX=U.maxNL);else if(U.minX>0)U.minX=U.minX-a,U.minX<0&&(U.minX=0);else if(U.maxX=U.maxX+a,U.maxX>B.QuoteTab.length-1)return U.maxX=B.QuoteTab.length-1,zt(),d.histoLength!=1||d.set.noVeilleIntra||(i=B.qv.c,i>U.maxY&&(U.maxY=i),i<U.minY&&(U.minY=i)),Ee(!0,!1),!0;zt(),Ee(!0,!1)}}function Mr(e,t,a){var i=d,l=new XMLHttpRequest;l.open("POST",VGP.urlWS+"TraceGetSymbol",!0),l.setRequestHeader("Content-Type","application/json;charset=UTF-8"),l.onload=function(){var s,n;if(l.status>=200&&l.status<400){if(s=JSON.parse(l.responseText),s!=null&&s.d!=null){n=s.d.substring(0,1)=='"'?s.d.substr(1,s.d.length-2):s.d;try{Ne(i.symbol,JSON.parse(n)),VGP.drawings[i.symbol]=1,t&&(z=JSON.parse(n),Ee())}catch(u){z=[],localStorage.removeItem(i.symbol),Ha(),delete VGP.drawings[i.symbol]}}e&&da(a)}},l.send(JSON.stringify({userid:VGP.userID,symbol:i.symbol}))}function zt(){var e=0,t=999999,a,i=0,l=U.minX,s=U.maxX,n=B.QuoteTab;for(d.mainChart.typedef.nolinearX&&(l=0,s=n.length-1),a=l;a<=s;a++)n[a]!=null&&(i==0&&(i=n[a].c),n[a].h>e&&(e=n[a].h),n[a].l<t&&(t=B.QuoteTab[a].l));U.maxY=e,U.minY=t,d.isCompare&&ha(e,t,i,l,s)}function Kt(e){var t=o.gi(ge("overlay-")),a=t.getContext("2d"),i,l;a.clearRect(0,0,t.width,t.height),i=e.wheelDelta||-e.detail,l=i>0?Pa(1):Ca(1),l||e.preventDefault()}function Ee(e,t){ca();var a,i=R.length;if(d.mainChart.typedef.nolinearX){R[0].DrawEncadre(),fa(t),Et();return}for(a=0;a<i;a++)R[a].DrawEncadre();for(pa(B,!1,e),a=1;a<i;a++)ma(R[a]);e||Et()}function Be(e,t){if(e==0){ca(),R[0].DrawEncadre(),d.mainChart.typedef.nolinearX?fa(t):pa(B),Et();return}R[e-1].DrawEncadre(),R[e].DrawEncadre(),e-1==0&&pa(B,!0),ma(R[e-1]),ma(R[e]),Et()}function De(){var e,t;if(!VGP.chartSimple&&(e=o.gi(ge("trace-")),t=e.getContext("2d"),t.clearRect(0,0,e.width,e.height),d.mainChart.type!="perf"&&!d.hideTrace)){for(var a=B.QuoteTab[U.minX].d,i=U.maxX>B.QuoteTab.length-1?La():B.QuoteTab[U.maxX].d,l=z.length,s=0;s<l;s++)if(z[s]!=null)switch(z[s].type){case"fa":z[s].x0<i&&fo(t,z[s],a);break;case"t":z[s].x0<i&&po(t,z[s],a);break;case"ewi":case"ewc":ho(t,z[s],a);break;case"gg":case"ga":case"ff":z[s].x0<i&&Sa(t,z[s],a);break;case"wf":mo(t,z[s],a);break;case"arrup":case"arrdw":case"arrlt":case"arrrt":case"sm1":case"sm2":so(t,z[s],a);break;case"af":case"cf":case"an":case"c":case"ef":Sa(t,z[s],a);break;case"sr":z[s].x0<i&&no(t,z[s],a);break;case"a":z[s].x0<i&&uo(t,z[s],a);break;case"v":z[s].x0<i&&io(t,z[s],a);break;case"rf":case"r":case"m":(z[s].x1>a||z[s].x0>a)&&(z[s].x1<i||z[s].x0<i)&&co(t,z[s],a,i);break;case"h":lo(t,z[s]);break;default:z[s].x1<=a&&z[s].x0<=a||z[s].x0>i?(z[s].RealX0=0,z[s].RealX1=0):Sa(t,z[s],a)}}}function ft(e,t,a,i,l){e.RealX0=t,e.RealY0=a,e.RealX1=i,e.RealY1=l}function lo(e,t){var a;a=d.set.semilog&&d.logData!=null?xe(t.y0,d.logData):Math.round((R[0].V0-t.y0)*R[0].PxPointY),a>0&&a<R[0].HeightPx&&Ht(e,{my:a,y:t.y0},t.style,t.width,t.color,t.type=="mg"?0:t.fontSize,t.type),ft(t,0,a,d.innerWidth,a)}function io(e,t,a){var i=new Je(t.x0,t.y0,a);sa(e,i,t.style,t.width,t.color,t.fontSize),ft(t,i.mx,0,i.mx,i.my)}function so(e,t,a){var i=new Je(t.x0,t.y0,a);if(i.mx<0&&(i.mx=0),i.my>0&&i.my<R[0].HeightPx)switch(t.type){case"arrup":case"arrdw":case"arrrt":case"arrlt":At(e,i,t.color,t.type,t.color2,t.width);break;case"sm1":case"sm2":Zt(e,i,t.color,t.type,t.width)}ft(t,i.mx,i.my,i.mx,i.my)}function no(e,t,a){var i=new Je(t.x0,t.y0,a);i.mx<0&&(i.mx=0),i.my>0&&i.my<R[0].HeightPx&&ia(e,i,t.style,t.width,t.color,t.fontSize),ft(t,i.mx,i.my,d.innerWidth,i.my)}function co(e,t,a,i){var l=new Je(t.x0,t.y0,a),s=new Je(t.x1,t.y1,a),n=l.my,u=s.my,m=l.mx,y=s.mx;t.x0<a&&(m=l.mx=0),t.x1>i&&(y=s.mx=d.innerWidth),t.x0>i&&(m=l.mx=d.innerWidth),t.x1<a&&(y=s.mx=0),ft(t,m,n,y,u),(m!=0||y!=0)&&(t.type=="rf"&&Ea(e,t.color,t.color2,l,s,t.width,t.fontSize),(t.type=="r"||t.type=="m")&&na(e,t.color,t.color2,l,s,t.type,t.h,t.width,t.style,t.fontSize))}function uo(e,t,a){var i=new Je(t.x0,t.y0,a),l=unescape(t.h),s;if(e.save(),e.fillStyle=t.color,e.font=(t.fontSize!=null?t.fontSize:12)+"px Arial",s=e.measureText(l).width,i.mx+s<0){ft(t,0,0,0,0),e.restore();return}e.fillText(l,i.mx,i.my+4),e.restore(),ft(t,i.mx,i.my,i.mx+s,i.my)}function Sa(e,t,a){var i=new Je(t.x0,t.y0,a),l=new Je(t.x1,t.y1,a),s;switch(t.type){case"ff":ea(e,t.color,t.style,t.width,i,l,t.fontSize);break;case"ga":ta(e,t.color,t.style,t.width,i,l,t.fontSize);break;case"gg":aa(e,t.color,t.style,t.width,i,l);break;case"cf":Jt(e,t.color,t.style,t.width,i,l,0,t.fontSize);break;case"af":oa(e,t.color,t.style,t.width,i,l,t.fontSize);break;case"an":l.mx=ra(e,t.color,t.style,t.width,i,l,t.h,t.fontSize);break;case"c":la(e,t.color,t.style,t.width,i,l,t.color2);break;default:s=t.h,t.type=="p"&&(s=Math.round(t.h*R[0].PxPointY)),kt(e,t.type,t.color,t.style,t.width,s,i,l,t.color2,t.fontSize)}ft(t,i.mx,i.my,l.mx,l.my)}function ho(e,t,a,i){for(var l=[],s=t.h.length,n=0;n<s;n++)l.push(new Je(t.h[n].x,t.h[n].y,a,i));Ma(e,l,t.color,t.width,t.style,t.fontSize),t.h=l}function po(e,t,a){var i=new Je(t.x0,t.y0,a),l=new Je(t.x1,t.y1,a),s=new Je(t.h.C.x,t.h.C.y,a);$t(e,i,l,s,t.color,t.color2,t.width),ft(t,i.mx,i.my,l.mx,l.my),t.h.C=s}function mo(e,t,a){var i=new Je(t.x0,t.y0,a),l=new Je(t.x1,t.y1,a),s=new Je(t.h.C.x,t.h.C.y,a);Ft(e,i,l,s,t.color,t.color2,t.width,t.fontSize),ft(t,i.mx,i.my,l.mx,l.my),t.h.C=s}function fo(e,t,a){var i=new Je(t.x0,t.y0,a),l=new Je(t.x1,t.y1,a),s=new Je(t.h.B.x,t.h.B.y,a),n=new Je(t.h.C.x,t.h.C.y,a);It(e,i,s,n,t.color,t.color2,t.width),ft(t,i.mx,i.my,l.mx,l.my),t.h.B=s,t.h.C=n}function go(e,t){var a,i,l,s;if(e.save(),a=d.paddingLeft,t!=null){for(s=t.id.param2*t.et*R[0].PxPointY,i=1;i<4;i++)if(!t.id["v"+i]){switch(e.strokeStyle=i==1?t.id.color:t.id["color"+i],i){case 1:l=0;break;case 2:l=-s;break;case 3:l=s}e.lineWidth=t.id["w"+i]!=null?t.id["w"+i]:1,e.beginPath(),e.moveTo(t.p0.mx+a,t.p0.my+l),e.lineTo(t.p1.mx+a,t.p1.my+l),e.stroke()}e.restore()}}function Jt(e,t,a,i,l,s,n,u){var m,y,x,T,M;for(e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(l.mx,l.my),e.lineTo(s.mx,s.my),e.stroke(),m=s.mx-l.mx,y=[0,1,2,3,5,8,13,21,34,55],a!=null&&i!=null?(e.lineWidth=i,He(e,a)):e.lineWidth=1,e.fillStyle=t,e.font=(u!=null?u:12)+"px Arial",e.beginPath(),M=y.length,T=0;T<M;T++)x=l.mx+m*y[T]+.5,e.moveTo(x,0),e.lineTo(x,R[n].HeightPx),e.fillText(y[T],x+2,R[n].HeightPx-3);e.stroke(),e.restore()}function It(e,t,a,i,l,s,n){var u,m,y,x;e.save(),e.strokeStyle=l,e.beginPath();var T=a.mx+Math.round((i.mx-a.mx)/2),M=a.my+Math.round((i.my-a.my)/2),A=(t.my-M)/(T-t.mx),D=3e3;return T<t.mx&&(D=-D),u=t.mx+D,m=t.my-D*A,e.lineWidth=n!=null?n:1,e.moveTo(a.mx+D,a.my-D*A),e.lineTo(a.mx,a.my),e.lineTo(i.mx,i.my),e.lineTo(i.mx+D,i.my-D*A),e.fillStyle=X(s,.15),e.fill(),e.moveTo(t.mx,t.my),e.lineTo(u,m),e.stroke(),e.setLineDash&&e.setLineDash([2]),e.beginPath(),y=a.mx+Math.round((T-a.mx)/2),x=a.my+Math.round((M-a.my)/2),e.moveTo(y,x),e.lineTo(y+D,x-D*A),y=T+Math.round((i.mx-T)/2),x=M+Math.round((i.my-M)/2),e.moveTo(y,x),e.lineTo(y+D,x-D*A),e.stroke(),e.restore(),{Dx:u,Dy:m}}function Zt(e,t,a,i,l){var s=10+2*l,n=2,u=4+l,m,y;e.save(),e.strokeStyle=a,e.beginPath(),e.arc(t.mx,t.my,s,0,2*Math.PI,!1),e.lineWidth=2,e.stroke(),e.beginPath(),m=t.mx-u,y=t.my-u,e.arc(m,y,n,0,2*Math.PI,!1),m=t.mx+u,e.arc(m,y,n,0,2*Math.PI,!1),e.fillStyle=a,e.fill(),e.beginPath(),i=="sm1"?e.arc(t.mx,t.my,s-7,0,Math.PI,!1):e.arc(t.mx,t.my+s/2,s-7,Math.PI,2*Math.PI,!1),e.stroke(),e.restore()}function At(e,t,a,i,l,s){var n,u;switch(i){case"arrup":case"arrlt":n=8.5+s,u=15.5+2*s;break;case"arrdw":case"arrrt":n=-8.5-s,u=-15.5-2*s}e.save(),e.strokeStyle=a,e.beginPath(),e.moveTo(t.mx,t.my),i=="arrlt"||i=="arrrt"?(e.lineTo(t.mx+n,t.my-6.5-s),e.lineTo(t.mx+n,t.my-1.5-s),e.lineTo(t.mx+u,t.my-1.5-s),e.lineTo(t.mx+u,t.my+1.5+s),e.lineTo(t.mx+n,t.my+1.5+s),e.lineTo(t.mx+n,t.my+6.5+s),e.lineTo(t.mx,t.my)):(e.lineTo(t.mx-6.5-s,t.my+n),e.lineTo(t.mx-1.5-s,t.my+n),e.lineTo(t.mx-1.5-s,t.my+u),e.lineTo(t.mx+1.5+s,t.my+u),e.lineTo(t.mx+1.5+s,t.my+n),e.lineTo(t.mx+6.5+s,t.my+n),e.lineTo(t.mx,t.my)),e.fillStyle=l,e.fill(),e.stroke(),e.restore()}function Ma(e,t,a,i,l,s){e.save(),e.strokeStyle=a,e.fillStyle=a,e.font=(s!=null?s:14)+"px Arial",l!=null&&i!=null?(e.lineWidth=i,He(e,l)):e.lineWidth=1,e.beginPath(),e.moveTo(t[0].mx,t[0].my);for(var n=t.length,m=[],u,m=t.length==6?["1","2","3","4","5"]:["a","b","c"],y=1;y<n;y++)e.lineTo(t[y].mx,t[y].my),u=t[y].my<t[y-1].my?-7:16,e.fillText(m[y-1],t[y].mx-4,t[y].my+u);e.stroke(),e.restore()}function $t(e,t,a,i,l,s,n){e.strokeStyle=l,e.lineWidth=n!=null?n:1,e.beginPath(),e.moveTo(t.mx,t.my),e.lineTo(a.mx,a.my),e.lineTo(i.mx,i.my),e.lineTo(t.mx,t.my),e.stroke(),s!=null&&(e.fillStyle=X(s,.15),e.fill())}function ea(e,t,a,i,l,s,n){var u;e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(l.mx,l.my),e.lineTo(s.mx,s.my),e.stroke(),a!=null&&i!=null?(e.lineWidth=i,He(e,a)):e.lineWidth=1;var m=l.my-s.my,y,x,T=1500,M=200,A=[.25,.382,.5,.618,.75],D=["0.25","0.382","0.5","0.618","0.75"],k,E;for(e.fillStyle=t,e.font=(n!=null?n:12)+"px Arial",e.beginPath(),u=A.length,k=0;k<u;k++)E=Math.atan(m/A[k]/Math.abs(l.mx-s.mx)),y=l.my-T*Math.sin(E),x=l.mx+T*Math.cos(E),e.moveTo(l.mx,l.my),e.lineTo(x,y),y=l.my-M*Math.sin(E),x=l.mx+M*Math.cos(E),e.fillText(D[k],x,y),E=Math.atan(m*A[k]/Math.abs(l.mx-s.mx)),y=l.my-T*Math.sin(E),x=l.mx+T*Math.cos(E),e.moveTo(l.mx,l.my),e.lineTo(x,y),y=l.my-M*Math.sin(E),x=l.mx+M*Math.cos(E),e.fillText(D[k],x,y);e.stroke(),e.restore()}function ta(e,t,a,i,l,s,n){var u;e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(l.mx,l.my),e.lineTo(s.mx,s.my),e.stroke(),a!=null&&i!=null?(e.lineWidth=i,He(e,a)):e.lineWidth=1;var m=l.my-s.my,y,x,T=1500,M=180,A=[8,4,3,2,1,.5,.333,.25,.125],D=["8x1","4x1","3x1","2x1","1x1","1x2","1x3","1x4","1x8"],k,E;for(e.fillStyle=t,e.font=(n!=null?n:12)+"px Arial",e.beginPath(),u=A.length,k=0;k<u;k++)E=Math.atan(m/A[k]/Math.abs(l.mx-s.mx)),y=l.my-T*Math.sin(E),x=l.mx+T*Math.cos(E),e.moveTo(l.mx,l.my),e.lineTo(x,y),y=l.my-M*Math.sin(E),x=l.mx+M*Math.cos(E),e.fillText(D[k],x,y);e.stroke(),e.restore()}function aa(e,t,a,i,l,s){e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(l.mx,l.my),e.lineTo(s.mx,s.my),e.stroke(),a!=null&&i!=null?(e.lineWidth=i,He(e,a)):e.lineWidth=1;var n=(l.my-s.my)/Math.abs(l.mx-s.mx),u=l.mx-s.mx>0?-1:1,m=l.my-n*1500,y=l.mx+u*1500,x=(l.my-s.my)*2,T,M=l.my+n*1500;for(e.beginPath(),T=-20;T<20;T++)e.moveTo(l.mx,l.my+x*T),e.lineTo(y,m+x*T),e.moveTo(l.mx,l.my+x*T),e.lineTo(y,M+x*T);e.stroke(),e.restore()}function ra(e,t,a,i,l,s,n,u){var m,y;return e.save(),e.strokeStyle=t,e.beginPath(),e.moveTo(l.mx+50,l.my+.5),e.lineTo(l.mx,l.my+.5),e.stroke(),m=!(n>=0),e.beginPath(),e.arc(l.mx,l.my,30,-n,0,m),e.stroke(),y=(l.my-s.my)/Math.tan(n),a!=null&&i!=null?(e.lineWidth=i,He(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(l.mx,l.my),e.lineTo(l.mx+y,s.my),e.stroke(),e.fillStyle=t,e.font=(u!=null?u:12)+"px Arial",e.fillText((n*180/Math.PI).toFixed(0)+"\xB0",l.mx+55,l.my),e.restore(),l.mx+y}function oa(e,t,a,i,l,s,n){var u,m,y,x,T;e.save();var M=Math.abs(l.mx-s.mx),A=Math.abs(l.my-s.my),D=Math.sqrt(M*M+A*A);for(e.strokeStyle=t,e.beginPath(),e.moveTo(l.mx,l.my),e.lineTo(s.mx,s.my),e.stroke(),a!=null&&i!=null?(e.lineWidth=i,He(e,a)):e.lineWidth=1,e.strokeStyle=X(t,.7),e.fillStyle=t,e.font=(n!=null?n:12)+"px Arial",u=!0,l.y>s.y&&(u=!1),y=[.236,.5,.786,1,1.618,2.618],T=y.length,x=0;x<T;x++)e.beginPath(),e.arc(l.mx,l.my,D*y[x],0,Math.PI,u),e.stroke(),m=u?l.my-D*y[x]-2:l.my+D*y[x]+10,e.fillText(y[x].toFixed(3),l.mx-15,m);e.restore()}function la(e,t,a,i,l,s,n){e.save(),e.beginPath();var u=Math.abs(l.mx-s.mx),m=Math.abs(l.my-s.my);e.translate(l.mx-u,l.my-m),e.scale(u,m),e.arc(1,1,1,0,2*Math.PI,!1),e.restore(),e.save(),e.strokeStyle=t,a!=null&&i!=null?(e.lineWidth=i,He(e,a)):e.lineWidth=1,e.stroke(),n!=null&&(e.fillStyle=X(n,.15),e.fill()),e.restore()}function ia(e,t,a,i,l,s){var n=.5;e.strokeStyle=l,e.save(),a!=null&&i!=null?(e.lineWidth=i,i%2==0&&(n=0),He(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(t.mx,t.my+n),e.lineTo(d.innerWidth,t.my+n),e.stroke(),e.fillStyle=l,e.font=(s!=null?s:12)+"px Arial",e.fillText(t.y.toFixed(2),t.mx+5,t.my-2),e.restore()}function sa(e,t,a,i,l,s){var n=.5,u;e.strokeStyle=l,e.save(),a!=null&&i!=null?(e.lineWidth=i,i%2==0&&(n=0),He(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(t.mx+n,0),e.lineTo(t.mx+n,R[0].HeightPx),e.stroke(),e.fillStyle=l,e.font=(s!=null?s:12)+"px Arial",u=t.mx+3,d.innerWidth-t.mx<60&&(u=t.mx-60),d.chartPeriod<0?e.fillText(I(t.x),u,R[0].HeightPx-2):e.fillText(Z(t.x,2),u,R[0].HeightPx-2),e.restore()}function Ht(e,t,a,i,l,s,n){var u=.5,m,y;if(e.strokeStyle=l,e.save(),a!=null&&i!=null?(e.lineWidth=i,i%2==0&&(u=0),He(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(0,t.my+u),e.lineTo(d.innerWidth,t.my+u),e.stroke(),e.font=(s!=null?s:12)+"px Arial",s!=0&&(e.fillStyle=l,m=t.y,e.fillText(m.toFixed(2),5,t.my-4)),n=="mg"){e.font="12px Arial";var x=t.y,T=0,M=0,A,D=U.maxX;for(D>=B.QuoteTab.length&&(D=B.QuoteTab.length-1),A=U.minX;A<=D;A++)B.QuoteTab[A].c>=x?T++:M++;y=s!=0?70:5,e.fillStyle="#fe0000",e.fillText((M*100/(T+M)).toFixed(0)+"%",y,t.my+15),e.fillStyle="#008000",e.fillText((T*100/(T+M)).toFixed(0)+"%",y,t.my-4),e.fillStyle="rgba(0,191,0,0.1)",e.fillRect(0,0,d.innerWidth,t.my),e.fillStyle="rgba(255,0,0,0.1)",e.fillRect(0,t.my,d.innerWidth,9999)}e.restore()}function ka(e,t,a,i,l){e.save(),e.font=(a!=null?a:"12")+"px Arial",e.fillStyle=i;var s=t.mx+e.measureText(l).width;return e.fillText(l,t.mx,t.my+4),e.restore(),Math.round(s)}function kt(e,t,a,i,l,s,n,u,m,y){var x,T,M,A,D;if(e.save(),He(e,i),e.strokeStyle=a,x=.5,l==null&&(l=1),e.lineWidth=l,l%2==0&&(x=0),e.beginPath(),(t=="mv"||t=="mh")&&(e.font=(y!=null?y:"12")+"px Arial",T=y!=null?parseInt(y)+2:12,e.fillStyle=a),t=="mv"){e.moveTo(u.mx-10,u.my+.5),e.lineTo(u.mx+10,u.my+.5),e.moveTo(u.mx-10,n.my+.5),e.lineTo(u.mx+10,n.my+.5),u.y<n.y?(e.moveTo(u.mx-8,u.my-8),e.lineTo(u.mx,u.my),e.lineTo(u.mx+8,u.my-8)):(e.moveTo(u.mx-8,u.my+8),e.lineTo(u.mx,u.my+1),e.lineTo(u.mx+8,u.my+8)),e.moveTo(n.mx+.5,n.my),e.lineTo(u.mx+.5,u.my),e.stroke(),M=(u.y-n.y)*100/n.y,A=(u.y-n.y).toFixed(2),D=Math.min(u.my,n.my)+Math.abs((u.my-n.my)/2),e.fillText(A,u.mx+5,D),e.fillText(M.toFixed(2)+"%",u.mx+5,D+T+2),e.restore();return}if(t=="mh"){e.moveTo(u.mx+.5,n.my-10),e.lineTo(u.mx+.5,n.my+10),e.moveTo(n.mx+.5,n.my-10),e.lineTo(n.mx+.5,n.my+10),e.moveTo(Math.max(u.mx,n.mx)-8,u.my-8),e.lineTo(Math.max(u.mx,n.mx),u.my),e.lineTo(Math.max(u.mx,n.mx)-8,u.my+8),e.moveTo(n.mx,n.my+.5),e.lineTo(u.mx,u.my+.5),e.stroke(),e.fillText(kr(n.x,u.x),Math.min(u.mx,n.mx)+5,n.my+T),e.restore();return}e.moveTo(n.mx,n.my+x),e.lineTo(u.mx,u.my+x),t=="p"&&(e.moveTo(n.mx,n.my+s+x),e.lineTo(u.mx,u.my+s+x)),e.stroke(),t=="p"&&m!=null&&(e.moveTo(n.mx,n.my+x),e.lineTo(u.mx,u.my+x),e.lineTo(u.mx,u.my+s+x),e.lineTo(n.mx,n.my+s+x),e.fillStyle=X(m,.15),e.fill()),t=="ef"&&vo(e,n,u,a,m,s,y),t=="f"&&(s==1||s==null?Er(e,n.mx,u.mx,n.my,u.my,a,l):Er(e,u.mx,n.mx,u.my,n.my,a,l)),e.restore()}function kr(e,t){var a="";return R[0].Bars[0][e]!=null&&R[0].Bars[0][t]!=null&&(a=" - "+Math.abs(R[0].Bars[0][t].i-R[0].Bars[0][e].i)+lang.l_barres),d.chartPeriod>=0?Math.abs(e-t)+lang.l_jours+a:a!=""?ae(Math.abs((R[0].Bars[0][t].i-R[0].Bars[0][e].i)*parseInt(d.chartPeriod)))+a:ae(Math.abs(t-e))}function vo(e,t,a,i,l,s,n){var u,m,y=m=a.my,x=u=t.my,T=t.mx,M=a.mx,A=t.y,D=a.y,k=Math.max(T,M),E,Y,F,q,Q,ce;for(s==null&&(s=250),T>M&&(y=u,x=m,A=a.y,D=t.y),e.beginPath(),E=x-y,(e.lineWidth==1||e.lineWidth==3)&&(y+=.5),Y=[0,.236,.382,.5,.618,1,1.618,2.618],q=Y.length,F=0;F<q;F++)e.moveTo(k,y-Math.round(E*Y[F])),e.lineTo(k+s,y-Math.round(E*Y[F]));for(e.stroke(),l!=null&&(e.fillStyle=X(l,.15),e.fillRect(k,y,s,-Math.round(E*2.618))),y=y-3,e.font=(n!=null?n:12)+"px Arial",e.fillStyle=i,F=0;F<q;F++)ce=y-Math.round(E*Y[F]),Q=D+(D-A)*Y[F],e.fillText(Q.toFixed(2)+"  ("+(Y[F]*100).toFixed(1)+"%)",k,ce)}function Er(e,t,a,i,l,s,n){var u=a,m=l,y=5+n,x,T,M;e.fillStyle=s,e.lineWidth=1,e.beginPath(),x=Math.atan2(l-i,a-t),T=y*Math.cos(x)+u,M=y*Math.sin(x)+m,e.moveTo(T,M),x+=1/3*2*Math.PI,T=y*Math.cos(x)+u,M=y*Math.sin(x)+m,e.lineTo(T,M),x+=1/3*2*Math.PI,T=y*Math.cos(x)+u,M=y*Math.sin(x)+m,e.lineTo(T,M),e.closePath(),e.fill()}function na(e,t,a,i,l,s,n,u,m,y){var x=i.mx,T=l.mx,M=i.my,A=l.my,D=.5,k,E,Y,F,q,Q;if(u!=null?(e.lineWidth=u,u%2==0&&(D=0)):e.lineWidth=1,e.save(),He(e,m),e.strokeStyle=t,e.beginPath(),e.rect(x+D,M+D,T-x,A-M),e.stroke(),s=="m"){e.save(),e.setLineDash&&e.setLineDash([1,1]),k=Math.round((T+x)/2),e.moveTo(k+.5,M),e.lineTo(k+.5,A);var ce=Math.min(M,A),de=Math.max(M,A),_e=Math.min(x,T);n==0?(e.moveTo(k-5,de-5),e.lineTo(k,de),e.lineTo(k+5,de-5)):(e.moveTo(k-5,ce+5),e.lineTo(k,ce),e.lineTo(k+5,ce+5)),E=Math.round((A+M)/2),e.moveTo(x,E+.5),e.lineTo(T,E+.5),e.lineTo(T-5,E-5),e.moveTo(T,E),e.lineTo(T-5,E+5),e.moveTo(x+5,E+5),e.lineTo(x,E),e.lineTo(x+5,E-5),e.stroke(),e.restore(),Y=Math.min(i.y,l.y),F=Math.max(i.y,l.y),n==1?(q=(F-Y)*100/Y,Q=(F-Y).toFixed(2)+"\u20AC ("+q.toFixed(2)+"%)"):(q=(Y-F)*100/F,Q=(Y-F).toFixed(2)+"\u20AC ("+q.toFixed(2)+"%)"),e.fillStyle=t,y==null&&(y=12),e.font=y+"px Arial",e.fillText(Q,_e+5,de-6),e.fillText(kr(i.x,l.x),_e+5,de+11+(y-11))}a!=null&&(e.fillStyle=X(a,.15),e.fill()),e.restore()}function Ea(e,t,a,i,l,s,n,u){var m=.5,y,x,T,M,A,D,k;s!=null?(e.lineWidth=s,s%2==0&&(m=0)):e.lineWidth=1;var E=i.my,Y=l.my,F=i.mx,q=l.mx,Q=i.y,ce=l.y;for(u&&(E=l.my,Y=i.my,Q=l.y,ce=i.y),e.strokeStyle=t,e.beginPath(),y=E-Y,Y=Y+m,x=[0,.236,.382,.5,.618,.786,1,1.618],M=x.length,T=0;T<M;T++)e.moveTo(F,Y+Math.round(y*x[T])),e.lineTo(q,Y+Math.round(y*x[T]));for(e.stroke(),A=Math.min(F,q),a!=null&&(e.fillStyle=X(a,.15),e.fillRect(A,Y,Math.abs(q-F),Math.round(y*1.618))),Y=Y-1.5,e.font=(n!=null?n:12)+"px Arial",e.fillStyle=t,T=0;T<M;T++)D=Y+Math.round(y*x[T]),k=ce+(Q-ce)*x[T],e.fillText(k.toFixed(2)+"  ("+(x[T]*100).toFixed(1)+"%)",A,D)}function Je(e,t,a){var i,l,s,n,u,m,y;if(this.x=e,this.y=t,i=d,this.my=i.set.semilog&&i.logData!=null&&t!=0?xe(t,i.logData):Math.round((R[0].V0-t)*R[0].PxPointY),R[0].Bars[0][e]!=null)this.mx=Math.round(R[0].Bars[0][e].i*R[0].PxPointX+i.padBarCandle);else if(s=R[0].Bars[0][0].d,e>=a){if(e>s)n=R[0].Bars[0][0].i,u=Lr(e-s),this.mx=Math.round((n+u)*R[0].PxPointX+i.padBarCandle);else for(l=e-5;l<=s;l++)if(R[0].Bars[0][l]!=null){this.mx=Math.round(R[0].Bars[0][l].i*R[0].PxPointX+i.padBarCandle);break}}else B.Xperiod<0?Math.floor((a-e+515)/1e4)>=1?(y=Math.floor((a-e+515)/1e4),m=(e-a+y*9485)/-B.Xperiod):m=(e-a)*-B.Xperiod:m=Lr(e-a),this.mx=Math.round(m*R[0].PxPointX+i.padBarCandle)}function Lr(e){if(B.Xperiod<0)e=e*(-1/B.Xperiod);else switch(B.Xperiod){case 7:e=e/7;break;case 30:e=e/30;break;case 91:e=e/91;break;case 365:e=e/365;break;default:e=e*5/7}return e<1&&e>0?e=1:e>-1&&e<0&&(e=-1),e}function Ne(e,t,a){if(!L())return!1;d.chartPeriod<0||a?sessionStorage.setItem(e,JSON.stringify(t)):localStorage.setItem(e,JSON.stringify(t))}function Vr(e){var t;if(!L())return[];if(t=null,t=d.chartPeriod<0?sessionStorage.getItem(e):localStorage.getItem(e),t!=null&&t!=""&&t!="[]"){for(var a=JSON.parse(t),i=a.length,l=0,s=0;s<i;s++)a[s].type=="a"&&(a[s].h=f(a[s].h),l=1);return l==1&&localStorage.setItem(e,JSON.stringify(a)),a}return d.chartPeriod>=0&&localStorage.removeItem(e),[]}function vt(e){var t,a,i,l;switch(e){case"topinfo":t=document.createElement("div"),t.id=ge("eod_topinfo-"),t.setAttribute("class","eod_topinfo"),t.style.left=d.paddingLeft+2+"px",t.style.width=d.innerWidth+"px",t.style.color=d.set.txtColor,d.set.fontSize!=11&&(t.style.fontSize=d.set.fontSize+"px"),a=document.createElement("span"),t.appendChild(a),i=document.createElement("span"),t.appendChild(i),l=document.createElement("span"),l.setAttribute("class","fr"),t.appendChild(l),O.doc.appendChild(t);break;case"overlay":t=document.createElement("canvas"),t.id=ge("overlay-"),t.setAttribute("height",d.heightGraph),t.setAttribute("width",d.widthGraph),O.doc.appendChild(t);break;case"trace":t=document.createElement("canvas"),t.id=ge("trace-"),t.style.left=d.paddingLeft+"px",t.style.top=d.paddingTop+"px",t.setAttribute("height",R[0].HeightPx),t.setAttribute("width",d.innerWidth),t.setAttribute("tabindex","0"),O.doc.appendChild(t);break;case"mainci":t=document.createElement("div"),t.id=ge("eod_mainchartinfos-"),t.setAttribute("class","eod_mainchartinfos"),t.style.left=d.paddingLeft+2+"px",t.style.top=d.paddingTop+4+"px",t.style.color=d.set.txtColor,d.set.fontSize!=11&&(t.style.fontSize=d.set.fontSize+"px"),O.doc.appendChild(t);break;case"rodgraph":O.doc.innerHTML='<canvas id="rodgraph-'+O.callID+'" style="background-color:'+d.set.bkcolor+'" width="'+d.widthGraph+'" height="'+d.heightGraph+'" ></canvas>'}}function ca(){O.ctxback.clearRect(0,0,d.widthGraph,d.heightGraph),O.ctxback.font=d.set.fontSize+"px Arial"}function La(e){e==null&&(e=U.maxX-(B.QuoteTab.length-1));var t;if(B.Xperiod<0)t=-B.Xperiod;else switch(B.Xperiod){case 7:t=7;break;case 30:t=30;break;case 91:t=91;break;case 365:t=365;break;default:t=7/5}return Math.round(t*e)+B.QuoteTab[B.QuoteTab.length-1].d}function yo(e){for(var t=R.length,a=1;a<t;a++)if(e>=R[a].RealY-4&&e<=R[a].RealY+1)return a;return null}function Va(e,t){if(e>d.widthGraph-d.paddingRight||e<d.paddingLeft)return null;for(var a=R.length,i=0;i<a;i++)if(t>=R[i].RealY&&t<=R[i].RealY+R[i].HeightPx)return i;return null}function Bt(e){vt("rodgraph");var t=o.gi(ge("rodgraph-"));O.ctxback=t.getContext("2d"),ca(),e!=null?Go(e):wo(d,O.doc,R),VGP.chartSimple||(vt("topinfo"),vt("overlay"),vt("trace"),vt("mainci"),B!=null&&o.qstxt(ge("#eod_topinfo-")+" span",B.Name))}function ua(e){VGP.drawings[d.symbol]==0&&d.chartPeriod>=0&&!VGP.noCommand&&!VGP.noAutoReadTrace?Mr(!0,!1,e):da(e)}function da(e,t){var a,i,l,s,n,u,m;if(d.histoLength==null&&(d.histoLength=365),d.chartPeriod==null&&(d.chartPeriod=d.histoLength>20?0:-1),typeof stopTimers=="function"&&stopTimers(),VGP.noCommand||(a=o.gi(ge("trace-")),i=a.getContext("2d"),i.clearRect(0,0,a.width,a.height),z=Vr(d.symbol)),l=d.dataSource,l){if(s=o.gigt(l),s=="")return;n=JSON.parse(s),n!=null&&(B=v(n),Ra(n,e));return}u=VGP.urlWS+"GetTicksEOD",VGP.callType=="GET"&&(u=u+"?symbol="+d.symbol+"&length="+d.histoLength+"&period="+d.chartPeriod+"&guid="+o.gigt("guid")),m=new XMLHttpRequest,m.open(VGP.callType,u,!0),m.setRequestHeader("Content-Type","application/json;charset=UTF-8"),m.onload=function(){var y,x,T,M,A,D,k,E,Y;if(m.status>=200&&m.status<400)if(y=JSON.parse(m.responseText),y!=null&&y.d!=null)if(B=v(y.d),x=d.mainChart.indicators,d.isCompare){for(D=x.length,k="",T=0;T<D;T++)x[T].type=="compare"&&(k+=x[T].symbol+";");k!=""&&(k=k.substring(0,k.length-1),E=VGP.urlWS+"GetTicksList",VGP.callType=="GET"&&(E=E+"?symbols="+k+"&length="+d.histoLength+"&period="+d.chartPeriod+"&guid="+o.gigt("guid")),Y=new XMLHttpRequest,Y.open(VGP.callType,E,!0),Y.setRequestHeader("Content-Type","application/json;charset=UTF-8"),Y.onload=function(){if(Y.status>=200&&Y.status<400){var F=JSON.parse(Y.responseText);if(F!=null&&F.d!=null){for(A=F.d.length,T=0;T<D;T++)if(x[T].type=="compare"){for(M=0;M<A;M++)if(F.d[M].SymbolId==x[T].symbol){x[T].datas2=F.d[M];break}}}Ra(y.d,e)}},Y.send(JSON.stringify({symbols:k,length:d.histoLength,period:d.chartPeriod,guid:o.gigt("guid")})))}else Ra(y.d,e);else typeof DisplayAlert=="function"&&(d.chartPeriod<0?DisplayAlert(lang.l_msg3,3):DisplayAlert(lang.l_msg4,4)),t&&(d.chartPeriod=t.chartPeriod,d.histoLength=t.histoLength)},m.send(JSON.stringify({symbol:d.symbol,length:d.histoLength,period:d.chartPeriod,guid:o.gigt("guid")}))}function Ra(e,t){var a,i,l;if(U.minX=0,U.maxX=e.QuoteTab.length-1,U.maxY=e.High,U.minY=e.Low,d.isCompare&&ha(e.High,e.Low,B.QuoteTab[0].c),d.histoLength!=1||d.set.noVeilleIntra||(a=e.qv.c,a>U.maxY&&(U.maxY=a),a<U.minY&&(U.minY=a)),U.qv=e.qv,U.qd=e.qd,d.chartPeriod=parseInt(e.Xperiod),t==!1)if(d.mainChart.typedef.nolinearX)fa(!0);else for(pa(e),l=R.length,i=1;i<l;i++)ma(R[i]);else Ee(!1,!0);VGP.chartSimple||(ee(),o.qstxt(ge("#eod_topinfo-")+" span",e.Name),Gt()),typeof launchTimers=="function"&&launchTimers(O.callID,d.chartPeriod,d.symbol),Et()}function Et(){if(d.mainChart.typedef.nolinearX){typeof extIndicatorsList=="function"&&extIndicatorsList({ind1:t,ind2:a});return}for(var e={},t=[],a=[],i,l,s=0;s<d.mainChart.indicators.length;s++)i=d.mainChart.indicators[s],i.type!="actu"&&i.type!="evt"&&(l=i.type=="compare"?i.datas2?i.datas2.Name:"NC":i.param1?" ("+i.param1+")":"",t[s]={id:s,name:i.type,color:i.color,param:l,bkcolor:Yt(i.color)});for(s=1;s<R.length;s++)i=R[s].Indicator,i.type!="volume"&&(l=i.param1?" ("+i.param1+")":"",a[s]={id:s,name:i.type,color:i.color,param:l,bkcolor:Yt(i.color)});e={ind1:t,ind2:a},typeof extIndicatorsList=="function"&&extIndicatorsList(e)}function ha(e,t,a,i,l){for(var s=d.mainChart.indicators.length,n=-1e3,u=1e3,m,y,x,T,M=0;M<s;M++)d.mainChart.indicators[M].type=="compare"&&(x=d.mainChart.indicators[M].datas2,x&&(T=x.QuoteTab[0].c,d.mainChart.indicators[M].datas2=v(d.mainChart.indicators[M].datas2,i,l),m=(x.High-T)/T,y=(x.Low-T)/T,m>n&&(n=m),y<u&&(u=y)));m=(e-a)/a,y=(t-a)/a,m>n&&(n=m),y<u&&(u=y),U.maxY=a*(1+n),U.minY=a*(1+u)}function pa(e,t,a){var i,l,s,n,u,m,y,x,T,M,A,D,k,E,Y,F,q,Q,ce,de,_e,Me,Ye,Qe,Oe,Xe,we,qe,Pe,pe,ve,Le,be,Ve,ne,Dt,Wt;if(e!=null){i={Name:e.Name,High:e.High,Low:e.Low,QuoteTab:e.QuoteTab},U.maxX==0&&U.minX==0&&(U.maxX=i.QuoteTab.length-1,U.minX=0),i.QuoteTab=ht(e.QuoteTab);var ct=i.High,gt=i.Low,re,st=i.QuoteTab.length,Fe=R[0];U.maxY==0&&U.minY==0?(U.maxY=ct,U.minY=gt):(ct=U.maxY,gt=U.minY),ct==gt&&(ct=ct*1.01,gt=gt*.99),l=d.mainChart.typedef,s=57,Fe.HeightPx==57&&(s=56),Fe.PxPointY=(Fe.HeightPx-s)/(ct-gt),Fe.V0=ct+(s-20)/Fe.PxPointY;var ut=Fe.V0,mt=Fe.PxPointY,oe=Fe.ctx,Ke;if(["bar","candle","barcolor","hollow","heikin ashi"].indexOf(d.mainChart.type)!=-1?(Ke=Math.floor(d.innerWidth/st)-3,Ke%2==0&&Ke++,Ke>19?Ke=19:Ke<3&&(Ke=3),d.padBarCandle=2+Ke):d.padBarCandle=0,n=d.paddingLeft+d.padBarCandle,d.mainChart.type=="perf"&&(i=te.computePERFORMANCE(i),gt=i.Low<0?i.Low*1.05:i.Low*.95,ct=i.High>0?i.High*1.05:i.High*.95,mt=(Fe.HeightPx-s)/(ct-gt),Fe.PxPointY=mt,ut=ct+(s-20)/Fe.PxPointY,Fe.V0=ut),d.mainChart.type=="heikin ashi"&&(i=bl(i),!i)){Ie={},st=[],Fe.Bars[0]={};return}switch(u=null,d.set.semilog&&d.mainChart.type!="perf"&&!d.isCompare&&(u=Ho(ct,gt)),d.logData=u,d.isCompare?Tt(oe,Fe.HeightPx,n,ut,mt,!0):d.set.semilog&&d.mainChart.type!="perf"?Tt(oe,Fe.HeightPx,n,ut,mt,!1,!0):Tt(oe,Fe.HeightPx,n,ut,mt),M=st==1?d.innerWidth-2*d.padBarCandle:(d.innerWidth-2*d.padBarCandle)/(st-1),Fe.PxPointX=M,t?wt(Fe):wt(Fe,!0,i.QuoteTab),Ie={},ze=[],Fe.Bars[0]={},A=n-1,D={},d.mainChart.type){case"perf":for(oe.save(),oe.beginPath(),y=(ut-i.QuoteTab[0].c)*mt,oe.moveTo(n,y),re=0;re<st;re++)if(k=i.QuoteTab[re],k!=null){if(m=Math.round(re*M+n),ze[m-d.paddingLeft]={d:k.d,i:re},oe.lineTo(m+.5,Math.round((ut-k.c)*mt)+.5),M<2)Ie[m]=k.d;else for(x=-1;x<=1;x++)Ie[m+x]=k.d;D[k.d]={c:k.c.toFixed(2),i:re},de=re}k=i.QuoteTab[de],D[0]={c:k.c.toFixed(2),i:de,d:k.d},l.v1||(oe.strokeStyle=l.color,He(oe,1,l),it(oe,l,1),oe.stroke()),l.v2||(oe.lineTo(m,ut*mt),oe.lineTo(n,ut*mt),Q=oe.createLinearGradient(0,0,0,Fe.HeightPx),Q.addColorStop(0,X(K(l.color2),.7)),Q.addColorStop(1,X(K(l.color2),.1)),oe.fillStyle=Q,oe.fill()),oe.restore();break;case"line":case"line2":for(oe.save(),oe.beginPath(),_e=l.source!=null?l.source:"c",y=xe(N(i.QuoteTab[0],_e),u),oe.moveTo(n,y),Me=[],Me.push({x:n,y}),re=0;re<st;re++)if(k=i.QuoteTab[re],k!=null){if(m=Math.round(re*M+n),ze[m-d.paddingLeft]={d:k.d,i:re},m-A>=1)if(y=xe(N(k,_e),u)+.5,oe.lineTo(m+.5,y),Me.push({x:m+.5,y}),A=m,M<2)Ie[m]=k.d;else for(x=-1;x<=1;x++)Ie[m+x]=k.d;D[k.d]={o:k.o,h:k.h,l:k.l,c:k.c,i:re},de=re}if(k=i.QuoteTab[de],D[0]={o:k.o,h:k.h,l:k.l,c:k.c,i:de,d:k.d},d.mainChart.type=="line"&&(l.v2||(oe.strokeStyle="transparent",oe.lineTo(m,Fe.HeightPx),oe.lineTo(n,Fe.HeightPx),oe.lineTo(n,ut),oe.stroke(),Ye=ut-ct,Ye!=0&&(Q=oe.createLinearGradient(0,xe(i.High,u),0,Fe.HeightPx),Q.addColorStop(0,l.color2),l.color3!=null?Q.addColorStop(1,l.color3):Q.addColorStop(1,X(K(l.color2),.1)),oe.fillStyle=Q,oe.fill()))),!l.v1){if(oe.beginPath(),Qe=Me.length,Qe>0)for(oe.moveTo(Me[0].x,Me[0].y),x=1;x<Qe;x++)oe.lineTo(Me[x].x,Me[x].y);it(oe,l,1),He(oe,1,l),oe.strokeStyle=l.color,oe.stroke()}oe.restore();break;case"bar":case"barcolor":oe.save();var xt=.5,jt=0,wa=Math.floor(Ke/2),ro=wa+1;for(M>5&&(oe.lineWidth=2,xt=0,jt=1,wa+=1),oe.strokeStyle=l.v1?"transparent":l.color,oe.beginPath(),re=0;re<st;re++)if(k=i.QuoteTab[re],k!=null){for(m=Math.round(re*M+n),k.c>=k.o&&(F=xe(k.o,u)+xt,q=xe(k.c,u)+xt,E=xe(k.l,u),Y=xe(k.h,u),ze[m-d.paddingLeft]={d:k.d,i:re},oe.moveTo(m+xt,E+jt),oe.lineTo(m+xt,Y-jt),oe.moveTo(m,F),oe.lineTo(m-wa,F),oe.moveTo(m,q),oe.lineTo(m+ro,q)),T=-Ke;T<=Ke;T++)Ie[m+T]=k.d;de=re,D[k.d]={o:k.o,h:k.h,l:k.l,c:k.c,i:re}}for(k=i.QuoteTab[de],D[0]={o:k.o,h:k.h,l:k.l,c:k.c,i:de,d:k.d},oe.stroke(),d.mainChart.type=="barcolor"&&(oe.strokeStyle=l.v2?"transparent":l.color2),oe.beginPath(),re=0;re<st;re++)k=i.QuoteTab[re],k!=null&&k.c<k.o&&(F=xe(k.o,u)+xt,q=xe(k.c,u)+xt,m=Math.round(re*M+n),E=xe(k.l,u),Y=xe(k.h,u),ze[m-d.paddingLeft]={d:k.d,i:re},oe.moveTo(m+xt,E+jt),oe.lineTo(m+xt,Y-jt),oe.moveTo(m,F),oe.lineTo(m-wa,F),oe.moveTo(m,q),oe.lineTo(m+ro,q));oe.stroke(),oe.restore();break;case"heikin ashi":case"candle":for(M>5&&M<7&&(Ke=5),oe.strokeStyle=l.color3,oe.beginPath(),oe.fillStyle=l.color,ce=Math.floor(Ke/2),re=0;re<st;re++)if(k=i.QuoteTab[re],k!=null){for(m=Math.round(re*M+n)-ce,k.c>=k.o&&Lt(oe,Ke,k,m,ce,re,u),T=0;T<=Ke;T++)Ie[m+T]=k.d;de=re,D[k.d]={o:k.o,h:k.h,l:k.l,c:k.c,i:re}}for(k=i.QuoteTab[de],D[0]={o:k.o,h:k.h,l:k.l,c:k.c,i:de,d:k.d},l.v1||(oe.stroke(),oe.fill()),oe.beginPath(),oe.fillStyle=l.color2,re=0;re<st;re++)k=i.QuoteTab[re],k!=null&&k.c<k.o&&(m=Math.round(re*M+n)-ce,Lt(oe,Ke,k,m,ce,re,u));l.v2||(oe.stroke(),oe.fill());break;case"hollow":for(M>5&&M<7&&(Ke=5),oe.strokeStyle=l.color,oe.beginPath(),ce=Math.floor(Ke/2),re=1;re<st;re++)if(k=i.QuoteTab[re],k!=null){for(m=Math.round(re*M+n)-ce,k.c>=k.o&&k.c>=i.QuoteTab[re-1].c&&Lt(oe,Ke,k,m,ce,re,u),T=0;T<=Ke;T++)Ie[m+T]=k.d;de=re,D[k.d]={o:k.o,h:k.h,l:k.l,c:k.c,i:re}}for(de!=null&&(k=i.QuoteTab[de],D[0]={o:k.o,h:k.h,l:k.l,c:k.c,i:de,d:k.d}),l.v1||oe.stroke(),oe.strokeStyle=l.color2,oe.beginPath(),re=1;re<st;re++)k=i.QuoteTab[re],k!=null&&(m=Math.round(re*M+n)-ce,k.c>=k.o&&k.c<i.QuoteTab[re-1].c&&Lt(oe,Ke,k,m,ce,re,u));for(l.v2||oe.stroke(),oe.strokeStyle=l.color3,oe.fillStyle=l.color,oe.beginPath(),re=1;re<st;re++)k=i.QuoteTab[re],k!=null&&(m=Math.round(re*M+n)-ce,k.c<=k.o&&k.c>=i.QuoteTab[re-1].c&&Lt(oe,Ke,k,m,ce,re,u));for(l.v1||(oe.stroke(),oe.fill()),oe.fillStyle=l.color2,oe.beginPath(),re=1;re<st;re++)k=i.QuoteTab[re],k!=null&&(m=Math.round(re*M+n)-ce,k.c<=k.o&&k.c<i.QuoteTab[re-1].c&&Lt(oe,Ke,k,m,ce,re,u));l.v2||(oe.stroke(),oe.fill())}if(Fe.Bars[0]=D,st!=0&&D[0]!=null&&(d.set.nohighlow||d.isCompare||(pt(oe,ut,i.High,mt,"rgba(0, 128, 0, 1)",!0,u),pt(oe,ut,i.Low,mt,"rgba(192, 0, 0, 1)",!0,u)),d.set.nosticky||pt(oe,ut,D[0].c,mt,null,!0,u)),t||a||VGP.chartSimple||(Oe="",d.mainChart.type!="perf"&&(Oe=Rr(d.chartPeriod<0).toFixed(2)),Xe="",VGP.noCommand||(Xe='<span class="mci-p"></span>'),we='<div><span class="eod_param" data-name="'+d.mainChart.type+'">'+Xe+lang.l_cours+"</span>",Pe=e.QuoteTab[e.QuoteTab.length-1],d.chartPeriod<0?(qe=B.qd,qe.dt=I(Pe.d,2)):(qe=Pe,qe.dt=Z(Pe.d,1)),qe.var=Oe,typeof extGetQuotesHover=="function"&&extGetQuotesHover(qe),o.idhtml(ge("eod_mainchartinfos-"),we)),Xt(R[0],!0,u),d.mainChart.type!="perf"){for(pe=d.mainChart.indicators.length,re=0;re<pe;re++)switch(ve=d.mainChart.indicators[re],ve.type){case"compare":Lo(ve,n,t,re,a);break;case"sar":Do(ve,n,t,re,a,u);break;case"phpb":Ro(ve,n,t,re,a,u);break;case"ichimoku":Eo(ve,n,t,re,a,u);break;case"pivots":ko(ve,t,re,a,u);break;case"supertrend":Vo(ve,n,t,re,a,u);break;default:bo(ve,n,t,re,a,u)}if(d.newsConfig&&(J.fiEvt.length==0&&J.fiEvt!="no"?Mo(n,re):Nr(n,t,re,a)),d.searchConfig!=""){switch(Ve=i.QuoteTab,d.searchConfig){case"gaps":Le="G",be=te.computeGAP(Ve);break;case"dojis":Le="D",be=te.computeDOJI(Ve,d.chartPeriod);break;case"keyr":Le="K",be=te.computeKEYR(Ve);break;case"englob":Le="E",be=te.computeEnglobante(Ve);break;case"marteau":Le=lang.l_m,be=te.computeMarteau(Ve);break;case"pendu":Le=lang.l_p,be=te.computePendu(Ve);break;case"pinces":Le=lang.l_p,be=te.computePinces(Ve);break;case"marubozu":Le=lang.l_m,be=te.computeMarubozu(Ve);break;case"soldiers":Le=lang.l_s,be=te.computeSoldiers(Ve,"s");break;case"harami":Le="H",be=te.computeHarami(Ve);break;case"corbeaux":Le="C",be=te.computeSoldiers(Ve,"c");break;case"dragon":Le="D",be=te.computeDragonFly(Ve);break;case"shootings":Le="E",be=te.computeShootingStar(Ve)}for(ne=be.Values.length,re=0;re<ne;re++)be.Values[re].v1!=0?(oe.beginPath(),oe.arc(Math.round(be.Values[re].i*M+n),xe(be.Values[re].v1,u)+20,8,0,2*Math.PI),oe.fillStyle="#008000",oe.fill()):be.Values[re].v2!=0&&(oe.beginPath(),oe.arc(Math.round(be.Values[re].i*M+n),xe(be.Values[re].v2,u)-20,8,0,2*Math.PI),oe.fillStyle="#ff0000",oe.fill());for(oe.fillStyle="#fff",re=0;re<ne;re++)be.Values[re].v1!=0?oe.fillText(Le,Math.round(be.Values[re].i*M+n)-4,xe(be.Values[re].v1,u)+24):be.Values[re].v2!=0&&oe.fillText(Le,Math.round(be.Values[re].i*M+n)-4,xe(be.Values[re].v2,u)-16)}}VGP.chartSimple||t||(Dt=document.querySelectorAll(ge("#eod_topinfo-")+" span"),Dt.length>1&&(d.mainChart.type=="perf"?Dt[1].innerHTML=lang.l_varperiod+" : "+Nt(i.QuoteTab,1).c.toFixed(2)+"%":d.set.noVarPeriod||(Wt=(Nt(i.QuoteTab,1).c-i.QuoteTab[0].c)*100/i.QuoteTab[0].c,Dt[1].innerHTML=lang.l_varperiod+" : "+(Wt>0?"+":"")+Wt.toFixed(2)+"%"))),De(),J.orders!=null&&(Ia(),Ar())}}function ht(e){if(e==null)return e;for(var t=[],a=U.minX,i=U.maxX,l=a;l<=i;l++)t.push(e[l]);return t}function wt(e,t,a,i){var l=d,s=Math.round((l.innerWidth-2*l.padBarCandle)/80),n=U.maxX-U.minX,u,m=Math.round(n/s),y,x,T,M;if(m<=0&&(m=1),y=e.ctx,y.beginPath(),y.save(),y.strokeStyle=l.set.gridColor,!l.set.gridLine&&y.setLineDash&&y.setLineDash([3]),t&&(O.ctxback.fillStyle=l.set.txtColor),T=l.heightGraph-6,i)for(u=m;u<n;u+=m)a[u]!=null&&(x=Math.round(a[u].cu-a[0].cu+l.paddingLeft)+.5,l.set.gridV&&(y.moveTo(x,0),y.lineTo(x,e.HeightPx)),M=a[u].d,l.chartPeriod>=0?l.histoLength>365?O.ctxback.fillText(Z(M,4),x-18,T):O.ctxback.fillText(Z(M,3),x-18,T):l.histoLength>2?O.ctxback.fillText(I(M),x-18,T):O.ctxback.fillText(I(M,1),x-18,T));else for(u=m;u<n;u+=m)x=Math.round(u*R[0].PxPointX+l.paddingLeft+l.padBarCandle)+.5,l.set.gridV&&(y.moveTo(x,0),y.lineTo(x,e.HeightPx)),t&&(M=a[u]==null?La(u+1-ze[ze.length-1].i):a[u].d,l.chartPeriod>=0?l.histoLength>365?O.ctxback.fillText(Z(M,4),x-18,T):O.ctxback.fillText(Z(M,3),x-18,T):l.histoLength>2?O.ctxback.fillText(I(M),x-18,T):O.ctxback.fillText(I(M,1),x-18,T));y.stroke(),y.restore()}function Tt(e,t,a,i,l,s,n){var u="",m,y,x,T,M,A,D;i>=1e5&&(i=i/1e3,l=l*1e3,u="K"),n&&(x=d.logData),e.save(),e.beginPath(),!d.set.gridLine&&e.setLineDash&&e.setLineDash([3]),e.strokeStyle=d.set.gridColor,e.font=d.set.fontSize+"px Arial",e.fillStyle=d.set.txtColor,T=t/l,M=35,t<120&&(M=20);var k=Math.round(t/M),E=T/(k-1),Y=Math.ceil(Math.log10(E)-1),F=Math.pow(10,Y),q=Math.ceil(E/F)*F,Q=Math.ceil((i-T)/q)*q,ce,de,_e;for(d.mainChart.typedef.nolinearX||(_e=B.QuoteTab[U.minX].c),A=d.widthGraph-d.paddingRight,D=a-d.padBarCandle,m=0;m<=k&&(ce=Q+m*q,de=n?xe(ce,x):Math.round((i-ce)*l),!(de<=5));m++)d.set.gridH&&(e.moveTo(D,de+.5),e.lineTo(A,de+.5)),y=s||d.mainChart.type=="perf"?d.mainChart.type=="perf"?b(ce,!0):b((ce-_e)*100/_e,!0):b(ce)+u,d.set.yaxis?e.fillText(y,2,de+2):e.fillText(y,A+5,de+2);e.stroke(),e.restore()}function pt(e,t,a,i,l,s,n){var u=d,m,y,x,T,M,A;a=parseFloat(a),s?m=xe(a,n):(m=Math.round(t-a*i),m<t+7&&(m=m-7)),l==null&&(l="rgba(51, 102, 255, 1)"),e.fillStyle=K(l),e.font=u.set.fontSize+"px Arial",x=u.widthGraph-u.paddingRight,T=u.paddingRight,u.set.yaxis&&(x=-2,T=u.paddingLeft-1),M=u.set.fontSize-11,e.fillRect(x+2,m-7,T,15+M),e.fillStyle=Yt(l),s&&u.isCompare&&!u.mainChart.typedef.nolinearX&&u.mainChart.type!="perf"?(y=B.QuoteTab[U.minX].c,a=(a-y)*100/y,e.fillText(a.toFixed(2),x+5,m+4+M)):(A="",a>=1e5&&(a=Math.round(a/1e3),A="K"),e.fillText(b(a)+A,x+5,m+4+M))}function xe(e,t){return t==null?Math.round((R[0].V0-e)*R[0].PxPointY):R[0].HeightPx-Math.round((Math.log10(e)/Math.log10(10)-t.floor)/t.range*R[0].HeightPx)}function Da(e,t){var a=R[0];return t==null?(a.V0*a.PxPointY-e)/a.PxPointY:Math.pow(10,Math.log10(10)*((a.HeightPx-e)*t.range/a.HeightPx+t.floor))}function Rr(e){if(e)return B.qv!=null?(Nt(B.QuoteTab,1).c-B.qv.c)*100/B.qv.c:0;var t=Nt(B.QuoteTab,2).c;return(Nt(B.QuoteTab,1).c-t)*100/t}function bo(e,t,a,i,l,s){var n,u={},m=R[0],y,x,T;switch(m.Bars[i+1]={},y=e.source!=null?e.source:"c",e.type){case"mm":n=te.computeMovingAverage(B.QuoteTab,e.param1,y);break;case"zig zag":n=te.computeZigZag(B.QuoteTab,e.param1/100,y);break;case"mmt":n=te.computeMovingAverageT(B.QuoteTab,e.param1,y);break;case"mmp":n=te.computeMovingAverageP(B.QuoteTab,e.param1,y);break;case"mmh":n=te.computeMovingAverageHull(B.QuoteTab,e.param1,y);break;case"double EMA":n=te.computeDoubleEMA(B.QuoteTab,e.param1,y);break;case"triple EMA":n=te.computeTripleEMA(B.QuoteTab,e.param1,y);break;case"linearc":n=te.computeLinearCurve(B.QuoteTab,e.param1,1,y);break;case"lineard":x=vl(B.QuoteTab,e.param1,e,y);break;case"supres":fl(B,e.param1,e);break;case"cmoy":n=gl(B.QuoteTab,d,e,y,s);break;case"mme":n=te.computeMovingAverageE(B.QuoteTab,e.param1,y);break;case"boll":e.param2==null&&(e.param2=2),n=te.computeBollinger(B.QuoteTab,e.param1,e.param2,y);break;case"donchian":n=te.computeDonchian(B.QuoteTab,e.param1);break;case"keltner":n=te.computeKeltner(B.QuoteTab,e.param1,e.param2,e.param3);break;case"evmm":n=te.computeEVMM(B.QuoteTab,e.param1,e.param2,y);break;case"alligator":n=te.computeAlligator(B.QuoteTab,e.param1,e.param2,e.param3);break;case"gmma":n=te.computeGMMA(B.QuoteTab)}if(e.type=="lineard"){go(m.ctx,x);return}if(e.type!="supres"&&n!=null){if(n.Values=ht(n.Values),e.type=="alligator"){_o(m,n,t,e,s,i,a,l);return}if(e.type=="gmma"){xo(m,n,t,e,s,i,a,l);return}var M=n.Values.length,A=m.ctx,D=t-1,k,E,Y,F=m.PxPointX,q;if(A.strokeStyle=e.v1?"transparent":e.color,n.Values[0]==null&&(n.Values[0]={v1:B.QuoteTab[U.minX].c,d:B.QuoteTab[U.minX].d}),n.Values[0].v2==null){for(A.save(),A.beginPath(),A.moveTo(t,xe(n.Values[0].v1,s)+.5),it(A,e,1),He(A,1,e),E=1;E<M;E++)n.Values[E]!=null&&(k=Math.round(E*F+t),k-D>=1&&(A.lineTo(k+.5,xe(n.Values[E].v1,s)+.5),D=k),u[n.Values[E].d]=n.Values[E].v1,q=E);q!=null&&(u[0]=n.Values[q].v1),m.Bars[i+1]=u,A.stroke(),A.restore();return}for(A.beginPath(),T=!1,E=M-1;E>=0;E--)n.Values[E]!=null&&(Y=xe(n.Values[E].v1,s),T?(k=Math.round(E*F+t),A.lineTo(k+.5,Math.round(Y)+.5)):(A.moveTo(Math.round(E*F+t)+.5,Y+.5),T=!0));for(Y=xe(n.Values[0].v1,s),A.lineTo(d.paddingLeft+1,Y+.5),Y=xe(n.Values[0].v2,s),A.lineTo(d.paddingLeft+1,Y+.5),E=0;E<M;E++)n.Values[E]!=null&&(k=Math.round(E*F+t),Y=xe(n.Values[E].v2,s),A.lineTo(k+.5,Y+.5),u[n.Values[E].d]=[n.Values[E].v1,n.Values[E].v2],q=E);u[0]=[n.Values[q].v1,n.Values[q].v2],A.save(),it(A,e,1),He(A,1,e),A.stroke(),A.restore(),e.v2||(A.fillStyle=e.color2,A.fill()),m.Bars[i+1]=u}}function xo(e,t,a,i,l){for(var s=t.Values.length,n=e.ctx,u,m,y=e.PxPointX,x,T=1;T<13;T++){for(n.save(),n.strokeStyle=T<7?i.v1?"transparent":i.color:i.v2?"transparent":i.color2,n.beginPath(),T<7&&it(n,i,1),T>=7&&it(n,i,2),it(n,i,T),T<7?He(n,1,i):He(n,2,i),x=!1,m=1;m<s;m++)t.Values[m]!=null&&(u=Math.round(m*y+a),x||(n.moveTo(u,xe(t.Values[m]["v"+T],l)+.5),x=!0),n.lineTo(u+.5,xe(t.Values[m]["v"+T],l)+.5));n.stroke(),n.restore()}}function _o(e,t,a,i,l,s){for(var n=t.Values.length,u=e.ctx,m,y,x=e.PxPointX,T={},M,A,D,k,E=1;E<4;E++){for(M="v"+E,u.save(),u.strokeStyle=E==1?i[M]?"transparent":i.color:i[M]?"transparent":i["color"+E],u.beginPath(),it(u,i,E),He(u,E,i),k=!1,y=1;y<n;y++)D=t.Values[y],D!=null&&D[M]!=null&&(m=Math.round(y*x+a),k||(u.moveTo(m,xe(D[M],l)+.5),k=!0),u.lineTo(m+.5,xe(D[M],l)+.5),E==3&&(A=y,T[D.d]=[D.v1,D.v2,D.v3]));u.stroke(),u.restore()}D=t.Values[A],T[0]=[D.v1,D.v2,D.v3],e.Bars[s+1]=T}function ma(e){var t=e.Indicator,a=B.QuoteTab,i,l=t.source!=null?t.source:"c",s,n;switch(t.type){case"volume":Dr(te.computeVolume(a,U),e);break;case"accDist":et(te.computeAccDist(a),e,"curve",0);break;case"obv":et(te.computeOBV(a),e,"curve",0);break;case"bollb":Ge(te.computeBollingerB(a,t.param1,2,l),e);break;case"bollw":Ge(te.computeBollingerBandwith(a,t.param1,t.param2,l),e);break;case"perfi":et(te.computePERFORMANCE(B,!0),e,"curve",0);break;case"volumecash":Dr(te.computeVolume(a,U,!0),e);break;case"rsi":Ge(te.computeRSI(a,t.param1,l),e);break;case"cmo":Ge(te.computeCMO(a,t.param1),e);break;case"fr":if(d.isCompare){for(n=d.mainChart.indicators,i=0;i<n.length;i++)if(n[i].type=="compare"&&n[i].datas2){s=n[i].datas2.QuoteTab;break}et(te.computeFR(a,s),e,"curve",0)}break;case"ultimate":Ge(te.computeUltimateOsc(a,t.param1,t.param2,t.param3),e);break;case"atr":Ge(te.computeATR(a,t.param1,"pma"),e);break;case"cci":Ge(te.computeCCI(a,t.param1),e);break;case"eom":et(te.computeEaseOfMovement(a,t.param1),e,"curve",0);break;case"cmf":et(te.computeCMF(a,t.param1),e,"curve",0);break;case"dpo":et(te.computeDPO(a,t.param1),e,"curve",0);break;case"mom":et(te.computeMomentum(a,t.param1,l),e,"curve",0);break;case"asi":et(te.computeASI(a),e,"curve",0);break;case"coppock":et(te.computeCoppock(a,t.param1,t.param2,t.param3,l),e,"curve",0);break;case"nvi":Ge(te.computeNVIPVI(a,l,"nvi"),e);break;case"pvi":Ge(te.computeNVIPVI(a,l,"pvi"),e);break;case"macd":Ge(te.computeMACD(a,t.param1,t.param2,t.param3,"macd",l),e);break;case"macdzl":Ge(te.computeMACDZL(a,t.param1,t.param2,t.param3),e);break;case"wto":Ge(te.computeWaveTrendOsc(a,t.param1,t.param2),e);break;case"dmi":Ge(te.computeDMI(a,t.param1,"dmi"),e);break;case"aroon":Ge(te.ComputeAroon(a,t.param1),e);break;case"adx":Ge(te.computeDMI(a,t.param1,"adx"),e);break;case"vortex":Ge(te.computeVortex(a,t.param1),e);break;case"macdh":et(te.computeMACD(a,t.param1,t.param2,t.param3,"macdh",l),e,"bar");break;case"awesome":et(te.computeAwesomeIndicator(a,t.param1,t.param2),e,"awesome");break;case"bop":et(te.computeBOP(a),e,"bop");break;case"qstick":et(te.computeQStick(a,t.param1),e,"bar");break;case"roc":Ge(te.computeROC(a,t.param1,l,!0),e);break;case"std":Ge(te.computeSTD(a,t.param1,l),e);break;case"ulcer":Ge(te.computeUlcerIndex(a,t.param1,l),e);break;case"sto":Ge(te.computeSTOCH(a,t.param1,t.param2,t.param3),e);break;case"di":Ge(te.computeDI(a,t.param1),e);break;case"sto rsi":Ge(te.computeStochRSI(a,t.param1,t.param2,t.param3,t.param4,l),e);break;case"smi":Ge(te.computeSMI(a,t.param1,t.param2,t.param3,t.param4),e);break;case"tsi":Ge(te.computeTSI(a,t.param1,t.param2,t.param3),e);break;case"kvo":Ge(te.computeKVO(a),e);break;case"kst":Ge(te.computeKST(a,t.param1,t.param2,t.param3,t.param4,l),e);break;case"trix":Ge(te.computeTRIX(a,t.param1,l),e);break;case"mass index":Ge(te.computeMassIndex(a,t.param1),e);break;case"vroc":Ge(te.computeVROC(a,t.param1),e);break;case"ac will":et(te.computeWILAC(a),e,"curve",0);break;case"will r":Ge(te.computeWILR(a,t.param1),e);break;case"mfi":Ge(te.computeMFI(a,t.param1),e);break;case"linearo":et(te.computeLinearCurve(a,t.param1,2,l),e,"curve",0);break;case"moonphase":d.chartPeriod>=0&&et(te.computeMoonPhase(a),e,"curve",0);break;case"elderbull":et(te.computeElderRay(a,t.param1,"bull"),e,"bar");break;case"elderbear":et(te.computeElderRay(a,t.param1,"bear"),e,"bar");break;case"forceindex":et(te.computeForceIndex(a,t.param1,l),e,"curve",0)}}function et(e,t,a,i){var l=t.ctx,s,n,u,m,y,x,T,M,A,D,k;if(wt(t),e==null){Xt(t);return}s=t.Indicator,n=s.mm,n!=null&&n!=0&&(e.Values=te.computeMM(e.Values,n)),e.Values=ht(e.Values);var E=e.High,Y=e.Low,F=e.Values.length,q,Q,ce,de,_e,Me=17,Ye=5;if(s.type=="moonphase"&&(Ye=0),t.PxPointY=(t.HeightPx-Me-Ye)/(E-Y),u=R[0].PxPointX,m=d.paddingLeft+d.padBarCandle,Tt(l,t.HeightPx,m,E+Me/t.PxPointY,t.PxPointY),y=m-1,t.V0=Math.round(t.PxPointY*E)+Me,x=t.V0-Math.round(i*t.PxPointY),t.Bars={},a=="curve"){for(l.strokeStyle=s.v1?"transparent":s.color,l.beginPath(),l.moveTo(m,x),q=0;q<F;q++)e.Values[q]!=null&&(Q=Math.round(q*u+m),Q-y>=1&&(l.lineTo(Q,t.V0-Math.round(e.Values[q].v1*t.PxPointY)),y=Q),_e=q,t.Bars[e.Values[q].d]=e.Values[q].v1);_e!=null&&(t.Bars[0]=e.Values[_e].v1),l.save(),it(l,s,1),He(l,1,s),l.stroke(),l.restore(),l.lineTo(y,x),l.lineTo(m,x),s.v2||(l.fillStyle=s.color2,l.fill())}if(a=="bar"){for(d.padBarCandle!=0?(D=Math.floor(d.innerWidth/F)-1,D<1&&(D=1),m=d.paddingLeft+d.padBarCandle-Math.round(D/2)):(m=d.paddingLeft,D=2),M=s.v1?"transparent":s.color,A=s.v2?"transparent":s.color2,q=0;q<F;q++)e.Values[q]!=null&&(Q=Math.round(q*u+m),T=Math.round(-e.Values[q].v1*t.PxPointY),Q-y>=1&&(l.fillStyle=T<=0?M:A,l.fillRect(Q,t.V0,D,T),y=Q),_e=q,t.Bars[e.Values[q].d]=e.Values[q].v1);_e!=null&&(t.Bars[0]=e.Values[_e].v1)}if(a=="awesome"||a=="bop"){for(d.padBarCandle!=0?(D=Math.floor(d.innerWidth/F)-1,D<1&&(D=1),m=d.paddingLeft+d.padBarCandle-Math.round(D/2)):(m=d.paddingLeft,D=2),_e=0,ce=1;ce<4&&(de="v"+ce,!(ce==3&&a!="bop"));ce++)for(l.fillStyle=ce==1?s.v1?"transparent":s.color:s[de]?"transparent":s["color"+ce],q=0;q<F;q++)e.Values[q]!=null&&e.Values[q][de]!=null&&(Q=Math.round(q*u+m),T=Math.round(-e.Values[q][de]*t.PxPointY),l.fillRect(Q,t.V0,D,T),t.Bars[e.Values[q].d]=e.Values[q][de],q>_e&&(_e=q,k=de));_e!=0&&(t.Bars[0]=e.Values[_e][k])}Ba(l,t,e.Values,m,u),d.set.nosticky||pt(l,t.V0,t.Bars[0]||"",t.PxPointY,s.color),Xt(t)}function Dr(e,t){var a=t.ctx,i=e.High,l,s,n,u,m,y,x,T,M,A;wt(t),l=t.Indicator,s=l.mm,s!=null&&s!=0&&(e.Values=te.computeMMonVolume(e.Values,s)),e.Values=ht(e.Values);var D=e.Values.length,k,E=!1,Y=20;for(t.PxPointY=(t.HeightPx-Y)/i,t.V0=Math.round(t.PxPointY*i)+Y,n=R[0].PxPointX,u=Math.floor(d.innerWidth/D)-2,u%2==0&&u++,u>21?u=21:u<0?u=1:u<2&&(u=2),m=d.paddingLeft+d.padBarCandle-Math.round(u/2),Tt(a,t.HeightPx,m,i+Y/t.PxPointY,t.PxPointY),t.Bars={},a.fillStyle=l.v1?"transparent":l.color,a.beginPath(),T=d.innerWidth+d.paddingLeft,(l.type=="volume"||l.type=="volumecash")&&(A=3),l.type=="mf"&&(A=5),M=1;M<A;M++){for(a.fillStyle=M==1?l.v1?"transparent":l.color:l["v"+M]?"transparent":l["color"+M]||j(l.type)["color"+M],a.beginPath(),k=0;k<D;k++)e.Values[k]!=null&&e.Values[k]["v"+M]&&(E=Math.round(k*n+m),E<T&&(x=E+u>T?T-E:u,E<d.paddingLeft&&(x=u-(d.paddingLeft-E),E=d.paddingLeft),a.rect(E,t.HeightPx,x,-e.Values[k]["v"+M]*t.PxPointY)),t.Bars[e.Values[k].d]=e.Values[k]["v"+M],k>y&&(y=k));a.fill()}y!=null&&(t.Bars[0]=t.Bars[e.Values[y].d]),Ba(a,t,e.Values,m,n),d.set.nosticky||pt(a,t.HeightPx,t.Bars[0]||"",t.PxPointY,l.color),Xt(t)}function Ge(e,t){var a=t.ctx,i,l,s,n,u,m,y,x,T,M,A,D,k;if(wt(t),Xt(t),e!=null){var E=t.Indicator,Y=E.type,F=E.mm;F!=null&&F!=0&&(e.Values=te.computeMM(e.Values,F)),i=17,l=5,(Y=="rsi"||Y=="ultimate")&&(i=0,l=0),e.Values=ht(e.Values);var q=e.High,Q=e.Low,ce=e.Values.length;if(t.PxPointY=(t.HeightPx-i-l)/(q-Q),s=R[0].PxPointX,n=d.paddingLeft+d.padBarCandle,Tt(a,t.HeightPx,n,q+i/t.PxPointY,t.PxPointY),y=n-1,t.V0=Math.round(t.PxPointY*q)+i,t.Bars={},Y=="roc"||Y=="rsi"||Y=="di"){switch(a.beginPath(),a.strokeStyle="#99ccff",Y){case"roc":T=100;break;case"rsi":T=50;break;case"di":T=0}a.moveTo(d.paddingLeft,t.V0-Math.round(T*t.PxPointY)+.5),a.lineTo(d.widthGraph-d.paddingRight,t.V0-Math.round(T*t.PxPointY)+.5),a.stroke()}for(Y=="wto"&&(a.beginPath(),a.strokeStyle="rgba(255,0,0,0.7)",a.moveTo(d.paddingLeft,t.V0-Math.round(53*t.PxPointY)+.5),a.lineTo(d.widthGraph-d.paddingRight,t.V0-Math.round(53*t.PxPointY)+.5),a.stroke(),a.beginPath(),a.strokeStyle="rgba(0,128,0,0.7)",a.moveTo(d.paddingLeft,t.V0-Math.round(-53*t.PxPointY)+.5),a.lineTo(d.widthGraph-d.paddingRight,t.V0-Math.round(-53*t.PxPointY)+.5),a.stroke()),a.strokeStyle=E.v1?"transparent":E.color,a.beginPath(),M=0,a.moveTo(n,t.V0-Math.round(e.Values[0].v1*t.PxPointY)),u=1;u<ce;u++)e.Values[u]!=null&&e.Values[u].v1!=null&&(m=Math.round(u*s+n),m-y>=1&&(a.lineTo(m,t.V0-Math.round(e.Values[u].v1*t.PxPointY)),y=m),t.Bars[e.Values[u].d]=Y=="aroon"?[e.Values[u].v1,e.Values[u].v2]:e.Values[u].v1,x=u);if(x!=null&&(t.Bars[0]=e.Values[x].v1),a.save(),it(a,E,1),He(a,1,E),a.stroke(),a.restore(),e.Values[0].v2!=null){for(y=n-1,a.strokeStyle=E.v2?"transparent":E.color2,a.beginPath(),a.moveTo(n,t.V0-Math.round(e.Values[0].v2*t.PxPointY)),u=1;u<ce;u++)e.Values[u]!=null&&(m=Math.round(u*s+n),m-y>=1&&(a.lineTo(m,t.V0-Math.round(e.Values[u].v2*t.PxPointY)),y=m),M=e.Values[u].v2);a.save(),it(a,E,2),He(a,2,E),a.stroke(),a.restore()}if(Y=="dmi"){for(a.strokeStyle=E.v3?"transparent":E.color3,a.beginPath(),a.moveTo(n,t.V0-Math.round(e.Values[0].v3*t.PxPointY)),u=0;u<ce;u++)e.Values[u]!=null&&(m=Math.round(u*s+n),a.lineTo(m,t.V0-Math.round(e.Values[u].v3*t.PxPointY)));for(a.save(),it(a,E,3),He(a,3,E),a.stroke(),a.restore(),t.Bars={},u=0;u<ce;u++)e.Values[u]!=null&&(t.Bars[e.Values[u].d]=[e.Values[u].v1,e.Values[u].v2,e.Values[u].v3],x=u);x!=null&&(t.Bars[0]=e.Values[x].v1)}if(Y=="macd"||Y=="macdzl"||Y=="wto"){for(y=n-1,a.beginPath(),a.moveTo(n,t.V0),A=E.v3?"transparent":E.color3!=null?E.color3:A=X(K(E.color2),.5),a.strokeStyle=A,t.Bars={},u=0;u<ce;u++)e.Values[u]!=null&&(m=Math.round(u*s+n),m-y>=1&&(a.lineTo(m,t.V0-Math.round((e.Values[u].v1-e.Values[u].v2)*t.PxPointY)),y=m),x=u,t.Bars[e.Values[u].d]=e.Values[u].v1-e.Values[u].v2);x!=null&&(t.Bars[0]=e.Values[x].v1),a.stroke(),a.lineTo(m,t.V0),a.lineTo(n,t.V0),a.fillStyle=A,a.fill()}Ba(a,t,e.Values,n,s),j(E.type).sb!=null&&(D=E.sh!=null?E.sh:j(E.type).sh,k=E.sb!=null?E.sb:j(E.type).sb,E.sh!=9999&&(a.beginPath(),E.shs==3&&(a.lineWidth=3),a.strokeStyle="rgba(255,0,0,0.5)",a.moveTo(d.paddingLeft,Math.round(t.V0-D*t.PxPointY)+.5),a.lineTo(d.widthGraph-d.paddingRight,Math.round(t.V0-D*t.PxPointY)+.5),a.stroke(),(E.shs==null||E.shs==1)&&(a.fillStyle="rgba(255,0,0,0.15)",a.fillRect(d.paddingLeft,1,d.innerWidth,t.V0-Math.round(D*t.PxPointY)))),E.sb!=9999&&(a.beginPath(),a.lineWidth=E.sbs==3?3:1,a.strokeStyle="rgba(0,128,0,0.5)",a.moveTo(d.paddingLeft,Math.round(t.V0-k*t.PxPointY)+.5),a.lineTo(d.widthGraph-d.paddingRight,Math.round(t.V0-k*t.PxPointY)+.5),a.stroke(),(E.sbs==null||E.sbs==1)&&(a.fillStyle="rgba(0,128,0,0.15)",a.fillRect(d.paddingLeft,t.V0-Math.round(k*t.PxPointY),d.innerWidth,t.V0-Math.round(k*t.PxPointY)))),a.lineWidth=1),d.set.nosticky||(M!=0&&pt(a,t.V0,M,t.PxPointY,E.color2),pt(a,t.V0,t.Bars[0]||"",t.PxPointY,E.color))}}function Gt(){var e=d.histoLength,t;switch(e<=20?e=e+" JOUR"+(e!=1?"S":""):e<365?(e=Math.round(e/30),e=e+" MOIS"):(e=Math.round(e/365),e=e+" AN"+(e!=1?"S":"")),t=d.chartPeriod,t){case 0:t="JOUR";break;case 7:t="HEBDO";break;case 30:t="MENSUEL";break;case 91:t="TRIMESTRIEL";break;case 365:t="ANNUEL";break;default:t=t>=-60?Math.abs(t)+" MINUTE"+(t!=-1?"S":""):Math.round(t/-60)+" HEURES"}o.qstxt(ge("#eod_topinfo-")+" span:last-child",e+" - "+t)}function _t(e){Ie={},R=[],dt(),e||typeof stopTimers=="function"&&stopTimers()}function wo(){var e,t,a,i,l,s,n,u,m;for(t=[0,.25,.2,.1666,.15,.13,.12][d.indicators.length],i=[1,.75,.6,.5002,.4,.35,.28][d.indicators.length],e=i,l=new yt(0,i,d.mainChart.type,ge("main-"),0),l.Create(),l.DrawEncadre(),s=d.indicators.length,a=0;a<s;a++)n=new yt(e,t,d.indicators[a],ge("indic-")+(a+1),d.marginInter*(a+1)),n.Create(),n.DrawEncadre(),u=Math.round(e*d.usableHeight)+d.paddingTop+d.marginInter*(a+1)+5,m=Oa(O.callID+(a+1),d.indicators[a].type,d.paddingLeft+5,u,d.innerWidth-7),O.doc.appendChild(m),e=e+t,s>1&&(a==s-1?Vt(a+1,!0):Vt(a+1,!1))}function ge(e){return e+O.callID}function Ir(e,t){var a,i,l,s,n;if(a=t?e.type:e,J.flagSave=!0,We(),d.mainChart.typedef.nolinearX){if(U.maxX=0,U.minX=0,B.Low==null&&v(B),U.minY=B.Low,U.maxY=B.High,d.isCompare&&ha(B.High,B.Low,B.QuoteTab[0].c),d.mainChart.type=a,d.mainChart.typedef=j(a),t&&(d.mainChart=r(d.mainChart,e)),R.length>1&&R.splice(0,1),d.mainChart.typedef.nolinearX){Ga();return}for(d.histoLength!=1||d.set.noVeilleIntra||(i=B.qv.c,i>U.maxY&&(U.maxY=i),i<U.minY&&(U.minY=i)),s=R.length,l=0;l<s;l++)R[l].Bars=l==0?[]:{},delete R[l].canvas,delete R[l].ctx;n=c(R),_t(!0),Bt(n),Gt(),Ee(),ee();return}d.mainChart.type=a,d.mainChart.typedef=j(a),t&&(d.mainChart=r(d.mainChart,e)),d.mainChart.typedef.nolinearX?Ga():Ee()}function Ia(){o.qsarem("#"+O.callID+" .shorderzn"),o.qsarem("#"+O.callID+" .shorderln")}function To(e){var t=VGP.urlWS+"GetOrders",a;VGP.callType=="GET"&&(t=t+"?symbol="+d.symbol+"&id="+e),a=new XMLHttpRequest,a.open(VGP.callType,t,!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.onload=function(){if(a.status>=200&&a.status<400){var i=JSON.parse(a.responseText);i!=null&&i.d!=null?(J.orders=i.d,Ar()):J.orders=null}},a.send(JSON.stringify({symbol:d.symbol,id:e}))}function Ar(){for(var e=J.orders,t=J.orders.length,a=R[0].RealY+10,i=R[0].RealY+R[0].HeightPx-15,l,s,n,u,m,y,x,T,M,A,D=0;D<t;D++)l=xe(e[D].Cours,d.logData)+d.paddingTop,l>a&&l<i&&(s=e[D].Sens=="A"?"buy":"sell",n=document.createElement("div"),n.setAttribute("class","shorderzn"),u=document.createElement("div"),u.setAttribute("class","ord1 "+s+"1"),n.appendChild(u),m=document.createElement("div"),m.setAttribute("class","ord3 "+s+"3"),y=document.createElement("div"),y.setAttribute("class","ord2 "+s+"2"),x="",T="closeshsimple",e[D].Nb>1&&(x="x"+e[D].Nb,T="closesh"+s),M="<span>"+e[D].Type+" "+e[D].Reg+": </span><span>"+e[D].Qte+" @ "+e[D].Cours+'</span><span class="closeShOrder '+T+'" data-name="'+e[D].Id+'">'+x+"</span>",m.innerHTML=M,n.appendChild(m),n.appendChild(y),n.style.top=l+"px",O.doc.appendChild(n),A=document.createElement("div"),A.setAttribute("class",s+"3 shorderln"),A.style.top=l+"px",A.style.left=d.paddingLeft+"px",A.style.width=d.innerWidth+"px",O.doc.appendChild(A))}function Po(e){var t,a,i;dt(),Ia(),Se.sens=e,Se.last=R[0].Bars[0][0].c,t=e=="buy"?Se.last*.98:Se.last*1.02,Se.popup=o.gi("orderzn"),O.doc.querySelector("orderzn")==null&&O.doc.appendChild(Se.popup),Se.cvs=o.gi(ge("overlay-")),Se.ctx=Se.cvs.getContext("2d"),Se.oft=Ue(o.gi(ge("rodgraph-"))),a=Se.popup.querySelector("div:nth-of-type(2)"),i=window.getComputedStyle(a).backgroundColor,Se.ctx.strokeStyle=i,Se.ctx.lineWidth=2,Se.ctx.setLineDash&&Se.ctx.setLineDash([]);var l=window.getComputedStyle(Se.popup),s=l.width.replace("px",""),n=parseInt((d.widthGraph-s)/2);Se.popup.style.left=n+"px",Se.popup.style.display="block",Aa(t),Se.isMove=!1,["touchstart","mousedown"].forEach(function(u){o.gi("ordertype").addEventListener(u,Gr)}),O.clickHandler.forEach(function(u){o.qs(".closeorder").addEventListener(u,Hr)}),o.gi("orderlevel").addEventListener("keydown",Br)}function Hr(e){e.preventDefault(),qr(),Se.ctx.clearRect(0,0,Se.cvs.width,Se.cvs.height)}function Br(e){var t=e.which?e.which:e.keyCode,a,i;t==13&&(a=this.value,i=parseFloat(a.replace(/,/g,".")),Aa(i))}function Gr(e){e.preventDefault(),Se.isMove=!0,["touchmove","mousemove"].forEach(function(t){document.addEventListener(t,Or)}),["touchend","mouseup"].forEach(function(t){o.gi("ordertype").addEventListener(t,Ot),document.addEventListener(t,Ot)})}function Or(e){e.preventDefault(),Se.isMove&&So(e)}function Ot(e){e.preventDefault(),Se.isMove=!1,["touchmove","mousemove"].forEach(function(t){document.removeEventListener(t,Or)}),["touchend","mouseup"].forEach(function(t){o.gi("ordertype").removeEventListener(t,Ot),document.removeEventListener(t,Ot)})}function qr(){var e=o.gi("orderzn");e!=null&&e.offsetParent!=null&&(Se.ctx.clearRect(0,0,Se.cvs.width,Se.cvs.height),["touchstart","mousedown"].forEach(function(t){o.gi("ordertype").removeEventListener(t,Gr)}),["touchend","mouseup"].forEach(function(t){document.removeEventListener(t,Ot)}),o.gi("orderlevel").removeEventListener("keydown",Br),O.clickHandler.forEach(function(t){o.qs(".closeorder").removeEventListener(t,Hr)}),Se.popup.style.display="none",O.doc.parentNode.insertBefore(Se.popup,O.doc.nextSibling),ee())}function Co(e,t,a){var i={t:"limit\xE9",c:"limit"},l={t:"seuil de d\xE9clenchement",c:"stop"};return a=="buy"?e>=t?i:l:e<=t?i:l}function Aa(e){var t,a,i,l,s;Se.ctx.clearRect(0,0,Se.cvs.width,Se.cvs.height),t=e,e>U.maxY&&(e=U.maxY),e<U.minY&&(e=U.minY),a=xe(e,d.logData)+d.paddingTop,i=a+1,Se.ctx.beginPath(),Se.ctx.moveTo(d.paddingLeft,a),Se.ctx.lineTo(Se.cvs.width-d.paddingRight,a),Se.ctx.stroke(),Se.popup.style.top=i+"px",o.gi("orderlevel").value=b(t),l=Co(Se.last,e,Se.sens),s=o.gi("ordertype"),s!=null&&(s.textContent=l.t,s.setAttribute("order",l.c))}function So(e){var t=ie(e),a=parseInt(t.y-Se.oft.top),i=parseInt(t.x-Se.oft.left),l;a<d.paddingTop||a>R[0].HeightPx+d.paddingTop||(l=new Ae(i,a-d.paddingTop),Aa(l.y))}function Ha(){var e=new XMLHttpRequest;e.open("POST",VGP.urlWS+"TraceDeleteSymbol",!0),e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.send(JSON.stringify({userid:VGP.userID,symbol:d.symbol}))}function Mo(e,t){var a=VGP.urlWS+"GetEvtList",i;VGP.callType=="GET"&&(a=a+"?symbol="+d.symbol+"&length="+d.histoLength+"&isIntraday="+(d.chartPeriod<0)),dt(),i=new XMLHttpRequest,i.open(VGP.callType,a,!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.onload=function(){if(i.status>=200&&i.status<400){var l=JSON.parse(i.responseText);l!=null&&l.d!=null?(J.fiEvt=l.d,Nr(e,!1,t,!1)):J.fiEvt="no",ee()}},i.send(JSON.stringify({symbol:d.symbol,isIntraday:d.chartPeriod<0,length:d.histoLength}))}function ko(e,t,a,i,l){var s,n,u;if(R[0].Bars[a+1]=null,!(d.chartPeriod>=0)&&U.qv!=null&&U.qd!=null){var m,y,x=new Date,T=x.getHours()*60+x.getMinutes(),M=x.getFullYear().toString().substring(2,4)+W(x.getMonth()+1,"00")+W(x.getDate(),"00")+W(T,"0000"),A=M-B.QuoteTab[B.QuoteTab.length-1].d;if(y=A<30?U.qv:A>240||T>1080?U.qd:U.qv,n=B.QuoteTab.length,n<3)u=B.QuoteTab[0].d;else for(s=n-1;s>0;s--)if(B.QuoteTab[s].d-B.QuoteTab[s-1].d>480){u=B.QuoteTab[s].d;break}u==null&&(u=B.QuoteTab[0].d),m=new Je(u,0,0);var D=R[0].ctx,k=(y.h+y.l+y.c)/3,E=2*k-y.l,Y=k+(y.h-y.l),F=2*k-y.h,q=k-(y.h-y.l),Q=m.mx+d.paddingLeft;D.save(),e.v1||qt(D,e.color,Q,k,1,l),e.v2||(qt(D,e.color2,Q,F,1,l),qt(D,e.color2,Q,q,2,l)),e.v3||(qt(D,e.color3,Q,E,1,l),qt(D,e.color3,Q,Y,2,l)),D.restore()}}function qt(e,t,a,i,l,s){var n=xe(i,s)+.5*l,u=d;e.lineWidth=l,e.beginPath(),e.strokeStyle=t,e.moveTo(a,n),e.lineTo(u.widthGraph-u.paddingRight,n),e.fillStyle=K(t),e.fillText(i.toFixed(2),u.widthGraph-u.paddingRight-47,n-3),e.stroke()}function Eo(e,t,a,i,l,s){var n={},u=R[0],m,y,x,T,M,A,D,k,E,Y,F;if(u.Bars[i+1]={},m=te.computeIchimoku(B.QuoteTab,e.param1,e.param2,d.chartPeriod),m!=null){for(m.Values=ht(m.Values),y=m.Values.length,x=u.ctx,D=1;D<6;D++)if(k="v"+D,!e[k]){for(x.save(),x.strokeStyle=D==1?e.color:e["color"+D],D==5?e.s5!=null?He(x,5,e):He(x,3):He(x,D,e),x.beginPath(),it(x,e,D),A=xe(m.Values[0][k],s),x.moveTo(t,A+.5),M=1;M<y;M++)Y=m.Values[M],Y!=null&&Y[k]!=null&&(T=Math.round(M*u.PxPointX+t),A=xe(Y[k],s),x.lineTo(T+.5,A+.5),D==1&&(n[Y.d]=[Y.v1,Y.v2],E=M));x.stroke(),x.restore()}if(E!=null&&(Y=m.Values[E],n[0]=[Y.v1,Y.v2]),u.Bars[i+1]=n,!e.v6){for(x.save(),e.color6!=null?(x.strokeStyle=e.color6,x.fillStyle=e.color6):(x.strokeStyle=X(K(e.color4),.3),x.fillStyle=X(K(e.color4),.3)),x.beginPath(),F=!1,M=y-1;M>=0;M--)m.Values[M]!=null&&m.Values[M].v6!=null&&(A=xe(m.Values[M].v6,s),F?(T=Math.round(M*u.PxPointX+t),x.lineTo(T+.5,A+.5)):(x.moveTo(Math.round(M*u.PxPointX+t)+.5,A+.5),F=!0));for(M=0;M<y;M++)m.Values[M]!=null&&(T=Math.round(M*u.PxPointX+t),A=xe(m.Values[M].v7,s),x.lineTo(T+.5,A+.5));x.closePath(),x.stroke(),x.fill(),x.restore()}}}function Lo(e,t,a,i){var l={},s=R[0],n,u,m,y,x,T,M,A,D,k,E,Y;if(s.Bars[i+1]={},e.datas2&&(n=e.datas2.QuoteTab,!e.v1)){for(u=n.length,m=s.ctx,m.strokeStyle=e.color,m.save(),m.beginPath(),T=s.PxPointY*B.QuoteTab[U.minX].c,M=Math.round((s.V0-B.QuoteTab[U.minX].c)*s.PxPointY),m.moveTo(t,M),it(m,e,1),He(m,1,e),A=0,x=0;x<u;x++)n[x]!=null&&s.Bars[0][n[x].d]!=null&&(k=s.Bars[0][n[x].d].i,y=Math.round(k*s.PxPointX+t),A==0?A=n[x].c:(D=(n[x].c-A)/A,m.lineTo(y+.5,M-D*T),l[n[x].d]=n[x].c,E=x));E!=null&&(l[0]=n[E].c),s.Bars[i+1]=l,m.stroke(),m.restore(),d.set.nosticky||u==0||(Y=s.V0-(M-D*T)/s.PxPointY,pt(m,s.V0,Y,s.PxPointY,e.color,!0,null))}}function Vo(e,t,a,i,l,s){var n={},u=R[0],m;if(u.Bars[i+1]={},m=te.computeSupertrend(B.QuoteTab,e.param1,e.param2),m.Values=ht(m.Values),m.Values!=null){for(var y=m.Values.length,x=u.ctx,T,M,A,D,k,E,Y=0,F,q=1;q<3;q++)if(k="v"+q,D=!0,!e["v"+q]){for(x.save(),x.beginPath(),A=xe(m.Values[0][k],s),x.moveTo(t,A+.5),it(x,e,q),x.strokeStyle=q==1?e.color:e.color2,M=1;M<y;M++)E=m.Values[M],E!=null&&(E[k]==0?(D&&x.stroke(),D=!1):(n[E.d]=E[k],T=Math.round(M*u.PxPointX+t),A=xe(E[k],s),D?x.lineTo(T+.5,A+.5):(x.beginPath(),x.moveTo(T+.5,A+.5),D=!0),M>Y&&(Y=M,F=k)));D&&x.stroke(),x.restore()}Y>0&&(n[0]=m.Values[Y][F]),u.Bars[i+1]=n}}function Ro(e,t,a,i,l,s){var n=te.computeHighLow(B.QuoteTab,e.param1),u={},m=R[0],y,x,T,M,A,D,k,E,Y;if(m.Bars[i+1]={},n==null)return null;for(y=m.ctx,n.Values=ht(n.Values),Y=n.Values.length,A=1;A<3;A++)if(D="v"+A,!e[D])for(y.fillStyle=A==1?e.color:e.color2,T=0;T<Y;T++)n.Values[T]!=null&&(x=Math.round(T*m.PxPointX+t),n.Values[T][D]!=0&&(y.beginPath(),M=xe(n.Values[T][D],s),y.arc(x,M,3,0,2*Math.PI),y.fill(),u[n.Values[T].d]=n.Values[T][D],k=T,E=D));k!=null&&(u[0]=n.Values[k][E]),m.Bars[i+1]=u}function Do(e,t,a,i,l,s){var n=te.computeSAR(B.QuoteTab,e.param1,e.param2),u={},m=R[0],y,x,T,M,A,D,k,E,Y;if(m.Bars[i+1]={},n.Values=ht(n.Values),y=n.Values.length,!(y<5)){for(x=m.ctx,E=0,D=1;D<3;D++)if(k="v"+D,!e[k])for(x.fillStyle=D==1?e.color:e.color2,M=5;M<y;M++)n.Values[M]!=null&&(T=Math.round(M*m.PxPointX+t),n.Values[M][k]!=0&&(x.beginPath(),A=xe(n.Values[M][k],s),x.arc(T,A,2,0,2*Math.PI),x.fill(),u[n.Values[M].d]=n.Values[M][k],M>E&&(E=M,Y=k)));E>0&&(u[0]=n.Values[E][Y]),m.Bars[i+1]=u}}function Io(e,t,a,i,l,s){var n=document.createElementNS("http://www.w3.org/2000/svg","svg"),u,m;n.setAttribute("class","svginfofi"),n.setAttribute("width","22"),n.setAttribute("height","22"),n.setAttribute("data-id",l),n.setAttribute("data-seq",s),u=document.createElementNS("http://www.w3.org/2000/svg","circle"),u.setAttributeNS(null,"cx",11),u.setAttributeNS(null,"cy",11),u.setAttributeNS(null,"r",11),u.setAttributeNS(null,"fill",a),n.appendChild(u),m=document.createElementNS("http://www.w3.org/2000/svg","text"),m.setAttributeNS(null,"x",7),m.setAttributeNS(null,"y",15),m.textContent=i,n.appendChild(m),n.style.top=t+"px",n.style.left=e-10+"px",O.doc.appendChild(n)}function Nr(e,t,a){var i,l,s,n,u,m,y,x,T,M,A,D,k,E,Y;if(o.clrem(["svginfofi"]),J.fiEvt!="no"){if(J.fiEvt.length==0){J.fiEvt="no";return}i=[],n=R[0],n.Bars[a+1]=[];var F=B.QuoteTab[U.minX].d,q=B.QuoteTab[B.QuoteTab.length-1].d,Q=J.fiEvt.length,ce;for(l=0;l<Q;l++){if(ce=B.QuoteTab[s],J.fiEvt[l].d>F&&J.fiEvt[l].d<=q){if(n.Bars[0][J.fiEvt[l].d]!=null)i[n.Bars[0][J.fiEvt[l].d].i]={i:l,data:J.fiEvt[l]};else for(s=U.minX;s<=U.maxX;s++)if(ce!=null&&ce.d>=J.fiEvt[l].d&&n.Bars[0][ce.d]!=null){i[n.Bars[0][ce.d].i]={i:l,data:J.fiEvt[l]};break}}J.fiEvt[l].d>F&&J.fiEvt[l].d>q&&n.Bars[0][q]!=null&&(u=J.fiEvt[l].d-B.QuoteTab[B.QuoteTab.length-1].d,u=d.chartPeriod!=0?Math.round(u/d.chartPeriod):Math.round(u*5/7),m=n.Bars[0][q].i+u,m<=U.maxX-u+2&&(i[m]={i:l,data:J.fiEvt[l]}))}for(T=i.length,A={},l=0;l<d.newsConfig.length;l++)A[d.newsConfig[l]]=!0;if(T!=null){for(l=1;l<T;l++)if(i[l]!=null)for(y=Math.round(l*n.PxPointX+e),x=n.HeightPx-10,D=i[l].data.tabEvents.length,M=0;M<D&&(k=i[l].data.tabEvents[M].evt,!(A[k]&&(E=i[l].i,Y=M,y<d.widthGraph-d.paddingRight&&y>d.paddingLeft&&Io(y,x,i[l].data.tabEvents[M].c,i[l].data.tabEvents[M].evt,E,Y),x=x-22,M>=5)));M++);}[].forEach.call(o.qsa(".svginfofi"),function(de){de.addEventListener("mouseenter",Ao)})}}function Ao(){var e=this.getAttribute("data-id"),t=this.getAttribute("data-seq"),a=J.fiEvt[e].tabEvents[t],i=parseInt(this.style.left.replace("px","")),l=parseInt(this.style.top.replace("px","")),s=o.gi(ge("eod_infofi-")),n,u,m,y;s==null&&(s=document.createElement("div"),s.id=ge("eod_infofi-"),O.doc.appendChild(s)),s.setAttribute("class","eod_infofi"),n="",n=d.chartPeriod<0?I(J.fiEvt[e].d):Z(J.fiEvt[e].d,1),u=a.u!=null&&a.u!=""?'<a href="'+a.u+'" target = "_blank" > '+a.s+"</a>":a.s,u+="</br>"+n,s.innerHTML=u,s.style.display="block",m=s.clientWidth,y=s.clientHeight,i=i>m+20?i-(m+2):i+22,s.style.top=l-Math.round(y/2)+"px",s.style.left=i+"px",s.addEventListener("mouseleave",Yr)}function Yr(){o.clhide("eod_infofi")}function Ho(e,t){var a=(e-t)/100;t=t-a,t<=0&&(t=(t+a)*.98);var i=Math.log10(t)/Math.log10(10),l=Math.log10(e+4*a)/Math.log10(10),s=l-i;return{floor:i,ceil:l,range:s}}function Nt(e,t){var a,i=e.length-t;for(i<0&&(i=0),a=i;a>=0;a--)if(e[a]!=null)return e[a]}function Ba(e,t,a,i,l){if(a[0].vm!=null){var s=i-1,n,u=a.length,m=t.V0,y;for(t.Indicator.type=="volume"&&(m=t.HeightPx),e.strokeStyle=t.Indicator.mmColor,e.beginPath(),e.moveTo(i,m-Math.round(a[0].vm*t.PxPointY)),y=1;y<u;y++)a[y]!=null&&(n=Math.round(y*l+i),n-s>=2&&(e.lineTo(n,m-Math.round(a[y].vm*t.PxPointY)),s=n));e.stroke()}}function Yt(e){var t,a,i,l,s,n;return e.indexOf("#")!=-1?(t=e.substring(1),t.length==3&&(t=t+t)):t=K(e).substring(1),a=parseInt(t,16),i=a>>16&255,l=a>>8&255,s=a>>0&255,n=.2126*i+.7152*l+.0722*s,n>130?"#000":"#fff"}function Ga(){var e,t,a,i,l;for(o.idempty(ge("")),t=R.length,Ie={},e=0;e<t;e++)R[e].Bars=e==0?[]:{},delete R[e].canvas,delete R[e].ctx;for(dt(),U.maxY=B.High,U.minY=B.Low,vt("rodgraph",O.doc),O.ctxback=o.gi(ge("rodgraph-")).getContext("2d"),ca(),VGP.chartSimple||(vt("topinfo",O.doc),vt("mainci",O.doc)),a=c(R,!0),R=[],i=new yt(0,1,d.mainChart.type,"main",0),i.Create(),l=a.length,e=0;e<l;e++)R.push(a[e]);R[0].DrawEncadre(),VGP.chartSimple||(vt("overlay",O.doc),vt("trace",O.doc),o.qstxt(ge("#eod_topinfo-")+" span",B.Name)),Gt(),fa(!0),Et(),ee()}function fa(e){var t,a=d,i=a.mainChart.typedef,l=i.param1,s="",n=R[0],u,m,y,x,T,M,A,D,k,E,Y,F,q,Q,ce,de,_e,Me,Ye,Qe,Oe,Xe,we,qe;switch(Ie={},u="c",i.source!=null&&(u=i.source),a.mainChart.type){case"renko":if(l==null&&(l=+((B.High-B.Low)/20).toFixed(2)),s=l,t=to(B,l,u),!t)return;(t.QuoteTab.length>700||t.QuoteTab.length<5)&&(l=+((B.High-B.Low)/20).toFixed(2),t=to(B,l,u));break;case"line break":(l>5||l<1||l==null)&&(l=2),s=l,t=xl(B,l,u);break;case"kagi":l==null&&(l=+((B.High-B.Low)/30).toFixed(2)),t=yl(B,l,u),s=l;break;case"equivolume":t=B;break;case"point figure":l==null&&(l=((B.High-B.Low)/50).toFixed(2)),m=i.param2,m==null&&(m=3),t=_l(B,l,m,u),s=l+", "+m}if(VGP.chartSimple||o.idhtml(ge("eod_mainchartinfos-"),'<div><span class="eod_param" data-name="'+a.mainChart.type+'"><span class="mci-p"></span> '+a.mainChart.type.toUpperCase()+" ("+s+")</span></div>"),y={Name:t.Name,High:t.High,Low:t.Low,QuoteTab:t.QuoteTab},y.QuoteTab!=null&&y.QuoteTab.length!=0){U.maxNL=y.QuoteTab.length,(U.maxX==0&&U.minX==0||e)&&(U.maxX=y.QuoteTab.length-1,U.minX=0),y.QuoteTab=ht(t.QuoteTab);var Pe=y.High,pe=y.Low,ve,Le=y.QuoteTab.length;U.maxY==0&&U.minY==0?(U.maxY=Pe,U.minY=pe):(Pe=U.maxY,pe=U.minY),n.PxPointY=(n.HeightPx-57)/(Pe-pe),n.V0=Pe+37/n.PxPointY;var be=n.V0,Ve=n.PxPointY,ne=n.ctx;if(Le!=0){switch(x=Math.floor(a.innerWidth/Le)-1,x%2==0&&x++,a.padBarCandle=x,T=a.paddingLeft+a.padBarCandle,Tt(ne,n.HeightPx,T,be,Ve),D=(a.innerWidth-2*a.padBarCandle)/(Le-1),n.PxPointX=D,a.mainChart.type=="equivolume"?(y=wl(y,a.innerWidth-5),wt(n,!0,y.QuoteTab,!0)):wt(n,!0,y.QuoteTab),ze=[],n.Bars[0]={},k={},ne.save(),a.mainChart.type){case"equivolume":for(M=a.paddingLeft,ve=0;ve<Le;ve++)if(E=y.QuoteTab[ve],E!=null){for(F=Math.round((be-E.l)*Ve),q=Math.round((be-E.h)*Ve),Q=Math.round((be-E.c)*Ve),ce=Math.round((be-E.o)*Ve),E.s?(ne.fillStyle=X(K(i.color),.4),ne.strokeStyle=i.color):(ne.fillStyle=X(K(i.color2),.4),ne.strokeStyle=i.color2),(i.v1||!E.s)&&(i.v2||E.s)||(ne.beginPath(),ne.rect(M+.5,q+.5,E.w,F-q),ne.stroke(),ne.fill()),ne.fillStyle=E.s?X(K(i.color),.8):X(K(i.color2),.8),(i.v1||!E.s)&&(i.v2||E.s)||(ne.beginPath(),ne.rect(M+.5,Math.max(Q,ce),E.w,-Math.abs(Q-ce)),ne.fill()),k[E.d]={c:E.c.toFixed(2),i:ve},Y=ve,ze[Math.floor(M+E.w/2)]={d:E.d,i:ve},A=M;A<=M+E.w;A++)Ie[A]=E.d;M+=E.w}E=y.QuoteTab[Y],k[0]={c:E.c.toFixed(2),i:Y,d:E.d};break;case"point figure":for(de=Math.floor(x/2),Me=Math.round(D),Ye=l*Ve,ve=0;ve<Le;ve++)if(E=y.QuoteTab[ve],E!=null){if(_e=Math.round((be-E.c)*Ve),M=Math.round(ve*D+T)-de,E.f){for(ne.strokeStyle=i.color,ne.beginPath(),A=0;A<E.n;A++)_e=_e+Ye,i.v1||(ne.moveTo(M,_e),ne.lineTo(M+Me,_e-Ye),ne.moveTo(M+Me,_e),ne.lineTo(M,_e-Ye));ne.stroke()}else for(ne.strokeStyle=i.color2,A=0;A<E.n;A++)_e=_e-Ye,i.v2||(ne.save(),ne.beginPath(),ne.translate(M,_e),ne.scale(Me/2,Ye/2),ne.arc(1,1,1,0,2*Math.PI,!1),ne.restore(),ne.stroke());for(k[E.d]={c:E.c.toFixed(2),i:ve},Y=ve,ze[Math.floor(M+de)-a.paddingLeft]={d:E.d,i:ve},A=0;A<=Me;A++)Ie[M+A]=E.d}Y!=null&&(E=y.QuoteTab[Y],k[0]={c:E.c.toFixed(2),i:Y,d:E.d});break;case"renko":case"line break":if(ne.strokeStyle=i.color3,de=Math.floor(x/2),!i.v1){for(ne.beginPath(),ne.fillStyle=i.color,ve=0;ve<Le;ve++)if(E=y.QuoteTab[ve],E!=null)for(M=Math.round(ve*D+T)-de,E.s==1&&(F=Math.round((be-E.l)*Ve),q=Math.round((be-E.h)*Ve),ne.rect(M+.5,q+.5,Math.round(D),F-q)),k[E.d]={c:E.c.toFixed(2),i:ve},Y=ve,ze[Math.floor(M+de)-a.paddingLeft]={d:E.d,i:ve},A=-de;A<=de;A++)Ie[M+A]=E.d;E=y.QuoteTab[Y],k[0]={c:E.c.toFixed(2),i:Y,d:E.d},i.v3&&(ne.strokeStyle=i.color),ne.stroke(),ne.fill()}if(!i.v2){for(ne.beginPath(),ne.fillStyle=i.color2,ve=0;ve<Le;ve++)E=y.QuoteTab[ve],E!=null&&(M=Math.round(ve*D+T)-de,E.s==0&&(F=Math.round((be-E.l)*Ve),q=Math.round((be-E.h)*Ve),ne.rect(M+.5,q+.5,Math.round(D),F-q)));i.v3&&(ne.strokeStyle=i.color2),ne.stroke(),ne.fill()}break;case"kagi":for(ne.lineWidth=3,ve=0;ve<Le;ve++)if(E=y.QuoteTab[ve],E!=null)for(qe=Math.round(ve*D+T)-x+.5,M=Math.round((ve+1)*D+T)-x+.5,Qe=Math.round((be-E.l1)*Ve)+.5,Oe=Math.round((be-E.h1)*Ve)+.5,Xe=Math.round((be-E.l2)*Ve)+.5,we=Math.round((be-E.h2)*Ve)+.5,E.l1!=null&&E.l2!=null&&(E.s==1?(i.v2||(ne.beginPath(),ne.strokeStyle=i.color2,ne.moveTo(qe,Xe),ne.lineTo(M,Xe),ne.lineTo(M,we-1),ne.stroke()),i.v1||(ne.beginPath(),ne.strokeStyle=i.color,ne.moveTo(M,Qe),ne.lineTo(M,Oe-1.5),ne.stroke())):(i.v1||(ne.beginPath(),ne.strokeStyle=i.color,ne.moveTo(qe,Oe),ne.lineTo(M,Oe),ne.lineTo(M,Qe+1),ne.stroke()),i.v2||(ne.beginPath(),ne.strokeStyle=i.color2,ne.moveTo(M,we),ne.lineTo(M,Xe+1.5),ne.stroke()))),E.l2==null&&(i.v1||(ne.beginPath(),ne.strokeStyle=i.color,E.s==1?(ne.moveTo(qe,Qe),ne.lineTo(M,Qe),ne.lineTo(M,Oe-1.5)):(ne.moveTo(qe,Oe),ne.lineTo(M,Oe),ne.lineTo(M,Qe+1.5)),ne.stroke())),E.l1==null&&(i.v2||(ne.beginPath(),ne.strokeStyle=i.color2,E.s==1?(ne.moveTo(qe,Xe),ne.lineTo(M,Xe),ne.lineTo(M,we-1.5)):(ne.moveTo(qe,we),ne.lineTo(M,we),ne.lineTo(M,Xe+1.5)),ne.stroke())),k[E.d]={c:E.c.toFixed(2),i:ve},Y=ve,ze[Math.floor(M-.5)-a.paddingLeft]={d:E.d,i:ve},A=qe-.5;A<=M-.5;A++)Ie[A]=E.d;E=y.QuoteTab[Y],k[0]={c:E.c.toFixed(2),i:Y,d:E.d}}ne.restore(),n.Bars[0]=k,Le!=0&&k[0]!=null&&a.mainChart.type!="point figure"&&(a.set.nohighlow||(pt(ne,be,y.High,Ve,"rgba(0, 128, 0, 1)",!0),pt(ne,be,y.Low,Ve,"rgba(192, 0, 0, 1)",!0)),a.set.nosticky||pt(ne,be,k[0].c,Ve,null,!0))}}}function Lt(e,t,a,i,l,s,n){var u=xe(a.l,n),m=xe(a.h,n),y=xe(a.o,n),x=xe(a.c,n),T;e.rect(i+.5,x+.5,t-1,y-x),T=i+.5+l,d.mainChart.typedef.v3||(e.moveTo(T,m),e.lineTo(T,x),e.moveTo(T,y),e.lineTo(T,u)),ze[Math.floor(T)-d.paddingLeft]={d:a.d,i:s}}function Bo(){for(var e=B.QuoteTab.length,t=[],a={d0:B.QuoteTab[0].d,c:U.qv.c},i=1;i<e;i++)B.QuoteTab[i].d-B.QuoteTab[i-1].d>480&&(a.d=B.QuoteTab[i-1].d,t.push(a),a={d0:B.QuoteTab[i].d,c:B.QuoteTab[i-1].c});return a.d=B.QuoteTab[e-1].d,t.push(a),t}function Xt(e,t,a){var i;if(!(d.histoLength>20)){var l,s=Bo(),n=s.length,u=e.ctx,m,y,x,T;for(u.save(),i=d.set.splitColor,y=d.widthGraph-d.paddingRight,l=n-1;l>=0;l--)T=xe(s[l].c,a),R[0].Bars[0][s[l].d0]!=null?(m=R[0].Bars[0][s[l].d0].i,x=Math.round(m*R[0].PxPointX)+.5+d.paddingLeft+d.padBarCandle):x=0,R[0].Bars[0][s[l].d]!=null?(m=R[0].Bars[0][s[l].d].i,y=Math.round(m*R[0].PxPointX)+.5+d.paddingLeft+d.padBarCandle):y=0,y<x&&(y=d.widthGraph-d.paddingRight),y==0&&(y=d.paddingLeft),x==0&&(x=d.paddingLeft),n==1&&y==0&&x==0&&(y=d.widthGraph-d.paddingRight,x=d.paddingLeft),!d.set.noVeilleIntra&&t&&(u.strokeStyle=d.set.veilleColor,u.lineWidth=d.set.veilleWidth||1,d.set.veilleStyle?He(u,0):He(u,3),u.beginPath(),u.moveTo(y,T+.5),u.lineTo(x,T+.5),u.stroke()),d.set.splitStyle!="none"&&n>1&&(d.set.splitStyle=="band"?l%2==0&&(u.fillStyle=le(i)==1?X(K(i),.2):i,u.fillRect(x,0,y-x,e.HeightPx)):x!=d.paddingLeft&&(u.strokeStyle=K(i),He(u,2),u.beginPath(),u.moveTo(x,0),u.lineTo(x,e.HeightPx),u.stroke()));u.restore()}}function Oa(e,t,a,i,l){var s=document.createElement("div"),n,u,m;for(s.setAttribute("class","infoindic"),s.style.left=a+"px",s.style.top=i+"px",l!=null&&(s.style.width=l+"px"),s.id="infoindic-"+e,d.set.fontSize!=11&&(s.style.fontSize=d.set.fontSize+"px"),m=["closelayericon","indicname","eodupdown"],VGP.chartSimple&&(m=["indicname"]),n=0;n<m.length;n++)u=document.createElement("span"),u.setAttribute("class",m[n]),d.set.txtColor!="#606060"&&(u.style.color=d.set.txtColor),m[n]=="indicname"&&(u.textContent=t),s.appendChild(u);return s}function Go(e){var t=d,a=new yt(0,e[0].Height,t.mainChart.type,ge("main-"),0),i,l,s,n,u;for(a.Create(),a.DrawEncadre(),i=e.length,l=1;l<i;l++)s=new yt(e[l].Y,e[l].Height,e[l].Indicator,ge("indic-")+l,t.marginInter*l),s.Create(),s.DrawEncadre(),u=Math.round(e[l].Y*t.usableHeight)+t.paddingTop+t.marginInter*l+5,n=Oa(O.callID+l,e[l].Indicator.type,t.paddingLeft+5,u,t.innerWidth-7),O.doc.appendChild(n),i>2&&(l==i-1?Vt(l,!0):Vt(l,!1))}function We(){va(),qr();var e=document.querySelector(".linemodif");e!=null&&(document.removeEventListener("keydown",Ur),document.removeEventListener("keydown",Fr),e.getAttribute("cid")==O.callID&&(je(),o.gi(ge("trace-")).removeEventListener("touchend",Rt),o.gi(ge("trace-")).removeEventListener("mousedown",Rt),o.clrem(["linemodif","resizehandler"]),ee(),d.chartPeriod>=0&&J.flagSave&&!VGP.noAutoSaveTrace&&qa())),J.flagSave=!1}function qa(e){var t,a;if(!L())return!1;if(t=localStorage.getItem(d.symbol),t=="[]"||t==null)return Ha(),delete VGP.drawings[d.symbol],!1;if(e)return t;a=new XMLHttpRequest,a.open("POST",VGP.urlWS+"TraceSaveSymbol",!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.send(JSON.stringify({userid:VGP.userID,symbol:d.symbol,content:t}))}function Xr(){var e=d.heightGraph-d.paddingBottom-d.paddingTop,t=R.length,a,i,l,s,n,u,m,y;for(t>1&&(e=e-d.marginInter*(R.length-1)),d.usableHeight=e,s=[0,.25,.2,.1666,.15,.13,.12],n=[1,.75,.6,.5002,.4,.35,.28],i=s[t-1],u=n[t-1],a=u,R[0].Resize(0,u,0),l=1;l<t;l++)m=Math.round(a*d.usableHeight)+d.paddingTop+d.marginInter*l+5,R[l].Resize(a,i,l*d.marginInter),o.idcss(ge("infoindic-")+l,"top",m+"px"),a=a+i,t>2&&(l==t-1?Vt(l,!0):Vt(l,!1));y=o.gi(ge("trace-")),y.height=R[0].HeightPx}function Vt(e,t){var a;a=t?'<span class="eodmoveup"/></span>':e>1?'<span class="eodmoveup" /></span><span class="eodmovedown" /></span>':'<span class="eodmovedown" /></span>',o.qshtml(ge("#infoindic-")+e+" .eodupdown",a)}function Oo(e){var t=R.length,a=new yt(0,0,e,ge("indic-")+t),i,l,s,n;a.Create(),i=o.gi(ge("overlay-")),i.parentNode.insertBefore(o.gi(ge("indic-")+t),i),l=Oa(O.callID+t,e.type,d.paddingLeft+5,R[t].RealY+5),t>1&&(s=l.querySelector(".eodupdown"),s!=null&&(n=document.createElement("span"),n.setAttribute("class","eodmoveup"),s.appendChild(n))),O.doc.appendChild(l),Xr(),Ee()}function Qt(e){var t,a,i,l;for(o.idrem(ge("indic-")+e),o.idrem(ge("infoindic-")+e),t=[],t[0]=R[0],a=1,l=R.length,i=1;i<l;i++)i!=e&&(t[a]=R[i],o.gi(ge("indic-")+i).setAttribute("id",ge("indic-")+a),o.gi(ge("infoindic-")+i).setAttribute("id",ge("infoindic-")+a),o.qsaempty(ge("#infoindic-")+a+" .eodupdown"),a++);R=t,Xr(),Ee()}function Ce(e,t,a,i,l,s,n,u,m,y,x,T,M){this.x0=e,this.y0=t,this.x1=a,this.y1=i,this.color=l,this.type=y,this.width=u!=null?u:1,this.style=m!=null?m:1,M!=null&&(this.fontSize=M),x!=null&&(this.h=x),T!=null&&(this.color2=T),d.set.semilog&&d.logData!=null&&t!=0&&i!=2e4?(this.RealY0=xe(t,d.logData),this.RealY1=xe(i,d.logData)):(this.RealY0=Math.round((R[0].V0-t)*R[0].PxPointY),this.RealY1=Math.round((R[0].V0-i)*R[0].PxPointY)),e==0&&a==0?(this.RealX0=0,this.RealX1=d.widthGraph-d.paddingRight):a==0?(this.RealX1=d.widthGraph-d.paddingRight,this.RealX0=s):(this.RealX0=s,this.RealX1=n)}function yt(e,t,a,i,l){this.Y=e,this.RealY=Math.round(e*d.usableHeight)+d.paddingTop+l,this.Height=t,this.HeightPx=Math.round(t*d.usableHeight),this.PxPointY=0,this.PxPointX=0,this.V0=0,this.id=i,this.Indicator=a,this.Bars=[]}function dt(){var e,t;O.doc!=null&&(O.doc.removeEventListener("mousewheel",Kt),O.doc.removeEventListener("DOMMouseScroll",Kt),O.doc.removeEventListener("mouseleave",ke),O.doc.removeEventListener("touchmove",nt),O.doc.removeEventListener("mousemove",nt),O.doc.removeEventListener("mouseup",St),O.doc.removeEventListener("mousedown",se),O.doc.removeEventListener("touchstart",se),O.doc.removeEventListener("touchend",St),e=o.gi("indicList"),e&&(e.removeEventListener("mousedown",lt),e.removeEventListener("touchstart",lt))),je(),t=o.gi(ge("trace-")),t&&(t.removeEventListener("touchend",Rt),t.removeEventListener("mousedown",Rt)),J.eventsActive=!1}function qo(e){o.gi("param1Automatic").addEventListener("change",function(){this.checked&&(d.mainChart.typedef["param"+e]=null,Ee(!1,!0),o.gi("mperiod"+e).value="")})}function Na(e,t,a){var i,l,s,n,u,m,y,x,T,M,A,D,k,E,Y,F,q,Q,ce,de,_e,Me,Ye;if(o.qsa(".params_zone").length==0){if(dt(),l=document.createElement("div"),l.id=ge("uParams-"),l.setAttribute("class","uParams"),l.style.height="100%",l.innerHTML='<div style="top:'+d.paddingTop+"px;left:"+d.paddingLeft+'px" class="params_zone"><div class="params_zone_in clearfix"><img class="closeparams" /></div><div class="params_content"></div></div>',O.doc.appendChild(l),a!=null&&(t=R[a].Indicator.type),s=j(t),a!=null?R[a].Indicator=r(s,R[a].Indicator):e!=null?d.mainChart.indicators[e]=r(s,d.mainChart.indicators[e]):d.mainChart.typedef=r(s,d.mainChart.typedef),s.params.p!=null)for(u=s.params.p.length,n=0;n<u;n++){if(m=10,m=a!=null?R[a].Indicator["param"+(n+1)]:e!=null?d.mainChart.indicators[e]["param"+(n+1)]:d.mainChart.typedef["param"+(n+1)],m==null&&(m=""),y=document.createElement("div"),y.setAttribute("class","clearfix pad5"),i='<div class="eod_pname">'+s.params.p[n]+'</div><input value="'+m+'" class="eod_inp" onkeypress="return isNumberLetterKey(event)" id="mperiod'+(n+1)+'" type="text" />',x=["renko","line break","kagi","point figure"],x.indexOf(t)<0){var Qe=2,Oe=100,Xe=1;switch(t){case"zig zag":Qe=.1,Oe=20,Xe=.1;break;case"sar":Qe=.02,Oe=.06,Xe=.01;break;case"evmm":n+1==2&&(Qe=.1,Oe=15,Xe=.1);break;case"boll":n+1==2&&(Qe=.1,Oe=10,Xe=.1);break;case"lineard":n+1==2&&(Qe=.1,Oe=10,Xe=.1)}y.innerHTML=i+'<div class="eod_slider"><div id="slider'+(n+1)+'" class="sliderout" min="'+Qe+'" max="'+Oe+'" step="'+Xe+'" value="'+m+'"></div></div>',o.qs(".params_content").appendChild(y),Qo(n+1,e,a)}else t=="point figure"&&n==1?(y.innerHTML=i+"</div>",o.qs(".params_content").appendChild(y)):(y.innerHTML=i+'<input id="param1Automatic" type="checkbox"><span>'+lang.l_automatic+"</span>",o.qs(".params_content").appendChild(y),m==""&&(o.gi("param1Automatic").checked=!0),qo(n+1));No(n+1,e,t,a)}if(s.params.c!=null){for(T=s.params.c.length,n=0;n<T;n++){if(M="",s.params.w!=null){switch(s.params.w[n]){case"sw":M='<div id="w'+(n+1)+'" class="widthSelect w1"></div><div id="s'+(n+1)+'" class="styleSelect s2"></div>';break;case"s":M='<div id="s'+(n+1)+'" class="styleSelect s2">';break;case"w":M='<div id="w'+(n+1)+'" class="widthSelect w1">';break;case"o":M='<div id="o'+(n+1)+'" class="opSelect">'}M=M+"</div>"}A="",D=!1,a!=null?R[a].Indicator["v"+(n+1)]&&(D=!0):e!=null?d.mainChart.indicators[e]["v"+(n+1)]&&(D=!0):d.mainChart.typedef["v"+(n+1)]&&(D=!0),D||(A='checked="true"'),i='<input class="eod_cbv" id="v'+(n+1)+'" type="checkbox" '+A+' /><div class="eod_cname">'+s.params.c[n]+'</div><input id="color'+(n+1)+'" type="text" />'+M,k=document.createElement("div"),k.setAttribute("class","clearfix pad5"),k.innerHTML=i,o.qs(".params_content").appendChild(k),Y=n+1==1?"color":"color"+(n+1),E=a!=null?K(R[a].Indicator[Y]):e!=null?K(d.mainChart.indicators[e][Y]):K(d.mainChart.typedef[Y]),Xo(n+1,e,a,E,s.type)}Yo(e,t,a)}if(a!=null){if(j(R[a].Indicator.type).sb!=null){var we='<option value="1">'+lang.l_zone+'</option><option value="2">'+lang.l_traitfi+'</option><option value="3">'+lang.l_traitep+"</option>",qe='<input id="cbSeuilH" checked="checked" type="checkbox" /><div class="eod_cname">'+lang.l_upperb+'</div><input id="valSeuilH" type="text" onkeypress="return isNumberLetterKey(event)" /><select id="stylSeuilH">'+we+"</select>",Pe='<input id="cbSeuilB" checked="checked" type="checkbox" /><div class="eod_cname">'+lang.l_lowerb+'</div><input id="valSeuilB" type="text" onkeypress="return isNumberLetterKey(event)" /><select id="stylSeuilB">'+we+"</select>",pe=document.createElement("div");pe.setAttribute("class","clearfix pad5"),pe.innerHTML=qe,F=document.createElement("div"),F.setAttribute("class","clearfix pad5"),F.innerHTML=Pe,q=o.qs(".params_content"),q.appendChild(pe),q.appendChild(F),R[a].Indicator.sh==null?o.gi("valSeuilH").value=j(R[a].Indicator.type).sh:R[a].Indicator.sh==9999?(o.gi("cbSeuilH").checked=!1,o.gi("valSeuilH").disabled=!0,o.gi("stylSeuilH").disabled=!0):(o.gi("valSeuilH").value=R[a].Indicator.sh,R[a].Indicator.shs!=null&&(o.gi("stylSeuilH").value=R[a].Indicator.shs)),R[a].Indicator.sb==null?o.gi("valSeuilB").value=j(R[a].Indicator.type).sb:R[a].Indicator.sb==9999?(o.gi("cbSeuilB").checked=!1,o.gi("valSeuilB").disabled=!0,o.gi("stylSeuilB").disabled=!0):(o.gi("valSeuilB").value=R[a].Indicator.sb,R[a].Indicator.sbs!=null&&(o.gi("stylSeuilB").value=R[a].Indicator.sbs)),o.gi("cbSeuilH").addEventListener("change",function(){var ve=o.gi("valSeuilH"),Le=o.gi("stylSeuilH"),be;this.checked?(be=j(R[a].Indicator.type).sh,be==9999&&(be=90),R[a].Indicator.sh=be,ve.disabled=!1,ve.value=be,Le.disabled=!1):(R[a].Indicator.sh=9999,ve.disabled=!0,Le.disabled=!0),Be(a)}),o.gi("cbSeuilB").addEventListener("change",function(){var ve=o.gi("valSeuilB"),Le=o.gi("stylSeuilB"),be;this.checked?(be=j(R[a].Indicator.type).sb,be==9999&&(be=10),R[a].Indicator.sb=be,ve.disabled=!1,ve.value=be,Le.disabled=!1):(R[a].Indicator.sb=9999,ve.disabled=!0,Le.disabled=!0),Be(a)}),o.gi("stylSeuilH").addEventListener("change",function(){R[a].Indicator.shs=this.value,Be(a)}),o.gi("stylSeuilB").addEventListener("change",function(){R[a].Indicator.sbs=this.value,Be(a)}),o.gi("valSeuilH").addEventListener("keyup",function(){R[a].Indicator.sh=parseInt(this.value.replace(",",".")),Be(a)}),o.gi("valSeuilB").addEventListener("keyup",function(){R[a].Indicator.sb=parseInt(this.value.replace(",",".")),Be(a)})}Q=["macd","macdzl","wto","dmi","adx","macdh","sto","aroon","qstick","ewo","ppo","moonphase","awesome","vortex","kst","kvo","bop","tsi","smi","sto rsi","equity","forceindex","tvi","rvi","mf"],Q.indexOf(R[a].Indicator.type)<0&&(ce=document.createElement("div"),ce.setAttribute("class","clearfix pad5"),ce.innerHTML='<input id="cbMM" type="checkbox" /><div class="eod_cname">'+lang.l_moymob+'</div><input id="colorMM" type="text" name="colorMM" value="#fe0000" /><input id="valMM" value="5" type="text" onkeypress="return isIntNumberKey(event)" />',o.qs(".params_content").appendChild(ce),de=new ColorPicker({wrapperEl:"#colorMM",value:"#fe0000",onChange:function(ve){R[a].Indicator.mmColor=ve,Be(a)}}),R[a].Indicator.mm!=null&&(o.gi("cbMM").checked=!0,o.gi("valMM").value=R[a].Indicator.mm,de.change(R[a].Indicator.mmColor)),o.gi("cbMM").addEventListener("change",function(){var ve=o.gi("valMM"),Le;if(this.checked){if(ve.disabled=!1,Le=parseInt(ve.value),isNaN(Le))return;R[a].Indicator.mm=Le,R[a].Indicator.mmColor=o.gi("colorMM").value}else delete R[a].Indicator.mm,delete R[a].Indicator.mmColor,ve.disabled=!0;Be(a)}),o.gi("valMM").addEventListener("keyup",function(){var ve=parseInt(this.value);isNaN(ve)||(R[a].Indicator.mm=ve,Be(a))}))}_e=["phpb","line","line2","renko","kagi","line break","mm","mme","mmp","mmh","cmoy","cmedian","double EMA","triple EMA","trix","bollw","bollb","boll","lineard","linearc","linearo","roc","kst","coppock","zig zag","mmt","evmm","rsi","mom","pvi","nvi","macd","macdh","std","sto rsi","point figure","ulcer"],_e.indexOf(s.type)>=0&&(Me=document.createElement("div"),Me.innerHTML=lang.l_datasource,o.qs(".params_content").appendChild(Me),s.source!=null&&o.qs("#datasource option[value='"+s.source+"']").setAttribute("selected","selected"),o.gi("datasource").addEventListener("change",function(){Pt(a,"source",this.value,e),a==null?Be(0):Be(a)})),(a!=null||e!=null)&&(Ye=document.createElement("div"),Ye.setAttribute("class","mtb10"),Ye.innerHTML='<span class="lnkmsg suppressMainIndic">'+lang.l_suppindic+"</span>",o.qs(".params_content").appendChild(Ye)),o.qs(".params_zone").style.display="block",Fo(e,a)}}function No(e,t,a,i){o.qs(".params_zone #mperiod"+e).addEventListener("keyup",function(){var l=this.value.trim().replace(",",".");if(l=parseFloat(l),!isNaN(l)&&l!=0){switch(e){case 1:a!="sar"&&a!="zig zag"&&a!="renko"&&a!="kagi"&&a!="point figure"&&(l=parseInt(l));break;case 2:a!="boll"&&a!="evmm"&&a!="lineard"&&(l=parseInt(l));break;default:l=parseInt(l)}Pt(i,"param"+e,l,t),i==null?Be(0,!0):Be(i)}})}function ga(e){for(var t="<ul>",a=1;a<5;a++)t=t+'<li class="'+e+a+'"></li>';return t+"</ul>"}function Pt(e,t,a,i){e==null?i==null?d.mainChart.typedef[t]=a:d.mainChart.indicators[i][t]=a:R[e].Indicator[t]=a}function Yo(e,t,a){function i(u){if(u.preventDefault(),this.innerHTML!=""){this.innerHTML="";return}o.qsarem(".widthSelect ul"),o.qsarem(".styleSelect ul");var m=this.id,y=parseInt(m.slice(-1)),x=document.createElement("div");x.setAttribute("class","opContent"),x.innerHTML='<div class="sliderout" id="sliderO" min="0" max="100" step="1">',this.appendChild(x),l(a,y,e)}function l(u,m,y){var x=m==1?"color":"color"+m;new Slider({wrapperEl:"#sliderO",value:50,onSlide:function(T){T=T/100;var M;M=u!=null?R[u].Indicator[x]:y!=null?d.mainChart.indicators[y][x]:d.mainChart.typedef[x],Pt(u,x,X(K(M),T),y),u==null?Be(0):Be(u)}})}function s(u){if(u.preventDefault(),u.target.nodeName=="LI"){var m=parseInt(u.target.className.slice(-1));Pt(a,this.id,m,e),this.innerHTML="",a==null?Be(0):Be(a);return}if(this.innerHTML!=""){this.innerHTML="";return}o.qsarem(".styleSelect ul"),o.qsarem(".widthSelect ul"),this.innerHTML=ga("w")}function n(u){if(u.preventDefault(),u.target.nodeName=="LI"){var m=parseInt(u.target.className.slice(-1));Pt(a,this.id,m,e),this.innerHTML="",a==null?Be(0):Be(a);return}if(this.innerHTML!=""){this.innerHTML="";return}o.qsarem(".styleSelect ul"),o.qsarem(".widthSelect ul"),this.innerHTML=ga("s")}[].forEach.call(o.qsa(".opSelect"),function(u){O.clickHandler.forEach(function(m){u.addEventListener(m,i)})}),[].forEach.call(o.qsa(".widthSelect"),function(u){O.clickHandler.forEach(function(m){u.addEventListener(m,s)})}),[].forEach.call(o.qsa(".styleSelect"),function(u){O.clickHandler.forEach(function(m){u.addEventListener(m,n)})}),[].forEach.call(o.qsa(".eod_cbv"),function(u){u.addEventListener("change",function(){var m=this.id,y=this.checked;a==null?(e==null?y?delete d.mainChart.typedef[m]:d.mainChart.typedef[m]=!0:y?delete d.mainChart.indicators[e][m]:d.mainChart.indicators[e][m]=!0,Be(0)):(y?delete R[a].Indicator[m]:R[a].Indicator[m]=!0,Be(a))})})}function Xo(e,t,a,i,l){var s=j(l);o.gi("color"+e)&&new ColorPicker({wrapperEl:"#color"+e,value:i,onChange:function(n){var u=e==1?"color":"color"+e,m=le(s[u]);m==null&&(m=1),n=X(n,m),Pt(a,u,n,t),a==null?Be(0):Be(a)}})}function Qo(e,t,a){var i=o.gi("mperiod"+e);new Slider({wrapperEl:"#slider"+e,onSlide:function(l){Math.round(l)-l!=0&&(l=l.toFixed(2)),i.value=l,Pt(a,"param"+e,+l,t),a==null?Be(0,!0):Be(a)}})}function va(){o.gi(ge("uParams-"))!=null&&(o.idrem(ge("uParams-")),ee())}function Fo(e,t){function a(s){s.preventDefault(),s.stopPropagation(),va()}function i(s){s.target.className=="uParams"&&va()}function l(s){var n,u,m,y;if(s.preventDefault(),t==null){if(n=d.mainChart.indicators[e].type,d.mainChart.indicators.splice(e,1),R[0].Bars.splice(parseInt(e)+1,1),n=="compare"){for(m=d.mainChart.indicators.length,y=0,u=0;u<m;u++)d.mainChart.indicators[u].type=="compare"&&y++;if(y==0)for(d.isCompare=!1,u=1;u<R.length;u++)R[u].Indicator.type=="fr"&&Qt(u)}d.newsConfig&&(J.fiEvt=[],o.clrem(["svginfofi"])),Be(0)}else Qt(t);va()}O.clickHandler.forEach(function(s){var n=o.qs(".closeparams");n&&n.addEventListener(s,a)}),O.clickHandler.forEach(function(s){o.gi(ge("uParams-")).addEventListener(s,i)}),O.clickHandler.forEach(function(s){var n=o.qs(".suppressMainIndic");n&&n.addEventListener(s,l)})}function Qr(e,t){var a=parseInt(t.parentNode.parentNode.id.slice(-1)),i=R[a],l,s,n,u;for(e=="up"?(l=R[a-1].Y,R[a]=R[a-1],R[a-1]=i,R[a-1].Y=l,R[a].Y=l+R[a-1].Height):(l=R[a].Y,R[a]=R[a+1],R[a+1]=i,R[a].Y=l,R[a+1].Y=l+R[a].Height),n=R.length,s=0;s<n;s++)R[s].Bars=s==0?[]:{},delete R[s].canvas,delete R[s].ctx;u=c(R),_t(!0),Bt(u),Ee(),ee()}function ot(e,t){return e>=0&&e<=d.innerWidth&&t>=0&&t<R[0].HeightPx+d.paddingTop-7}function $e(e,t,a,i){for(var l=document.createElement("div"),s=a.length,n=0;n<s;n++)l.setAttribute(a[n].n,a[n].v);i&&(l.id=i),l.setAttribute("class","resizehandler"),l.style.left=e+"px",l.style.top=t+"px",O.doc.appendChild(l)}function at(e){var t,a,i,l,s,n,u,m,y,x,T,M,A,D,k,E,Y,F,q,Q,ce,de,_e,Me,Ye,Qe,Oe,Xe,we,qe;if(We(),q=d,C(),Q=z[e],ce=document.createElement("div"),ce.setAttribute("cid",O.callID),ce.setAttribute("onmousedown","mydragg.startMoving(this,'trace-"+O.callID+"',event);"),ce.setAttribute("onmouseup","mydragg.stopMoving('trace-"+O.callID+"');"),ce.setAttribute("class","linemodif"),ce.setAttribute("name",e),ce.style.left=q.paddingLeft+4+"px",ce.style.top=q.paddingTop+4+"px",de='<div class="spg delLine" title="'+lang.l_supprimer+'"></div><input id="color1" type="text" name="color1" value="#000000" />',_e=["t","rf","r","m","fa","ef","c","arrdw","arrup","arrrt","arrlt","p","wf"],_e.indexOf(Q.type)>=0&&(t=Q.color2!=null?Q.color2:"#ffffff",de=de+'<span class="eod_sp10">&nbsp;</span><input id="color2" type="text" name="color2" value="'+t+'" />'),Q.type!="a"&&(de=de+'<div title="Epaisseur du trac\xE9" class="widthSelect w'+Q.width+'"></div>',Me=["rf","m","t","fa","arrup","arrdw","arrrt","arrlt","sm1","sm2","sm3"],Me.indexOf(Q.type)<0&&(de=de+'<div title="Style du trac\xE9" class="styleSelect s'+Q.style+'"></div>')),(Q.type=="v"||Q.type=="sr"||Q.type=="h")&&(de=de+'<div title="Taille du texte" class="fontSelect">'+(Q.fontSize&&Q.fontSize!=0?Q.fontSize:12)+"</div>",de=de+'<div class="fontSizeZone"><input type="checkbox" class="showtext" '+(Q.fontSize!=0?"checked":"")+"> L\xE9gende</div>"),Ye=["mv","mh","rf","ef","af","cf","wf","ff","an","m","ewi","ewc","ga"],Ye.indexOf(Q.type)>=0&&(de=de+'<div title="Taille du texte" class="fontSelect">'+(Q.fontSize!=0&&Q.fontSize!=null?Q.fontSize:12)+"</div>"),Q.type=="sr"&&(VGP.isSms&&(de=de+'<div class="spg eod_alert" title="'+lang.l_createalert+'"></div>'),de=de+'<input class="textSR" onkeypress="return isNumberKey(event)" id="srTxt" type="text" value="'+Q.y0.toFixed(2)+'" /><input class="btnSR" id="srBtn" type="button" value="ok" />'),Q.type=="a"&&(de=de+'<div class="fontSelect">'+(Q.fontSize!=null?Q.fontSize:12)+'</div><input autocomplete="off" id="annotationTxt" type="text"/>'),Qe=["fa","cf","mv","ewi","ewc","wf"],Qe.indexOf(Q.type)<0&&(de=de+'<div class="spg eod_copy" title="'+lang.l_dupliquer+'"></div>'),ce.innerHTML=de,O.doc.appendChild(ce),Q.type=="fa"){Y=q.paddingTop-9,F=q.paddingLeft-9,a=Q.RealX0+F,i=Q.RealY0+Y,l=Q.h.B.mx+F,s=Q.h.B.my+Y,u=Q.h.C.mx+F,n=Q.h.C.my+Y,ot(a,i)&&$e(a,i,[{n:"name",v:e},{n:"pt",v:"A"}],"handlerfaA"),ot(l,s)&&$e(l,s,[{n:"name",v:e},{n:"pt",v:"B"}],"handlerfaB"),ot(u,n)&&$e(u,n,[{n:"name",v:e},{n:"pt",v:"C"}],"handlerfaC"),Ct();return}if(Q.type=="ewi"||Q.type=="ewc"){for(Oe=0;Oe<Q.h.length;Oe++)a=Q.h[Oe].mx+q.paddingLeft-8,i=Q.h[Oe].my+q.paddingTop-8,ot(a,i)&&$e(a,i,[{n:"name",v:e},{n:"pt",v:Oe}],"handlerEW"+Oe);Ct();return}if(Q.type=="t"||Q.type=="wf"){Y=q.paddingTop-8,F=q.paddingLeft-8,a=Q.RealX0+F,i=Q.RealY0+Y,l=Q.RealX1+F,s=Q.RealY1+Y,u=Q.h.C.mx+F,n=Q.h.C.my+Y,Q.type=="wf"?(ot(a,i)&&$e(a,i,[{n:"name",v:e}],"handler2oblic"),ot(l,s)&&$e(l,s,[{n:"name",v:e},{n:"pt",v:"B"}],"handlerWFB"),ot(u,n)&&$e(u,n,[{n:"name",v:e},{n:"pt",v:"C"}],"handlerWFC")):(ot(a,i)&&$e(a,i,[{n:"name",v:e},{n:"pt",v:"A"}],"handlerTA"),ot(l,s)&&$e(l,s,[{n:"name",v:e},{n:"pt",v:"B"}],"handlerTB"),ot(u,n)&&$e(u,n,[{n:"name",v:e},{n:"pt",v:"C"}],"handlerTC"),Xe=(a+l+u)/3,we=(i+s+n)/3,ot(Xe,we)&&$e(Xe,we,[{n:"name",v:e}],"handler2oblic")),Ct();return}if(Q.type=="ef"&&$e(Q.RealX1+Q.h+q.paddingLeft-6,Q.RealY1+q.paddingTop-8,[{n:"name",v:e}],"handlerEF"),Q.type=="v"){$e(Q.RealX0+q.paddingLeft-10,Math.round(R[0].HeightPx/2),[{n:"name",v:e}],"handlerV"),Ct();return}if(Q.type=="sr"){$e(Q.RealX0+q.paddingLeft-15,Q.RealY0+q.paddingTop-9,[{n:"name",v:e}],"handlerSR"),Ct();return}if(Q.type=="c"){D=Q.RealX0+q.paddingLeft-6,k=Q.RealY0+q.paddingTop-10,E=Q.RealX1+q.paddingLeft-9,ot(D,k)&&$e(D,k,[{n:"name",v:e}],"handler2oblic"),ot(E,k)&&$e(E,k,[{n:"name",v:e}],"handlerEllipse"),Ct();return}Q.x0==0&&Q.x1==0?$e(Math.round(q.innerWidth/2),Q.RealY0+q.paddingTop-9,[{n:"name",v:e}],"handlerH"):(Y=q.paddingTop-9,F=q.paddingLeft-9,m=Q.RealX0+F,T=Q.RealY0+Y,y=Q.RealX1+F,M=Q.RealY1+Y,qe=["a","arrup","arrdw","arrrt","arrlt","sm1","sm2"],qe.indexOf(Q.type)<0&&(Q.type!="an"&&ot(m,T)&&$e(m,T,[{n:"name",v:e}],"handler0oblic"),ot(y,M)&&$e(y,M,[{n:"name",v:e}],"handler1oblic")),Q.type=="p"?(x=Math.round(Q.RealX0+(Q.RealX1-Q.RealX0)/2)+F,A=Math.round(Q.RealY1+(Q.RealY0-Q.RealY1)/2)+Y+Math.round(Q.h*R[0].PxPointY),ot(x,A)&&$e(x,A,[{n:"name",v:e}],"handlerPara")):(x=Math.round(Q.RealX0+(Q.RealX1-Q.RealX0)/2)+F,A=Math.round(Q.RealY1+(Q.RealY0-Q.RealY1)/2)+Y,ot(x,A)&&$e(x,A,[{n:"name",v:e}],"handler2oblic"))),Ct()}function Fr(e){e.target.id!="srTxt"&&e.target.id!="annotationTxt"&&(e.keyCode==46||e.keyCode==8)&&(e.preventDefault(),Ya())}function Ur(e){if(e.target.id!="srTxt"&&e.target.id!="annotationTxt")switch(e.keyCode){case 38:e.preventDefault(),ya(0,-1);break;case 40:e.preventDefault(),ya(0,1);break;case 37:e.preventDefault();var t=Math.floor(R[0].PxPointX)+1;ya(-t,0);break;case 39:e.preventDefault(),ya(1,0);break;case 46:case 8:e.preventDefault(),Ya()}}function Ya(){var e=o.qsga(".linemodif","name");z.splice(e,1),De(),Ne(d.symbol,z),J.flagSave=!0,We()}function ya(e,t){var a=o.qsga(".linemodif","name"),i=c(z[a]),l,s;(t!=0||i.type!="h")&&(e!=0||i.type!="v")&&(l=Ze(),z.splice(a,1),De(),s=Kr(l.ctx,i,e,t),$r(i,s))}function Ct(){function e(F,q){q==1?T.color=F:T.color2=F,De(),Ne(d.symbol,z)}function t(F){var q,Q;F.preventDefault(),q=parseFloat(o.gi("srTxt").value.replace(",",".")),q==0||isNaN(q)||(T.y0=q,T.y1=q,Q=d.set.semilog&&d.logData!=null?xe(q,d.logData):R[0].V0*R[0].PxPointY-q*R[0].PxPointY,T.RealY0=Q,T.RealY1=Q,o.gi("handlerSR").style.top=Q+d.paddingTop-6+"px",De(),Ne(d.symbol,z))}function a(F){F.preventDefault();var q=B.Name+";"+d.symbol+";"+T.y0.toFixed(3);sessionStorage.setItem("vartemp",q),J.flagSave=!0,We(),loadPopupHelp("graph_setalert6")}function i(F){var q,Q;F.preventDefault(),q=c(T),T.type=="v"?(Q=new Ae(q.RealX0+20,0),q.x0=Q.x,q.x1=Q.x):(q.y0=q.y0+20/R[0].PxPointY,q.y1=q.y1+20/R[0].PxPointY),z.push(q),We(),De(),Ne(d.symbol,z),at(z.length-1)}function l(){var F=o.gi("annotationTxt").value.trim();if(F=="")return!1;F=F.replace(/,/g,"."),T=f(F),De(),Ne(d.symbol,z),J.flagSave=!0,We()}function s(F){if(F.preventDefault(),F.target.nodeName=="LI"){var q=parseInt(F.target.className.slice(-1));T.width=q,De(),Ne(d.symbol,z),this.setAttribute("class","widthSelect w"+q),this.innerHTML="";return}if(this.innerHTML!=""){this.innerHTML="";return}o.qsarem(".styleSelect ul"),o.qsarem(".widthSelect ul"),this.innerHTML=ga("w")}function n(F){if(F.preventDefault(),F.target.nodeName=="LI"){var q=parseInt(F.target.className.slice(-1));T.style=q,De(),Ne(d.symbol,z),this.setAttribute("class","styleSelect s"+q),this.innerHTML="";return}if(this.innerHTML!=""){this.innerHTML="";return}o.qsarem(".styleSelect ul"),o.qsarem(".widthSelect ul"),this.innerHTML=ga("s")}function u(F){var q,Q,ce,de,_e,Me;if(F.preventDefault(),q=this.innerHTML,F.target.nodeName=="LI"){Q=parseInt(F.target.getAttribute("data-name")),T.fontSize=Q,De(),Ne(d.symbol,z),this.innerHTML=Q,ce=o.qs(".showtext"),ce&&(ce.checked=!0);return}if(this.innerHTML.length>2){this.innerHTML=q;return}for(o.qsarem(".styleSelect ul"),o.qsarem(".fontSelect ul"),de=[0,11,12,14,16,20,24,28,32,48],_e="<ul>",Me=1;Me<10;Me++)_e=_e+'<li data-name="'+de[Me]+'">'+de[Me]+"</li>";_e=_e+"</ul>",this.innerHTML=_e}function m(F){F.preventDefault(),Ya()}function y(F){var q=F.target.id,Q,ce=c(z[x]);switch(q){case"handlerfaA":case"handlerfaB":case"handlerfaC":Q=F.target.getAttribute("pt"),Uo(ce,Q);break;case"handlerEW0":case"handlerEW1":case"handlerEW2":case"handlerEW3":case"handlerEW4":case"handlerEW5":Q=F.target.getAttribute("pt"),jo(ce,Q);break;case"handlerTA":case"handlerTB":case"handlerTC":case"handlerWFB":case"handlerWFC":Q=F.target.getAttribute("pt"),Wo(ce,Q);break;case"handlerEF":rl(ce);break;case"handlerV":case"handlerSR":case"handlerH":$o(ce);break;case"handlerEllipse":nl(ce);break;case"handlerPara":ll(ce);break;case"handler0oblic":case"handler1oblic":var de=T.RealX1,_e=T.RealY1,Me=T.x1;q=="handler1oblic"&&(de=T.RealX0,_e=T.RealY0,Me=T.x0),T.type=="p"?il(T.color,de,_e,Me,T.width,T.style,T.h,T.color2):T.type=="rf"||T.type=="r"||T.type=="m"?tl(T,T.type,F.target.id):ol(ce,de,_e,Me);break;case"handler2oblic":var Ye=ie(F),Qe=Ze(),Oe=parseInt(Ye.y-Qe.offset.top),Xe=parseInt(Ye.x-Qe.offset.left);el(ce,Xe,Oe)}o.clhide("resizehandler"),z.splice(x,1)}var x=o.qsga(".linemodif","name"),T=z[x],M,A,D,k,E,Y;for(new ColorPicker({wrapperEl:"#color1",value:T.color,onChange:function(F){e(F,1)}}),o.gi("color2")!=null&&(M=new ColorPicker({wrapperEl:"#color2",onChange:function(F){e(F,2)}}),T.color2!=null&&M.change(T.color2)),dt(),A=o.gi(ge("overlay-")),D=A.getContext("2d"),D.clearRect(0,0,A.width,A.height),T.type=="sr"&&O.clickHandler.forEach(function(F){o.gi("srBtn").addEventListener(F,t)}),O.clickHandler.forEach(function(F){var q=o.qs(".eod_alert");q&&q.addEventListener(F,a)}),O.clickHandler.forEach(function(F){var q=o.qs(".eod_copy");q&&q.addEventListener(F,i)}),T.type=="a"&&(o.gi("annotationTxt").value=unescape(T.h),o.gi("annotationTxt").addEventListener("keyup",function(F){if(F.keyCode==13)return l(),!1;T.h=f(this.value),De()})),[].forEach.call(o.qsa(".widthSelect"),function(F){O.clickHandler.forEach(function(q){F.addEventListener(q,s)})}),[].forEach.call(o.qsa(".styleSelect"),function(F){O.clickHandler.forEach(function(q){F.addEventListener(q,n)})}),[].forEach.call(o.qsa(".fontSelect"),function(F){O.clickHandler.forEach(function(q){F.addEventListener(q,u)})}),[].forEach.call(o.qsa(".delLine"),function(F){O.clickHandler.forEach(function(q){F.addEventListener(q,m)})}),E=o.qs(".showtext"),E&&E.addEventListener("change",function(F){F.preventDefault(),T.fontSize=this.checked?o.qs(".fontSelect").textContent:0,De(),Ne(d.symbol,z)}),Y=o.qsa(".resizehandler"),k=0;k<Y.length;k++)["touchstart","mousedown"].forEach(function(F){Y[k].addEventListener(F,y)});o.gi("handler2oblic")!=null||z[x].type=="sr"||z[x].type=="v"||z[x].type=="h"?document.addEventListener("keydown",Ur):document.addEventListener("keydown",Fr),o.gi(ge("trace-")).addEventListener("touchend",Rt),o.gi(ge("trace-")).addEventListener("mousedown",Rt)}function Rt(e){J.flagSave=!0,e.preventDefault(),We()}function Ae(e,t){var a,i;for(this.mx=e,this.my=t,this.y=d.set.semilog&&d.logData!=null?Math.round(Da(t,d.logData)*1e4)/1e4:Math.round((R[0].V0*R[0].PxPointY-t)*1e4/R[0].PxPointY)/1e4,i=ze.length,a=e;a<i;a++)if(e<=a&&ze[a]!=null){this.x=ze[a].d,this.mx=a;break}if(e>i-1){var l=i-1,s=e-l,n=Math.round(s/R[0].PxPointX),u=Math.round(n*R[0].PxPointX)+l;if(B.Xperiod<0)n=-n*B.Xperiod;else switch(B.Xperiod){case 7:n=n*7;break;case 30:n=n*30;break;case 91:n=n*91;break;case 365:n=n*365;break;default:n=n*(7/5)}this.mx=u,this.x=ze[i-1].d+Math.round(n)}}function fe(e,t){J.evtList.push({ev:e,f:t})}function je(){for(var e=J.evtList.length,t=0;t<e;t++)O.doc.removeEventListener(J.evtList[t].ev,J.evtList[t].f);J.evtList=[]}function Uo(e,t){C("c"),w={c:Ze(),A:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},B:e.h.B,C:e.h.C,D:null,line:e,pt:t},["touchend","mouseup"].forEach(function(a){O.doc.addEventListener(a,Xa)}),["touchmove","mousemove"].forEach(function(a){O.doc.addEventListener(a,Qa)}),fe("mouseup",Xa),fe("mousemove",Qa),fe("touchend",Xa),fe("touchmove",Qa)}function Xa(e){e.preventDefault(),z.push(new Ce(w.A.x,w.A.y,w.D.x,w.D.y,w.line.color,w.A.mx,w.D.mx,w.line.width,null,"fa",{B:w.B,C:w.C},w.line.color2)),Ne(d.symbol,z),je(),at(z.length-1)}function Qa(e){var t;e.preventDefault();var a=ie(e),i=parseInt(a.x-w.c.offset.left),l=parseInt(a.y-w.c.offset.top),s=w.line,n;if(!(l<0)&&!(l>R[0].HeightPx)){switch(t=new Ae(i,l),De(),w.pt){case"A":n=It(w.c.ctx,t,w.B,w.C,s.color,s.color2,s.width),w.A=t;break;case"B":n=It(w.c.ctx,w.A,t,w.C,s.color,s.color2,s.width),w.B=t;break;case"C":n=It(w.c.ctx,w.A,w.B,t,s.color,s.color2,s.width),w.C=t}w.D=new Ae(n.Dx,n.Dy)}}function Wo(e,t){C("c"),e.type=="t"||e.type=="wf"&&t=="B"?w={line:e,pt:t,c:Ze(),A:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},B:{mx:e.RealX1,my:e.RealY1,x:e.x1,y:e.y1},C:e.h.C}:e.type=="wf"&&t=="C"&&(w={line:e,pt:t,c:Ze(),A:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},C:{mx:e.RealX1,my:e.RealY1,x:e.x1,y:e.y1},B:e.h.C}),["touchend","mouseup"].forEach(function(a){O.doc.addEventListener(a,Fa)}),["touchmove","mousemove"].forEach(function(a){O.doc.addEventListener(a,Ua)}),fe("mouseup",Fa),fe("mousemove",Ua),fe("touchend",Fa),fe("touchmove",Ua)}function Fa(e){e.preventDefault(),z.push(new Ce(w.A.x,w.A.y,w.B.x,w.B.y,w.line.color,w.A.mx,w.B.mx,w.line.width,null,w.line.type,{C:w.C},w.line.color2,w.line.fontSize)),Ne(d.symbol,z),je(),at(z.length-1)}function Ua(e){var t,a;e.preventDefault();var i=ie(e),l=parseInt(i.x-w.c.offset.left),s=parseInt(i.y-w.c.offset.top);if(!(s<0)&&!(s>R[0].HeightPx)){if(t=new Ae(l,s),De(),w.line.type=="wf")w.B=t;else switch(w.pt){case"A":w.A=t;break;case"B":w.B=t;break;case"C":w.C=t}w.line.type=="t"?$t(w.c.ctx,w.A,w.B,w.C,w.line.color,w.line.color2,w.line.width):w.line.type=="wf"&&(a=Ft(w.c.ctx,w.A,w.B,w.C,w.line.color,w.line.color2,w.line.width,w.line.fontSize),w.C=new Ae(a.mx,a.my))}}function jo(e,t){C("c"),w={line:e,pt:t,c:Ze()},["touchend","mouseup"].forEach(function(a){O.doc.addEventListener(a,Wa)}),["touchmove","mousemove"].forEach(function(a){O.doc.addEventListener(a,ja)}),fe("mouseup",Wa),fe("mousemove",ja),fe("touchend",Wa),fe("touchmove",ja)}function Wa(e){e.preventDefault();var t=w.line;z.push(new Ce(null,null,null,null,t.color,null,null,t.width,t.style,t.type,t.h,null,t.fontSize)),Ne(d.symbol,z),je(),at(z.length-1)}function ja(e){var t;e.preventDefault();var a=ie(e),i=parseInt(a.x-w.c.offset.left),l=parseInt(a.y-w.c.offset.top);l<0||l>R[0].HeightPx||(t=new Ae(i,l),De(),w.pt=parseInt(w.pt),w.line.h[w.pt]=t,Ma(w.c.ctx,w.line.h,w.line.color,w.line.width,w.line.style,w.line.fontSize))}function za(e,t){C("c"),w={c:Ze(),tabPoints:[],color:bt(),nbPoints:t,type:e},["touchstart","click"].forEach(function(a){O.doc.addEventListener(a,Ka)}),["touchmove","mousemove"].forEach(function(a){O.doc.addEventListener(a,Ja)}),fe("click",Ka),fe("mousemove",Ja),fe("touchstart",Ka),fe("touchmove",Ja)}function Ka(e){var t;e.preventDefault();var a=ie(e),i=parseInt(a.x-w.c.offset.left),l=parseInt(a.y-w.c.offset.top);if(!(l<0)&&!(l>R[0].HeightPx)){if(w.tabPoints.length<w.nbPoints-1){w.tabPoints.push(new Ae(i,l));return}switch(w.tabPoints.push(new Ae(i,l)),De(),w.type){case"t":$t(w.c.ctx,w.tabPoints[0],w.tabPoints[1],w.tabPoints[2],w.color),z.push(new Ce(w.tabPoints[0].x,w.tabPoints[0].y,w.tabPoints[1].x,w.tabPoints[1].y,w.color,w.tabPoints[0].mx,w.tabPoints[1].mx,null,null,w.type,{C:w.tabPoints[2]}));break;case"ewi":case"ewc":Ma(w.c.ctx,w.tabPoints,w.color),z.push(new Ce(null,null,null,null,w.color,null,null,null,null,w.type,w.tabPoints));break;case"wf":t=Ft(w.c.ctx,w.tabPoints[0],w.tabPoints[1],w.tabPoints[2],w.color,null,1),w.tabPoints[2]=new Ae(t.mx,t.my),z.push(new Ce(w.tabPoints[0].x,w.tabPoints[0].y,w.tabPoints[1].x,w.tabPoints[1].y,w.color,w.tabPoints[0].mx,w.tabPoints[1].mx,null,null,w.type,{C:w.tabPoints[2]}))}Ne(d.symbol,z),je(),at(z.length-1)}}function Ja(e){var t,a,i,l;if(e.preventDefault(),t=w.tabPoints,t.length!=0){var s=w.c.ctx,n=ie(e),u=parseInt(n.x-w.c.offset.left),m=parseInt(n.y-w.c.offset.top);if(!(m<0)&&!(m>R[0].HeightPx)){switch(De(),a=[],w.type){case"ewi":a=["1","2","3","4","5"];break;case"ewc":a=["a","b","c"]}if(w.type!="wf"){for(s.lineWidth=1,s.strokeStyle=w.color,s.beginPath(),s.moveTo(t[0].mx,t[0].my),l=1;l<t.length;l++)s.lineTo(t[l].mx,t[l].my),w.type!="t"&&(i=t[l].my<t[l-1].my?-7:16,s.fillText(a[l-1],t[l].mx-4,t[l].my+i));s.lineTo(u,m),s.stroke()}else t[1]==null?(s.beginPath(),s.moveTo(t[0].mx,t[0].my),s.lineTo(u,m),s.strokeStyle=w.color,s.stroke()):t[2]==null&&Ft(s,t[0],t[1],{mx:u,my:m},w.color,null,1);return}}}function Ft(e,t,a,i,l,s,n,u){var m,y;e.lineWidth=n,e.strokeStyle=l,e.beginPath(),e.moveTo(t.mx,t.my),e.lineTo(a.mx,a.my);var x=Math.atan2(t.my-a.my,a.mx-t.mx),T=Math.atan2(t.my-i.my,i.mx-t.mx),M=!1,A=!1,D=!1;Math.abs(x-T)>Math.PI&&(M=!0,A=!0),x<T&&(M=!0,D=!0),A&&D&&(M=!1),m=Math.sqrt(Math.pow(Math.abs(t.my-a.my),2)+Math.pow(Math.abs(t.mx-a.mx),2)),e.arc(t.mx,t.my,m*1.618,-x,-T,M),e.closePath(),s!=null&&(e.fillStyle=X(s,.15),e.fill()),e.stroke(),e.beginPath(),e.arc(t.mx,t.my,m,-x,-T,M),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,m*.786,-x,-T,M),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,m*.618,-x,-T,M),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,m*.5,-x,-T,M),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,m*.236,-x,-T,M),e.stroke(),y=(x+T)/2,e.fillStyle=l,e.font=(u!=null?u:12)+"px Arial",e.save(),e.translate(t.mx,t.my);var k=Math.PI/2-y,E=93*Math.PI/180,Y=-3;return k>E?(k=-y-Math.PI/2,Y=11):m=-m,(A&&!D||A&&D)&&(m=-m),e.rotate(k),e.fillText("1.618",-12,m*1.618+Y),e.fillText("1",-3,m+Y),e.fillText("0.786",-12,m*.786+Y),e.fillText("0.618",-12,m*.618+Y),e.fillText("0.5",-7,m*.5+Y),e.fillText("0.236",-12,m*.236+Y),e.restore(),{mx:Math.round(t.mx+Math.cos(T)*Math.abs(m)),my:Math.round(t.my-Math.sin(T)*Math.abs(m))}}function zo(){C("c"),w={c:Ze(),color:bt(),color2:"#4040ff"},["touchstart","click"].forEach(function(e){O.doc.addEventListener(e,Za)}),["touchmove","mousemove"].forEach(function(e){O.doc.addEventListener(e,$a)}),fe("click",Za),fe("mousemove",$a),fe("touchstart",Za),fe("touchmove",$a)}function Za(e){e.preventDefault();var t=ie(e),a=parseInt(t.x-w.c.offset.left),i=parseInt(t.y-w.c.offset.top);if(!(i<0)&&!(i>R[0].HeightPx)){if(w.A==null){w.A=new Ae(a,i);return}if(w.B==null){w.B=new Ae(a,i);return}w.C==null&&(w.C=new Ae(a,i),w.D=new Ae(w.D.Dx,w.D.Dy),z.push(new Ce(w.A.x,w.A.y,w.D.x,w.D.y,w.color,w.A.mx,w.D.mx,null,null,"fa",{B:w.B,C:w.C},w.color2)),Ne(d.symbol,z),je(),at(z.length-1))}}function $a(e){if(e.preventDefault(),w.A!=null){var t=w.c.ctx,a=ie(e),i=parseInt(a.x-w.c.offset.left),l=parseInt(a.y-w.c.offset.top);if(!(l<0)&&!(l>R[0].HeightPx)){if(w.B==null){De(),t.lineWidth=1,t.strokeStyle=bt(),t.beginPath(),t.moveTo(w.A.mx,w.A.my),t.lineTo(i,l),t.stroke();return}w.C==null&&(De(),w.D=It(t,w.A,w.B,{mx:i,my:l},w.color,w.color2))}}}function Ko(){w={c:Ze(),idLine:999},["touchstart","mousedown"].forEach(function(e){O.doc.addEventListener(e,er)}),O.doc.addEventListener("mousemove",Wr),fe("mousemove",Wr),fe("mousedown",er),fe("touchstart",er)}function Wr(e){var t=ie(e),a=parseInt(t.x-w.c.offset.left+d.paddingLeft),i=parseInt(t.y-w.c.offset.top+d.paddingTop);w.idLine=Ta(a,i,Va(a,i))}function er(e){e.preventDefault(),w.idLine!=999?(z.splice(w.idLine,1),De(),Ne(d.symbol,z),z.length==0&&tr()):tr()}function tr(){je(),ee()}function Jo(e){C("c"),w={c:Ze(),t:e},["touchstart","mousedown"].forEach(function(t){O.doc.addEventListener(t,ar)}),fe("mousedown",ar),fe("touchstart",ar)}function ar(e){var t,a;if(e.preventDefault(),o.qs(".linemodif")==null){var i=w.c.ctx,l=w.t,s=ie(e),n=parseInt(s.x-w.c.offset.left),u=parseInt(s.y-w.c.offset.top);if(!(u<0)&&!(u>R[0].HeightPx)){switch(t=new Ae(n,u),l){case"arrup":a="#008000",At(i,t,a,l,a,1);break;case"arrdw":a="#c00000",At(i,t,a,l,a,1);break;case"arrrt":case"arrlt":a="#3366ff",At(i,t,a,l,a,1);break;case"sm1":a="#008000",Zt(i,t,a,l,1);break;case"sm2":a="#c00000",Zt(i,t,a,l,1)}z.push(new Ce(t.x,t.y,t.x,t.y,a,t.mx,t.mx,1,null,l,null,a)),Ne(d.symbol,z),je(),at(z.length-1)}}}function Zo(){w={c:Ze(),color:bt()},C("c"),["touchstart","mousedown"].forEach(function(e){O.doc.addEventListener(e,rr)}),fe("touchstart",rr),fe("mousedown",rr)}function rr(e){function t(u){u.preventDefault(),jr(w.c.ctx,s,n,w.color)}var a,i;if(e.preventDefault(),o.qs(".linemodif")==null){var l=ie(e),s=parseInt(l.x-w.c.offset.left),n=parseInt(l.y-w.c.offset.top);n<0||n>R[0].HeightPx||(a=z.length,i=document.createElement("div"),i.setAttribute("cid",O.callID),i.setAttribute("onmousedown","mydragg.startMoving(this,'trace-"+O.callID+"',event);"),i.setAttribute("onmouseup","mydragg.stopMoving('trace-"+O.callID+"');"),i.setAttribute("class","linemodif"),i.setAttribute("name",a),i.style.left=d.paddingLeft+4+"px",i.style.top=d.paddingTop+4+"px",i.innerHTML='<input id="annotationTxt" type="text"/><input id="annotationBtn" class="btnSR" type="button" value="ok" />',O.doc.appendChild(i),o.gi("annotationTxt").focus(),dt(),o.gi("annotationTxt").addEventListener("keyup",function(u){u.preventDefault();var m=u.which?u.which:u.keyCode;m==13?(De(),jr(w.c.ctx,s,n,w.color)):(De(),ka(w.c.ctx,new Ae(s,n),"12",w.color,this.value))}),O.clickHandler.forEach(function(u){o.gi("annotationBtn").addEventListener(u,t)}))}}function jr(e,t,a,i){var l,s,n;if(t!=null||a!=null){if(l=o.gi("annotationTxt").value.trim(),l=l.replace(/,/g,"."),l=="")return o.clrem(["linemodif"]),ee(),!1;s=new Ae(t,a),n=ka(e,s,"12",i,l),z.push(new Ce(s.x,s.y,s.x,s.y,i,s.mx,n,null,"12","a",f(l))),Ne(d.symbol,z),o.clrem(["linemodif"]),at(z.length-1)}}function bt(){return d.set.traceColor==null?Yt(d.set.bkcolor):d.set.traceColor}function $o(e){w={c:Ze(),pt:null,line:e},["touchend","mouseup"].forEach(function(t){O.doc.addEventListener(t,or)}),["touchmove","mousemove"].forEach(function(t){O.doc.addEventListener(t,lr)}),fe("touchend",or),fe("mouseup",or),fe("mousemove",lr),fe("touchmove",lr)}function or(e){e.preventDefault();var t=w.line;w.pt==null&&(w.pt=zr(t.type,e,w.c.offset,w.c.ctx,t.color,t.style,t.width,t.fontSize)),ul(t.type,t.color,w.pt,t.style,t.width,t.fontSize)}function lr(e){e.preventDefault();var t=w.line;w.pt=zr(t.type,e,w.c.offset,w.c.ctx,t.color,t.style,t.width,t.fontSize)}function el(e,t,a){w={c:Ze(),pt:null,line:e,x0:t,y0:a},["touchend","mouseup"].forEach(function(i){O.doc.addEventListener(i,sr)}),["touchmove","mousemove"].forEach(function(i){O.doc.addEventListener(i,ir)}),fe("touchend",sr),fe("mouseup",sr),fe("mousemove",ir),fe("touchmove",ir)}function ir(e){e.preventDefault(),De();var t=ie(e),a=parseInt(t.x-w.c.offset.left)-w.x0,i=parseInt(t.y-w.c.offset.top)-w.y0;w.pt=Kr(w.c.ctx,w.line,a,i)}function sr(e){e.preventDefault(),w.pt!=null&&$r(w.line,w.pt)}function tl(e,t,a){var i=a=="handler0oblic"?{x:e.x1,y:e.y1,mx:e.RealX1,my:e.RealY1}:{x:e.x0,y:e.y0,mx:e.RealX0,my:e.RealY0};w={c:Ze(),line:e,type:t,ptb:i,target:a},["touchend","mouseup"].forEach(function(l){O.doc.addEventListener(l,nr)}),["touchmove","mousemove"].forEach(function(l){O.doc.addEventListener(l,cr)}),fe("touchend",nr),fe("mouseup",nr),fe("mousemove",cr),fe("touchmove",cr)}function nr(e){e.preventDefault(),w.pte!=null&&eo(w.line.color,w.line.color2,w.type,w.pte,w.target,w.ptb,w.line.width,w.line.style,w.line.fontSize)}function cr(e){e.preventDefault(),w.pte=Jr(e,w.c.offset,w.c.ctx,w.line.color,w.line.color2,w.type,w.target,w.ptb,w.line.width,w.line.style,w.line.fontSize)}function al(e){C("c"),w={c:Ze(),type:e,color:bt()},["touchstart","mousedown"].forEach(function(t){O.doc.addEventListener(t,ur)}),["touchmove","mousemove"].forEach(function(t){O.doc.addEventListener(t,dr)}),fe("touchstart",ur),fe("mousedown",ur),fe("mousemove",dr),fe("touchmove",dr)}function ur(e){e.preventDefault(),w.ptb==null&&(w.ptb=Pr(e,w.c.offset)),w.pte!=null&&eo(w.color,null,w.type,w.pte,null,w.ptb)}function dr(e){e.preventDefault(),w.ptb!=null&&(w.pte=Jr(e,w.c.offset,w.c.ctx,w.color,null,w.type,null,w.ptb))}function rl(e){C("c"),w={c:Ze(),line:e,ptb:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},pte:{mx:e.RealX1,my:e.RealY1,x:e.x1,y:e.y1},x1:Math.max(e.RealX1,e.RealX0)},["touchend","mouseup"].forEach(function(t){O.doc.addEventListener(t,hr)}),["touchmove","mousemove"].forEach(function(t){O.doc.addEventListener(t,pr)}),fe("touchend",hr),fe("mouseup",hr),fe("mousemove",pr),fe("touchmove",pr)}function hr(e){e.preventDefault();var t=w.line;Zr(t.color,w.pte,t.width,t.style,t.type,t.color2,w.move,w.ptb,null,t.fontSize)}function pr(e){var t,a,i;e.preventDefault(),t=ie(e),a=parseInt(t.x-w.c.offset.left),w.move=a-w.x1,w.move<100||(De(),i=w.line,kt(w.c.ctx,i.type,i.color,i.style,i.width,w.move,w.ptb,w.pte,i.color2))}function ol(e,t,a,i){var l;l=d.set.semilog&&d.logData!=null?Da(a,d.logData):(R[0].V0*R[0].PxPointY-a)/R[0].PxPointY,w={ptb:{x:i,mx:t,my:a,y:l},pte:null,line:e,c:Ze()},["touchend","mouseup"].forEach(function(s){O.doc.addEventListener(s,mr)}),["touchmove","mousemove"].forEach(function(s){O.doc.addEventListener(s,fr)}),fe("touchend",mr),fe("mouseup",mr),fe("mousemove",fr),fe("touchmove",fr)}function mr(e){e.preventDefault();var t=w.line;w.pte!=null&&Zr(t.color,w.pte,t.width,t.style,t.type,t.color2,t.h,w.ptb,t.fontSize)}function fr(e){e.preventDefault();var t=w.line;t.type=="f"&&t.x1<t.x0?t.h=-1:t.type=="f"&&t.x1>=t.x0&&(t.h=1),w.pte=Cr(e,w.c.offset,w.c.ctx,t.color,t.width,t.style,t.h,t.type,t.color2,w.ptb,t.fontSize)}function ll(e){je(),w={c:Ze(),line:e},["touchend","mouseup"].forEach(function(t){O.doc.addEventListener(t,vr)}),["touchmove","mousemove"].forEach(function(t){O.doc.addEventListener(t,gr)}),fe("touchend",vr),fe("mouseup",vr),fe("mousemove",gr),fe("touchmove",gr)}function gr(e){e.preventDefault();var t=w.line,a=ie(e),i=parseInt(a.y-w.c.offset.top+(t.RealY1-t.RealY0)/2);w.rh=t.RealY1-i,De(),kt(w.c.ctx,"p",t.color,t.style,t.width,-w.rh,{mx:t.RealX0,my:t.RealY0},{mx:t.RealX1,my:t.RealY1},t.color2)}function vr(e){e.preventDefault();var t=w.line,a=w.rh/R[0].PxPointY,i=t.y0,l=t.y1;a>0&&(i=i+a,l=l+a),z.push(new Ce(t.x0,i,t.x1,l,t.color,t.RealX0,t.RealX1,t.width,t.style,"p",Math.abs(a),t.color2)),Ne(d.symbol,z),je(),at(z.length-1)}function il(e,t,a,i,l,s,n,u){w={c:Ze(),ptb:{mx:t,my:a,x:i},style:s,height:n*R[0].PxPointY,color2:u,width:l,color:e},["touchend","mouseup"].forEach(function(m){O.doc.addEventListener(m,yr)}),["touchmove","mousemove"].forEach(function(m){O.doc.addEventListener(m,br)}),fe("touchend",yr),fe("mouseup",yr),fe("mousemove",br),fe("touchmove",br)}function yr(e){var t,a,i,l;e.preventDefault(),t=w.pte,a=w.ptb,t!=null&&(i=d.set.semilog&&d.logData!=null?Da(a.my,d.logData):(R[0].V0*R[0].PxPointY-a.my)/R[0].PxPointY,l=w.height/R[0].PxPointY,t.mx<a.mx?z.push(new Ce(t.x,t.y,a.x,i,w.color,t.mx,a.mx,w.width,w.style,"p",l,w.color2)):z.push(new Ce(a.x,i,t.x,t.y,w.color,a.mx,t.mx,w.width,w.style,"p",l,w.color2)),Ne(d.symbol,z),je(),at(z.length-1))}function br(e){e.preventDefault(),w.pte=Cr(e,w.c.offset,w.c.ctx,w.color,w.width,w.style,w.height,"p",w.color2,w.ptb)}function sl(){C("c"),w={c:Ze(),color:bt(),step1:!1},["touchstart","touchend","mousedown"].forEach(function(e){O.doc.addEventListener(e,ba)}),["touchmove","mousemove"].forEach(function(e){O.doc.addEventListener(e,xr)}),fe("touchend",ba),fe("touchstart",ba),fe("mousedown",ba),fe("mousemove",xr),fe("touchmove",xr)}function ba(e){if(e.preventDefault(),w.ptb==null){w.ptb=Pr(e,w.c.offset);return}if(w.pte!=null&&w.rh==null){w.step1=!0;return}var t=w.ptb.y,a=w.rh/R[0].PxPointY;a>0&&(t=t+a,w.pte.y=w.pte.y+a),a=Math.abs(a),w.pte.mx<w.ptb.mx?z.push(new Ce(w.pte.x,w.pte.y,w.ptb.x,t,w.color,w.pte.mx,w.ptb.mx,1,null,"p",a)):z.push(new Ce(w.ptb.x,t,w.pte.x,w.pte.y,w.color,w.ptb.mx,w.pte.mx,1,null,"p",a)),Ne(d.symbol,z),je(),at(z.length-1)}function xr(e){if(e.preventDefault(),w.ptb!=null){if(w.ptb!=null&&!w.step1){w.pte=Cr(e,w.c.offset,w.c.ctx,null,null,null,null,"p",null,w.ptb);return}var t=w.c.ctx,a=ie(e),i=parseInt(a.y-w.c.offset.top);w.rh=w.pte.my-i,De(),t.strokeStyle=w.color,t.lineWidth=1,t.beginPath(),t.moveTo(w.ptb.mx,w.ptb.my),t.lineTo(w.pte.mx,w.pte.my),t.moveTo(w.ptb.mx,w.ptb.my-w.rh),t.lineTo(w.pte.mx,w.pte.my-w.rh),t.stroke()}}function nl(e){w={line:e,ptb:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},pte:null,c:Ze()},["touchend","mouseup"].forEach(function(t){O.doc.addEventListener(t,wr)}),["touchmove","mousemove"].forEach(function(t){O.doc.addEventListener(t,_r)}),fe("touchend",wr),fe("mouseup",wr),fe("mousemove",_r),fe("touchmove",_r)}function _r(e){e.preventDefault(),De();var t=w.line,a=ie(e),i=parseInt(a.y-w.c.offset.top),l=parseInt(a.x-w.c.offset.left);i=_a(i),w.pte=new Ae(l,i),la(w.c.ctx,t.color,t.style,t.width,w.ptb,w.pte,t.color2)}function wr(e){e.preventDefault();var t=w.line;w.pte!=null&&(z.push(new Ce(w.ptb.x,w.ptb.y,w.pte.x,w.pte.y,t.color,w.ptb.mx,w.pte.mx,t.width,t.style,"c",null,t.color2)),Ne(d.symbol,z),je(),at(z.length-1))}function cl(e){C("c"),w={type:e,c:Ze(),color:bt()},["touchstart","touchend","mousedown"].forEach(function(t){O.doc.addEventListener(t,xa)}),["touchmove","mousemove"].forEach(function(t){O.doc.addEventListener(t,Tr)}),fe("touchend",xa),fe("touchstart",xa),fe("mousedown",xa),fe("mousemove",Tr),fe("touchmove",Tr)}function Tr(e){var t;e.preventDefault();var a=w.ptb,i=w.type,l=w.color,s=w.c.ctx;if(a!=null){De();var n=ie(e),u=parseInt(n.y-w.c.offset.top),m=parseInt(n.x-w.c.offset.left);switch(u=_a(u),w.pte=new Ae(m,u),i=="mv"&&(w.pte.mx=a.mx,w.pte.x=a.x),i=="mh"&&(w.pte.my=a.my,w.pte.y=a.y),i){case"an":t=Math.atan2(a.my-w.pte.my,w.pte.mx-a.mx),ra(s,l,null,null,a,w.pte,t);break;case"af":oa(s,l,null,null,a,w.pte);break;case"c":la(s,l,null,null,a,w.pte);break;case"gg":aa(s,l,null,null,a,w.pte);break;case"ga":ta(s,l,null,null,a,w.pte);break;case"cf":Jt(s,l,null,null,a,w.pte,0);break;case"ff":ea(s,l,null,null,a,w.pte);break;case"o":case"f":case"ef":case"mv":case"mh":kt(s,i,l,null,null,null,a,w.pte);break;case"v":sa(s,w.pte,null,null,l);break;case"h":Ht(s,w.pte,null,null,l,null,"h");break;case"sr":ia(s,w.pte,null,null,l);break;case"mg":Ht(s,w.pte,null,null,l,null,"mg")}}}function xa(e){var t=w.pte,a=w.ptb,i=w.type,l;if(a==null){w.ptb=Pr(e,w.c.offset);return}if(t==null){je(),ee();return}switch(l=null,i=="ef"&&(l=250),i=="an"&&(l=Math.atan2(a.my-t.my,t.mx-a.mx)),i){case"o":case"f":case"ef":t.mx<a.mx?z.push(new Ce(t.x,t.y,a.x,a.y,w.color,t.mx,a.mx,null,null,i,i=="f"?-1:l)):z.push(new Ce(a.x,a.y,t.x,t.y,w.color,a.mx,t.mx,null,null,i,i=="f"?1:l));break;case"v":z.push(new Ce(t.x,0,t.x,2e4,w.color,t.mx,t.mx,null,null,i));break;case"sr":z.push(new Ce(t.x,t.y,0,t.y,w.color,t.mx,null,null,null,i));break;case"h":case"mg":z.push(new Ce(0,t.y,0,t.y,w.color,null,null,null,null,i));break;default:z.push(new Ce(a.x,a.y,t.x,t.y,w.color,a.mx,t.mx,null,null,i,l))}Ne(d.symbol,z),je(),at(z.length-1)}function _a(e){return e<0&&(e=0),e>R[0].HeightPx&&(e=R[0].HeightPx),e}function Pr(e,t){var a=ie(e);return new Ae(parseInt(a.x-t.left),parseInt(a.y-t.top))}function zr(e,t,a,i,l,s,n,u){var m;De();var y=ie(t),x=parseInt(y.y-a.top),T=parseInt(y.x-a.left);switch(x<0&&(x=1),x>R[0].HeightPx&&(x=R[0].HeightPx-1),m=new Ae(T,x),e){case"sr":ia(i,m,s,n,l,u);break;case"v":sa(i,m,s,n,l,u);break;default:Ht(i,m,s,n,l,u,e)}return m}function Kr(e,t,a,i){var l=new Ae(t.RealX0+a,t.RealY0+i),s=new Ae(t.RealX1+a,t.RealY1+i),n=null;switch(t.type){case"t":n=new Ae(t.h.C.mx+a,t.h.C.my+i),$t(e,l,s,n,t.color,t.color2,t.width);break;case"wf":n=new Ae(t.h.C.mx+a,t.h.C.my+i),Ft(e,l,s,n,t.color,t.color2,t.width,t.fontSize);break;case"a":ka(e,l,t.style,t.color,unescape(t.h));break;case"r":na(e,t.color,t.color2,l,s,t.type,null,t.width,t.style);break;case"m":na(e,t.color,t.color2,l,s,t.type,t.h,t.width,t.style,t.fontSize);break;case"rf":Ea(e,t.color,t.color2,l,s,t.width,t.fontSize);break;case"c":la(e,t.color,t.style,t.width,l,s,t.color2);break;case"an":ra(e,t.color,t.style,t.width,l,s,t.h,t.fontSize);break;case"af":oa(e,t.color,t.style,t.width,l,s,t.fontSize);break;case"cf":Jt(e,t.color,t.style,t.width,l,s,0,t.fontSize);break;case"gg":aa(e,t.color,t.style,t.width,l,s);break;case"ga":ta(e,t.color,t.style,t.width,l,s,t.fontSize);break;case"ff":ea(e,t.color,t.style,t.width,l,s,t.fontSize);break;case"sr":ia(e,l,t.style,t.width,t.color,t.fontSize);break;case"v":sa(e,l,t.style,t.width,t.color,t.fontSize);break;case"h":case"mg":Ht(e,l,t.style,t.width,t.color,12,t.type);break;case"arrup":case"arrdw":case"arrrt":case"arrlt":At(e,l,t.color,t.type,t.color2,t.width);break;case"sm1":case"sm2":Zt(e,l,t.color,t.type,t.width);break;default:kt(e,t.type,t.color,t.style,t.width,t.h,l,s,t.color2,t.fontSize)}return{ptb:l,pte:s,C:n}}function Cr(e,t,a,i,l,s,n,u,m,y,x){var T,M;De();var A=ie(e),D=parseInt(A.x-t.left),k=parseInt(A.y-t.top);switch(k=_a(k),T=new Ae(D,k),u=="mv"&&(T.mx=y.mx,T.x=y.x),u=="mh"&&(T.my=y.my,T.y=y.y),u){case"an":M=Math.atan2(y.my-T.my,T.mx-y.mx),T.mx=ra(a,i,s,l,y,T,M,x);break;case"af":oa(a,i,s,l,y,T,x);break;case"gg":aa(a,i,s,l,y,T);break;case"ga":ta(a,i,s,l,y,T,x);break;case"ff":ea(a,i,s,l,y,T,x);break;case"cf":Jt(a,i,s,l,y,T,0,x);break;default:kt(a,u,i,s,l,n,y,T,m,x)}return T}function Jr(e,t,a,i,l,s,n,u,m,y,x){var T,M;De();var A=ie(e),D=parseInt(A.x-t.left),k=parseInt(A.y-t.top);return k=_a(k),T=new Ae(D,k),s=="rf"&&Ea(a,i,l,u,T,m,x,n=="handler0oblic"),(s=="r"||s=="m")&&(M=u.my>T.my?1:0,na(a,i,l,u,T,s,M,m,y,x)),T}function ul(e,t,a,i,l,s){switch(e){case"sr":z.push(new Ce(a.x,a.y,0,a.y,t,a.mx,null,l,i,e,null,null,s));break;case"v":z.push(new Ce(a.x,0,a.x,2e4,t,a.mx,a.mx,l,i,e,null,null,s));break;default:z.push(new Ce(0,a.y,0,a.y,t,null,null,l,i,"h",null,null,s))}Ne(d.symbol,z),je(),at(z.length-1)}function Zr(e,t,a,i,l,s,n,u,m){switch(e==null&&(e=bt()),l=="ef"&&n==null&&(n=250),l){case"an":n=Math.atan2(u.my-t.my,t.mx-u.mx),z.push(new Ce(u.x,u.y,t.x,t.y,e,u.mx,t.mx,a,i,l,n,null,m));break;case"af":case"cf":z.push(new Ce(u.x,u.y,t.x,t.y,e,u.mx,t.mx,a,i,l,null,null,m));break;default:t.mx<u.mx?z.push(new Ce(t.x,t.y,u.x,u.y,e,t.mx,u.mx,a,i,l,l=="f"?-1:n,s,m)):z.push(new Ce(u.x,u.y,t.x,t.y,e,u.mx,t.mx,a,i,l,l=="f"?1:n,s,m))}Ne(d.symbol,z),je(),at(z.length-1)}function $r(e,t){e.color==null&&(e.color=bt());var a=t.ptb,i=t.pte,l=t.C,s=a.y,n=a.x,u=i.y,m=i.x;switch(e.type){case"t":case"wf":z.push(new Ce(n,s,m,u,e.color,a.mx,i.mx,e.width,null,e.type,{C:l},e.color2,e.fontSize));break;case"a":z.push(new Ce(n,s,n,s,e.color,a.mx,i.mx,e.width,e.style,e.type,e.h,null,e.fontSize));break;case"r":case"rf":z.push(new Ce(n,s,m,u,e.color,a.mx,i.mx,e.width,null,e.type,null,e.color2,e.fontSize));break;case"ef":case"m":z.push(new Ce(n,s,m,u,e.color,a.mx,i.mx,e.width,e.style,e.type,e.h,e.color2,e.fontSize));break;case"c":z.push(new Ce(n,s,m,u,e.color,a.mx,i.mx,e.width,e.style,e.type,null,e.color2));break;case"an":case"f":z.push(new Ce(n,s,m,u,e.color,a.mx,i.mx,e.width,e.style,e.type,e.h,null,e.fontSize));break;case"mv":case"mh":case"af":case"gg":case"ga":case"ff":case"cf":z.push(new Ce(n,s,m,u,e.color,a.mx,i.mx,e.width,e.style,e.type,null,null,e.fontSize));break;case"sr":z.push(new Ce(n,a.y,0,a.y,e.color,a.mx,null,e.width,e.style,e.type,null,null,e.fontSize));break;case"v":z.push(new Ce(n,0,t.x,2e4,e.color,a.mx,a.mx,e.width,e.style,e.type,null,null,e.fontSize));break;case"h":z.push(new Ce(0,a.y,0,a.y,e.color,null,null,e.width,e.style,"h",null,null,e.fontSize));break;case"arrup":case"arrdw":case"arrrt":case"arrlt":z.push(new Ce(n,a.y,n,a.y,e.color,a.mx,a.mx,e.width,null,e.type,null,e.color2));break;case"sm1":case"sm2":z.push(new Ce(n,a.y,n,a.y,e.color,a.mx,a.mx,e.width,null,e.type,null,null));break;default:z.push(new Ce(n,s,m,u,e.color,a.mx,i.mx,e.width,e.style))}Ne(d.symbol,z),je(),at(z.length-1)}function eo(e,t,a,i,l,s,n,u,m){var y=s.y,x=i.y,T=Math.min(s.x,i.x),M=Math.max(s.x,i.x),A=Math.min(s.mx,i.mx),D=Math.max(s.mx,i.mx),k=0;switch(s.my>i.my&&(k=1),a){case"r":case"m":z.push(new Ce(T,Math.max(y,x),M,Math.min(y,x),e,A,D,n,null,a,a=="r"?null:k,t,m));break;case"rf":l=="handler0oblic"?z.push(new Ce(T,x,M,y,e,A,D,n,null,a,null,t,m)):z.push(new Ce(T,y,M,x,e,A,D,n,null,a,null,t,m))}Ne(d.symbol,z),je(),at(z.length-1)}function Ze(){var e=o.gi(ge("trace-"));return{offset:Ue(e),ctx:e.getContext("2d")}}function it(e,t,a){var i="w"+a;t[i]!=null&&(e.lineWidth=t[i])}function He(e,t,a){var i,l;if(e.setLineDash)switch(a!=null?(l="s"+t,a[l]!=null&&(i=a[l])):i=t,i){case 2:e.setLineDash([2,2]);break;case 3:e.setLineDash([4]);break;case 4:e.setLineDash([7,2,2,2])}}function Sr(e,t,a){var i=function(y,x,T){return y+T*(x-y)},l=e.RealX1-e.RealX0,s=e.RealY1-e.RealY0,n=((t-e.RealX0)*l+(a-e.RealY0)*s)/(l*l+s*s),u=i(e.RealX0,e.RealX1,n),m=i(e.RealY0,e.RealY1,n);return{x:u,y:m}}function dl(e,t,a){if((a.type=="arrrt"||a.type=="arrlt")&&t>=a.RealY0-5&&t<=a.RealY0+5)switch(a.type){case"arrrt":if(e>=a.RealX0-16&&e<=a.RealX0)return!0;break;case"arrlt":if(e<=a.RealX0+16&&e>=a.RealX0)return!0}if(e>=a.RealX0-5&&e<=a.RealX0+5)switch(a.type){case"arrup":if(t>=a.RealY0&&t<=a.RealY0+16)return!0;break;case"arrdw":if(t<=a.RealY0&&t>=a.RealY0-16)return!0;break;case"sm1":case"sm2":if(t>=a.RealY0-10&&t<=a.RealY0+10)return!0}return!1}function hl(e,t,a){var i=5,l=Math.abs(a.RealX1-a.RealX0),s=Math.abs(a.RealY0-a.RealY1),n=Math.pow(e-a.RealX0,2)/Math.pow(l+i,2),u=Math.pow(t-a.RealY0,2)/Math.pow(s+i,2),m=!1,y,x;return n+u<=1&&(m=!0),y=Math.pow(e-a.RealX0,2)/Math.pow(l-i,2),x=Math.pow(t-a.RealY0,2)/Math.pow(s-i,2),y+x<=1&&(m=!1),m}function pl(e,t,a){for(var i,l,s,n,u=a.h.length,m,y,x=1;x<u;x++)if(m=a.h[x-1],y=a.h[x],e>Math.min(m.mx,y.mx)&&e<Math.max(m.mx,y.mx)&&(i=Sr({RealX0:m.mx,RealY0:m.my,RealX1:y.mx,RealY1:y.my},e,t),l=e-i.x,s=t-i.y,n=Math.abs(Math.sqrt(l*l+s*s)),n<4))return!0;return!1}function ml(e,t,a){var i=[{RealX0:a.RealX0,RealY0:a.RealY0,RealX1:a.RealX1,RealY1:a.RealY1},{RealX0:a.RealX0,RealY0:a.RealY0,RealX1:a.h.C.mx,RealY1:a.h.C.my}],l,s,n,u,m,y;for(a.type=="t"&&i.push({RealX0:a.RealX1,RealY0:a.RealY1,RealX1:a.h.C.mx,RealY1:a.h.C.my}),y=i.length,l=0;l<y;l++)if(e>Math.min(i[l].RealX0,i[l].RealX1)-3&&e<Math.max(i[l].RealX0,i[l].RealX1)+3&&(s=Sr(i[l],e,t),n=e-s.x,u=t-s.y,m=Math.abs(Math.sqrt(n*n+u*u)),m<5))return!0;return!1}function fl(e,t,a){var i=c(e.QuoteTab),l,s,n,u,m,y,x,T,M;i=ht(i);for(var A=i.length,D=0,k=999999,E=0;E<A;E++)i[E]!=null&&(i[E].h>D&&(D=i[E].h),i[E].l<k&&(k=i[E].l));for(l=(D-k)*t/100,n=[],n[0]={h:i[0].v,b:0},E=1;E<A;E++)i[E]!=null&&(s=Math.floor((i[E].c-k)/l),u=i[E].c>=i[E-1].c,n[s]!=null?u?n[s].h=n[s].h+i[E].v:n[s].b=n[s].b+i[E].v:n[s]=u?{h:i[E].v,b:0}:{h:0,b:i[E].v});for(m=0,y=n.length,E=0;E<y;E++)n[E]!=null&&n[E].h+n[E].b>m&&(m=n[E].h+n[E].b);x=R[0],T=x.ctx,T.strokeStyle=d.set.gridColor,T.save();var Y=d.paddingLeft,F=m/(d.innerWidth/2),q=Math.floor((D-k)*x.PxPointY/y);for(q=q<2?2:q-2,M=0,E=0;E<y;E++)n[E]!=null&&(a.v1||(T.fillStyle=a.color,M=n[E].h/F,T.fillRect(Y,Math.round((x.V0-(k+E*l))*x.PxPointY),M,-q)),a.v2||(T.fillStyle=a.color2,T.fillRect(M+Y,Math.round((x.V0-(k+E*l))*x.PxPointY),n[E].b/F,-q)));T.restore()}function gl(e,t,a,i,l){var s=c(e),n,u,m;s=ht(s);var y=s.length,x,T=0,M=0;if(y!=0){for(n=R[0],x=0;x<y;x++)s[x]!=null&&(T+=N(s[x],i),M++);T=T/M,u=xe(T,l,n)+.5,m=n.ctx,m.save(),m.strokeStyle=a.v1?"transparent":a.color,m.fillStyle=m.strokeStyle,m.beginPath(),m.moveTo(t.paddingLeft,u),m.lineTo(t.innerWidth+t.paddingLeft,u),it(m,a,1),He(m,1,a),m.stroke(),m.font="14px Arial",m.fillStyle=m.strokeStyle,m.fillText(b(T),t.paddingLeft+5,u-4),m.restore()}}function vl(e,t,a,i){var l=e.length,s;if(l<=t)return null;var n=0,u=0,m=0,y=0,x=0,T;for(s=1;s<=t;s++)T=N(e[l-s],i),n+=s*T,u+=s,m+=T,y+=s*s,x+=T*T;var M=(n*t-u*m)/(t*y-u*u),A=(m-M*u)/t,D=A+M*t,k=A+M,E=Math.pow((t*x-m*m)/(t*(t-1)),.5),Y=new Je(e[l-t].d,D,B.QuoteTab[U.minX].d),F=new Je(e[l-1].d,k,B.QuoteTab[U.minX].d);return{p0:Y,p1:F,et:E,id:a}}function yl(e,t,a){var i={QuoteTab:e.QuoteTab},l=[],s,n=i.QuoteTab.length,u,m,y,x,T,M,A,D,k;if(n<5)return!1;for(N(i.QuoteTab[1],a)>N(i.QuoteTab[0],a)?(m=N(i.QuoteTab[0],a),y=N(i.QuoteTab[1],a),l.push({d:i.QuoteTab[0].d,l1:m,h1:y,c:i.QuoteTab[0].c,s:1}),u=1,x=!0,T=N(i.QuoteTab[0],a)):(m=N(i.QuoteTab[1],a),y=N(i.QuoteTab[0],a),l.push({d:i.QuoteTab[0].d,l2:m,h2:y,c:i.QuoteTab[0].c,s:0}),u=0,x=!1,M=N(i.QuoteTab[0],a)),s=2;s<n;s++){if(D=N(i.QuoteTab[s],a),k=l.length-1,u==1&&x){A=D-l[k].h1,A>0&&(l[k].h1=D,y=D),A<0&&A<-t&&(M=y,l.push({d:i.QuoteTab[s].d,l1:Math.max(D,T),h1:y,c:D,s:0}),D<T&&(l[l.length-1].l2=D,l[l.length-1].h2=T,u=0),x=!1,m=D);continue}if(u==1&&!x){A=D-l[k].l1,A>t&&(l.push({d:i.QuoteTab[s].d,l1:m,h1:D,c:D,s:1}),u=1,x=!0,T=m,y=D),A<0&&(l[k].l1=Math.max(D,T),D<T&&(l[k].l2=D,l[k].h2=T,u=0),m=D);continue}if(u==0&&!x){A=D-l[k].l2,A<0&&(l[k].l2=D,m=D),A>0&&A>t&&(T=m,l.push({d:i.QuoteTab[s].d,l2:m,h2:Math.min(D,M),c:D,s:1}),D>M&&(l[l.length-1].l1=M,l[l.length-1].h1=D,u=1),x=!0,y=D);continue}u==0&&x&&(A=D-l[k].h2,A<-t&&(l.push({d:i.QuoteTab[s].d,l2:D,h2:y,c:D,s:0}),u=0,x=!1,m=D,M=y),A>0&&(l[k].h2=Math.min(D,M),D>M&&(l[k].l1=M,l[k].h1=D,u=1),y=D))}return{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:l}}function bl(e){var t={QuoteTab:e.QuoteTab},a=[],i,l=t.QuoteTab.length,s,n,u,m,y,x;if(l<2)return!1;for(y=t.QuoteTab[0],a[0]={d:y.d,o:y.o,h:y.h,l:y.l,c:y.c,v:y.v},i=1;i<l;i++)x=t.QuoteTab[i],x!=null&&(m=(x.o+x.h+x.l+x.c)/4,s=(a[i-1].o+a[i-1].c)/2,n=Math.max(x.h,m,s),u=Math.min(x.l,s,m),a[i]={d:x.d,o:+s.toFixed(3),h:+n.toFixed(3),l:+u.toFixed(3),c:+m.toFixed(3),v:x.v});return{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:a}}function xl(e,t,a){function i(k,E){var Y;if(k==1)for(Y=Math.min(s[E-1].l,s[E-2].l),Y=s[E-t].l,A=1;A<t;A++)s[E-A].l<Y&&(Y=s[E-A].l);else for(Y=s[E-t].h,A=1;A<t;A++)s[E-A].h>Y&&(Y=s[E-A].h);return Y}var l={QuoteTab:e.QuoteTab},s=[],n,u=l.QuoteTab.length,m,y,x,T,M,A,D;if(t>5&&(t=5),t>u-5)return!1;for(y=N(l.QuoteTab[0],a),x=N(l.QuoteTab[0],a),n=1;n<t;n++)N(l.QuoteTab[n],a)>x&&(x=N(l.QuoteTab[n],a)),N(l.QuoteTab[n],a)<y&&(y=N(l.QuoteTab[n],a));for(N(l.QuoteTab[t-1],a)>N(l.QuoteTab[0],a)?(m=1,T=y):(m=0,T=x),n=0;n<t;n++)s.push({d:l.QuoteTab[n].d,l:y,h:x,s:m,c:l.QuoteTab[n].c});for(n=t;n<u;n++)if(M=s.length,D=l.QuoteTab[n],m==0){if(T=i(0,M),N(D,a)>T){m=1,s.push({d:D.d,l:s[M-1].h,h:N(D,a),s:1,c:D.c});continue}if(D.c<s[M-1].l){m=0,s.push({d:D.d,l:N(D,a),h:s[M-1].l,s:0,c:D.c});continue}}else{if(T=i(1,M),N(D,a)<T){m=0,s.push({d:D.d,l:N(D,a),h:s[M-1].l,s:0,c:D.c});continue}if(N(D,a)>s[M-1].h){m=1,s.push({d:D.d,l:s[M-1].h,h:N(D,a),s:1,c:D.c});continue}}return s.splice(0,t-1),s.length==1&&(s=[]),{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:s}}function _l(e,t,a,i){var l={QuoteTab:e.QuoteTab},s=[],n,u=l.QuoteTab.length,m,y;if(u<3||t<=0||a<=1)return!1;var x=N(l.QuoteTab[0],i),T=!0,M=l.QuoteTab[0].d,A;for(n=1;n<u;n++){if(A=N(l.QuoteTab[n],i)-x,A>=t){T=!0;break}if(A<=-t){T=!1;break}}for(m=1,n=1;n<u;n++)y=(N(l.QuoteTab[n],i)-x)/t,T?(y>=1&&(x=x+Math.floor(y)*t,m+=Math.floor(y)),y<=-a&&(s.push({d:M,f:!0,n:m,c:x}),M=l.QuoteTab[n].d,x=x+Math.ceil(y)*t,T=!1,m=Math.floor(Math.abs(y)))):y>=a?(s.push({d:M,f:!1,n:m,c:x-t}),M=l.QuoteTab[n].d,x=x+Math.floor(y)*t,T=!0,m=Math.floor(Math.abs(y))):y<=-1&&(x=x+Math.ceil(y)*t,m+=Math.floor(Math.abs(y)));return m!=1&&s.push({d:M,f:T,n:m,c:x}),{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:s}}function wl(e,t){for(var a={QuoteTab:e.QuoteTab},i=[],l=a.QuoteTab.length,s=0,n=0,u,m,y,x=0;x<l;x++)a.QuoteTab[x]!=null&&(n+=a.QuoteTab[x].v);for(n+=n*1e3,x=0;x<l;x++)m=a.QuoteTab[x],m!=null&&(u=Math.round(m.v*1e3/n*t),y=m.c>=m.o,i.push({d:m.d,l:m.l,h:m.h,s:y,w:u,c:m.c,cu:s,o:m.o}),s+=u);return{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:i}}function to(e,t,a){var i={QuoteTab:e.QuoteTab},l=[],s,n=i.QuoteTab.length,u,m,y=N(i.QuoteTab[0],a),x=N(i.QuoteTab[0],a),T,M,A;if(n<3)return!1;for(N(i.QuoteTab[1],a)>=N(i.QuoteTab[0],a)?x+=t:y-=t,s=2;s<n;s++){if(A=i.QuoteTab[s],T=N(A,a)-x-t,M=N(A,a)-y+t,T>0){for(m=(T+t)/t>>0,u=0;u<m;u++)l.push({d:A.d,l:y+t*(u+1),h:x+t*(u+1),s:1,c:A.c});x=x+t*m,y=y+t*m}if(M<0){for(m=Math.abs((M-t)/t>>0),u=0;u<m;u++)l.push({d:A.d,l:y-t*(u+1),h:x-t*(u+1),s:0,c:A.c});x=x-t*m,y=y-t*m}}return l.length==1&&(l=[]),{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:l}}var Ut;this.clickHandler=["click"],this.callID=g.callID,this.doc=o.gi(this.callID),("ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0)&&(this.clickHandler=["touchend","click"]),VGP.callType==null&&(VGP.callType="POST"),g.symbol==null&&(g.symbol="PX1p");var ao=window.getComputedStyle(this.doc),Tl={widthGraph:parseInt(ao.width),heightGraph:parseInt(ao.height),paddingTop:17,paddingLeft:10,paddingBottom:20,paddingRight:45,histoLength:365,chartPeriod:0,padBarCandle:0,searchConfig:"",mainChart:{type:"line",indicators:[]},indicators:[],set:p(),cursor:"r"},O=this,d=r(Tl,g);VGP.isMobile&&(d.cursor="b"),Ut=d.set.fontSize-11,d.paddingBottom+=Ut,d.paddingTop+=Ut,d.paddingRight+=Ut*4,d.paddingLeft+=Ut*4;var R=[],z=[],U={maxY:0,minY:0,maxX:null,minX:0},B,ze=[],Ie={},Se={},w={},J={initViewBegin:0,initViewEnd:0,initMaxY:0,initMinY:0,lineNumber:999,evtList:[],cursorState:!1,moveZoomX:0,moveZoomY:0,moveLayer:!1,activeLayer:null,flagSave:!1,fiEvt:[],tmp1:null,tmp2:null};this.hideShowTrace=function(){d.hideTrace=!d.hideTrace,_(),Ee()},this.duree_menu=function(e,t){if(e!=""&&(e=parseInt(e),t=t!=null?parseInt(t):d.chartPeriod,e!=d.histoLength||t!=d.chartPeriod)){J.fiEvt=[],o.clrem(["svginfofi"]),J.flagSave=!0,We();var a={chartPeriod:d.chartPeriod,histoLength:d.histoLength};t<0&&e>20&&(t=0),t>=0&&e<=20&&(t=-1),d.chartPeriod=t,d.histoLength=e,da(!0,a)}},this.period_menu=function(e,t){e=parseInt(e),e!=d.chartPeriod&&(t=t!=null?parseInt(t):d.histoLength,t!=d.histoLength||e!=d.chartPeriod)&&(J.flagSave=!0,We(),e<0&&t>20&&(t=1,J.fiEvt=[],o.clrem(["svginfofi"])),e>=0&&t<=20&&(t=365,J.fiEvt=[],o.clrem(["svginfofi"])),d.chartPeriod=e,d.histoLength=t,da(!0))},this.settings_changeFont=function(e){var t=e-d.set.fontSize;t!=0&&(d.paddingBottom+=t,d.paddingTop+=t,d.paddingRight+=t*4,d.paddingLeft+=t*4,d.set.fontSize=e,this.set_screenSize())},this.style_menu_template=function(e){B!=null&&Ir(e,!0)},this.style_menu=function(e){B!=null&&e!=d.mainChart.type&&Ir(e)},this.indic1_menu=function(e){if(B!=null&&d.mainChart.type!="perf"&&!d.mainChart.typedef.nolinearX&&e!=null){var t,a=d.mainChart.indicators.length;if(e=="sar"||e=="ichimoku"||e=="pivots"){for(t=0;t<a;t++)if(d.mainChart.indicators[t].type==e)return}if((e=="pivots"||e=="VWAP")&&d.chartPeriod>=0){DisplayAlert("Cet indicateur n'est disponible qu'en vision intraday");return}d.mainChart.indicators.push(j(e)),Be(0)}},this.indics_menu=function(e){if(B!=null&&!d.mainChart.typedef.nolinearX&&e!=null){if(!d.isCompare&&e=="fr"){typeof DisplayAlert=="function"&&DisplayAlert("La Force Relative ne peut \xEAtre appliqu\xE9e que quand 2 valeurs sont compar\xE9es");return}if(R.length==5&&typeof DisplayAlert=="function"){DisplayAlert(lang.l_msg1,1);return}Oo(j(e))}},this.loadDefautChart=function(e){o.idempty(O.callID),_t(),J.fiEvt=[],o.clrem(["svginfofi"]),delete d.newsConfig,e.indicators||(e.indicators=[]);for(var t=e.indicators.length,a=[],i=0;i<t;i++)typeof e.indicators[i]=="object"?a.push(r(j(e.indicators[i].type),e.indicators[i])):a.push(j(e.indicators[i]));e.indicators=a,me(e),ua(!1)},this.loadTemplateJSON=function(e,t){var a,i;o.idempty(O.callID),_t(),J.fiEvt=[],o.clrem(["svginfofi"]),a=JSON.parse(e),delete a.logData,Te(a);var l=[],s,n=JSON.parse(t),u=n.length;if(u>1){for(s=1;s<u;s++)l.push(n[s].Indicator);a.indicators=l}else a.indicators=[];for(d!=null&&d.symbol!=null&&(a.symbol=d.symbol),me(a,n),i=o.qsa(".indicname"),s=0;s<i.length;s++)i[s].removeAttribute("style");ua(!1)},this.loadTemplate=function(e){var t;J.flagSave=!0,We(),o.idempty(O.callID),_t(),J.fiEvt=[],o.clrem(["svginfofi"]),t=JSON.parse(e.Parametres),delete t.logData,Te(t),t.set=r(p(),t.set);var a,i=[],l,s=JSON.parse(e.Layers),n=s.length;if(n>1){for(l=1;l<n;l++)i.push(s[l].Indicator);t.indicators=i}else t.indicators=[];switch(d!=null&&d.symbol!=null&&(t.symbol=d.symbol),delete d.indicators,delete d.mainChart,delete d.newsConfig,me(t,s),d.mainChart.type){case"heikin ashi":a="heikin";break;case"line break":a="linebreak";break;case"point figure":a="pnf";break;default:a=d.mainChart.type}return ua(!1),a},this.change_symbol=function(e){J.fiEvt=[],o.clrem(["svginfofi"]),d.symbol=e,ua(!0)},this.set_screenSize=function(){var e,t,a,i;if(J.flagSave=!0,We(),O.doc=o.gi(O.callID),e=window.getComputedStyle(O.doc),d.widthGraph=parseInt(e.width),d.heightGraph=parseInt(e.height),d.innerWidth=d.widthGraph-d.paddingLeft-d.paddingRight,d.usableHeight=d.heightGraph-d.paddingTop-d.paddingBottom-d.indicators.length*d.marginInter,t=R.length,d.mainChart.typedef.nolinearX){t>1&&R.splice(0,1),Ga();return}for(a=0;a<t;a++)R[a].Bars=a==0?[]:{},delete R[a].canvas,delete R[a].ctx;i=c(R),_t(!0),Bt(i),B!=null&&(Ee(),VGP.chartSimple||(ee(),Gt()))},this.saveTemplate=function(e){var t,a,i,l,s,n,u;if(B!=null){for(a=c(d),i=["widthGraph","heightGraph","paddingTop","paddingLeft","paddingBottom","paddingRight","indicators","usableHeight","marginInter","innerWidth","symbol","padBarCandle","cursor","logData","hideTrace","compare","isIntraday","callID"],t=0;t<i.length;t++)delete a[i[t]];for(delete a.mainChart.typedef.params,a=ye(a),t=0;t<a.mainChart.indicators.length;t++)delete a.mainChart.indicators[t].params,delete a.mainChart.indicators[t].datas2;for(t=0;t<a.mainChart.indicators.length;t++)delete a.mainChart.indicators[t].params;for(l=R.length,t=0;t<l;t++)R[t].Bars=t==0?[]:{};for(t=0;t<l;t++)delete R[t].canvas,delete R[t].ctx;for(s=c(R),t=0;t<s.length;t++)delete s[t].Bars,delete s[t].RealY,delete s[t].PxPointX,delete s[t].PxPointY,delete s[t].V0,delete s[t].id,delete s[t].HeightPx,delete s[t].Indicator.params;if(n=c(R),d.mainChart.typedef.nolinearX&&(s.splice(1),a.mainChart.indicators=[],n.splice(1)),_t(!0),Bt(n),Ee(),Gt(),ee(),e==null)return{l:JSON.stringify(s),p:JSON.stringify(a)};u=new XMLHttpRequest,u.open("POST",VGP.urlWS+"UpdateConfigEOD",!0),u.setRequestHeader("Content-Type","application/json;charset=UTF-8"),u.send(JSON.stringify({configname:escape(e),parametres:JSON.stringify(a),layers:JSON.stringify(s)}))}},this.SynchronizeLines=function(){z=Vr(d.symbol),De()},this.get_symbol=function(){return d.symbol},this.delete_chart=function(){o.idempty(O.callID),_t()},this.get_id=function(){return O.callID},this.get_name=function(){return B==null?"":B.Name},this.get_chartType=function(){return d.mainChart.type},this.get_parametres=function(){return d},this.settings_setdefaut=function(){B!=null&&(d.set=p(),d.paddingLeft=10,d.paddingRight=45,d.paddingTop=17,d.paddingBottom=20,this.set_screenSize())},this.settings_setAxis=function(e){var t=(d.set.fontSize-11)*4;e=="left"?(d.set.yaxis=!0,d.paddingLeft=45+t,d.paddingRight=10+t):(d.set.yaxis=!1,d.paddingLeft=10+t,d.paddingRight=45+t),o.idcss(ge("eod_mainchartinfos-"),"left",d.paddingLeft+2+"px"),o.clcss("infoindic","left",d.paddingLeft+5+"px"),o.idcss(ge("trace-"),"left",d.paddingLeft+"px"),Ee()},this.settings_setAxisLog=function(e){e?d.set.semilog=!0:(d.set.semilog=!1,delete d.logData),Ee()},this.settings_setSticky=function(e){d.set.nosticky=e,Ee()},this.settings_setHLSticky=function(e){d.set.nohighlow=e,Ee()},this.stop_events=function(){dt()},this.set_events=function(){ee()},this.settings_setNoVeilleIntra=function(e){if(d.set.noVeilleIntra=e,d.histoLength<=20){if(U.minX=0,U.maxX=B.QuoteTab.length-1,U.maxY=B.High,U.minY=B.Low,!d.set.noVeilleIntra){var t=B.qv.c;t>U.maxY&&(U.maxY=t),t<U.minY&&(U.minY=t)}Ee()}},this.settings_setTraceColor=function(e){B!=null&&(d.set.traceColor=e)},this.settings_setVeilleStyle=function(e){d.set.veilleStyle=e,Ee()},this.settings_setVeilleColor=function(e){d.set.veilleColor=e,Ee()},this.settings_getTraceColor=function(){return bt()},this.settings_setGridlineShow=function(e){d.set.gridLine=e,Ee()},this.settings_setGridlineH=function(e){d.set.gridH=e,Ee()},this.settings_setGridlineV=function(e){d.set.gridV=e,Ee()},this.settings_setSplitdayStyle=function(e){d.set.splitStyle=e,Ee()},this.settings_setSplitdayColor=function(e){d.set.splitColor=X(e,1),Ee()},this.settings_setGridColor=function(e){B!=null&&(d.set.gridColor=e,Ee())},this.settings_setCadreColor=function(e){B!=null&&(d.set.cadreColor=e,Ee())},this.settings_setReticuleColor=function(e){if(B!=null){d.set.reticColor=e;var t=o.gi(ge("overlay-")).getContext("2d");t.strokeStyle=d.set.reticColor}},this.settings_setEncadreShow=function(e){d.set.isEncadre=e,Ee()},this.settings_setBackColor=function(e){B!=null&&(d.set.bkcolor=e,o.idcss(ge("rodgraph-"),"background-color",e))},this.settings_setTextColor=function(e){B!=null&&(o.clcss("indicname","color",e),o.idcss(ge("eod_mainchartinfos-"),"color",e),o.idcss(ge("eod_topinfo-"),"color",e),d.set.txtColor=e,Ee())},this.updateQuoteEODrefresh=function(e){var t=B.QuoteTab[B.QuoteTab.length-1],a=t.d;d.chartPeriod==0?(t=e,t.d=a,B.QuoteTab[B.QuoteTab.length-1]=t):(e.h>t.h&&(t.h=e.h),e.l<t.l&&(t.l=e.l),t.c=e.c,t.v=e.v),Ee()},this.updateQuoteIntraRefresh=function(e){var t=B.QuoteTab.length-1,a=B.QuoteTab[t].d,i=0,l=e.qt;if(l==null)return!1;for(var s=U.maxY,n=U.minY,u=l.length,m=u-1;m>=0;m--)l[m].d>=a&&(l[m].d==a?B.QuoteTab[t]=l[m]:(B.QuoteTab.push(l[m]),i++),l[m].h>s&&(s=l[m].h),l[m].l<n&&(n=l[m].l),l[m].h>B.High&&(B.High=l[m].h),l[m].l<B.Low&&(B.Low=l[m].l));B.qd&&(B.qd.h=e.h,B.qd.l=e.l,B.qd.c=e.c,B.qd.v=e.v),U.maxY=s,U.minY=n,U.maxX=U.maxX+i,Ee()},this.stopGomme=function(){tr()},this.stopMZoom=function(){G()},this.zoom=function(e){J.flagSave=!0,We(),e?Pa(3):Ca(3)},this.order_show=function(e){We(),o.qsa("#"+O.callID+" .shorderzn").length>0?(Ia(),J.orders=null):To(e)},this.order_level=function(e,t){if(d.mainChart.type=="perf"){DisplayAlert("Le passage d'ordre n'est pas disponible en mode 'performance'");return}We(),Po(e,t)},this.tools_menu=function(e){if(B!=null)switch(e){case"g":if(z.length==0)return;dt(),Ko();break;case"r":je(),ee(),d.cursor="r";break;case"m":je(),ee(),d.cursor="m";break;case"z":dt(),P();break;case"b":dt(),d.cursor="b",ee();break;case"t":dt(),d.cursor="t",ee()}},this.setNews=function(e){B==null||d.mainChart.typedef.nolinearX||(e==null||e.length==0?(J.fiEvt=[],o.clrem(["svginfofi"]),delete d.newsConfig):d.newsConfig=e,We(),Ee())},this.addSearch=function(e){B==null||d.mainChart.typedef.nolinearX||e==null||(d.searchConfig=e,J.flagSave=!0,We(),Ee())},this.removeSearch=function(){B!=null&&(d.searchConfig="",Ee())},this.closeToolsParams=function(){J.flagSave=!0,We()},this.CloseTools=function(e){e||(J.flagSave=!0),We(!0)},this.saveTrace=function(){qa()},this.saveTraceFull=function(){var e=qa(!0),t=this.saveTemplate();return{Traces:e,Parametres:t.p,Layers:t.l,Symbol:d.symbol}},this.readTraceFull=function(e){if(e!=null){if(e.Symbol!=null&&(d.symbol=e.Symbol),e.Traces!=null){var t=e.Traces;Ne(d.symbol,JSON.parse(t)),VGP.drawings[d.symbol]=1,z=JSON.parse(t)}this.loadTemplate(e)}},this.readTrace=function(){Mr(!1,!0,!1)},this.screenCapture=function(e){var t,a,i,l,s,n,u,m,y,x,T,M,A;if(B!=null){if(J.flagSave=!0,We(),t=document.createElement("canvas"),t.id="canvasflatten",t.width=d.widthGraph,t.height=d.heightGraph,O.doc.parentNode.insertBefore(t,O.doc.nextSibling),a=t.getContext("2d"),a.fillStyle=d.set.bkcolor,a.fillRect(0,0,t.width,t.height),a.font="11px Arial",i=o.gi(ge("rodgraph-")),a.drawImage(i,0,0),a.drawImage(R[0].canvas,0,d.paddingTop),z.length==null||d.mainChart.type=="perf"||d.mainChart.typedef.nolinearX||(l=o.gi(ge("trace-")),a.drawImage(l,d.paddingLeft,d.paddingTop)),!d.mainChart.typedef.nolinearX)for(s=1;s<R.length;s++)a.drawImage(R[s].canvas,0,R[s].RealY),a.fillStyle=R[s].Indicator.color,n=R[s].Indicator.type.toUpperCase(),R[s].Indicator.param1!=null&&(n+=" ("+R[s].Indicator.param1,R[s].Indicator.param2!=null&&(n+=", "+R[s].Indicator.param2,R[s].Indicator.param3!=null&&(n+=", "+R[s].Indicator.param3)),n+=")"),a.fillText(n,d.paddingLeft+5,R[s].RealY+13);if(a.fillStyle="#808080",e=e!=null?" - "+e:"",a.fillText(B.Name.toUpperCase()+e,d.paddingLeft,13),m=document.querySelector(".eod_topinfo span:last-child"),m!=null&&(u=m.textContent),y=a.measureText(u).width,a.fillText(u,d.widthGraph-d.paddingRight-y,13),!d.mainChart.typedef.nolinearX)for(x=d.paddingLeft+5,s=0;s<d.mainChart.indicators.length;s++)T=d.mainChart.indicators[s],a.fillStyle=T.color,M="",T.param1!=null&&(M+=" ("+T.param1,T.param2!=null&&(M+=", "+T.param2),M+=")"),M=T.type=="compare"?T.datas2?T.datas2.Name:"NC":T.type.toUpperCase()+M,a.fillText(M,x,d.paddingTop+12),x+=a.measureText(M).width+15;return A=t.toDataURL("image/png"),A=A.replace("data:image/png;base64,",""),o.idrem("canvasflatten"),A}},this.daysToDate=function(e,t){return d.histoLength<=20?I(e):Z(e,t)},this.trace_menu=function(e){if(B!=null&&!d.mainChart.typedef.nolinearX)switch(dt(),e){case"ewi":za(e,6);break;case"ewc":za(e,4);break;case"t":case"wf":za(e,3);break;case"a":Zo();break;case"fa":zo();break;case"arrup":case"arrdw":case"arrrt":case"arrlt":case"sm1":case"sm2":case"sm3":Jo(e);break;case"p":sl();break;case"rf":case"r":case"m":al(e);break;case"e":z=[],L()&&(d.chartPeriod<0?sessionStorage.removeItem(d.symbol):(localStorage.removeItem(d.symbol),VGP.noAutoSaveTrace||(Ha(),delete VGP.drawings[d.symbol]))),De(),ee();break;default:cl(e)}},this.compare=function(e){var t,a,i,l,s;if(B!=null&&!d.mainChart.typedef.nolinearX&&d.mainChart.type!="perf"){for(a=d.mainChart.indicators.length,i=0,t=0;t<a;t++)d.mainChart.indicators[t].type=="compare"&&i++;if(i>=4){DisplayAlert("Vous avez atteint le maximum de valeurs en comparaison");return}l=VGP.urlWS+"GetTicksEOD",VGP.callType=="GET"&&(l=l+"?symbol="+e+"&length="+d.histoLength+"&period="+d.chartPeriod+"&guid="+o.gigt("guid")),s=new XMLHttpRequest,s.open(VGP.callType,l,!0),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.onload=function(){var n,u;if(s.status>=200&&s.status<400)if(n=JSON.parse(s.responseText),n!=null&&n.d!=null){switch(u=j("compare"),i){case 1:u.color="rgba(0,128,0,1)";break;case 2:u.color="rgba(0,95,192,1)";break;case 3:u.color="rgba(127,0,255,1)"}u.datas2=n.d,u.symbol=e,d.mainChart.indicators.push(u),d.isCompare=!0,ha(B.High,B.Low,B.QuoteTab[0].c),Be(0)}else return},s.send(JSON.stringify({symbol:e,length:d.histoLength,period:d.chartPeriod,guid:o.gigt("guid")}))}},yt.prototype.Create=function(){this.canvas=document.createElement("canvas"),this.canvas.width=d.widthGraph,this.canvas.height=this.HeightPx,this.canvas.style.top=this.RealY+"px",this.canvas.id=this.id,O.doc.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),R.push(this)},yt.prototype.Resize=function(e,t,a){this.Y=e,this.RealY=Math.round(e*d.usableHeight)+d.paddingTop+a,this.Height=t,this.HeightPx=Math.round(t*d.usableHeight),this.canvas.style.top=this.RealY+"px",this.canvas.height=this.HeightPx},yt.prototype.Move=function(e,t,a){this.RealY=e,this.HeightPx=this.HeightPx+t,this.Y=(this.RealY-d.paddingTop-d.marginInter*a)/d.usableHeight,this.Height=this.HeightPx/d.usableHeight,this.canvas.style.top=this.RealY+"px",this.canvas.height=this.HeightPx},yt.prototype.DrawEncadre=function(){this.ctx.clearRect(0,0,d.widthGraph,this.HeightPx),d.set.isEncadre&&(this.ctx.strokeStyle=d.set.cadreColor,this.ctx.strokeRect(d.paddingLeft+.5,.5,d.innerWidth,this.HeightPx-1))}},window.RODGraph=h})(),Re=function(){return{move:function(j,r,f){j.style.left=r+"px",j.style.top=f+"px"},startMoving:function(j,r,f){var L,c;if(f.target.className!="linemodif")return!1;f=f||window.event;var v=f.clientX,p=f.clientY,o=j.style.top,h=j.style.left,g=j.clientWidth,_=j.clientHeight,C=document.getElementById(r).clientWidth,P=document.getElementById(r).clientHeight;o=o.replace("px",""),h=h.replace("px",""),L=v-h,c=p-o,document.onmousemove=function(G){G=G||window.event;var H=G.clientX,$=G.clientY,ue=H-L,ee=$-c;ue<10&&(ue=10),ee<18&&(ee=18),ue+g>C-6&&(ue=C-g-6),ee+_>P+12&&(ee=P-_+12),Re.move(j,ue,ee)}},stopMoving:function(){document.onmousemove=function(){}}}}(),te=new function(){function j(r){var f=function(rt){return rt-Math.floor(rt)},L=r.getJulian(),c=r.getFullYear(),v=3.14159265/180,p,o,h,g,_,C,P,G,H,$,ue,ee;for(p=Math.floor((c-1900)*12.3685),o=(c-1899.5)/100,h=o*o,g=o*o*o,_=2415020+29*p,C=1178e-7*h-155e-9*g+(.75933+.53058868*p)-(837e-6*o+335e-6*h),P=360*f(p*.08084821133)+359.2242-333e-7*h-347e-8*g,G=360*f(p*.07171366128)+306.0253+.0107306*h+1236e-8*g,H=360*f(p*.08519585128)+21.2964-.0016528*h-239e-8*g,ue=0,ee=0;ee<L;){var me=C+1.530588*ue,Te=(P+ue*29.10535608)*v,ye=(G+ue*385.81691806)*v,ke=(H+ue*390.67050646)*v;me-=.4068*Math.sin(ye)+(.1734-393e-6*o)*Math.sin(Te),me+=.0161*Math.sin(2*ye)+.0104*Math.sin(2*ke),me-=.0074*Math.sin(Te-ye)-.0051*Math.sin(Te+ye),me+=.0021*Math.sin(2*Te)+.001*Math.sin(2*ke-ye),me+=.5/1440,$=ee,ee=_+28*ue+Math.floor(me),ue++}return(L-$)/29.53059}this.computeMovingAverage=function(r,f,L){for(var c=[],v=r.length,p=0,o=0;o<v;o++)o<f?(p=p+N(r[o],L),c[o]={d:r[o].d,v1:p/(o+1)}):(p=p+N(r[o],L)-N(r[o-f],L),c[o]={d:r[o].d,v1:p/f});return{Values:c}},this.computeFR=function(r,f){for(var L=[],c=r.length,v=f.length,p=0,o=-100,h,g=0,_=999999,C=[],P=0;P<v;P++)C[f[P].d]=f[P];for(P=0;P<c;P++)C[r[P].d]!=null&&(o==-100?(o=r[P].c,h=C[r[P].d].c):(p=((r[P].c-o)/o-(C[r[P].d].c-h)/h)*100,p>g&&(g=p),p<_&&(_=p))),L[P]={d:r[P].d,v1:p};return{High:g,Low:_,Values:L}},this.computeCMO=function(r,f){var L=[],c=r.length,v,p=0,o=0,h=[],g;for(h[0]=0,v=1;v<c;v++)h[v]=(r[v].c-r[v-1].c)*100/r[v-1].c;for(L[0]={d:r[0].d,v1:0},v=1;v<c;v++)v<f?h[v]>=0?p=p+h[v]:o=o-h[v]:h[v]>=0?(p=p+h[v],h[v-f]>=0?p=p-h[v-f]:o=o+h[v-f]):(o=o-h[v],h[v-f]>=0?p=p-h[v-f]:o=o+h[v-f]),g=100*(p-o)/(p+o),g=isNaN(g)?0:g,L[v]={d:r[v].d,v1:g};return{High:100,Low:-100,Values:L}},this.computeHighLow=function(r,f){var L=r.length,c,v,p,o,h;if(L<f)return null;for(h=[],c=0;c<f;c++)h[c]={d:r[c].d,v1:0,v2:0};for(c=f;c<L;c++){for(p=0,o=9999999,v=1;v<f&&!(c-v<0);v++)r[c-v].h>p&&(p=r[c-v].h),r[c-v].l<o&&(o=r[c-v].l);h[c]=p<r[c].h?{d:r[c].d,v1:r[c].h,v2:0}:o>r[c].l?{d:r[c].d,v1:0,v2:r[c].l}:{d:r[c].d,v1:0,v2:0}}return{Values:h}},this.computeSupertrend=function(r,f,L){var c=[],v=r.length,p,o,h,g,_,C=this.computeATR(r,f,"pma"),P;if(C==null)return!1;for(h=(r[0].h+r[0].l)/2,p=h+L*C.Values[0].v1,o=h-L*C.Values[0].v1,c[0]={d:r[0].d,v1:p,v2:o},P=[],P[0]={u:p,d:o},_=1;_<v;_++)h=(r[_].h+r[_].l)/2,p=h+L*C.Values[_].v1,o=h-L*C.Values[_].v1,P[_]={u:p,d:o};for(_=1;_<v;_++)r[_].c>P[_-1].u?g=1:r[_].c<P[_-1].d&&(g=-1),g==-1?(P[_].u>P[_-1].u&&(P[_].u=P[_-1].u),c[_]={d:r[_].d,v1:P[_].u,v2:0}):(P[_].d<P[_-1].d&&(P[_].d=P[_-1].d),c[_]={d:r[_].d,v1:0,v2:P[_].d});return{Values:c}},this.computeVolume=function(r,f,L){var c=[],v=0,p=9999999999999,o=r.length,h,g;for(g=L?r[0].v*r[0].c:r[0].v,c[0]={d:r[0].d,v1:g},f.minX<=0&&(g>v&&(v=g),g<p&&(p=g)),h=1;h<o;h++)g=L?r[h].v*r[h].c:r[h].v,c[h]=r[h].c-r[h-1].c>=0?{d:r[h].d,v1:g}:{d:r[h].d,v2:g},h>=f.minX&&h<=f.maxX&&(g>v&&(v=g),g<p&&(p=g));return{High:v,Low:p,Values:c}},this.computeBollingerBandwith=function(r,f,L,c){for(var v=r.length,p=0,o=999999,h=[],g=this.computeBollinger(r,f,L,c),_=this.computeMovingAverage(r,f,c),C=0,P=0;P<v;P++)C=(g.Values[P].v1-g.Values[P].v2)*100/_.Values[P].v1,h[P]={d:r[P].d,v1:C},C>p&&(p=C),C<o&&(o=C);return{High:p,Low:o,Values:h}},this.computeVortex=function(r,f){var L=r.length,c;if(L<f+2)return null;var v=[],p=[],o=0,h=999999,g=[];for(v[0]={p:Math.abs(r[0].h-r[0].l),m:Math.abs(r[0].l-r[0].h)},p[0]=r[0].h-r[0].l,c=1;c<L;c++)v[c]={p:Math.abs(r[c].h-r[c-1].l),m:Math.abs(r[c].l-r[c-1].h)},p[c]=Math.max(r[c].h-r[c].l,Math.abs(r[c].h-r[c-1].c),Math.abs(r[c].l-r[c-1].c));var _=0,C=0,P=0,G,H;for(c=0;c<L;c++)c<f?(C=C+v[c].p,_=_+v[c].m,P=P+p[c],G=_/(c+1)/P,H=C/(c+1)/P):(C=C+v[c].p-v[c-f].p,_=_+v[c].m-v[c-f].m,P=P+p[c]-p[c-f],G=_/f/P,H=C/f/P,H>o&&(o=H),H<h&&(h=H),G>o&&(o=G),G<h&&(h=G)),g[c]={d:r[c].d,v1:H,v2:G};for(c=0;c<f;c++)g[c]={d:r[c].d,v1:g[f].v1,v2:g[f].v2};return{High:o,Low:h,Values:g}},this.computeMFI=function(r,f){var L=r.length,c=[],v=[],p,o=[];for(o[0]={p:0,n:0},v[0]=(r[0].h+r[0].l+r[0].c)/3,p=1;p<L;p++)v[p]=(r[p].h+r[p].l+r[p].c)/3,o[p]=v[p]>=v[p-1]?{p:v[p]*r[0].v,n:0}:{p:0,n:v[p]*r[0].v};var h=0,g=0,_=[];for(p=0;p<L;p++)p<f?(h=h+o[p].p,g=g+o[p].n,_[p]={p:h/(p+1),n:g/(p+1)}):(h=h+o[p].p-o[p-f].p,g=g+o[p].n-o[p-f].n,_[p]={p:h/f,n:g/f}),c[p]=_[p].n==0?{d:r[p].d,v1:0}:{d:r[p].d,v1:100-100/(1+_[p].p/_[p].n)};return{High:100,Low:0,Values:c}},this.computeOBV=function(r){var f=-1e5,L=9999999999,c=r.length,v=[],p,o=0,h;for(v[0]={d:r[0].d,v1:0},p=1;p<c;p++)r[p].c>r[p-1].c&&(o=o+r[p].v),r[p].c<r[p-1].c&&(o=o-r[p].v),h=o/1e3,v[p]={d:r[p].d,v1:h},h>f&&(f=h),h<L&&(L=h);return{High:f,Low:L,Values:v}},this.computeAccDist=function(r){var f=[],L=-1e6,c=9999999999,v=r.length,p=0,o,h;for(f[0]={d:r[0].d,v1:0},o=1;o<v;o++)h=r[o].h-r[o].l,h!=0&&(p=p+(r[o].c-r[o].l-(r[o].h-r[o].c))*(r[o].v/1e3)/h),f[o]={d:r[o].d,v1:p},p>L&&(L=p),p<c&&(c=p);return{High:L,Low:c,Values:f}},this.computeBollinger=function(r,f,L,c){for(var v=[],p=r.length,o=this.computeMovingAverage(r,f,c),h=[],g,_,C=0,P,G,H,$,ue,ee,me=0;me<p;me++)g=N(r[me],c),me<f?(C=C+g*g,h[me]=C*f/(me+1)):(_=N(r[me-f],c),C=C+g*g-_*_,h[me]=C);for(P=[],G=0,me=0;me<p;me++)g=N(r[me],c),me<f?(G=G+g,H=G*f/(me+1),P[me]=H*H):(_=N(r[me-f],c),G=G+g-_,P[me]=G*G);for(ue=f*(f-1),me=0;me<p;me++)ee=f*h[me]-P[me],$=ee<0?0:Math.pow(ee/ue,.5)*L,v[me]={d:r[me].d,v1:o.Values[me].v1+$,v2:o.Values[me].v1-$};return{Values:v}},this.computeBollingerB=function(r,f,L,c){for(var v=this.computeBollinger(r,f,L,c),p=[],o=v.Values.length,h=0,g=100,_,C,P=0;P<o;P++)C=v.Values[P].v1-v.Values[P].v2,C==0&&(C=1),_=100*(N(r[P],c)-v.Values[P].v2)/C,p[P]={d:r[P].d,v1:_},_>h&&(h=_),_<g&&(g=_);return{High:h,Low:g,Values:p}},this.computeDMI=function(r,f,L){var c=[],v=r.length,p=0,o,h,g,_;if(v<f*2)return null;var C=[],P=[],G=[],H=[],$=0,ue=0,ee=0,me=[],Te=[],ye=[];for(C[0]={p:0,m:0},P[0]=1,o=1;o<v;o++)h=r[o].h-r[o-1].h,g=r[o-1].l-r[o].l,P[o]=Math.max(Math.abs(r[o].h-r[o].l),Math.abs(r[o].h-r[o-1].c),Math.abs(r[o].l-r[o-1].c)),C[o]=h>g?{p:Math.max(0,h),m:0}:{p:0,m:0},g>h&&(C[o].m=Math.max(0,g));for(o=1;o<=f;o++)ee=ee+P[o],$=$+C[o].p,ue=ue+C[o].m;for(G[f]=ee,H[f]={p:$,m:ue},me[f]={p:H[f].p*100/G[f],m:H[f].m*100/G[f]},Te[f]=100*(Math.abs(H[f].p-H[f].m)/(H[f].p+H[f].m)),ye[f]=Te[f],c[f]=L=="dmi"?{d:r[f].d,v1:me[f].p,v2:me[f].m,v3:ye[f]}:{d:r[f].d,v1:ye[f],v2:ye[f]},o=f+1;o<v;o++)G[o]=G[o-1]-G[o-1]/f+P[o],$=H[o-1].p-H[o-1].p/f+C[o].p,ue=H[o-1].m-H[o-1].m/f+C[o].m,H[o]={p:$,m:ue},me[o]={p:H[o].p*100/G[o],m:H[o].m*100/G[o]},Te[o]=100*(Math.abs(H[o].p-H[o].m)/(H[o].p+H[o].m)),ye[o]=(ye[o-1]*(f-1)+Te[o])/f,L=="dmi"&&(me[o].p>p&&(p=me[o].p),me[o].m>p&&(p=me[o].m),c[o]={d:r[o].d,v1:me[o].p,v2:me[o].m,v3:ye[o]}),ye[o]>p&&(p=ye[o]);if(p>100&&(p=90),L=="dmi")for(_=(c[f+1].v1+c[f+1].v2+c[f+1].v3)/3,o=0;o<=f;o++)c[o]={d:r[o].d,v1:_,v2:_,v3:_};if(L=="adx"&&v>f*2){for(o=f+1;o<f*2;o++)c[o]={d:r[o].d,v1:ye[o],v2:(ye[f]+ye[o])/2};for(o=f*2;o<v;o++)c[o]={d:r[o].d,v1:ye[o],v2:(ye[o-f]+ye[o])/2};for(o=0;o<=f;o++)c[o]={d:r[o].d,v1:c[f].v1,v2:c[f].v2}}return{High:p,Low:0,Values:c}},this.computeLinearCurve=function(r,f,L,c){var v=[],p=r.length,o,h,g,_,C,P,G,H;if(p<=f)return null;if(L==1)for(o=0;o<=f;o++)v[o]={d:r[o].d,v1:N(r[o],c)};else for(o=0;o<=f;o++)v[o]={d:r[o].d,v1:0};for(g=-100,_=100,o=p-1;o>f;o--){var $=0,ue=0,ee=0,me=0;for(h=f;h>=1;h--)P=N(r[o-(f-h)],c),$+=h*P,ue+=h,ee+=P,me+=h*h;H=($*f-ue*ee)/(f*me-ue*ue),G=(ee-H*ue)/f,L==1?v[o]={d:r[o].d,v1:G+H*f}:(C=N(r[o],c)-(G+H*f),C>g&&(g=C),C<_&&(_=C),v[o]={d:r[o].d,v1:C})}return L==1?{Values:v}:{High:g,Low:_,Values:v}},this.computeUlcerIndex=function(r,f,L){for(var c=[],v=0,p=r.length,o,h=0,g=[],_,C,P,G=0;G<p;G++){for(o=0;o<f&&!(G-o<0);o++)N(r[G-o],L)>h&&(h=N(r[G-o],L));_=(N(r[G],L)-h)/h*100,g[G]={d:r[G].d,c:_*_},h=0}for(P=this.computeMovingAverage(g,f,"c"),G=0;G<p;G++)C=Math.pow(P.Values[G].v1,.5),c[G]={d:r[G].d,v1:C},C>v&&(v=C);return{High:v,Low:0,Values:c}},this.computeCCI=function(r,f){for(var L=[],c=r.length,v=0,p=0,o=[],h=0,g,_,C,P,G,H,$,ue,ee=0;ee<c;ee++)o[ee]=(r[ee].h+r[ee].l+r[ee].c)/3;for(g=[],ee=0;ee<c;ee++)ee<f?(h=h+o[ee],g[ee]=h/(ee+1)):(h=h+o[ee]-o[ee-f],g[ee]=h/f);for(_=[],C=0,ee=0;ee<c;ee++)P=o[ee],ee<f?(C=C+P*P,_[ee]=C*f/(ee+1)):(G=o[ee-f],C=C+P*P-G*G,_[ee]=C);for(H=[],$=0,ee=0;ee<c;ee++)P=o[ee],ee<f?($=$+P,ue=$*f/(ee+1),H[ee]=ue*ue):(G=o[ee-f],$=$+P-G,H[ee]=$*$);L[0]={d:r[0].d,v1:0};var me=[],Te=0,ye=f*(f-1);for(ee=1;ee<c;ee++)P=f*_[ee]-H[ee],me[ee]=P<0?0:Math.pow(P/ye,.5),Te=(o[ee]-g[ee])/(.015*me[ee]),L[ee]={d:r[ee].d,v1:Te},Te>v&&(v=Te),Te<p&&(p=Te);return{High:v,Low:p,Values:L}},this.computeMM=function(r,f){for(var L=r.length,c=0,v=0;v<L;v++)v<f?(c=c+r[v].v1,r[v].vm=c/(v+1)):(c=c+r[v].v1-r[v-f].v1,r[v].vm=c/f);return r},this.computeMMonVolume=function(r,f){for(var L=r.length,c=0,v,p,o=0;o<L;o++)o<f?(c=c+(r[o].v1||r[o].v2),r[o].vm=c/(o+1)):(v=r[o].v1!=null?r[o].v1:r[o].v2,p=r[o-f].v1!=null?r[o-f].v1:r[o-f].v2,c=c+v-p,r[o].vm=c/f);return r},this.computeUltimateOsc=function(r,f,L,c){var v=[],p=r.length,o,h,g=[],_=[],C;for(g[0]=r[0].c-r[0].l,_[0]=r[0].h-r[0].l,o=1;o<p;o++)C=Math.min(r[o].l,r[o-1].c),g[o]=r[o].c-C,_[o]=Math.max(r[o].h,r[o-1].c)-C;var P=[],G=[],H=[],$,ue;for(o=0;o<p;o++){for($=0,ue=0,h=0;h<f&&!(o-h<0);h++)$=$+g[o-h],ue=ue+_[o-h];P[o]=$/ue}for(o=0;o<p;o++){for($=0,ue=0,h=0;h<L&&!(o-h<0);h++)$=$+g[o-h],ue=ue+_[o-h];G[o]=$/ue}for(o=0;o<p;o++){for($=0,ue=0,h=0;h<c&&!(o-h<0);h++)$=$+g[o-h],ue=ue+_[o-h];H[o]=$/ue}for(o=0;o<p;o++)v[o]={d:r[o].d,v1:100*(4*P[o]+2*G[o]+H[o])/7};return{High:95,Low:5,Values:v}},this.computeDI=function(r,f){var L,c,v,p,o;if(r.length<f*2+2)return null;for(var h=[],g=[],_=r.length,C=[],P=[],G=[],H=[],$=[],ue=[],ee=[],me=[],Te=[],ye=[],ke=[],rt=[],nt=80,lt=-80,se=0;se<_;se++)g[se]=(r[se].h+r[se].l+r[se].c*2)/4;for(C[0]={d:r[0].d,c:0},se=1;se<_;se++)C[se]={d:r[se].d,c:Math.max(r[se-1].c,r[se].h)-Math.min(r[se-1].c,r[se].l)},G[se]=(g[se]-g[se-1])/Math.min(g[se-1],g[se]);for(P=this.computeMovingAverage(C,f),L=0,se=0;se<f;se++)L+=r[se].v;for(H[f-1]=L/f,se=f;se<_;se++)H[se]=(H[se-1]*(f-1)+r[se].v)/f;for(se=f-1;se<_;se++)$[se]=r[se].v/H[se];for(se=f;se<_;se++)c=g[se]*3/P.Values[se].v1*Math.abs(G[se]),ue[se]=c>88?88:c,ee[se]=$[se]/Math.exp(ue[se]),me[se]=G[se]>0?$[se]:ee[se],Te[se]=G[se]<0?$[se]:ee[se];for(v=0,p=0,se=f;se<f*2;se++)v+=me[se],p+=Te[se];for(ye[f*2-1]=p/f,ke[f*2-1]=v/f,se=f*2;se<_;se++)ye[se]=(ye[se-1]*(f-1)+Te[se])/f,ke[se]=(ke[se-1]*(f-1)+me[se])/f,rt[se]=ye[se]>ke[se]?-ke[se]/ye[se]:ye[se]/ke[se],o=rt[se]<0?(-1-rt[se])*100:(1-rt[se])*100,o>nt&&(nt=o),o<lt&&(lt=o),h[se]={d:r[se].d,v1:o};for(se=0;se<f*2;se++)h[se]={d:r[se].d,v1:0};return{High:nt,Low:lt,Values:h}},this.computeKST=function(r,f,L,c,v,p){for(var o=[],h=r.length,g=0,_=999999,C=this.computeROC(r,f,null,p),P=this.computeROC(r,L,null,p),G=this.computeROC(r,c,null,p),H=this.computeROC(r,v,null,p),$=this.computeMM(C.Values,10),ue=this.computeMM(P.Values,10),ee=this.computeMM(G.Values,10),me=this.computeMM(H.Values,15),Te=[],ye,ke=0;ke<h;ke++)Te[ke]={v1:$[ke].vm+ue[ke].vm*2+ee[ke].vm*3+me[ke].vm*4},Te[ke].v1>g&&(g=Te[ke].v1),Te[ke].v1<_&&(_=Te[ke].v1);for(ye=this.computeMM(Te,9),ke=0;ke<h;ke++)o[ke]={d:r[ke].d,v1:Te[ke].v1,v2:ye[ke].vm};return{High:g,Low:_,Values:o}},this.computeZigZag=function(r,f,L){var c=[],v=r.length,p,o=0,h,g=N(r[0],L),_=r[0].d,C,P;for(c[0]={d:r[0].d,v1:g},C="h",p=0;p<v;p++)P=N(r[p],L),h=(P-g)/g,C=="h"?h>0?(g=P,_=r[p].d,o=p):Math.abs(h)>=f&&(c[o]={d:_,v1:g},g=P,_=r[p].d,C="b",o=p):h<0?(g=P,_=r[p].d,o=p):Math.abs(h)>=f&&(c[o]={d:_,v1:g},g=P,_=r[p].d,C="h",o=p);return c[v-1]={d:r[v-1].d,v1:r[v-1].c},{Values:c}},this.computeMovingAverageT=function(r,f,L){f=Math.round((f+1)/2);for(var c=this.computeMovingAverage(r,f,L),v=[],p=c.Values.length,o=0,h=0;h<p;h++)h<f?(o=o+c.Values[h].v1,v[h]={d:c.Values[h].d,v1:o/(h+1)}):(o=o+c.Values[h].v1-c.Values[h-f].v1,v[h]={d:c.Values[h].d,v1:o/f});return{Values:v}},this.computeEVMM=function(r,f,L,c){var v=[],p=r.length,o,h=0;for(L=L/100,o=0;o<p;o++)o<f?(h=h+N(r[o],c),v[o]={d:r[o].d,v1:h/(o+1)*(1+L),v2:h/(o+1)*(1-L)}):(h=h+N(r[o],c)-N(r[o-f],c),v[o]={d:r[o].d,v1:h/f*(1+L),v2:h/f*(1-L)});return{Values:v}},this.computeDPO=function(r,f){var L=[],c,v=0,p=9999,o,h=r.length,g,_;if(f+1>h)return null;for(o=this.computeMovingAverage(r,f),_=Math.round(f/2-1),_<1&&(_=1),c=0;c<_;c++)L[c]={d:r[c].d,v1:0};for(c=_;c<h;c++)g=r[c].c-o.Values[c-_].v1,g>v&&(v=g),g<p&&(p=g),L[c]={d:r[c].d,v1:g};return{High:v,Low:p,Values:L}},this.computeCMF=function(r,f){var L=[],c=r.length,v,p,o,h=0,g,_=0,C=9999,P;for(L[0]={d:r[0].d,v1:0},v=1;v<c;v++){for(h=0,o=0,p=0;p<f&&!(v-p<0);p++)P=r[v-p].h-r[v-p].l,P!=0&&(o=o+r[v-p].v*(r[v-p].c-r[v-p].l-(r[v-p].h-r[v-p].c))/P),h=h+r[v-p].v;g=o/h,g>_&&(_=g),g<C&&(C=g),L[v]={d:r[v].d,v1:g}}return{High:_,Low:C,Values:L}},this.computeBOP=function(r){var f=[],L=r.length,c,v,p,o;for(p=r[0].h-r[0].l,o=p!=0?(r[0].c-r[0].o)/p:0,f[0]=o<0?{d:r[0].d,v2:o}:{d:r[0].d,v1:o},c=1;c<L;c++)p=r[c].h-r[c].l,v=p!=0?(r[c].c-r[c].o)/p:0,f[c]=v>=0&&o>=0?v>=o?{d:r[c].d,v1:v}:{d:r[c].d,v3:v}:v<0&&o<0?v<=o?{d:r[c].d,v2:v}:{d:r[c].d,v3:v}:v<0?{d:r[c].d,v2:v}:{d:r[c].d,v1:v},o=v;return{High:1.2,Low:-1.05,Values:f}},this.computeAwesomeIndicator=function(r,f,L){for(var c=[],v=r.length,p=[],o,h,g=0;g<v;g++)o=(r[g].h+r[g].l)/2,p[g]={d:r[g].d,c:o};var _=this.computeMovingAverage(p,f,"c"),C=this.computeMovingAverage(p,L,"c"),P,G=0,H=99999;for(P=_.Values[0].v1-C.Values[0].v1,c[0]={d:r[0].d,v1:P},h=P,g=1;g<v;g++)P=_.Values[g].v1-C.Values[g].v1,P>G&&(G=P),P<H&&(H=P),c[g]=P>=h?{d:r[g].d,v1:P}:{d:r[g].d,v2:P},h=P;return{High:G,Low:H,Values:c}},this.computeGMMA=function(r){for(var f=[],L=[],c,v=r.length,p=[3,5,8,10,12,15,30,35,40,45,50,60],o=p.length,h=0;h<o;h++)L[h]=this.computeMovingAverageE(r,p[h]);for(h=0;h<v;h++)for(f[h]={d:r[h].d},c=0;c<12;c++)f[h]["v"+(c+1)]=L[c].Values[h].v1;return{Values:f}},this.computeAlligator=function(r,f,L,c){var v=[],p=r.length,o,h=0,g=[],_=[],C=[],P=0,G=Math.max(f,L,c);if(p<G+1||G<13)return null;for(o=0;o<f;o++)h=h+N(r[o],"m"),g[o]=h/(o+1);for(P=h,o=f;o<p;o++)P=P+N(r[o],"m")-g[o-1],g[o]=P/f;for(h=0,o=0;o<L;o++)h=h+N(r[o],"m"),_[o]=h/(o+1);for(P=h,o=L;o<p;o++)P=P+N(r[o],"m")-_[o-1],_[o]=P/L;for(h=0,o=0;o<c;o++)h=h+N(r[o],"m"),C[o]=h/(o+1);for(P=h,o=c;o<p;o++)P=P+N(r[o],"m")-C[o-1],C[o]=P/c;for(o=G;o<p;o++)v[o]={d:r[o].d,v1:g[o-8],v2:_[o-5],v3:C[o-3]};return{Values:v}},this.computeMovingAverageHull=function(r,f,L){var c=[],v=r.length,p,o=Math.floor(f/2),h,g;o<1&&(o=1),h=Math.floor(Math.sqrt(f)),h<1&&(h=1);var _=this.computeMovingAverageP(r,o,L),C=this.computeMovingAverageP(r,f,L),P=[];for(p=0;p<v;p++)P[p]={d:_.Values[p].d,c:2*_.Values[p].v1-C.Values[p].v1};return g=this.computeMovingAverageP(P,h),c=g.Values,{Values:c}},this.computeMovingAverageP=function(r,f,L){var c=[],v=r.length,p,o,h,g,_;for(c[0]={d:r[0].d,v1:N(r[0],L)},p=1;p<v;p++){for(h=0,o=0;o<f&&!(p-o<0);o++)_=N(r[p-o],L),h=p<f?h+(p-o+1)*_:h+(f-o)*_;g=(o+1)*o*.5,c[p]={d:r[p].d,v1:h/g}}return{Values:c}},this.computeMovingAverageE=function(r,f,L){var c=[],v=r.length,p;c[0]={d:r[0].d,v1:N(r[0],L)};var o=N(r[0],L),h=2/(f+1),g=1-h;for(p=1;p<v;p++)o=N(r[p],L)*h+o*g,c[p]={d:r[p].d,v1:o};return{Values:c}},this.computeDoubleEMA=function(r,f,L){var c=this.computeMovingAverageE(r,f,L),v=[],p=c.Values.length,o,h,g;for(v[0]={d:c.Values[0].d,v1:c.Values[0].v1},h=c.Values[0].v1,g=2/(f+1),o=1;o<p;o++)h=c.Values[o].v1*g+h*(1-g),v[o]={d:c.Values[o].d,v1:2*c.Values[o].v1-h};return{Values:v}},this.computeTripleEMA=function(r,f,L){var c=this.computeMovingAverageE(r,f,L),v=[],p=c.Values.length,o;v[0]={d:c.Values[0].d,v1:c.Values[0].v1};var h=c.Values[0].v1,g=c.Values[0].v1,_=2/(f+1);for(o=1;o<p;o++)h=c.Values[o].v1*_+h*(1-_),g=h*_+g*(1-_),v[o]={d:c.Values[o].d,v1:3*c.Values[o].v1-3*h+g};return{Values:v}},this.computeTSI=function(r,f,L,c){var v=[],p=r.length,o,h=-100,g=100,_,C,P,G,H,$,ue,ee,me,Te,ye;if(p<L)return null;for(_=[],_[0]=0,o=1;o<p;o++)_[o]=r[o].c-r[o-1].c;for(C=_[0],P=[],P[0]=C,G=2/(L+1),o=1;o<p;o++)C=_[o]*G+C*(1-G),P[o]=C;for(C=P[0],H=[],H[0]=C,$=2/(f+1),o=1;o<p;o++)C=P[o]*$+C*(1-$),H[o]=C;for(C=Math.abs(_[0]),ue=[],ue[0]=C,o=1;o<p;o++)C=Math.abs(_[o])*G+C*(1-G),ue[o]=C;for(C=ue[0],ee=[],ue[0]=C,o=1;o<p;o++)C=ue[o]*$+C*(1-$),ee[o]=C;for(me=[],me[0]=0,o=1;o<p;o++)me[o]=100*H[o]/ee[o];for(o=15;o<p;o++)me[o]>h&&(h=me[o]),me[o]<g&&(g=me[o]);for(Te=[],C=me[0],Te[0]=C,ye=2/(c+1),o=1;o<p;o++)C=me[o]*ye+C*(1-ye),Te[o]=C;for(o=0;o<15;o++)v[o]={d:r[o].d,v1:0,v2:0};for(o=15;o<p;o++)v[o]={d:r[o].d,v1:me[o],v2:Te[o]};return{High:h,Low:g,Values:v}},this.computeMassIndex=function(r,f){var L=[],c=r.length,v=[],p,o,h=0,g=9999,_,C,P,G,H;if(c<9||c<f)return null;for(p=0;p<c;p++)v[p]=r[p].h-r[p].l;for(_=v[0],C=[],C[0]=_,p=1;p<c;p++)_=v[p]*.2+_*.8,C[p]=_;for(_=C[0],P=[],P[0]=_,p=1;p<c;p++)_=C[p]*.2+_*.8,P[p]=_;for(G=[],p=0;p<c;p++)G[p]=C[p]/P[p];for(H=0,p=0;p<c;p++){for(H=0,o=0;o<f;o++){if(p-o<0){H=H*f/o;break}H+=G[p-o]}H>h&&(h=H),H<g&&(g=H),L[p]={d:r[p].d,v1:H}}return{High:h,Low:g,Values:L}},this.computeRSI=function(r,f,L){var c;if(f<2)return null;var v=[],p=r.length,o,h,g=[],_=[],C,P;for(g[0]={h:0,b:0},_[0]={mmh:0,mmb:0},v[0]={d:r[0].d,v1:50},c=f-1,h=1;h<p;h++)o=N(r[h],L)-N(r[h-1],L),g[h]=o==0?{h:0,b:0}:o>0?{h:o,b:0}:{h:0,b:o*-1},C=(_[h-1].mmh*c+g[h].h)/f,P=(_[h-1].mmb*c+g[h].b)/f,_[h]={mmh:C,mmb:P},v[h]=P==0?{d:r[h].d,v1:100}:{d:r[h].d,v1:100-100/(1+C/P)};return{High:100,Low:0,Values:v}},this.computeForceIndex=function(r,f,L){var c=r.length,v=[],p=-9999,o=9999,h,g,_;for(v[0]={d:r[0].d,c:0},h=1;h<c;h++)v[h]={d:r[h].d,c:r[h].v*(N(r[h],L)-N(r[h-1],L))};for(g=this.computeMovingAverageE(v,f,"c"),_=g.Values.length,h=0;h<_;h++)g.Values[h].v1>p&&(p=g.Values[h].v1),g.Values[h].v1<o&&(o=g.Values[h].v1);return{High:p,Low:o,Values:g.Values}},this.computeElderRay=function(r,f,L){var c=this.computeMovingAverageE(r,f,"c"),v=[],p,o=c.Values.length,h=-1e3,g=1e3,_;if(L=="bear")for(p=0;p<o;p++)_=r[p].l-c.Values[p].v1,_>h&&(h=_),_<g&&(g=_),v[p]={d:r[p].d,v1:_};else for(p=0;p<o;p++)_=r[p].h-c.Values[p].v1,_>h&&(h=_),_<g&&(g=_),v[p]={d:r[p].d,v1:_};return{High:h,Low:g,Values:v}},this.computeQStick=function(r,f){for(var L=[],c=-1e3,v=1e3,p=r.length,o,h=[],g,_=0;_<p;_++)h[_]=r[_].c-r[_].o;for(_=0;_<p;_++){for(o=0,g=0;g<f&&!(_-g<0);g++)o=o+h[_-g];o=o/g,o>c&&(c=o),o<v&&(v=o),L[_]={d:r[_].d,v1:o}}return{High:c,Low:v,Values:L}},this.computeATR=function(r,f,L){var c=[],v=0,p=9999,o=r.length,h=0,g=0,_=0,C=[],P,G,H,$;if(o<f+1)return null;for(C[0]=r[0].h-r[0].l,c[0]={d:r[0].d,v1:C[0]},P=1;P<o;P++)h=r[P].h-r[P].l,g=Math.abs(r[P-1].c-r[P].h),_=Math.abs(r[P-1].c-r[P].l),C[P]=Math.max(h,g,_);if(H=0,L=="ema")for(H=C[0],$=2/(f+1),P=1;P<o;P++)H=C[P]*$+H*(1-$),H>v&&(v=H),H<p&&(p=H),c[P]={d:r[P].d,v1:H};if(L=="pma")for(H=C[0],P=1;P<o;P++)H=(H*(f-1)+C[P])/f,H>v&&(v=H),H<p&&(p=H),c[P]={d:r[P].d,v1:H};if(L=="sma"){for(P=1;P<f;P++){for(G=0;G<=P;G++)H=H+C[G];H=H/G,H>v&&(v=H),H<p&&(p=H),c[P]={d:r[P].d,v1:H},H=0}for(P=f;P<o;P++){for(G=0;G<f;G++)H=H+C[P-G];H=H/f,c[P]={d:r[P].d,v1:H},H>v&&(v=H),H<p&&(p=H),H=0}}return{High:v,Low:p,Values:c}},this.computeEaseOfMovement=function(r,f){var L=[],c=0,v=999999,p=r.length,o=0,h=[],g,_,C;for(h[0]=0,g=1;g<p;g++)o=r[g].v!=0?((r[g].h+r[g].l)/2-(r[g-1].h+r[g-1].l)/2)/(r[g].v/(r[g].h-r[g].l)):0,h[g]=o*1e6,o=0;for(L[0]={d:r[0].d,v1:0},_=0,C=2/(f+1),g=1;g<p;g++)_=h[g]*C+_*(1-C),L[g]={d:r[g].d,v1:_},_>c&&(c=_),_<v&&(v=_);return{High:c,Low:v,Values:L}},this.computeIchimoku=function(r,f,L,c){var v=[],p=r.length,o,h,g=0,_=999999,C;if(p<f*2+1)return null;for(o=0;o<f;o++){for(h=o;h>=0;h--)r[h].h>g&&(g=r[h].h),r[h].l<_&&(_=r[h].l);v[o]={d:r[o].d,v1:(g+_)/2},g=0,_=999999}for(o=f;o<p;o++){for(h=0;h<f;h++)r[o-h].h>g&&(g=r[o-h].h),r[o-h].l<_&&(_=r[o-h].l);v[o]={d:r[o].d,v1:(g+_)/2},g=0,_=999999}for(g=0,_=999999,o=0;o<L;o++){for(h=o;h>=0;h--)r[h].h>g&&(g=r[h].h),r[h].l<_&&(_=r[h].l);v[o].v2=(g+_)/2,g=0,_=999999}for(o=L;o<p;o++){for(h=0;h<L;h++)r[o-h].h>g&&(g=r[o-h].h),r[o-h].l<_&&(_=r[o-h].l);v[o].v2=(g+_)/2,g=0,_=999999}for(o=0;o<p-f;o++)v[o].v3=r[o+f].c;for(o=f;o<p;o++)v[o].v4=(v[o-f].v1+v[o-f].v2)/2;for(C=r[p-1].d,o=0;o<f;o++)v[p+o]={d:C+(o+1)*c,v4:(v[p+o-f].v1+v[p+o-f].v2)/2};for(g=0,_=999999,o=0;o<f*2;o++){for(h=o;h>=0;h--)r[h].h>g&&(g=r[h].h),r[h].l<_&&(_=r[h].l);v[o+f].v5=(g+_)/2,g=0,_=999999}for(o=f*2;o<p;o++){for(h=0;h<f*2;h++)r[o-h].h>g&&(g=r[o-h].h),r[o-h].l<_&&(_=r[o-h].l);v[o+f].v5=(g+_)/2,g=0,_=999999}for(o=f;o<p+f;o++)v[o].v4>v[o].v5?(v[o].v6=v[o].v4,v[o].v7=v[o].v5):(v[o].v6=v[o].v5,v[o].v7=v[o].v4);return{Values:v}},this.computeKVO=function(r){var f=[],L=0,c=999999,v=r.length,p,o=[],h=[],g;for(h[0]={d:r[0].d,c:r[0].v},o[0]=(r[0].c+r[0].l+r[0].h)/3,p=1;p<v;p++)o[p]=(r[p].c+r[p].l+r[p].h)/3,h[p]=o[p]>=o[p-1]?{d:r[p].d,c:r[p].v}:{d:r[p].d,c:-1*r[p].v};var _=this.computeMovingAverageE(h,34,"c"),C=this.computeMovingAverageE(h,55,"c"),P=[];for(p=0;p<v;p++)P[p]={d:r[p].d,c:_.Values[p].v1-C.Values[p].v1},P[p].c>L&&(L=P[p].c),P[p].c<c&&(c=P[p].c);for(g=this.computeMovingAverageE(P,13,"c"),p=0;p<v;p++)f[p]={d:r[p].d,v1:P[p].c,v2:g.Values[p].v1};return{High:L,Low:c,Values:f}},this.computeMomentum=function(r,f,L){var c=[],v=0,p=999999,o=r.length,h,g,_;if(o<f+1)return null;for(_=N(r[0],L),h=0;h<f;h++)g=N(r[h],L)-_,c[h]={d:r[h].d,v1:g},g>v&&(v=g),g<p&&(p=g);for(h=f;h<o;h++)g=N(r[h],L)-N(r[h-f],L),c[h]={d:r[h].d,v1:g},g>v&&(v=g),g<p&&(p=g);return{High:v,Low:p,Values:c}},this.computeNVIPVI=function(r,f,L){var c=[],v=0,p=999999,o=r.length,h=1,g=0,_,C,P;for(c[0]={d:r[0].d,v1:h},_=1;_<o;_++)r[_].v==0?c[_]={d:r[_].d,v1:h}:(P=N(r[_-1],f),C=N(r[_],f),L=="nvi"?r[_].v<r[_-1].v?(g=(C-P)*h/P,h=h+g,c[_]={d:r[_].d,v1:h}):c[_]={d:r[_].d,v1:h}:r[_].v>r[_-1].v?(g=(C-P)*h/P,h=h+g,c[_]={d:r[_].d,v1:h}):c[_]={d:r[_].d,v1:h}),h>v&&(v=h),h<p&&(p=h);return{High:v,Low:p,Values:c}},this.computeWaveTrendOsc=function(r,f,L){var c=[],v=r.length,p,o,h,g,_,C,P;if(f>=v||L>v)return null;for(o=this.computeMovingAverageE(r,f,"m2"),h=[],p=0;p<v;p++)h[p]={d:r[p].d,c:Math.abs(N(r[p],"m2")-o.Values[p].v1)};for(g=this.computeMovingAverageE(h,f),_=[],p=0;p<v;p++)_[p]=g.Values[p].v1!=0?{d:r[p].d,c:(N(r[p],"m2")-o.Values[p].v1)/(.015*g.Values[p].v1)}:{d:r[p].d,c:0};for(C=this.computeMovingAverageE(_,L),P=this.computeMM(C.Values,4),p=0;p<v;p++)c[p]={d:r[p].d,v1:C.Values[p].v1,v2:P[p].vm};return{High:85,Low:-90,Values:c}},this.computeMACDZL=function(r,f,L,c){var v=[],p=0,o=999999,h=r.length,g,_;if(f>=h||L>h||c>h)return null;var C=this.computeDoubleEMA(r,f),P=this.computeDoubleEMA(r,L),G=[],H;for(g=0;g<h;g++)H=C.Values[g].v1-P.Values[g].v1,G[g]={c:H,d:C.Values[g].d},H>p&&(p=H),H<o&&(o=H);for(_=this.computeDoubleEMA(G,c),g=0;g<h;g++)v[g]={d:r[g].d,v1:G[g].c,v2:_.Values[g].v1};return{High:p,Low:o,Values:v}},this.computeMACD=function(r,f,L,c,v,p){var o=[],h=0,g=999999,_=r.length,C,P=[],G=[],H,$;if(f>=_||L>_||c>_)return null;P[0]=N(r[0],p),G[0]=N(r[0],p),H=[],$=[],H[0]=0,$[0]=0;var ue=2/(f+1),ee=2/(L+1),me=2/(c+1),Te,ye;for(C=1;C<_;C++)Te=N(r[C],p),P[C]=Te*ue+P[C-1]*(1-ue),G[C]=Te*ee+G[C-1]*(1-ee),H[C]=P[C]-G[C],$[C]=H[C]*me+$[C-1]*(1-me);if(v=="macd")for(C=0;C<_;C++)o[C]={d:r[C].d,v1:H[C],v2:$[C]},H[C]>h&&(h=H[C]),H[C]<g&&(g=H[C]);else for(C=0;C<_;C++)ye=H[C]-$[C],o[C]={d:r[C].d,v1:ye},ye>h&&(h=ye),ye<g&&(g=ye);return{High:h,Low:g,Values:o}},this.computeCoppock=function(r,f,L,c,v){var p=[],o=0,h=999999,g;if(r.length<c+5)return null;var _=this.computeROC(r,f,null,v),C=this.computeROC(r,L,null,v),P=_.Values.length,G,H=[];for(g=1;g<P;g++)G=_.Values[g].v1+C.Values[g].v1,G>o&&(o=G),G<h&&(h=G),H[g]={d:_.Values[g].d,c:G};return H[0]={d:_.Values[0].d,c:H[1].c},p=this.computeMovingAverageP(H,c,"c"),{High:o,Low:h,Values:p.Values}},this.computeROC=function(r,f,L,c){var v=[],p=0,o=999999,h=0,g,_=r.length,C,P=N(r[0],L);if(c)for(v[0]={d:r[0].d,v1:100},g=1;g<_;g++)h=g-f<0?N(r[g],L)*100/P:N(r[g],L)*100/N(r[g-f],L),h>p&&(p=h),h<o&&(o=h),v[g]={d:r[g].d,v1:h};else for(v[0]={d:r[0].d,v1:0},g=1;g<_;g++)g-f<0?h=(N(r[g],L)-P)*100/P:(C=N(r[g-f],L),h=(N(r[g],L)-C)*100/C),h>p&&(p=h),h<o&&(o=h),v[g]={d:r[g].d,v1:h};return{High:p,Low:o,Values:v}},this.computeSTD=function(r,f,L){for(var c=[],v=0,p,o=r.length,h=0,g,_=this.computeMovingAverage(r,f,L),C=0;C<o;C++){for(p=0;p<f&&!(C-p<0);p++)g=N(r[C-p],L)-_.Values[C].v1,h=h+g*g;h=Math.sqrt(h/p),c[C]={d:r[C].d,v1:h},h>v&&(v=h),h=0}return{High:v,Low:0,Values:c}},this.computeSMI=function(r,f,L,c,v){var p=[],o=r.length,h;if(o<f+1)return null;for(var g=[],_=[],C=r[0].l,P=r[0].h,G,H=0;H<o;H++){for(G=0;G<f&&!(H-G<0);G++)r[H-G].h>P&&(P=r[H-G].h),r[H-G].l<C&&(C=r[H-G].l);_[H]={h:P,l:C},g[H]={d:r[H].d,c:r[H].c-(P+C)/2},P=0,C=999999}var $=this.computeMovingAverageE(g,L,"c"),ue=this.computeMovingAverageE($.Values,c,"v1"),ee=[];for(H=0;H<o;H++)ee[H]={d:r[H].d,c:_[H].h-_[H].l};var me=this.computeMovingAverageE(ee,L,"c"),Te=this.computeMovingAverageE(me.Values,c,"v1"),ye=[];for(H=0;H<o;H++)ye[H]=ue.Values[H].v1*100/(Te.Values[H].v1/2);for(h=0,H=0;H<o;H++){for(h=0,G=0;G<v&&!(H-G<0);G++)h=h+ye[H-G];p[H]={d:r[H].d,v1:ye[H],v2:h/G}}return{High:110,Low:-100,Values:p}},this.computeASI=function(r){var f=[],L=r.length,c;if(L<3)return null;var v=0,p,o,h,g,_,C,P=0,G=999999;for(f[0]={d:r[0].d,v1:0},c=1;c<L;c++)h=Math.abs(r[c].h-r[c-1].c),g=Math.abs(r[c].l-r[c-1].c),_=r[c].h-r[c].l,C=Math.abs(r[c-1].c-r[c-1].o),h>g&&h>_&&(p=h-.5*g+.25*C),g>h&&g>_&&(p=g-.5*h+.25*C),_>h&&_>g&&(p=_+.25*C),p==null&&(p=_+.25*C),o=Math.max(h,g),p!=0&&(v=v+50*((r[c].c-r[c-1].c+.5*(r[c].c-r[c].o)+.25*(r[c-1].c-r[c-1].o))/p)*(o/300)),v>P&&(P=v),v<G&&(G=v),f[c]={d:r[c].d,v1:v};return{High:P,Low:G,Values:f}},this.computeStochRSI=function(r,f,L,c,v,p){var o=r.length,h,g,_,C;if(o<v+1||(g=this.computeRSI(r,v,p),g==null))return null;for(_=[],C=g.Values.length,h=0;h<C;h++)_[h]={d:g.Values[h].d,h:g.Values[h].v1,l:g.Values[h].v1,c:g.Values[h].v1};return this.computeSTOCH(_,f,L,c)},this.computeSTOCH=function(r,f,L,c){var v=[],p=r.length,o=0,h=9999,g,_;if(p<f+1)return null;var C=[],P=r[0].l,G=r[0].h,H,$,ue=G-P;for(C[0]=ue!=0?(r[0].c-P)*100/ue:0,H=1;H<f;H++){for($=0;$<=H;$++)r[$].h>G&&(G=r[$].h),r[$].l<P&&(P=r[$].l);ue=G-P,C[H]=ue==0?0:(r[H].c-P)*100/ue,G=0,P=999999}for(H=f;H<p;H++){for($=0;$<f;$++)r[H-$].h>G&&(G=r[H-$].h),r[H-$].l<P&&(P=r[H-$].l);ue=G-P,C[H]=ue==0?0:(r[H].c-P)*100/ue,G=0,P=999999}for(g=[],H=0;H<p;H++){for(_=0,$=0;$<L&&!(H-$<0);$++)_=_+C[H-$];g[H]=_/$,g[H]>o&&(o=g[H]),g[H]<h&&(h=g[H])}for(c==null&&(c=3),H=0;H<p;H++){for(_=0,$=0;$<c&&!(H-$<0);$++)_=_+g[H-$];v[H]={d:r[H].d,v1:g[H],v2:_/$}}return{High:o,Low:h,Values:v}},this.computeTRIX=function(r,f,L){var c=this.computeMovingAverageE(r,f,L),v=[],p=c.Values.length,o,h=0,g=999999,_,C,P,G;for(v[0]={d:c.Values[0].d,v1:0},_=c.Values[0].v1,C=[],C[0]=c.Values[0].v1,P=0,G=2/(f+1),o=1;o<p;o++)_=c.Values[o].v1*G+_*(1-G),C[o]=_*G+C[o-1]*(1-G),P=(C[o]-C[o-1])*100/C[o-1],v[o]={d:c.Values[o].d,v1:P},P>h&&(h=P),P<g&&(g=P);return{High:h,Low:g,Values:v}},this.computeVROC=function(r,f){var L=[],c=0,v=999999,p,o=r.length,h;if(o<=f)return null;for(p=0;p<f;p++)L[p]={d:r[p].d,v1:0};for(h=0,p=f;p<o;p++)r[p].v!=0&&r[p-1].v!=0?(h=r[p].v*100/r[p-1].v,h<100&&(h=h*-1),L[p]={d:r[p].d,v1:h},h>c&&(c=h),h<v&&(v=h)):L[p]={d:r[p].d,v1:0},h=0;return{High:c,Low:v,Values:L}},this.computeWILAC=function(r){var f=[],L=0,c=999999,v=r.length;f[0]={d:r[0].d,v1:0};for(var p=0,o=99999,h=0,g=1;g<v;g++)p=Math.max(r[g-1].c,r[g].h),o=Math.min(r[g-1].c,r[g].l),r[g].c==r[g-1].c?f[g]={d:r[g].d,v1:h}:r[g].c>r[g-1].c?(h=h+r[g].c-o,f[g]={d:r[g].d,v1:h}):(h=h+r[g].c-p,f[g]={d:r[g].d,v1:h}),h>L&&(L=h),h<c&&(c=h),p=0,o=99999;return{High:L,Low:c,Values:f}},this.computeKeltner=function(r,f,L,c){var v=this.computeMovingAverageE(r,f,"c"),p=[],o=v.Values.length,h,g=this.computeATR(r,c,"sma"),_;if(g==null)return null;for(h=0;h<o;h++)_=L*g.Values[h].v1,p[h]={d:v.Values[h].d,v1:v.Values[h].v1+_,v2:v.Values[h].v1-_};return{Values:p}},this.computeDonchian=function(r,f){var L=r.length,c,v,p,o,h;if(L<f)return null;for(h=[],c=0;c<L;c++){for(p=0,o=999999,v=0;v<f&&!(c-v<0);v++)r[c-v].h>p&&(p=r[c-v].h),r[c-v].l<o&&(o=r[c-v].l);h[c]={d:r[c].d,v1:p,v2:o}}return{Values:h}},this.ComputeAroon=function(r,f){var L=r.length,c,v;if(L<f)return null;var p=[],o=0,h=999999,g=0,_=0;for(c=0;c<f;c++){for(v=0;v<=c;v++)r[c-v].h>o&&(o=r[c-v].h,g=v),r[c-v].l<h&&(h=r[c-v].l,_=v);p[c]={d:r[c].d,v1:(f-g)/f*100,v2:(f-_)/f*100},o=0,h=999999}for(c=f;c<L;c++){for(v=0;v<=f;v++)r[c-v].h>o&&(o=r[c-v].h,g=v),r[c-v].l<h&&(h=r[c-v].l,_=v);p[c]={d:r[c].d,v1:(f-g)/f*100,v2:(f-_)/f*100},o=0,h=999999}return{High:110,Low:-5,Values:p}},this.computeWILR=function(r,f){var L=r.length;if(L<f)return null;for(var c=9999999,v=0,p,o=[],h=0;h<f+1;h++)o[h]={d:r[h].d,v1:0};for(h=f+1;h<L;h++){for(p=0;p<f;p++)r[h-p].h>v&&(v=r[h-p].h),r[h-p].l<c&&(c=r[h-p].l);o[h]=v-c==0?{d:r[h].d,v1:0}:{d:r[h].d,v1:(v-r[h].c)*-100/(v-c)},v=0,c=999999}return{High:0,Low:-100,Values:o}},this.computeMarteau=function(r){for(var f=[],L=r.length,c,v,p,o,h=2;h<L;h++)r[h-2]!=null&&r[h-1]!=null&&r[h]!=null&&r[h-2].l>r[h-1].l&&r[h-1].l>r[h].l&&(c=Math.min(r[h].o,r[h].c),v=Math.max(r[h].o,r[h].c),p=c-r[h].l,o=(r[h].h-v)/(r[h].h-r[h].l),o<.04&&p>=v-c&&f.push({i:h,d:r[h].d,v1:r[h].l,v2:0}));return{Values:f}},this.computePinces=function(r){for(var f=[],L=r.length,c=3;c<L;c++)r[c-3]!=null&&r[c-2]!=null&&r[c-1]!=null&&r[c]!=null&&(r[c-3].h<r[c-2].h&&r[c-2].h<r[c-1].h&&Math.abs(1-r[c-1].h/r[c].h)*100<.05&&f.push({i:c,d:r[c-1].d,v1:0,v2:r[c].h}),r[c-3].l>r[c-2].l&&r[c-2].l>r[c-1].l&&Math.abs(1-r[c-1].l/r[c].l)*100<.05&&f.push({i:c,d:r[c-1].d,v1:r[c].l,v2:0}));return{Values:f}},this.computeMarubozu=function(r){for(var f=[],L=r.length,c,v,p=1;p<L;p++)r[p]!=null&&Math.abs((r[p].c-r[p].o)*100/r[p].c)>1.2&&(c=Math.abs((r[p].l-r[p].o)*100/r[p].c),v=Math.abs((r[p].h-r[p].c)*100/r[p].c),c<.05&&v<.05&&f.push({i:p,d:r[p-1].d,v1:0,v2:r[p].h}),c=Math.abs((r[p].l-r[p].c)*100/r[p].c),v=Math.abs((r[p].h-r[p].o)*100/r[p].c),c<.05&&v<.05&&f.push({i:p,d:r[p-1].d,v1:r[p].l,v2:0}));return{Values:f}},this.computeSoldiers=function(r,f){var L=[],c,v=r.length,p=0;if(f=="s"){for(c=3;c<v;c++)if(r[c-2]!=null&&r[c-1]!=null&&r[c]!=null&&r[c-2].c<r[c-1].c&&r[c-1].c<r[c].c&&r[c-2].o<r[c-1].o&&r[c-1].o<r[c].o&&r[c-2].h<r[c-1].h&&r[c-1].h<r[c].h){if(r[c-2].c-r[c-2].o<=0||r[c-1].c-r[c-1].o<=0||r[c].c-r[c].o<=0)continue;c-p>2&&(L.push({i:c,d:r[c-1].d,v1:0,v2:r[c].h}),p=c)}}else for(c=3;c<v;c++)if(r[c-2]!=null&&r[c-1]!=null&&r[c]!=null&&r[c-2].c>r[c-1].c&&r[c-1].c>r[c].c&&r[c-2].o>r[c-1].o&&r[c-1].o>r[c].o&&r[c-2].l>r[c-1].l&&r[c-1].l>r[c].l){if(r[c-2].c-r[c-2].o>=0||r[c-1].c-r[c-1].o>=0||r[c].c-r[c].o>=0)continue;c-p>2&&(L.push({i:c,d:r[c-1].d,v1:r[c].l,v2:0}),p=c)}return{Values:L}},this.computePendu=function(r){for(var f=[],L=r.length,c,v,p,o,h=2;h<L;h++)r[h-2]!=null&&r[h-1]!=null&&r[h]!=null&&r[h-2].h<r[h-1].h&&r[h-1].h<r[h].h&&(c=Math.min(r[h].o,r[h].c),v=Math.max(r[h].o,r[h].c),p=c-r[h].l,o=(r[h].h-v)/(r[h].h-r[h].l),o<.04&&p>=v-c&&f.push({i:h,d:r[h-1].d,v1:0,v2:r[h].h}));return{Values:f}},this.computeDragonFly=function(r){for(var f=[],L=r.length,c,v,p,o=3;o<L;o++)r[o]!=null&&(c=Math.abs((r[o].o-r[o].c)*100/r[o].c),v=Math.abs((r[o].o-r[o].h)*100/r[o].c),p=Math.abs((r[o].l-r[o].c)*100/r[o].c),c<.05&&v<.05&p>.5&&f.push({i:o,d:r[o].d,v1:r[o].l,v2:0}));return{Values:f}},this.computeShootingStar=function(r){for(var f=[],L=r.length,c,v,p,o,h=3;h<L;h++)r[h-3]!=null&&r[h-2]!=null&&r[h-1]!=null&&r[h]!=null&&(c=Math.min(r[h].o,r[h].c),v=Math.max(r[h].o,r[h].c),p=r[h].h-v,o=(c-r[h].l)/(r[h].h-r[h].l),o<.04&&p>=v-c&&f.push({i:h,d:r[h].d,v1:r[h].l,v2:0}));return{Values:f}},this.computeHarami=function(r){for(var f=[],L=r.length,c=1;c<L;c++)r[c-1]!=null&&r[c]!=null&&(r[c].l>r[c-1].c&&r[c].h<r[c-1].o&&r[c-1].o>r[c-1].c?f.push({i:c,d:r[c-1].d,v1:r[c].l,v2:0}):r[c].l>r[c-1].o&&r[c].h<r[c-1].c&&r[c-1].o<r[c-1].c&&f.push({i:c,d:r[c-1].d,v1:0,v2:r[c].h}));return{Values:f}},this.computeEnglobante=function(r){for(var f=[],L=r.length,c=1;c<L;c++)r[c-1]!=null&&r[c]!=null&&(r[c].c>r[c-1].o&&r[c].o<r[c-1].c&&r[c-1].o>r[c-1].c?f.push({i:c,d:r[c].d,v1:r[c].l,v2:0}):r[c].c<r[c-1].o&&r[c].o>r[c-1].c&&r[c-1].o<r[c-1].c&&f.push({i:c,d:r[c].d,v1:0,v2:r[c].h}));return{Values:f}},this.computeGAP=function(r){for(var f=[],L=r.length,c=1;c<L;c++)r[c-1]!=null&&r[c]!=null&&(r[c-1].h<r[c].l?f.push({i:c,d:r[c].d,v1:r[c-1].l,v2:0}):r[c-1].l>r[c].h&&f.push({i:c,d:r[c].d,v1:0,v2:r[c-1].h}));return{Values:f}},this.computeDOJI=function(r,f){var L=[],c,v,p=r.length,o=.05;for(f<0&&(o=.002),v=0;v<p;v++)r[v]!=null&&(c=Math.abs((r[v].o-r[v].c)*100/r[v].o),c<o&&r[v].h>r[v].c&&r[v].l<r[v].c&&L.push({i:v,d:r[v].d,v1:r[v].l,v2:0}));return{Values:L}},this.computeKEYR=function(r){for(var f=[],L=r.length,c=2;c<L;c++)if(r[c-2]!=null&&r[c-1]!=null&&r[c]!=null){if(r[c-2].h<r[c-1].h&&r[c-1].h<r[c].h){r[c].o>r[c-1].c&&r[c].c<r[c-1].l&&f.push({i:c,d:r[c].d,v1:0,v2:r[c-1].h});continue}r[c-2].l>r[c-1].l&&r[c-1].l>r[c].l&&r[c].o<r[c-1].c&&r[c].c>r[c-1].h&&f.push({i:c,d:r[c].d,v1:r[c-1].l,v2:0})}return{Values:f}},this.computePERFORMANCE=function(r,f){var L={QuoteTab:r.QuoteTab},c=[],v=0,p=9999999;c[0]=f?{d:L.QuoteTab[0].d,v1:0}:{d:L.QuoteTab[0].d,c:0};for(var o=0,h=L.QuoteTab.length,g=L.QuoteTab[0].c,_,C=1;C<h;C++)_=L.QuoteTab[C],_!=null&&(o=(_.c-g)*100/g,c[C]=f?{d:_.d,v1:o}:{d:_.d,c:o},o>v&&(v=o),o<p&&(p=o));return f?{High:v,Low:p,Values:c}:{Name:r.Name,High:v,Low:p,QuoteTab:c}},this.computeSAR=function(r,f,L){var c=[],v=[],p=[],o=[],h=[],g=r.length,_=0,C=0,P;for(p[0]=r[0].c>r[0].l,v[0]=r[0].c,o[0]=f,h[0]=r[0].c,h[1]=p[0]?r[1].l:r[0].h,o[1]=f,v[1]=o[1]*(h[1]-h[0])+h[0],p[1]=p[0]?v[1]>r[0].h:v[1]>r[0].c,P=2;P<g;P++)h[P]=p[P-1]==p[P-2]?p[P-1]?r[P].l<h[P-1]?r[P].l:h[P-1]:r[P].h>h[P-1]?r[P].h:h[P-1]:p[P-1]?r[P].l:r[P].h,o[P]=p[P-1]==p[P-2]?h[P-1]==h[P]?o[P-1]:o[P-1]<L?o[P-1]+f:L:f,v[P]=p[P-1]==p[P-2]?o[P]*(h[P]-v[P-1])+v[P-1]:o[P]*(h[P]-h[P-1])+h[P-1],p[P]=p[P-1]?v[P]>r[P].h:v[P]>r[P].l,p[P]?(_=0,C=p[P]==p[P-1]?v[P]:h[P]):(C=0,_=p[P]==p[P-1]?v[P]:h[P]),c[P]={d:r[P].d,v1:C,v2:_};return{Values:c}},this.computeMoonPhase=function(r){for(var f=[],L=r.length,c,v,p,o=0;o<L;o++)c=new Date(r[o].d*864e5),p=new Date(c.getFullYear(),c.getMonth(),c.getDate()),v=j(p),v>.5&&(v=1-v),f[o]={d:r[o].d,v1:v*2};return c=new Date(r[L-1].d*864e5),p=new Date(c.getFullYear(),c.getMonth()+1,c.getDate()),{High:1,Low:0,Values:f}},Date.prototype.getJulian=function(){return this/864e5-this.getTimezoneOffset()/1440+24405875e-1}},function(){var j=function(r){if(this.wrapperEl="#color1",this.value="#ffffff",this.onChange=function(){},this.colors=["ffaaaa","ff5656","ff0000","bf0000","7f0000","ffffff","ffd4aa","ffaa56","ff7f00","bf5f00","7f3f00","e5e5e5","ffffaa","ffff56","ffff00","bfbf00","7f7f00","cccccc","aaffaa","56ff56","00ff00","00bf00","008000","999999","aaffff","56ffff","00ffff","00bfbf","007f7f","666666","aad4ff","56aaff","007fff","005fbf","003f7f","4c4c4c","aaaaff","5656ff","0000ff","0000bf","00007f","333333","d4aaff","aa56ff","7f00ff","5f00bf","3f007f","191919","ffaaff","ff56ff","ff00ff","bf00bf","7f007f","000000"],r)for(var f in r)this[f]=r[f];this.init()};j.prototype={init:function(){function r(c){var v,p,o,h,g;if(c.stopPropagation(),v=document.querySelector(".palette"),v!=null){c.target.className=="palettein"&&(p=window.getComputedStyle(c.target).backgroundColor,L.wrapper.style.backgroundColor=p,L.input.setAttribute("value",p),L.onChange(K(p))),v.parentNode.removeChild(v),document.removeEventListener("mousedown",f);return}for(v=document.createElement("div"),v.setAttribute("class","palette"),h=L.colors.length,g="",o=0;o<h;o++)g=g+'<div class="palettein" style="background-color:#'+L.colors[o]+'" ></div>';v.innerHTML=g,L.wrapper.appendChild(v),document.addEventListener("mousedown",f)}function f(){var c=document.querySelector(".palette");c!=null&&(c.parentNode.removeChild(c),document.removeEventListener("mousedown",f))}var L=this;this.input=document.querySelector(this.wrapperEl),this.input.style.display="none",this.wrapper=document.createElement("div"),this.wrapper.setAttribute("class","colorPicker-picker"),this.wrapper.style.backgroundColor=L.value,this.input.parentNode.insertBefore(this.wrapper,this.input.nextSibling),this.wrapper.addEventListener("mousedown",r)},change:function(r){var f=this;f.wrapper.style.backgroundColor=r,f.input.setAttribute("value",r)}},window.ColorPicker=j}(),function(){var j=function(r){if(this.wrapperEl="#slidercontainer",this.value=0,this.onSlide=function(){},this.isMove=!1,r)for(var f in r)this[f]=r[f];this.init()};j.prototype={init:function(){function r(C){C.preventDefault(),c.isMove=!0,["touchmove","mousemove"].forEach(function(P){document.addEventListener(P,f)}),["touchend","mouseup"].forEach(function(P){document.addEventListener(P,L)})}function f(C){var P,G,H;if(C.preventDefault(),c.isMove){var $=Ue(c.wrapper),ue=ie(C),ee=parseInt(ue.x-$.left)-20;ee<0&&(ee=0),ee>c.width-20&&(ee=c.width-20),o.style.left=ee+"px",p.style.width=ee+5+"px",P=ee/(c.width-20),P<0&&(P=0),G=c.max-c.min,H=c.min+G*P,H=c.increment==1?Math.round(H):Math.round(H/c.increment)*c.increment,c.onSlide(H)}}function L(C){C.preventDefault(),["touchmove","mousemove"].forEach(function(P){document.removeEventListener(P,f)}),["touchend","mouseup"].forEach(function(P){document.removeEventListener(P,L)}),c.isMove=!1}var c=this,v,p,o,h,g,_;this.wrapper=document.querySelector(this.wrapperEl),v=document.createElement("div"),v.setAttribute("class","sliderbar"),p=document.createElement("div"),p.setAttribute("class","sliderin"),this.divIn=p,v.appendChild(p),o=document.createElement("div"),o.setAttribute("class","sliderpointer"),this.divCursor=o,this.wrapper.appendChild(v),this.wrapper.appendChild(o),h=window.getComputedStyle(this.wrapper.parentNode).width,this.width=h.replace("px",""),this.min=parseFloat(this.wrapper.getAttribute("min")),this.max=parseFloat(this.wrapper.getAttribute("max")),this.increment=parseFloat(this.wrapper.getAttribute("step")),g=this.wrapper.getAttribute("value"),g&&(this.value=parseFloat(g)),_=(c.value-this.min)/(this.max-this.min)*(this.width-20),_<0&&(_=0),this.divCursor.style.left=_+"px",this.divIn.style.width=_+5+"px",["touchstart","mousedown"].forEach(function(C){c.divCursor.addEventListener(C,r)})},set:function(r){var f=this,L=(r-f.min)/(f.max-f.min)*(f.width-20);L<0&&(L=0),f.divCursor.style.left=L+"px",f.divIn.style.width=L+5+"px"}},window.Slider=j}()}},function(tt){var Ue=function(he){return tt(tt.s=he)};tt.O(0,[4692,5731],function(){return Ue(9604)});var ie=tt.O()}]);
