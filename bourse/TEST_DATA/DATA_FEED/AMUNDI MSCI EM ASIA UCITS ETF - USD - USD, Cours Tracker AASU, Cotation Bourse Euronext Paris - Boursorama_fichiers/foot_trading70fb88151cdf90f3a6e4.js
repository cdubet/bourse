/*! For license information please see foot_trading70fb88151cdf90f3a6e4.js.LICENSE.txt */
(self.webpackChunkweb_fr_portal_20=self.webpackChunkweb_fr_portal_20||[]).push([[9175],{4360:function(e,t,a){"use strict";var r,n,o;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return e.getClientRects().length?(t=e.getBoundingClientRect(),a=e.ownerDocument.defaultView,{top:t.top+a.pageYOffset,left:t.left+a.pageXOffset}):{top:0,left:0};var t,a}function s(e){var t,a={x:0,y:0};return"touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type?(t=e.touches[0]||e.changedTouches[0],a.x=t.pageX,a.y=t.pageY):(a.x=e.pageX,a.y=e.pageY),a}function c(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4==e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}function d(e){return e=e.replace(/^rgba?\(|\s+|\)$/g,"").split(","),parseFloat(e[3])}function u(e,t){var a;return e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,a,r){return t+t+a+a+r+r})),a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),"rgba("+parseInt(a[1],16)+","+parseInt(a[2],16)+","+parseInt(a[3],16)+","+t+")"}function h(e,t){return e=""+e,t.substring(0,t.length-e.length)+e}function p(e,t){if(t)return e.toFixed(1)+" %";var a=Math.abs(e);return a>1e3?function(e,t){e=e.toFixed(0)+"";for(var a=/(\d+)(\d{3})/;a.test(e);)e=e.replace(a,"$1 $2");return e}(e):a>100?e.toFixed(1):a>2?e.toFixed(2):e.toFixed(3)}function m(e,t){e+="";var a=parseInt(e.substr(6));return 1==t?h(Math.floor(a/60),"00")+":"+h(a%60,"00"):2==t?e.substring(4,6)+"/"+e.substring(2,4)+"/20"+e.substring(0,2):e.substring(4,6)+"/"+e.substring(2,4)+" "+h(Math.floor(a/60),"00")+":"+h(a%60,"00")}function f(e){return e<60?e+" min":Math.floor(e/60)+"h "+e%60+"min"}function g(e,t){var a=new Date(864e5*e);switch(t){case 1:return h(a.getDate(),"00")+"/"+h(a.getMonth()+1,"00")+"/"+a.getFullYear().toString();case 2:return h(a.getDate(),"00")+"/"+h(a.getMonth()+1,"00")+"/"+a.getFullYear().toString().substring(2,4);case 3:return h(a.getDate(),"00")+"/"+h(a.getMonth()+1,"00");case 4:return h(a.getMonth()+1,"00")+"/"+a.getFullYear().toString()}}function v(e,t){switch(t){case"c":case"o":case"h":case"l":case"v1":return e[t];case"m":return(e.h+e.l)/2;case"m2":return(e.h+e.l+e.c)/3;case"m3":return(e.o+e.h+e.l+e.c)/4;default:return e.c}}a(2526),a(1817),a(2165),a(3290),a(9554),a(2772),a(6992),a(7042),a(561),a(658),a(6977),a(7941),a(1539),a(4678),a(1058),a(4916),a(9714),a(8783),a(4723),a(5306),a(3123),a(3210),a(4747),a(3948),function(){function e(e){for(var t="rgba(255,0,0,1)",a="rgba(0,0,192,1)",r="rgba(0,0,255,1)",n="rgba(61,68,241,0.9)",o="rgba(61,68,241,0.5)",i="rgba(192,0,0,1)",l="rgba(192,0,0,0.9)",s="rgba(192,0,0,0.5)",c="rgba(192,0,0,0.8)",d="rgba(0,0,0,1)",u="rgba(0,140,0,1)",h="rgba(0,128,0,0.5)",p="rgba(0,128,0,0.8)",m="rgba(51,153,102,1)",f="rgba(96,96,96,1)",g=[{type:"actu",params:{},color:s},{type:"evt",params:{},color:s},{type:"evenements",params:{},color:s},{type:"line",color:"rgba(17,66,87,0.9)",color2:"rgba(24, 106, 142,0.8)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw"]}},{type:"line2",color:"rgba(17,66,87,1)",params:{c:[lang.l_trace],w:["sw"]}},{type:"candle",color:"rgba(0,255,0,1)",color2:t,color3:f,params:{c:[lang.l_hausses,lang.l_baisses,lang.l_ombres]}},{type:"mm",color:t,param1:20,params:{p:[lang.l_prd],c:[lang.l_moymobile],w:["sw"]}},{type:"barcolor",color:r,color2:t,params:{c:[lang.l_hausses,lang.l_baisses]}},{type:"bar",color:"rgba(17,66,87,1)",params:{c:["Bar Chart"]}},{type:"perf",color:"rgba(17,66,87,0.9)",color2:"rgba(24, 106, 142,0.8)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw"]}},{type:"volume",color:"rgba(3,170,2,0.75)",color2:"rgba(255,0,0,0.75)",params:{c:[lang.l_hausses,lang.l_baisses],w:["o","o"]}},{type:"boll",color:"rgba(244,143,0,0.7)",color2:"rgba(244,143,0,0.15)",param1:20,param2:2,params:{p:[lang.l_prd,lang.l_ec],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"rsi",color:a,param1:14,sh:70,sb:30,params:{c:["RSI"],p:[lang.l_prd],w:["sw"]}},{type:"fr",color:n,color2:o,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"cmo",color:a,param1:10,sh:50,sb:-50,params:{c:["CMO"],p:[lang.l_prd],w:["sw"]}},{type:"cci",color:a,param1:20,sh:100,sb:-100,params:{c:["CCI"],p:[lang.l_prd],w:["sw"]}},{type:"mom",color:l,color2:s,param1:12,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"macd",color:a,color2:i,color3:h,param1:12,param2:26,param3:9,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["MACD","Signal",lang.l_histogram],w:["sw","sw"]}},{type:"sto",color:r,color2:t,param1:14,param2:3,param3:3,sh:9999,sb:9999,params:{p:[lang.l_prd,lang.l_stok,lang.l_stod],c:["%K","%D"],w:["sw","sw"]}},{type:"ichimoku",color:r,color2:"rgba(210,0,0,1)",color3:u,color4:"rgba(64,64,255,1)",color5:"rgba(64,64,255,1)",color6:"rgba(64,64,255,0.3)",param1:26,param2:9,params:{c:["Kijun-Sen","Tenkan-Sen","Chikou-Span","Senkou A","Senkou B","Kumo"],p:["Kijun-Sen","Tenkan-Sen"],w:["sw","sw","sw","sw","sw","o"]}},{type:"phpb",color:u,color2:"rgba(210,0,0,1)",param1:20,params:{c:[lang.l_hausses,lang.l_baisses],p:[lang.l_prd]}},{type:"lineard",param1:30,param2:1,color:d,color2:"rgba(0,128,128,1)",color3:i,params:{p:[lang.l_prd,lang.l_ec],c:[lang.l_droitereg,"Resistance","Support"],w:["w","w","w"]}},{type:"supres",param1:5,color:h,color2:"rgba(255,0,0,0.4)",params:{p:[lang.l_barrep],c:[lang.l_hausses,lang.l_baisses],w:["o","o"]}},{type:"coppock",param1:11,param2:14,param3:10,color:"rgba(0,0,128,0.8)",color2:"rgba(0,0,128,0.3)",params:{p:["ROC 1","ROC2",lang.l_moyenne],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"compare",color:t,params:{c:["Style"],w:["sw"]}},{type:"pivots",color:"rgba(0,0,0,0.7)",color2:"rgba(255,0,0,0.7)",color3:"rgba(0,128,0,0.7)",params:{c:["Pivot","Supports","Resistances"]}},{type:"zig zag",color:t,param1:3,params:{p:[lang.l_variation],c:["Zig Zag"],w:["sw"]}},{type:"mmp",color:"rgba(180,0,0,1)",param1:15,params:{p:[lang.l_prd],c:[lang.l_moymobp],w:["sw"]}},{type:"mmh",color:"rgba(180,0,0,1)",param1:9,params:{p:[lang.l_prd],c:[lang.l_mmh2],w:["sw"]}},{type:"double EMA",color:t,param1:20,params:{p:[lang.l_prd],c:["Double EMA"],w:["sw"]}},{type:"triple EMA",color:r,param1:20,params:{p:[lang.l_prd],c:["Triple EMA"],w:["sw"]}},{type:"alligator",color:r,color2:t,color3:u,param1:13,param2:8,param3:5,params:{p:["Jaw","Teeth","Lips"],c:["Jaw","Teeth","Lips"],w:["sw","sw","sw"]}},{type:"mme",color:r,param1:30,params:{p:[lang.l_prd],c:[lang.l_moymobe],w:["sw"]}},{type:"mmt",color:r,param1:20,params:{p:[lang.l_prd],c:[lang.l_moymobt],w:["sw"]}},{type:"evmm",color:"rgba(192,0,0,0.7)",color2:"rgba(192,0,0,0.15)",param1:20,param2:2,params:{p:[lang.l_prd,lang.l_ecart],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"donchian",color:"rgba(0,128,0,0.7)",color2:"rgba(0,128,0,0.15)",param1:20,params:{p:[lang.l_prd],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"gmma",color:u,color2:i,params:{c:["Fast","Slow"],w:["sw","sw"]}},{type:"supertrend",color:i,color2:u,param1:10,param2:3,params:{p:[lang.l_prd,lang.l_coeff],c:["Resistance","Support"],w:["w","w"]}},{type:"keltner",color:"rgba(0,128,0,0.7)",color2:"rgba(0,128,0,0.20)",param1:20,param2:2,param3:10,params:{p:[lang.l_prd,lang.l_ecart2,lang.l_atrperiod],c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"heikin ashi",color:m,color2:"rgba(255,64,64,1)",color3:f,params:{c:[lang.l_hausses,lang.l_baisses,lang.l_ombres]}},{type:"renko",color:m,color2:t,color3:f,params:{p:[lang.l_tboite],c:[lang.l_hausses,lang.l_baisses,lang.l_border]},nolinearX:!0},{type:"point figure",color:m,color2:t,param2:3,params:{p:["Box","Reverse"],c:[lang.l_hausses,lang.l_baisses]},nolinearX:!0},{type:"kagi",color:"rgba(51,102,255,1)",color2:"rgba(255,64,64,1)",params:{p:[lang.l_tboite],c:["Yang","Yin"]},nolinearX:!0},{type:"equivolume",color:"rgba(51,102,255,1)",color2:"rgba(255,64,64,1)",params:{c:[lang.l_hausses,lang.l_baisses]},nolinearX:!0},{type:"line break",color:m,color2:t,color3:f,params:{p:[lang.l_lines],c:[lang.l_hausses,lang.l_baisses,lang.l_border]},nolinearX:!0},{type:"hollow",color:"rgba(7,103,69,1)",color2:t,color3:f,params:{c:[lang.l_hausses,lang.l_baisses,lang.l_ombres]}},{type:"accDist",color:l,color2:s,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"obv",color:n,color2:o,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"forceindex",color:n,color2:o,param1:13,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"ulcer",color:r,param1:14,params:{c:["Ulcer Index"],p:[lang.l_prd],w:["sw"]}},{type:"perfi",color:n,color2:o,params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"kvo",color:"rgba(0,0,128,1)",color2:u,params:{c:["KVO","Signal"],w:["sw","sw"]}},{type:"ultimate",color:a,param1:7,param2:14,param3:28,sh:70,sb:30,params:{c:["Ultimate Osc."],p:[lang.l_mm2+" 1",lang.l_mm2+" 2",lang.l_mm2+" 3"],w:["sw"]}},{type:"bollb",color:a,param1:20,sh:100,sb:0,params:{c:["Bollinger %B"],p:[lang.l_prd],w:["sw"]}},{type:"bollw",color:"rgba(255,102,0,1)",param1:20,param2:2,params:{c:[lang.l_trace],p:[lang.l_prd,lang.l_ec],w:["sw"]}},{type:"atr",color:a,param1:14,params:{c:["ATR"],p:[lang.l_prd],w:["sw"]}},{type:"eom",color:l,color2:s,param1:14,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"cmf",color:l,color2:s,param1:21,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"dpo",color:l,color2:s,param1:20,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}},{type:"asi",color:l,color2:"rgba(192,0,0,0.4)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"nvi",color:i,params:{c:["NVI"],w:["sw"]}},{type:"pvi",color:a,params:{c:["PVI"],w:["sw"]}},{type:"macdzl",color:a,color2:i,color3:h,param1:12,param2:26,param3:9,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["MACD Zéro Lag","Signal",lang.l_histogram],w:["sw","sw"]}},{type:"wto",color:a,color2:i,color3:h,param1:10,param2:21,sh:60,sb:-60,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2"],c:["Wave Trend Osc","Signal",lang.l_histogram],w:["sw","sw"]}},{type:"macdh",color:"rgba(0,0,192,0.8)",color2:c,param1:12,param2:26,param3:9,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["MACD > Signal","MACD < Signal"]}},{type:"awesome",color:p,color2:c,param1:5,param2:34,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2"],c:[lang.l_ascend,lang.l_descend]}},{type:"bop",color:p,color2:c,color3:"rgba(128,128,128,0.8)",params:{c:[lang.l_acheteur,lang.l_vendeur,lang.l_neutre]}},{type:"qstick",color:p,color2:c,param1:5,params:{p:[lang.l_prd],c:[lang.l_hausses,lang.l_baisses]}},{type:"elderbear",color:i,color2:i,param1:13,params:{p:[lang.l_prd],c:[lang.l_hausses,lang.l_baisses]}},{type:"elderbull",color:u,color2:u,param1:13,params:{p:[lang.l_prd],c:[lang.l_hausses,lang.l_baisses]}},{type:"dmi",color:u,color2:i,color3:d,param1:14,params:{p:[lang.l_prd],c:["DI+","DI-","ADX"],w:["sw","sw","sw"]}},{type:"aroon",color:u,color2:i,param1:14,params:{p:[lang.l_prd],c:["Aroon up","Aroon down"],w:["sw","sw"]}},{type:"adx",color:d,color2:i,param1:14,sh:9999,sb:9999,params:{p:[lang.l_prd],c:["ADX","ADXR"],w:["sw","sw"]}},{type:"vortex",color:u,color2:i,param1:14,params:{p:[lang.l_prd],c:["+VI","-VI"],w:["sw","sw"]}},{type:"roc",color:a,param1:10,sh:9999,sb:9999,params:{c:["Rate of change"],p:[lang.l_prd],w:["sw"]}},{type:"std",color:a,param1:10,params:{c:["Std Deviation"],p:[lang.l_prd],w:["sw"]}},{type:"di",color:r,param1:10,params:{c:["Demand Index"],p:[lang.l_prd],w:["sw"]}},{type:"sto rsi",color:r,color2:t,param1:14,param2:3,param3:3,param4:14,sh:80,sb:20,params:{p:[lang.l_prd+" Sto.",lang.l_stok,lang.l_stod,lang.l_prd+" RSI"],c:["%K","%D"],w:["sw","sw"]}},{type:"smi",color:"rgba(128,128,128,1)",color2:t,param1:14,param2:3,param3:5,param4:3,sh:9999,sb:9999,params:{p:[lang.l_prd,lang.l_lissage+" 1",lang.l_lissage+" 2","Signal"],c:[lang.l_stochastic,"Signal"],w:["sw","sw"]}},{type:"tsi",color:d,color2:t,param1:25,param2:13,param3:13,sh:9999,sb:9999,params:{p:[lang.l_prd+" 1",lang.l_prd+" 2","Signal"],c:["True Strength","Signal"],w:["sw","sw"]}},{type:"kst",color:r,color2:t,param1:10,param2:15,param3:20,param4:30,params:{p:["ROC 1","ROC 2","ROC 3","ROC 4"],c:["KST","Signal"],w:["sw","sw"]}},{type:"trix",color:a,param1:12,params:{c:["TRIX"],p:[lang.l_prd],w:["sw"]}},{type:"mass index",color:a,param1:25,params:{c:["Mass Index"],p:[lang.l_prd],w:["sw"]}},{type:"vroc",color:a,param1:10,params:{c:["Volume ROC"],p:[lang.l_prd],w:["sw"]}},{type:"moonphase",color:"rgba(255,153,0,0.9)",color2:"rgba(255,204,0,0.5)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw"]}},{type:"ac will",color:"rgba(61,68,241,0.9)",color2:"rgba(61,68,241,0.5)",params:{c:[lang.l_trace,lang.l_remplis],w:["sw","o"]}},{type:"will r",color:i,param1:14,sh:-20,sb:-80,params:{c:["Williams %R"],p:[lang.l_prd],w:["sw"]}},{type:"mfi",color:i,param1:14,sh:80,sb:20,params:{c:["Money flow idx"],p:[lang.l_prd],w:["sw"]}},{type:"sar",color:"rgba(210,0,0,1)",color2:u,param1:.02,param2:.2,params:{c:[lang.l_baisses,lang.l_hausses],p:[lang.l_accel]}},{type:"linearc",color:"rgba(255,0,255,1)",param1:10,params:{c:[lang.l_lineareg],p:[lang.l_prd],w:["sw"]}},{type:"linearo",color:l,color2:s,param1:10,params:{c:[lang.l_trace,lang.l_remplis],p:[lang.l_prd],w:["sw","o"]}}],v=g.length,y=0;y<v;y++)if(g[y].type==e)return g[y]}function t(){for(var e,a=1;a<arguments.length;a++)for(e in arguments[a])arguments[a].hasOwnProperty(e)&&("object"==i(arguments[0][e])&&"object"==i(arguments[a][e])?t(arguments[0][e],arguments[a][e]):arguments[0][e]=arguments[a][e]);return arguments[0]}function a(e){return(e=e.replace(/'/g,"%27")).replace(/"/g,"%22")}function r(){var e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}function o(e){try{return JSON.parse(JSON.stringify(e))}catch(e){}}function y(e,t,a){var r,n=e.QuoteTab,o=0,i=999999,l=n.length;for(t||(t=0),a?a>l&&(a=l):a=l,r=t;r<a;r++)n[r].h>o&&(o=n[r].h),n[r].l<i&&(i=n[r].l);return e.High=o,e.Low=i,e}var b,x;Math.log10=Math.log10||function(e){return Math.log(e)/Math.LN10},b=new function(){this.gi=function(e){return document.getElementById(e)},this.qsa=function(e){return document.querySelectorAll(e)},this.qs=function(e){return document.querySelector(e)},this.qsga=function(e,t){var a=this.qs(e);if(null!=a)return a.getAttribute(t)},this.idempty=function(e){var t=this.gi(e);null!=t&&(t.innerHTML="")},this.qsaempty=function(e){var t=this.qsa(e);[].forEach.call(t,(function(e){e.innerHTML=""}))},this.clrem=function(e){for(var t,a,r=0;r<e.length;r++)for(a=(t=document.getElementsByClassName(e[r])).item(0);a;)a.parentNode.removeChild(a),a=t.item(0)},this.idrem=function(e){var t=this.gi(e);null!=t&&t.parentNode.removeChild(t)},this.qsarem=function(e){var t=this.qsa(e);[].forEach.call(t,(function(e){e.parentNode.removeChild(e)}))},this.qsarclass=function(e,t){var a=this.qsa(e);[].forEach.call(a,(function(e){e.classList.remove(t)}))},this.qsaaclass=function(e,t){var a=this.qsa(e);[].forEach.call(a,(function(e){e.classList.add(t)}))},this.clcss=function(e,t,a){for(var r=document.getElementsByClassName(e),n=0;n<r.length;n++)r[n].style[t]=a},this.idst=function(e,t){var a=this.gi(e);null!=a&&(a.textContent=t)},this.idhtml=function(e,t){var a=this.gi(e);null!=a&&(a.innerHTML=t)},this.idcss=function(e,t,a){var r=this.gi(e);null!=r&&(r.style[t]=a)},this.gigt=function(e){var t=this.gi(e);return null!=t?t.textContent:""},this.qstxt=function(e,t){var a=this.qs(e);null!=a&&(a.textContent=t)},this.qshtml=function(e,t){var a=this.qs(e);null!=a&&(a.innerHTML=t)},this.clhide=function(e){for(var t=document.getElementsByClassName(e),a=0;a<t.length;a++)t[a].style.display="none"}},x=function(x){function w(e){var t="default";switch(e){case"c":t="crosshair";break;case"p":t="pointer";break;case"m":t="move";break;case"n":t="ns-resize";break;case"zi":t="zoom-in"}Vr.doc.style.cursor=t}function T(){Yr.tmp1=null,la(),P()}function C(e){e.preventDefault();var t=l(b.gi(et("rodgraph-"))),a=s(e),r=parseInt(a.x-t.left),n=parseInt(a.y-t.top),o=Lr;r<o.innerWidth+o.paddingLeft&&r>o.paddingLeft&&n>o.paddingTop&&n<Rr[0].HeightPx+o.paddingTop&&(Yr.tmp1=r,Vr.doc.addEventListener("mouseup",S),Vr.doc.addEventListener("touchend",S),ia("mouseup",S),ia("touchend",S))}function k(e){var t,a,r;e.preventDefault();var n=l(b.gi(et("rodgraph-"))),o=s(e),i=parseInt(o.x-n.left),c=Lr,d=b.gi(et("overlay-")),u=d.getContext("2d");if(!Yr.tmp1)return u.strokeStyle=c.set.reticColor,u.clearRect(0,0,d.width,d.height),u.beginPath(),u.moveTo(i+.5,c.paddingTop),u.lineTo(i+.5,Rr[0].HeightPx+c.paddingTop),u.stroke(),t=new oa(i,0),u.fillStyle=c.set.reticColor,void u.fillText(c.chartPeriod>=0?g(t.x,1):m(t.x),t.mx,Rr[0].HeightPx+c.paddingTop-3);Yr.tmp2=i,u.fillStyle="rgba(255,106,0,0.3)",u.clearRect(0,0,d.width,d.height),u.fillRect(Yr.tmp1,c.paddingTop,i-Yr.tmp1,Rr[0].HeightPx),a=new oa(Math.min(Yr.tmp1,Yr.tmp2),0),r=new oa(Math.max(Yr.tmp1,Yr.tmp2),0),u.fillStyle=c.set.reticColor,u.fillText(c.chartPeriod>=0?g(a.x,1):m(a.x),a.mx,Rr[0].HeightPx),u.fillText(c.chartPeriod>=0?g(r.x,1):m(r.x),r.mx,Rr[0].HeightPx+c.paddingTop-3)}function S(e){var t;e.preventDefault();for(var a=new oa(Math.min(Yr.tmp1,Yr.tmp2),0),r=new oa(Math.max(Yr.tmp1,Yr.tmp2),0),n=Dr.QuoteTab.length,o=0;o<n;o++)if(Dr.QuoteTab[o].d==a.x&&(Hr.minX=o),Dr.QuoteTab[o].d==r.x){Hr.maxX=o;break}(t=b.gi(et("overlay-"))).getContext("2d").clearRect(0,0,t.width,t.height),Y(),$(),T(),"function"==typeof extResetTools&&extResetTools()}function P(){var e,t;Yr.eventsActive||((e=b.gi(et("overlay-")).getContext("2d")).font=Lr.set.fontSize+"px Arial",e.strokeStyle=Lr.set.reticColor,e.lineWidth=1,e.setLineDash&&e.setLineDash([3]),Yr.lineNumber=999,Yr.cursorState=!1,VGP.noCommand&&b.clrem(["mci-p","closelayericon","eodmovedown","eodmoveup"]),Vr.doc.addEventListener("mousewheel",O),Vr.doc.addEventListener("DOMMouseScroll",O),Vr.doc.addEventListener("mouseleave",E),Vr.doc.addEventListener("touchmove",L),Vr.doc.addEventListener("mousemove",L),Vr.doc.addEventListener("mouseup",R),Vr.doc.addEventListener("touchend",R),Vr.doc.addEventListener("mousedown",D),Vr.doc.addEventListener("touchstart",D),(t=b.gi("indicList"))&&(t.addEventListener("mousedown",I),t.addEventListener("touchstart",I)),Yr.eventsActive=!0)}function M(a,r){var n,o,i,l;for(Lr=t(Lr,a),n=t(n=e(Lr.mainChart.type),Lr.mainChart.typedef),Lr.mainChart.typedef=n,i=Lr.mainChart.indicators.length,o=0;o<i;o++)n=t(n=e(Lr.mainChart.indicators[o].type),Lr.mainChart.indicators[o]),Lr.mainChart.indicators[o]=n;l=Lr.set.fontSize-11,Lr.set.yaxis?(null!=a.paddingRight?Lr.paddingRight+=4*l:Lr.paddingRight=10+4*l,null!=a.paddingLeft?Lr.paddingLeft+=4*l:Lr.paddingLeft=45+4*l):(null!=a.paddingRight?Lr.paddingRight+=4*l:Lr.paddingRight=45+4*l,null!=a.paddingLeft?Lr.paddingLeft+=4*l:Lr.paddingLeft=10+4*l),Lr.paddingTop+=l,Lr.paddingBottom+=l,Lr.innerWidth=Lr.widthGraph-Lr.paddingRight-Lr.paddingLeft,Lr.marginInter=3,Lr.usableHeight=Lr.heightGraph-Lr.paddingTop-Lr.paddingBottom-Lr.indicators.length*Lr.marginInter,De(r)}function _(e){var t,a,r=e.mainChart.indicators.length;if(null!=e.isCompare&&1!=e.isCompare&&0!=e.isCompare){for(t=0;t<r;t++)"compare"==e.mainChart.indicators[t].type&&(e.mainChart.indicators[t].symbol=e.isCompare,e.isCompare=!0,a=1);a||(e.isCompare=!1)}null==e.isCompare&&(e.isCompare=!1)}function E(){var e,t,a,r,n,o,i,l,s=b.gi(et("overlay-"));if(s.getContext("2d").clearRect(0,0,s.width,s.height),!(e=Lr).mainChart.typedef.nolinearX){if(t=0,"perf"!=e.mainChart.type&&(t=Qe(e.chartPeriod<0).toFixed(2)),null!=(a=Rr[0].Bars[0][0])&&(e.chartPeriod<0?(r=Dr.qd).dt=m(a.d,2):(r=Dr.QuoteTab[a.i]).dt=g(a.d,1),r.var=t,e.mainChart.type,"function"==typeof extGetQuotesHover&&extGetQuotesHover(r)),"perf"!=e.mainChart.type)for(o=e.mainChart.indicators.length,n=0;n<o;n++)"lineard"!=(i=e.mainChart.indicators[n].type)&&"pivots"!=i&&"gmma"!=i&&b.qstxt("#mainIndic_"+n+" .value1",V(Rr[0].Bars[n+1][0]));if(null!=a)for(l=Rr.length,n=1;n<l;n++)"volume"!=Rr[n].type&&b.qstxt("#secondIndic_"+n+" .value2",V(Rr[n].Bars[a.d]))}}function V(e){if(null==e)return"";var t,a=e.length,r="";if(null==a)return Math.abs(e)<2?e.toFixed(3):e.toFixed(2);for(t=0;t<a;t++)r=Math.abs(e[t])<2?r+e[t].toFixed(3)+" - ":r+e[t].toFixed(2)+" - ";return r.substring(0,r.length-3)}function L(e){var t,a,r,n,o,i,c,d,u,h,p,f,v,y,x,T,C,k,S,P,M,_,E;e.preventDefault();var L,I=l(b.gi(et("rodgraph-"))),D=s(e),R=parseInt(D.x-I.left),q=parseInt(D.y-I.top),G=Lr;if(Yr.moveLayer){if(null==Yr.activeLayer)return;A(q,Yr.activeLayer)}else if(0==Yr.moveZoomX||0==Yr.moveZoomY){if(t=Ie(R,q),"perf"==G.mainChart.type||G.mainChart.typedef.nolinearX||(Yr.lineNumber=B(R,q,t)),r=(a=b.gi(et("overlay-"))).getContext("2d"),R<a.width-G.paddingRight&&R>G.paddingLeft&&q>G.paddingTop&&q<a.height-G.paddingBottom){if(r.clearRect(0,0,a.width,a.height),null!=t){if(null!=qr[R]){for(n=G.chartPeriod>=0?g(qr[R],1):m(qr[R]),Vr.lastdatehover=n,null!=(o=Rr[0].Bars)[0][qr[R]]&&(c=0,(i=o[0][qr[R]].i)>0&&(d=Dr.QuoteTab[i-1+Hr.minX].c,c="perf"==G.mainChart.type?parseFloat(o[0][qr[R]].c):G.chartPeriod<0?100*(o[0][qr[R]].c-Dr.qv.c)/Dr.qv.c:100*(o[0][qr[R]].c-d)/d),c=c.toFixed(2),(u=Dr.QuoteTab[i+Hr.minX]).dt=n,u.var=c,"perf"==G.mainChart.type?o[0][qr[R]]&&(h=Xe(o[0][qr[R]].c,G.logData)+G.paddingTop):h=Xe(u.c,G.logData)+G.paddingTop,Vr.lastCloseHover={x:R,y:h,c:u.c},"function"==typeof extGetQuotesHover&&extGetQuotesHover(u)),Vr.hoverIndics=[],p=Rr.length,L=1;L<p;L++)"volume"!=Rr[L].type&&b.qstxt("#secondIndic_"+L+" .value2",V(Rr[L].Bars[qr[R]])),f=Rr[L].RealY+Rr[L].V0-Rr[L].PxPointY*Rr[L].Bars[qr[R]],Vr.hoverIndics.push({x:R,y:f,c:Rr[L].Indicator.color});if("perf"!=G.mainChart.type)for(p=G.mainChart.indicators.length,L=0;L<p;L++)if("lineard"!=(v=G.mainChart.indicators[L].type)&&null!=o[L+1])if(b.qstxt("#mainIndic_"+L+" .value1",V(o[L+1][qr[R]])),"boll"==v||"keltner"==v||"evmm"==v||"donchian"==v||"ichimoku"==v||"alligator"==v)null!=o[L+1][qr[R]]&&(null!=(x=o[L+1][qr[R]])[0]&&(y=Xe(x[0],G.logData)+G.paddingTop,Vr.hoverIndics.push({x:R,y:y,c:G.mainChart.indicators[L].color})),null!=x[1]&&(y=Xe(x[1],G.logData)+G.paddingTop,"ichimoku"==v||"alligator"==v?Vr.hoverIndics.push({x:R,y:y,c:G.mainChart.indicators[L].color2}):Vr.hoverIndics.push({x:R,y:y,c:G.mainChart.indicators[L].color})),null!=x[2]&&(y=Xe(x[2],G.logData)+G.paddingTop,Vr.hoverIndics.push({x:R,y:y,c:G.mainChart.indicators[L].color3})));else if("compare"==v){if(G.mainChart.indicators[L].datas2){var N=Dr.QuoteTab[Hr.minX].c,Y=G.mainChart.indicators[L].datas2.QuoteTab[Hr.minX].c,O=(o[L+1][qr[R]]-Y)/Y,$=Rr[0].PxPointY*N,X=Math.round((Rr[0].V0-N)*Rr[0].PxPointY);y=Xe(Rr[0].V0-(X-O*$)/Rr[0].PxPointY,G.logData)+G.paddingTop,Vr.hoverIndics.push({x:R,y:y,c:G.mainChart.indicators[L].color})}}else y=Xe(o[L+1][qr[R]],G.logData)+G.paddingTop,Vr.hoverIndics.push({x:R,y:y,c:G.mainChart.indicators[L].color})}else R-G.paddingLeft>Br.length-1?(T=Le(Math.round((R-G.paddingLeft-(Br.length-1))/Rr[0].PxPointX)),n=G.chartPeriod>=0?g(T,1):m(T)):n=Vr.lastdatehover;if(r.fillStyle=G.set.reticColor,Vr.lastCloseHover&&!G.mainChart.typedef.nolinearX&&(r.beginPath(),r.arc(Vr.lastCloseHover.x,Vr.lastCloseHover.y,5,0,2*Math.PI),r.fill()),Vr.lastCloseHover&&(r.beginPath(),C=G.set.fontSize-11,"r"==G.cursor&&Vr.lastCloseHover.x&&(G.isCompare||Lr.mainChart.typedef.nolinearX||(r.moveTo(G.paddingLeft,Vr.lastCloseHover.y+.5),r.lineTo(a.width-G.paddingRight,Vr.lastCloseHover.y+.5)),r.moveTo(Vr.lastCloseHover.x+.5,G.paddingTop),r.lineTo(Vr.lastCloseHover.x+.5,a.height-G.paddingBottom),r.stroke()),(S=R-(k=68+2*C)/2)<G.paddingLeft&&(S=G.paddingLeft),r.fillRect(S,a.height-G.paddingBottom+1,k,G.paddingBottom-1),r.fillRect(S,-2,k,G.paddingTop+2),r.fillStyle=St(G.set.reticColor),P=Math.round(r.measureText(n).width),r.fillText(n,Math.round(S+(k-P)/2),a.height-6),r.fillText(n,Math.round(S+(k-P)/2),11+C),G.chartPeriod>=0&&!G.isCompare&&!G.mainChart.typedef.nolinearX&&(_=null!=Dr.QuoteTab[Hr.minX]?Dr.QuoteTab[Hr.minX].c:Dr.QuoteTab[0].c,M=100*(Vr.lastCloseHover.c-_)/_,r.fillStyle=M>=0?"#008000":"#fe0000",G.set.yaxis?r.fillRect(0,Vr.lastCloseHover.y-8,G.paddingLeft,17+C):r.fillRect(G.widthGraph-G.paddingRight,Vr.lastCloseHover.y-8,G.paddingRight,18+C)),G.chartPeriod>=0&&!G.isCompare&&!G.mainChart.typedef.nolinearX&&(E=G.set.yaxis?2:a.width-G.paddingRight+5,M=M>0?"+"+M.toFixed(1)+"%":M.toFixed(1)+"%",r.fillStyle="#ffffff",r.fillText(M,E-2,Vr.lastCloseHover.y+5+C))),Vr.hoverIndics)for(L=0;L<Vr.hoverIndics.length;L++)r.fillStyle=Vr.hoverIndics[L].c,r.beginPath(),r.arc(Vr.hoverIndics[L].x,Vr.hoverIndics[L].y,5,0,2*Math.PI),r.fill()}}else r.clearRect(0,0,a.width,a.height);Yr.activeLayer=function(e){for(var t=Rr.length,a=1;a<t;a++)if(e>=Rr[a].RealY-4&&e<=Rr[a].RealY+1)return a;return null}(q),null!=Yr.activeLayer?(w("n"),Yr.cursorState=!0):Yr.cursorState&&(Yr.cursorState=!1,w())}else H(R,q)}function I(e){var t,a,r,n,o,i,l;switch(e.preventDefault(),(t=e.target).className){case"manageind2":Yr.flagSave=!0,Lt(),Yt(null,null,t.parentNode.id.slice(-1));break;case"manageind1":Yr.flagSave=!0,Lt(),Yt(a=(n=t.getAttribute("aria-label").split("_")).length>1?n[1]:null,n[0],null);break;case"closeind1":if(Yr.flagSave=!0,Lt(),o=(n=t.getAttribute("aria-label").split("_"))[0],a=n[1],Lr.mainChart.indicators.splice(a,1),Rr[0].Bars.splice(parseInt(a)+1,1),"compare"==o){for(i=Lr.mainChart.indicators.length,l=0,r=0;r<i;r++)"compare"==Lr.mainChart.indicators[r].type&&l++;if(0==l)for(Lr.isCompare=!1,r=1;r<Rr.length;r++)"fr"==Rr[r].Indicator.type&&Ht(r)}Lr.newsConfig&&(Yr.fiEvt=[],b.clrem(["svginfofi"])),X(0);break;case"closeind2":Yr.flagSave=!0,Lt(),Ht(t.parentNode.id.slice(-1))}}function D(e){var t,a,r,n,o=e.target;if(e.preventDefault(),(t=b.gi(et("overlay-"))).getContext("2d").clearRect(0,0,t.width,t.height),"A"!=o.tagName.toUpperCase()&&Tt(),!VGP.noCommand)switch(o.className){case"closelayericon":return e.stopPropagation(),void Ht(o.parentNode.id.slice(-1));case"eodmoveup":return e.stopPropagation(),void zt("up",o);case"eodmovedown":return e.stopPropagation(),void zt("down",o);case"eod_param":case"mci-p":return Yr.flagSave=!0,Lt(),void Yt((a="mci-p"==o.className?o.parentNode.getAttribute("data-name").split("_"):o.getAttribute("data-name").split("_")).length>1?a[1]:null,a[0],null)}if("touchstart"!=e.type)if(999!=Yr.lineNumber)Kt(Yr.lineNumber);else{if(Yr.cursorState)return void(Yr.moveLayer=!0);w("m"),r=s(e),n=l(b.gi(et("rodgraph-"))),Yr.moveZoomX=parseInt(r.x-n.left),Yr.moveZoomY=parseInt(r.y-n.top),Yr.initMaxY=Hr.maxY,Yr.initMinY=Hr.minY,Yr.initViewBegin=Hr.minX,Yr.initViewEnd=Hr.maxX}}function R(e){if("touchend"==e.type&&!Lr.mainChart.typedef.nolinearX){var t=e.touches[0]||e.changedTouches[0],a=l(b.gi(et("rodgraph-"))),r=parseInt(t.pageX-a.left),n=parseInt(t.pageY-a.top);if(Yr.lineNumber=B(r,n,Ie(r,n)),999!=Yr.lineNumber)return void Kt(Yr.lineNumber)}Yr.moveLayer=!1,Yr.activeLayer=null,Yr.moveZoomX=0,Yr.moveZoomY=0,w()}function A(e,t){var a,r=Rr[t].RealY-e;if(!(Rr[t].HeightPx+r<30||Rr[t-1].HeightPx-r<30))return Rr[t].Move(e,r,t),Rr[t].DrawEncadre(),b.idcss(et("infoindic-")+t,"top",e+5+"px"),Rr[t-1].Move(Rr[t-1].RealY,-r,t-1),Rr[t-1].DrawEncadre(),1==Yr.activeLayer&&((a=b.gi(et("trace-"))).height=a.height-r),void X(t)}function H(e,t){var a,r,n,o=Yr.initViewBegin,i=t-Yr.moveZoomY,l=i/Rr[0].PxPointY;Math.abs(i)<7&&(l=0),(0!=(a=Math.round((e-Yr.moveZoomX)/Rr[0].PxPointX))||0!=l)&&(r=!0,n=!0,("perf"==Lr.mainChart.type||Lr.set.semilog||t>Rr[0].RealY+Rr[0].HeightPx)&&(l=0),0==l&&(n=!1),Hr.maxY=Yr.initMaxY+l,Hr.minY=Yr.initMinY+l,o-Hr.minX==a&&(r=!1),Br.length<=200&&a<0&&(r=!1),o-a<0&&(r=!1),r&&(Hr.minX=o-a,Hr.maxX=Yr.initViewEnd-a),r||n)&&$(!0)}function B(e,t,a){var r;if(0!=a||Lr.hideTrace)return w(),999;for(var n,o=t-Lr.paddingTop,i=e-Lr.paddingLeft,l=Ar.length,s=0;s<l;s++)switch((n=Ar[s]).type){case"c":if(Cr(i,o,n))return w("p"),s;break;case"t":case"wf":if(Sr(i,o,n))return w("p"),s;break;case"ewi":case"ewc":if(kr(i,o,n))return w("p"),s;break;case"arrup":case"arrdw":case"arrrt":case"arrlt":case"sm1":case"sm2":if(Tr(i,o,n))return w("p"),s;break;default:if(i>=Math.min(n.RealX0,n.RealX1)-2&&i<Math.max(n.RealX0,n.RealX1)+2)switch(n.type){case"r":case"rf":case"m":if(o<(r="rf"==n.type?Math.ceil(n.RealY0+.618*(n.RealY0-n.RealY1)):n.RealY0)+4&&o>r-4||o<n.RealY1+4&&o>n.RealY1-4||i>=n.RealX0-2&&i<=n.RealX0+2||i>=n.RealX1-2&&i<=n.RealX1+2)return w("p"),s;break;case"sr":case"h":if(o>n.RealY0-3&&o<n.RealY0+3)return w("p"),s;break;case"mv":if(o>Math.min(n.RealY0,n.RealY1)-3&&o<Math.max(n.RealY0,n.RealY1)+3)return w("p"),s;break;default:var c=wr(n,i,o),d=i-c.x,u=o-c.y;if(Math.abs(Math.sqrt(d*d+u*u))<5)return w("p"),s}}return w(),999}function q(e){null!=Dr&&(0==Br.length||Br[Br.length-1].i<25||Hr.maxX-Hr.minX<25||(Hr.minX=Hr.minX+8*e,Y(),$(!0,!1)))}function G(e){if(null!=Dr){if(Lr.mainChart.typedef.nolinearX)Hr.minX>0?(Hr.minX=Hr.minX-8*e,Hr.minX<0&&(Hr.minX=0)):Hr.maxX=Hr.maxX+8*e,Hr.maxX>Hr.maxNL&&0==Hr.minX&&(Hr.maxX=Hr.maxNL);else if(Hr.minX>0)Hr.minX=Hr.minX-8*e,Hr.minX<0&&(Hr.minX=0);else if(Hr.maxX=Hr.maxX+8*e,Hr.maxX>Dr.QuoteTab.length-1){if(Hr.maxX=Dr.QuoteTab.length-1,Y(),1==Lr.histoLength&&!Lr.set.noVeilleIntra){var t=Dr.qv.c;t>Hr.maxY&&(Hr.maxY=t),t<Hr.minY&&(Hr.minY=t)}return void $(!0,!1)}Y(),$(!0,!1)}}function N(e,t,a){var r=Lr,n=new XMLHttpRequest;n.open("POST",VGP.urlWS+"TraceGetSymbol",!0),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.onload=function(){var o,i;if(n.status>=200&&n.status<400){if(null!=(o=JSON.parse(n.responseText))&&null!=o.d){i='"'==o.d.substring(0,1)?o.d.substr(1,o.d.length-2):o.d;try{Me(r.symbol,JSON.parse(i)),VGP.drawings[r.symbol]=1,t&&(Ar=JSON.parse(i),$())}catch(e){Ar=[],localStorage.removeItem(r.symbol),dt(),delete VGP.drawings[r.symbol]}}e&&Ae(a)}},n.send(JSON.stringify({userid:VGP.userID,symbol:r.symbol}))}function Y(){var e,t=0,a=999999,r=0,n=Hr.minX,o=Hr.maxX,i=Dr.QuoteTab;for(Lr.mainChart.typedef.nolinearX&&(n=0,o=i.length-1),e=n;e<=o;e++)null!=i[e]&&(0==r&&(r=i[e].c),i[e].h>t&&(t=i[e].h),i[e].l<a&&(a=Dr.QuoteTab[e].l));Hr.maxY=t,Hr.minY=a,Lr.isCompare&&qe(t,a,r,n,o)}function O(e){var t=b.gi(et("overlay-"));t.getContext("2d").clearRect(0,0,t.width,t.height),(e.wheelDelta||-e.detail)>0?q(1):G(1),e.preventDefault()}function $(e,t){Ve();var a,r=Rr.length;if(Lr.mainChart.typedef.nolinearX)return Rr[0].DrawEncadre(),Mt(t),void Be();for(a=0;a<r;a++)Rr[a].DrawEncadre();for(Ge(Dr,!1,e),a=1;a<r;a++)We(Rr[a]);e||Be()}function X(e,t){if(0==e)return Ve(),Rr[0].DrawEncadre(),Lr.mainChart.typedef.nolinearX?Mt(t):Ge(Dr),void Be();Rr[e-1].DrawEncadre(),Rr[e].DrawEncadre(),e-1==0&&Ge(Dr,!0),We(Rr[e-1]),We(Rr[e]),Be()}function F(){var e,t;if(!VGP.chartSimple&&((t=(e=b.gi(et("trace-"))).getContext("2d")).clearRect(0,0,e.width,e.height),"perf"!=Lr.mainChart.type&&!Lr.hideTrace))for(var a=Dr.QuoteTab[Hr.minX].d,r=Hr.maxX>Dr.QuoteTab.length-1?Le():Dr.QuoteTab[Hr.maxX].d,n=Ar.length,o=0;o<n;o++)if(null!=Ar[o])switch(Ar[o].type){case"fa":Ar[o].x0<r&&re(t,Ar[o],a);break;case"t":Ar[o].x0<r&&te(t,Ar[o],a);break;case"ewi":case"ewc":ee(t,Ar[o],a);break;case"gg":case"ga":case"ff":Ar[o].x0<r&&Z(t,Ar[o],a);break;case"wf":ae(t,Ar[o],a);break;case"arrup":case"arrdw":case"arrlt":case"arrrt":case"sm1":case"sm2":z(t,Ar[o],a);break;case"af":case"cf":case"an":case"c":case"ef":Z(t,Ar[o],a);break;case"sr":Ar[o].x0<r&&j(t,Ar[o],a);break;case"a":Ar[o].x0<r&&K(t,Ar[o],a);break;case"v":Ar[o].x0<r&&W(t,Ar[o],a);break;case"rf":case"r":case"m":(Ar[o].x1>a||Ar[o].x0>a)&&(Ar[o].x1<r||Ar[o].x0<r)&&J(t,Ar[o],a,r);break;case"h":U(t,Ar[o]);break;default:Ar[o].x1<=a&&Ar[o].x0<=a||Ar[o].x0>r?(Ar[o].RealX0=0,Ar[o].RealX1=0):Z(t,Ar[o],a)}}function Q(e,t,a,r,n){e.RealX0=t,e.RealY0=a,e.RealX1=r,e.RealY1=n}function U(e,t){var a;(a=Lr.set.semilog&&null!=Lr.logData?Xe(t.y0,Lr.logData):Math.round((Rr[0].V0-t.y0)*Rr[0].PxPointY))>0&&a<Rr[0].HeightPx&&ye(e,{my:a},t.style,t.width,t.color,!1),Q(t,0,a,Lr.innerWidth,a)}function W(e,t,a){var r=new Se(t.x0,t.y0,a);ve(e,r,t.style,t.width,t.color,!1),Q(t,r.mx,0,r.mx,r.my)}function z(e,t,a){var r=new Se(t.x0,t.y0,a);if(r.mx<0&&(r.mx=0),r.my>0&&r.my<Rr[0].HeightPx)switch(t.type){case"arrup":case"arrdw":case"arrrt":case"arrlt":le(e,r,t.color,t.type,t.color2,t.width);break;case"sm1":case"sm2":ie(e,r,t.color,t.type,t.width)}Q(t,r.mx,r.my,r.mx,r.my)}function j(e,t,a){var r=new Se(t.x0,t.y0,a);r.mx<0&&(r.mx=0),r.my>0&&r.my<Rr[0].HeightPx&&ge(e,r,t.style,t.width,t.color),Q(t,r.mx,r.my,Lr.innerWidth,r.my)}function J(e,t,a,r){var n=new Se(t.x0,t.y0,a),o=new Se(t.x1,t.y1,a),i=n.my,l=o.my,s=n.mx,c=o.mx;t.x0<a&&(s=n.mx=0),t.x1>r&&(c=o.mx=Lr.innerWidth),t.x0>r&&(s=n.mx=Lr.innerWidth),t.x1<a&&(c=o.mx=0),Q(t,s,i,c,l),(0!=s||0!=c)&&("rf"==t.type&&ke(e,t.color,t.color2,n,o,t.width),("r"==t.type||"m"==t.type)&&Ce(e,t.color,t.color2,n,o,t.type,t.h,t.width))}function K(e,t,a){var r,n=new Se(t.x0,t.y0,a),o=unescape(t.h);if(e.save(),e.fillStyle=t.color,e.font=t.style+"px Arial",r=e.measureText(o).width,n.mx+r<0)return Q(t,0,0,0,0),void e.restore();e.fillText(o,n.mx,n.my+4),e.restore(),Q(t,n.mx,n.my,n.mx+r,n.my)}function Z(e,t,a){var r,n=new Se(t.x0,t.y0,a),o=new Se(t.x1,t.y1,a);switch(t.type){case"ff":de(e,t.color,t.style,t.width,n,o);break;case"ga":ue(e,t.color,t.style,t.width,n,o);break;case"gg":he(e,t.color,t.style,t.width,n,o);break;case"cf":ne(e,t.color,t.style,t.width,n,o);break;case"af":me(e,t.color,t.style,t.width,n,o);break;case"an":o.mx=pe(e,t.color,t.style,t.width,n,o,t.h);break;case"c":fe(e,t.color,t.style,t.width,n,o,t.color2);break;default:r=t.h,"p"==t.type&&(r=Math.round(t.h*Rr[0].PxPointY)),xe(e,t.type,t.color,t.style,t.width,r,n,o,t.color2)}Q(t,n.mx,n.my,o.mx,o.my)}function ee(e,t,a){for(var r=[],n=t.h.length,o=0;o<n;o++)r.push(new Se(t.h[o].x,t.h[o].y,a));se(e,r,t.color,t.width),t.h=r}function te(e,t,a){var r=new Se(t.x0,t.y0,a),n=new Se(t.x1,t.y1,a),o=new Se(t.h.C.x,t.h.C.y,a);ce(e,r,n,o,t.color,t.color2,t.width),Q(t,r.mx,r.my,n.mx,n.my),t.h.C=o}function ae(e,t,a){var r=new Se(t.x0,t.y0,a),n=new Se(t.x1,t.y1,a),o=new Se(t.h.C.x,t.h.C.y,a);Ta(e,r,n,o,t.color,t.color2,t.width),Q(t,r.mx,r.my,n.mx,n.my),t.h.C=o}function re(e,t,a){var r=new Se(t.x0,t.y0,a),n=new Se(t.x1,t.y1,a),o=new Se(t.h.B.x,t.h.B.y,a),i=new Se(t.h.C.x,t.h.C.y,a);oe(e,r,o,i,t.color,t.color2,t.width),Q(t,r.mx,r.my,n.mx,n.my),t.h.B=o,t.h.C=i}function ne(e,t,a,r,n,o){var i,l,s,c,d;for(e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(o.mx,o.my),e.stroke(),i=o.mx-n.mx,l=[0,1,2,3,5,8,13,21,34,55],null!=a&&null!=r?(e.lineWidth=r,xr(e,a)):e.lineWidth=1,e.fillStyle=t,e.font="11px Arial",e.beginPath(),d=l.length,c=0;c<d;c++)s=n.mx+i*l[c]+.5,e.moveTo(s,0),e.lineTo(s,Rr[0].HeightPx),e.fillText(l[c],s+2,Rr[0].HeightPx-3);e.stroke(),e.restore()}function oe(e,t,a,r,n,o,i){var l,s,c,d;e.save(),e.strokeStyle=n,e.beginPath();var h=a.mx+Math.round((r.mx-a.mx)/2),p=a.my+Math.round((r.my-a.my)/2),m=(t.my-p)/(h-t.mx),f=3e3;return h<t.mx&&(f=-f),l=t.mx+f,s=t.my-f*m,e.lineWidth=null!=i?i:1,e.moveTo(a.mx+f,a.my-f*m),e.lineTo(a.mx,a.my),e.lineTo(r.mx,r.my),e.lineTo(r.mx+f,r.my-f*m),e.fillStyle=u(o,.15),e.fill(),e.moveTo(t.mx,t.my),e.lineTo(l,s),e.stroke(),e.setLineDash&&e.setLineDash([2]),e.beginPath(),c=a.mx+Math.round((h-a.mx)/2),d=a.my+Math.round((p-a.my)/2),e.moveTo(c,d),e.lineTo(c+f,d-f*m),c=h+Math.round((r.mx-h)/2),d=p+Math.round((r.my-p)/2),e.moveTo(c,d),e.lineTo(c+f,d-f*m),e.stroke(),e.restore(),{Dx:l,Dy:s}}function ie(e,t,a,r,n){var o,i,l=10+2*n,s=4+n;e.save(),e.strokeStyle=a,e.beginPath(),e.arc(t.mx,t.my,l,0,2*Math.PI,!1),e.lineWidth=2,e.stroke(),e.beginPath(),o=t.mx-s,i=t.my-s,e.arc(o,i,2,0,2*Math.PI,!1),o=t.mx+s,e.arc(o,i,2,0,2*Math.PI,!1),e.fillStyle=a,e.fill(),e.beginPath(),"sm1"==r?e.arc(t.mx,t.my,l-7,0,Math.PI,!1):e.arc(t.mx,t.my+l/2,l-7,Math.PI,2*Math.PI,!1),e.stroke(),e.restore()}function le(e,t,a,r,n,o){var i,l;switch(r){case"arrup":case"arrlt":i=8.5+o,l=15.5+2*o;break;case"arrdw":case"arrrt":i=-8.5-o,l=-15.5-2*o}e.save(),e.strokeStyle=a,e.beginPath(),e.moveTo(t.mx,t.my),"arrlt"==r||"arrrt"==r?(e.lineTo(t.mx+i,t.my-6.5-o),e.lineTo(t.mx+i,t.my-1.5-o),e.lineTo(t.mx+l,t.my-1.5-o),e.lineTo(t.mx+l,t.my+1.5+o),e.lineTo(t.mx+i,t.my+1.5+o),e.lineTo(t.mx+i,t.my+6.5+o),e.lineTo(t.mx,t.my)):(e.lineTo(t.mx-6.5-o,t.my+i),e.lineTo(t.mx-1.5-o,t.my+i),e.lineTo(t.mx-1.5-o,t.my+l),e.lineTo(t.mx+1.5+o,t.my+l),e.lineTo(t.mx+1.5+o,t.my+i),e.lineTo(t.mx+6.5+o,t.my+i),e.lineTo(t.mx,t.my)),e.fillStyle=n,e.fill(),e.stroke(),e.restore()}function se(e,t,a,r){e.strokeStyle=a,e.fillStyle=a,e.font="14px Arial",e.lineWidth=null!=r?r:1,e.beginPath(),e.moveTo(t[0].mx,t[0].my);for(var n,o=t.length,i=6==t.length?["1","2","3","4","5"]:["a","b","c"],l=1;l<o;l++)e.lineTo(t[l].mx,t[l].my),n=t[l].my<t[l-1].my?-7:16,e.fillText(i[l-1],t[l].mx-4,t[l].my+n);e.stroke()}function ce(e,t,a,r,n,o,i){e.strokeStyle=n,e.lineWidth=null!=i?i:1,e.beginPath(),e.moveTo(t.mx,t.my),e.lineTo(a.mx,a.my),e.lineTo(r.mx,r.my),e.lineTo(t.mx,t.my),e.stroke(),null!=o&&(e.fillStyle=u(o,.15),e.fill())}function de(e,t,a,r,n,o){var i;e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(o.mx,o.my),e.stroke(),null!=a&&null!=r?(e.lineWidth=r,xr(e,a)):e.lineWidth=1;var l,s,c,d,u=n.my-o.my,h=1500,p=200,m=[.25,.382,.5,.618,.75],f=["0.25","0.382","0.5","0.618","0.75"];for(e.fillStyle=t,e.font="12px Arial",e.beginPath(),i=m.length,c=0;c<i;c++)d=Math.atan(u/m[c]/Math.abs(n.mx-o.mx)),l=n.my-h*Math.sin(d),s=n.mx+h*Math.cos(d),e.moveTo(n.mx,n.my),e.lineTo(s,l),l=n.my-p*Math.sin(d),s=n.mx+p*Math.cos(d),e.fillText(f[c],s,l),d=Math.atan(u*m[c]/Math.abs(n.mx-o.mx)),l=n.my-h*Math.sin(d),s=n.mx+h*Math.cos(d),e.moveTo(n.mx,n.my),e.lineTo(s,l),l=n.my-p*Math.sin(d),s=n.mx+p*Math.cos(d),e.fillText(f[c],s,l);e.stroke(),e.restore()}function ue(e,t,a,r,n,o){var i;e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(o.mx,o.my),e.stroke(),null!=a&&null!=r?(e.lineWidth=r,xr(e,a)):e.lineWidth=1;var l,s,c,d,u=n.my-o.my,h=[8,4,3,2,1,.5,.333,.25,.125],p=["8x1","4x1","3x1","2x1","1x1","1x2","1x3","1x4","1x8"];for(e.fillStyle=t,e.font="12px Arial",e.beginPath(),i=h.length,c=0;c<i;c++)d=Math.atan(u/h[c]/Math.abs(n.mx-o.mx)),l=n.my-1500*Math.sin(d),s=n.mx+1500*Math.cos(d),e.moveTo(n.mx,n.my),e.lineTo(s,l),l=n.my-180*Math.sin(d),s=n.mx+180*Math.cos(d),e.fillText(p[c],s,l);e.stroke(),e.restore()}function he(e,t,a,r,n,o){e.save(),e.strokeStyle=t,e.lineWidth=2,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(o.mx,o.my),e.stroke(),null!=a&&null!=r?(e.lineWidth=r,xr(e,a)):e.lineWidth=1;var i,l=(n.my-o.my)/Math.abs(n.mx-o.mx),s=n.mx-o.mx>0?-1:1,c=n.my-1500*l,d=n.mx+1500*s,u=2*(n.my-o.my),h=n.my+1500*l;for(e.beginPath(),i=-20;i<20;i++)e.moveTo(n.mx,n.my+u*i),e.lineTo(d,c+u*i),e.moveTo(n.mx,n.my+u*i),e.lineTo(d,h+u*i);e.stroke(),e.restore()}function pe(e,t,a,r,n,o,i){var l,s;return e.save(),e.strokeStyle=t,e.beginPath(),e.moveTo(n.mx+50,n.my+.5),e.lineTo(n.mx,n.my+.5),e.stroke(),l=!(i>=0),e.beginPath(),e.arc(n.mx,n.my,30,-i,0,l),e.stroke(),s=(n.my-o.my)/Math.tan(i),null!=a&&null!=r?(e.lineWidth=r,xr(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(n.mx+s,o.my),e.stroke(),e.fillStyle=t,e.font="12px Arial",e.fillText((180*i/Math.PI).toFixed(0)+"°",n.mx+55,n.my),e.restore(),n.mx+s}function me(e,t,a,r,n,o){var i,l,s,c,d;e.save();var h=Math.abs(n.mx-o.mx),p=Math.abs(n.my-o.my),m=Math.sqrt(h*h+p*p);for(e.strokeStyle=t,e.beginPath(),e.moveTo(n.mx,n.my),e.lineTo(o.mx,o.my),e.stroke(),null!=a&&null!=r?(e.lineWidth=r,xr(e,a)):e.lineWidth=1,e.strokeStyle=u(t,.7),e.fillStyle=t,i=!0,n.y>o.y&&(i=!1),d=(s=[.236,.5,.786,1,1.618,2.618]).length,c=0;c<d;c++)e.beginPath(),e.arc(n.mx,n.my,m*s[c],0,Math.PI,i),e.stroke(),l=i?n.my-m*s[c]-2:n.my+m*s[c]+10,e.fillText(s[c].toFixed(3),n.mx-15,l);e.restore()}function fe(e,t,a,r,n,o,i){e.save(),e.beginPath();var l=Math.abs(n.mx-o.mx),s=Math.abs(n.my-o.my);e.translate(n.mx-l,n.my-s),e.scale(l,s),e.arc(1,1,1,0,2*Math.PI,!1),e.restore(),e.save(),e.strokeStyle=t,null!=a&&null!=r?(e.lineWidth=r,xr(e,a)):e.lineWidth=1,e.stroke(),null!=i&&(e.fillStyle=u(i,.15),e.fill()),e.restore()}function ge(e,t,a,r,n){var o=.5;e.strokeStyle=n,e.save(),null!=a&&null!=r?(e.lineWidth=r,r%2==0&&(o=0),xr(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(t.mx,t.my+o),e.lineTo(Lr.innerWidth,t.my+o),e.stroke(),e.fillStyle=n,e.font="11px Arial",e.fillText(t.y.toFixed(2),t.mx+5,t.my-2),e.restore()}function ve(e,t,a,r,n,o){var i,l=.5;e.strokeStyle=n,e.save(),null!=a&&null!=r?(e.lineWidth=r,r%2==0&&(l=0),xr(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(t.mx+l,0),e.lineTo(t.mx+l,Rr[0].HeightPx),e.stroke(),e.fillStyle=n,e.font="11px Arial",i=t.mx+3,Lr.innerWidth-t.mx<60&&(i=t.mx-60),o&&(Lr.chartPeriod<0?e.fillText(m(t.x),i,Rr[0].HeightPx-2):e.fillText(g(t.x,2),i,Rr[0].HeightPx-2)),e.restore()}function ye(e,t,a,r,n,o){var i,l=.5;e.strokeStyle=n,e.save(),null!=a&&null!=r?(e.lineWidth=r,r%2==0&&(l=0),xr(e,a)):e.lineWidth=1,e.beginPath(),e.moveTo(0,t.my+l),e.lineTo(Lr.innerWidth,t.my+l),e.stroke(),o&&(e.fillStyle=n,e.font="11px Arial",i=t.y,e.fillText(i.toFixed(2),5,t.my-2)),e.restore()}function be(e,t,a,r,n){e.save(),e.font=a+"px Arial",e.fillStyle=r;var o=t.mx+e.measureText(n).width;return e.fillText(n,t.mx,t.my+4),e.restore(),Math.round(o)}function xe(e,t,a,r,n,o,i,l,s){var c,d,h,p;return e.save(),xr(e,r),e.strokeStyle=a,c=.5,null!=n?(e.lineWidth=n,n%2==0&&(c=0)):e.lineWidth=1,e.beginPath(),"mv"==t?(e.moveTo(l.mx-10,l.my+.5),e.lineTo(l.mx+10,l.my+.5),e.moveTo(l.mx-10,i.my+.5),e.lineTo(l.mx+10,i.my+.5),l.y<i.y?(e.moveTo(l.mx-8,l.my-8),e.lineTo(l.mx,l.my),e.lineTo(l.mx+8,l.my-8)):(e.moveTo(l.mx-8,l.my+8),e.lineTo(l.mx,l.my+1),e.lineTo(l.mx+8,l.my+8)),e.moveTo(i.mx+.5,i.my),e.lineTo(l.mx+.5,l.my),e.stroke(),d=100*(l.y-i.y)/i.y,h=(l.y-i.y).toFixed(2),e.fillStyle=a,e.font="11px Arial",p=Math.min(l.my,i.my)+Math.abs((l.my-i.my)/2),e.fillText(h,l.mx+5,p),e.fillText(d.toFixed(2)+"%",l.mx+5,p+14),void e.restore()):"mh"==t?(e.moveTo(l.mx+.5,i.my-10),e.lineTo(l.mx+.5,i.my+10),e.moveTo(i.mx+.5,i.my-10),e.lineTo(i.mx+.5,i.my+10),e.moveTo(Math.max(l.mx,i.mx)-8,l.my-8),e.lineTo(Math.max(l.mx,i.mx),l.my),e.lineTo(Math.max(l.mx,i.mx)-8,l.my+8),e.moveTo(i.mx,i.my+.5),e.lineTo(l.mx,l.my+.5),e.stroke(),e.fillStyle=a,e.font="11px Arial",e.fillText(we(i.x,l.x),Math.min(l.mx,i.mx)+5,i.my+11),void e.restore()):(e.moveTo(i.mx,i.my+c),e.lineTo(l.mx,l.my+c),"p"==t&&(e.moveTo(i.mx,i.my+o+c),e.lineTo(l.mx,l.my+o+c)),e.stroke(),"p"==t&&null!=s&&(e.moveTo(i.mx,i.my+c),e.lineTo(l.mx,l.my+c),e.lineTo(l.mx,l.my+o+c),e.lineTo(i.mx,i.my+o+c),e.fillStyle=u(s,.15),e.fill()),"ef"==t&&function(e,t,a,r,n,o){var i,l,s,c,d,h,p,m,f=l=a.my,g=i=t.my,v=t.mx,y=a.mx,b=t.y,x=a.y,w=Math.max(v,y);for(null==o&&(o=250),v>y&&(f=i,g=l,b=a.y,x=t.y),e.beginPath(),s=g-f,(1==e.lineWidth||3==e.lineWidth)&&(f+=.5),h=(c=[0,.236,.382,.5,.618,1,1.618,2.618]).length,d=0;d<h;d++)e.moveTo(w,f-Math.round(s*c[d])),e.lineTo(w+o,f-Math.round(s*c[d]));for(e.stroke(),null!=n&&(e.fillStyle=u(n,.15),e.fillRect(w,f,o,-Math.round(2.618*s))),f-=3,e.font="11px Arial",e.fillStyle=r,d=0;d<h;d++)m=f-Math.round(s*c[d]),p=x+(x-b)*c[d],e.fillText(p.toFixed(2)+"  ("+(100*c[d]).toFixed(1)+"%)",w,m)}(e,i,l,a,s,o),"f"==t&&(1==o||null==o?Te(e,i.mx,l.mx+1,i.my,l.my,a):Te(e,l.mx,i.mx-1,l.my,i.my,a)),void e.restore())}function we(e,t){var a="";return null!=Rr[0].Bars[0][e]&&null!=Rr[0].Bars[0][t]&&(a=" - "+Math.abs(Rr[0].Bars[0][t].i-Rr[0].Bars[0][e].i)+lang.l_barres),Lr.chartPeriod>=0?Math.abs(e-t)+lang.l_jours+a:""!=a?f(Math.abs((Rr[0].Bars[0][t].i-Rr[0].Bars[0][e].i)*parseInt(Lr.chartPeriod)))+a:f(Math.abs(t-e))}function Te(e,t,a,r,n,o){var i=a-t,l=n-r,s=Math.sqrt(i*i+l*l),c=i/s,d=l/s,u=Math.round(a-8*c-8*d),h=Math.round(n-8*d+8*c),p=Math.round(a-8*c+8*d),m=Math.round(n-8*d-8*c);e.fillStyle=o,e.lineWidth=1,e.beginPath(),e.moveTo(a,n),e.lineTo(u,h),e.lineTo(p,m),e.lineTo(a,n),e.fill(),e.stroke()}function Ce(e,t,a,r,n,o,i,l){var s,c,d,h,p,m,f=r.mx,g=n.mx,v=r.my,y=n.my,b=.5;if(null!=l?(e.lineWidth=l,l%2==0&&(b=0)):e.lineWidth=1,e.strokeStyle=t,e.beginPath(),e.rect(f+b,v+b,g-f,y-v),e.stroke(),"m"==o){e.save(),e.setLineDash&&e.setLineDash([1,1]),s=Math.round((g+f)/2),e.moveTo(s+.5,v),e.lineTo(s+.5,y);var x=Math.min(v,y),w=Math.max(v,y),T=Math.min(f,g);0==i?(e.moveTo(s-5,w-5),e.lineTo(s,w),e.lineTo(s+5,w-5)):(e.moveTo(s-5,x+5),e.lineTo(s,x),e.lineTo(s+5,x+5)),c=Math.round((y+v)/2),e.moveTo(f,c+.5),e.lineTo(g,c+.5),e.lineTo(g-5,c-5),e.moveTo(g,c),e.lineTo(g-5,c+5),e.moveTo(f+5,c+5),e.lineTo(f,c),e.lineTo(f+5,c-5),e.stroke(),e.restore(),d=Math.min(r.y,n.y),h=Math.max(r.y,n.y),1==i?(p=100*(h-d)/d,m=(h-d).toFixed(2)+"€ ("+p.toFixed(2)+"%)"):(p=100*(d-h)/h,m=(d-h).toFixed(2)+"€ ("+p.toFixed(2)+"%)"),e.fillStyle=t,e.font="11px Arial",e.fillText(m,T+5,w-6),e.fillText(we(r.x,n.x),T+5,w+11)}null!=a&&(e.fillStyle=u(a,.15),e.fill())}function ke(e,t,a,r,n,o,i){var l,s,c,d,h,p,m,f=.5;null!=o?(e.lineWidth=o,o%2==0&&(f=0)):e.lineWidth=1;var g=r.my,v=n.my,y=r.mx,b=n.mx,x=r.y,w=n.y;for(i&&(g=n.my,v=r.my,x=n.y,w=r.y),e.strokeStyle=t,e.beginPath(),l=g-v,v+=f,d=(s=[0,.236,.382,.5,.618,.786,1,1.618]).length,c=0;c<d;c++)e.moveTo(y,v+Math.round(l*s[c])),e.lineTo(b,v+Math.round(l*s[c]));for(e.stroke(),h=Math.min(y,b),null!=a&&(e.fillStyle=u(a,.15),e.fillRect(h,v,Math.abs(b-y),Math.round(1.618*l))),v-=1.5,e.font="11px Arial",e.fillStyle=t,c=0;c<d;c++)p=v+Math.round(l*s[c]),m=w+(x-w)*s[c],e.fillText(m.toFixed(2)+"  ("+(100*s[c]).toFixed(1)+"%)",h,p)}function Se(e,t,a){var r,n,o,i,l,s;if(this.x=e,this.y=t,r=Lr,this.my=r.set.semilog&&null!=r.logData&&0!=t?Xe(t,r.logData):Math.round((Rr[0].V0-t)*Rr[0].PxPointY),null!=Rr[0].Bars[0][e])this.mx=Math.round(Rr[0].Bars[0][e].i*Rr[0].PxPointX+r.padBarCandle);else if(o=Rr[0].Bars[0][0].d,e>=a){if(e>o)i=Rr[0].Bars[0][0].i,l=Pe(e-o),this.mx=Math.round((i+l)*Rr[0].PxPointX+r.padBarCandle);else for(n=e-5;n<=o;n++)if(null!=Rr[0].Bars[0][n]){this.mx=Math.round(Rr[0].Bars[0][n].i*Rr[0].PxPointX+r.padBarCandle);break}}else s=Dr.Xperiod<0?Math.floor((a-e+515)/1e4)>=1?(e-a+9485*Math.floor((a-e+515)/1e4))/-Dr.Xperiod:(e-a)*-Dr.Xperiod:Pe(e-a),this.mx=Math.round(s*Rr[0].PxPointX+r.padBarCandle)}function Pe(e){if(Dr.Xperiod<0)e*=-1/Dr.Xperiod;else switch(Dr.Xperiod){case 7:e/=7;break;case 30:e/=30;break;case 91:e/=91;break;case 365:e/=365;break;default:e=5*e/7}return e<1&&e>0?e=1:e>-1&&e<0&&(e=-1),e}function Me(e,t,a){if(!r())return!1;Lr.chartPeriod<0||a?sessionStorage.setItem(e,JSON.stringify(t)):localStorage.setItem(e,JSON.stringify(t))}function _e(e){var t;if(!r())return[];if(null!=(t=Lr.chartPeriod<0?sessionStorage.getItem(e):localStorage.getItem(e))&&""!=t&&"[]"!=t){for(var n=JSON.parse(t),o=n.length,i=0,l=0;l<o;l++)"a"==n[l].type&&(n[l].h=a(n[l].h),i=1);return 1==i&&localStorage.setItem(e,JSON.stringify(n)),n}return Lr.chartPeriod>=0&&localStorage.removeItem(e),[]}function Ee(e){var t,a,r,n;switch(e){case"topinfo":(t=document.createElement("div")).id=et("eod_topinfo-"),t.setAttribute("class","eod_topinfo"),t.style.left=Lr.paddingLeft+2+"px",t.style.width=Lr.innerWidth+"px",t.style.color=Lr.set.txtColor,11!=Lr.set.fontSize&&(t.style.fontSize=Lr.set.fontSize+"px"),a=document.createElement("span"),t.appendChild(a),r=document.createElement("span"),t.appendChild(r),(n=document.createElement("span")).setAttribute("class","fr"),t.appendChild(n),Vr.doc.appendChild(t);break;case"overlay":(t=document.createElement("canvas")).id=et("overlay-"),t.setAttribute("height",Lr.heightGraph),t.setAttribute("width",Lr.widthGraph),Vr.doc.appendChild(t);break;case"trace":(t=document.createElement("canvas")).id=et("trace-"),t.style.left=Lr.paddingLeft+"px",t.style.top=Lr.paddingTop+"px",t.setAttribute("height",Rr[0].HeightPx),t.setAttribute("width",Lr.innerWidth),t.setAttribute("tabindex","0"),Vr.doc.appendChild(t);break;case"mainci":(t=document.createElement("div")).id=et("eod_mainchartinfos-"),t.setAttribute("class","eod_mainchartinfos"),t.style.left=Lr.paddingLeft+2+"px",t.style.top=Lr.paddingTop+4+"px",t.style.color=Lr.set.txtColor,11!=Lr.set.fontSize&&(t.style.fontSize=Lr.set.fontSize+"px"),Vr.doc.appendChild(t);break;case"rodgraph":Vr.doc.innerHTML='<canvas id="rodgraph-'+Vr.callID+'" style="background-color:'+Lr.set.bkcolor+'" width="'+Lr.widthGraph+'" height="'+Lr.heightGraph+'" ></canvas>'}}function Ve(){Vr.ctxback.clearRect(0,0,Lr.widthGraph,Lr.heightGraph),Vr.ctxback.font=Lr.set.fontSize+"px Arial"}function Le(e){var t;if(null==e&&(e=Hr.maxX-(Dr.QuoteTab.length-1)),Dr.Xperiod<0)t=-Dr.Xperiod;else switch(Dr.Xperiod){case 7:t=7;break;case 30:t=30;break;case 91:t=91;break;case 365:t=365;break;default:t=1.4}return Math.round(t*e)+Dr.QuoteTab[Dr.QuoteTab.length-1].d}function Ie(e,t){if(e>Lr.widthGraph-Lr.paddingRight||e<Lr.paddingLeft)return null;for(var a=Rr.length,r=0;r<a;r++)if(t>=Rr[r].RealY&&t<=Rr[r].RealY+Rr[r].HeightPx)return r;return null}function De(e){Ee("rodgraph");var t=b.gi(et("rodgraph-"));Vr.ctxback=t.getContext("2d"),Ve(),null!=e?function(e){var t,a,r,n,o,i=Lr,l=new qt(0,e[0].Height,i.mainChart.type,et("main-"),0);for(l.Create(),l.DrawEncadre(),t=e.length,a=1;a<t;a++)(r=new qt(e[a].Y,e[a].Height,e[a].Indicator,et("indic-")+a,i.marginInter*a)).Create(),r.DrawEncadre(),o=Math.round(e[a].Y*i.usableHeight)+i.paddingTop+i.marginInter*a+5,n=Vt(Vr.callID+a,e[a].Indicator.type,i.paddingLeft+5,o,i.innerWidth-7),Vr.doc.appendChild(n),t>2&&Rt(a,a==t-1)}(e):function(){var e,t,a,r,n,o,i,l,s;for(t=[0,.25,.2,.1666,.15,.13,.12][Lr.indicators.length],e=r=[1,.75,.6,.5002,.4,.35,.28][Lr.indicators.length],(n=new qt(0,r,Lr.mainChart.type,et("main-"),0)).Create(),n.DrawEncadre(),o=Lr.indicators.length,a=0;a<o;a++)(i=new qt(e,t,Lr.indicators[a],et("indic-")+(a+1),Lr.marginInter*(a+1))).Create(),i.DrawEncadre(),l=Math.round(e*Lr.usableHeight)+Lr.paddingTop+Lr.marginInter*(a+1)+5,s=Vt(Vr.callID+(a+1),Lr.indicators[a].type,Lr.paddingLeft+5,l,Lr.innerWidth-7),Vr.doc.appendChild(s),e+=t,o>1&&Rt(a+1,a==o-1)}(Vr.doc),VGP.chartSimple||(Ee("topinfo"),Ee("overlay"),Ee("trace"),Ee("mainci"),null!=Dr&&b.qstxt(et("#eod_topinfo-")+" span",Dr.Name))}function Re(e){0==VGP.drawings[Lr.symbol]&&Lr.chartPeriod>=0&&!VGP.noCommand&&!VGP.noAutoReadTrace?N(!0,!1,e):Ae(e)}function Ae(e,t){var a,r,n,o,i,l;if(null==Lr.histoLength&&(Lr.histoLength=365),null==Lr.chartPeriod&&(Lr.chartPeriod=Lr.histoLength>20?0:-1),"function"==typeof stopTimers&&stopTimers(),VGP.noCommand||((a=b.gi(et("trace-"))).getContext("2d").clearRect(0,0,a.width,a.height),Ar=_e(Lr.symbol)),r=Lr.dataSource){if(""==(n=b.gigt(r)))return;null!=(o=JSON.parse(n))&&(Dr=y(o),He(o,e))}else i=VGP.urlWS+"GetTicksEOD","GET"==VGP.callType&&(i=i+"?symbol="+Lr.symbol+"&length="+Lr.histoLength+"&period="+Lr.chartPeriod+"&guid="+b.gigt("guid")),(l=new XMLHttpRequest).open(VGP.callType,i,!0),l.setRequestHeader("Content-Type","application/json;charset=UTF-8"),l.onload=function(){var a,r,n,o,i,s,c,d,u;if(l.status>=200&&l.status<400)if(null!=(a=JSON.parse(l.responseText))&&null!=a.d)if(Dr=y(a.d),r=Lr.mainChart.indicators,Lr.isCompare){for(s=r.length,c="",n=0;n<s;n++)"compare"==r[n].type&&(c+=r[n].symbol+";");""!=c&&(c=c.substring(0,c.length-1),d=VGP.urlWS+"GetTicksList","GET"==VGP.callType&&(d=d+"?symbols="+c+"&length="+Lr.histoLength+"&period="+Lr.chartPeriod+"&guid="+b.gigt("guid")),(u=new XMLHttpRequest).open(VGP.callType,d,!0),u.setRequestHeader("Content-Type","application/json;charset=UTF-8"),u.onload=function(){if(u.status>=200&&u.status<400){var t=JSON.parse(u.responseText);if(null!=t&&null!=t.d)for(i=t.d.length,n=0;n<s;n++)if("compare"==r[n].type)for(o=0;o<i;o++)if(t.d[o].SymbolId==r[n].symbol){r[n].datas2=t.d[o];break}He(a.d,e)}},u.send(JSON.stringify({symbols:c,length:Lr.histoLength,period:Lr.chartPeriod,guid:b.gigt("guid")})))}else He(a.d,e);else"function"==typeof DisplayAlert&&(Lr.chartPeriod<0?DisplayAlert(lang.l_msg3,3):DisplayAlert(lang.l_msg4,4)),t&&(Lr.chartPeriod=t.chartPeriod,Lr.histoLength=t.histoLength)},l.send(JSON.stringify({symbol:Lr.symbol,length:Lr.histoLength,period:Lr.chartPeriod,guid:b.gigt("guid")}))}function He(e,t){var a,r,n;if(Hr.minX=0,Hr.maxX=e.QuoteTab.length-1,Hr.maxY=e.High,Hr.minY=e.Low,Lr.isCompare&&qe(e.High,e.Low,Dr.QuoteTab[0].c),1!=Lr.histoLength||Lr.set.noVeilleIntra||((a=e.qv.c)>Hr.maxY&&(Hr.maxY=a),a<Hr.minY&&(Hr.minY=a)),Hr.qv=e.qv,Hr.qd=e.qd,Lr.chartPeriod=parseInt(e.Xperiod),0==t)if(Lr.mainChart.typedef.nolinearX)Mt(!0);else for(Ge(e),n=Rr.length,r=1;r<n;r++)We(Rr[r]);else $(!1,!0);VGP.chartSimple||(P(),b.qstxt(et("#eod_topinfo-")+" span",e.Name),Ke()),"function"==typeof launchTimers&&launchTimers(Vr.callID,Lr.chartPeriod,Lr.symbol),Be()}function Be(){if(Lr.mainChart.typedef.nolinearX)"function"==typeof extIndicatorsList&&extIndicatorsList({ind1:a,ind2:r});else{for(var e,t,a=[],r=[],n=0;n<Lr.mainChart.indicators.length;n++)"actu"!=(e=Lr.mainChart.indicators[n]).type&&"evt"!=e.type&&(t="compare"==e.type?e.datas2?e.datas2.Name:"NC":e.param1?" ("+e.param1+")":"",a[n]={id:n,name:e.type,color:e.color,param:t,bkcolor:St(e.color)});for(n=1;n<Rr.length;n++)"volume"!=(e=Rr[n].Indicator).type&&(t=e.param1?" ("+e.param1+")":"",r[n]={id:n,name:e.type,color:e.color,param:t,bkcolor:St(e.color)});"function"==typeof extIndicatorsList&&extIndicatorsList({ind1:a,ind2:r})}}function qe(e,t,a,r,n){for(var o,i,l,s,c=Lr.mainChart.indicators.length,d=-1e3,u=1e3,h=0;h<c;h++)"compare"==Lr.mainChart.indicators[h].type&&(l=Lr.mainChart.indicators[h].datas2)&&(s=l.QuoteTab[0].c,Lr.mainChart.indicators[h].datas2=y(Lr.mainChart.indicators[h].datas2,r,n),(o=(l.High-s)/s)>d&&(d=o),(i=(l.Low-s)/s)<u&&(u=i));(o=(e-a)/a)>d&&(d=o),(i=(t-a)/a)<u&&(u=i),Hr.maxY=a*(1+d),Hr.minY=a*(1+u)}function Ge(e,t,a){var r,o,i,l,s,d,h,p,f,y,x,w,T,C,k,S,P,M,_,E,V,L,I,D,R,A,H,B,q,G,N,Y,O,$,X,Q,U;if(null!=e){r={Name:e.Name,High:e.High,Low:e.Low,QuoteTab:e.QuoteTab},0==Hr.maxX&&0==Hr.minX&&(Hr.maxX=r.QuoteTab.length-1,Hr.minX=0),r.QuoteTab=Ne(e.QuoteTab);var W,z=r.High,j=r.Low,J=r.QuoteTab.length,K=Rr[0];0==Hr.maxY&&0==Hr.minY?(Hr.maxY=z,Hr.minY=j):(z=Hr.maxY,j=Hr.minY),z==j&&(z*=1.01,j*=.99),o=Lr.mainChart.typedef,i=57,57==K.HeightPx&&(i=56),K.PxPointY=(K.HeightPx-i)/(z-j),K.V0=z+(i-20)/K.PxPointY;var Z,ee=K.V0,te=K.PxPointY,ae=K.ctx;if(-1!=["bar","candle","barcolor","hollow","heikin ashi"].indexOf(Lr.mainChart.type)?((Z=Math.floor(Lr.innerWidth/J)-3)%2==0&&Z++,Z>19?Z=19:Z<3&&(Z=3),Lr.padBarCandle=2+Z):Lr.padBarCandle=0,l=Lr.paddingLeft+Lr.padBarCandle,"perf"==Lr.mainChart.type&&(j=(r=n.computePERFORMANCE(r)).Low<0?1.05*r.Low:.95*r.Low,z=r.High>0?1.05*r.High:.95*r.High,te=(K.HeightPx-i)/(z-j),K.PxPointY=te,ee=z+(i-20)/K.PxPointY,K.V0=ee),"heikin ashi"==Lr.mainChart.type&&!(r=function(e){var t,a,r,n,o,i,l,s={QuoteTab:e.QuoteTab},c=[],d=s.QuoteTab.length;if(d<2)return!1;for(i=s.QuoteTab[0],c[0]={d:i.d,o:i.o,h:i.h,l:i.l,c:i.c,v:i.v},t=1;t<d;t++)null!=(l=s.QuoteTab[t])&&(o=(l.o+l.h+l.l+l.c)/4,a=(c[t-1].o+c[t-1].c)/2,r=Math.max(l.h,o,a),n=Math.min(l.l,a,o),c[t]={d:l.d,o:+a.toFixed(3),h:+r.toFixed(3),l:+n.toFixed(3),c:+o.toFixed(3),v:l.v});return{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:c}}(r)))return qr={},J=[],void(K.Bars[0]={});switch(s=null,Lr.set.semilog&&"perf"!=Lr.mainChart.type&&!Lr.isCompare&&(s=function(e,t){var a=(e-t)/100;(t-=a)<=0&&(t=.98*(t+a));var r=Math.log10(t)/Math.log10(10),n=Math.log10(e+4*a)/Math.log10(10);return{floor:r,ceil:n,range:n-r}}(z,j)),Lr.logData=s,Lr.isCompare?Oe(ae,K.HeightPx,l,ee,te,!0):Lr.set.semilog&&"perf"!=Lr.mainChart.type?Oe(ae,K.HeightPx,l,ee,te,!1,!0):Oe(ae,K.HeightPx,l,ee,te),y=1==J?Lr.innerWidth-2*Lr.padBarCandle:(Lr.innerWidth-2*Lr.padBarCandle)/(J-1),K.PxPointX=y,t?Ye(K):Ye(K,!0,r.QuoteTab),qr={},Br=[],K.Bars[0]={},x=l-1,w={},Lr.mainChart.type){case"perf":for(ae.save(),ae.beginPath(),h=(ee-r.QuoteTab[0].c)*te,ae.moveTo(l,h),W=0;W<J;W++)if(null!=(T=r.QuoteTab[W])){if(d=Math.round(W*y+l),Br[d-Lr.paddingLeft]={d:T.d,i:W},ae.lineTo(d+.5,Math.round((ee-T.c)*te)+.5),y<2)qr[d]=T.d;else for(p=-1;p<=1;p++)qr[d+p]=T.d;w[T.d]={c:T.c.toFixed(2),i:W},E=W}T=r.QuoteTab[E],w[0]={c:T.c.toFixed(2),i:E,d:T.d},o.v1||(ae.strokeStyle=o.color,xr(ae,1,o),br(ae,o,1),ae.stroke()),o.v2||(ae.lineTo(d,ee*te),ae.lineTo(l,ee*te),(M=ae.createLinearGradient(0,0,0,K.HeightPx)).addColorStop(0,u(c(o.color2),.7)),M.addColorStop(1,u(c(o.color2),.1)),ae.fillStyle=M,ae.fill()),ae.restore();break;case"line":case"line2":for(ae.save(),ae.beginPath(),V=null!=o.source?o.source:"c",h=Xe(v(r.QuoteTab[0],V),s),ae.moveTo(l,h),(L=[]).push({x:l,y:h}),W=0;W<J;W++)if(null!=(T=r.QuoteTab[W])){if(d=Math.round(W*y+l),Br[d-Lr.paddingLeft]={d:T.d,i:W},d-x>=1){if(h=Xe(v(T,V),s)+.5,ae.lineTo(d+.5,h),L.push({x:d+.5,y:h}),x=d,y<2)qr[d]=T.d;else for(p=-1;p<=1;p++)qr[d+p]=T.d;w[T.d]={o:T.o,h:T.h,l:T.l,c:T.c,i:W}}E=W}if(T=r.QuoteTab[E],w[0]={o:T.o,h:T.h,l:T.l,c:T.c,i:E,d:T.d},"line"==Lr.mainChart.type&&(o.v2||(ae.strokeStyle="transparent",ae.lineTo(d,K.HeightPx),ae.lineTo(l,K.HeightPx),ae.lineTo(l,ee),ae.stroke(),0!=ee-z&&((M=ae.createLinearGradient(0,Xe(r.High,s),0,K.HeightPx)).addColorStop(0,o.color2),null!=o.color3?M.addColorStop(1,o.color3):M.addColorStop(1,u(c(o.color2),.1)),ae.fillStyle=M,ae.fill()))),!o.v1){if(ae.beginPath(),(I=L.length)>0)for(ae.moveTo(L[0].x,L[0].y),p=1;p<I;p++)ae.lineTo(L[p].x,L[p].y);br(ae,o,1),xr(ae,1,o),ae.strokeStyle=o.color,ae.stroke()}ae.restore();break;case"bar":case"barcolor":ae.save();var re=.5,ne=0,oe=Math.floor(Z/2),ie=oe+1;for(y>5&&(ae.lineWidth=2,re=0,ne=1,oe+=1),ae.strokeStyle=o.v1?"transparent":o.color,ae.beginPath(),W=0;W<J;W++)if(null!=(T=r.QuoteTab[W])){for(d=Math.round(W*y+l),T.c>=T.o&&(S=Xe(T.o,s)+re,P=Xe(T.c,s)+re,C=Xe(T.l,s),k=Xe(T.h,s),Br[d-Lr.paddingLeft]={d:T.d,i:W},ae.moveTo(d+re,C+ne),ae.lineTo(d+re,k-ne),ae.moveTo(d,S),ae.lineTo(d-oe,S),ae.moveTo(d,P),ae.lineTo(d+ie,P)),f=-Z;f<=Z;f++)qr[d+f]=T.d;E=W,w[T.d]={o:T.o,h:T.h,l:T.l,c:T.c,i:W}}for(T=r.QuoteTab[E],w[0]={o:T.o,h:T.h,l:T.l,c:T.c,i:E,d:T.d},ae.stroke(),"barcolor"==Lr.mainChart.type&&(ae.strokeStyle=o.v2?"transparent":o.color2),ae.beginPath(),W=0;W<J;W++)null!=(T=r.QuoteTab[W])&&T.c<T.o&&(S=Xe(T.o,s)+re,P=Xe(T.c,s)+re,d=Math.round(W*y+l),C=Xe(T.l,s),k=Xe(T.h,s),Br[d-Lr.paddingLeft]={d:T.d,i:W},ae.moveTo(d+re,C+ne),ae.lineTo(d+re,k-ne),ae.moveTo(d,S),ae.lineTo(d-oe,S),ae.moveTo(d,P),ae.lineTo(d+ie,P));ae.stroke(),ae.restore();break;case"heikin ashi":case"candle":for(y>5&&y<7&&(Z=5),ae.strokeStyle=o.color3,ae.beginPath(),ae.fillStyle=o.color,_=Math.floor(Z/2),W=0;W<J;W++)if(null!=(T=r.QuoteTab[W])){for(d=Math.round(W*y+l)-_,T.c>=T.o&&_t(ae,Z,T,d,_,W,s),f=0;f<=Z;f++)qr[d+f]=T.d;E=W,w[T.d]={o:T.o,h:T.h,l:T.l,c:T.c,i:W}}for(T=r.QuoteTab[E],w[0]={o:T.o,h:T.h,l:T.l,c:T.c,i:E,d:T.d},o.v1||(ae.stroke(),ae.fill()),ae.beginPath(),ae.fillStyle=o.color2,W=0;W<J;W++)null!=(T=r.QuoteTab[W])&&T.c<T.o&&_t(ae,Z,T,d=Math.round(W*y+l)-_,_,W,s);o.v2||(ae.stroke(),ae.fill());break;case"hollow":for(y>5&&y<7&&(Z=5),ae.strokeStyle=o.color,ae.beginPath(),_=Math.floor(Z/2),W=1;W<J;W++)if(null!=(T=r.QuoteTab[W])){for(d=Math.round(W*y+l)-_,T.c>=T.o&&T.c>=r.QuoteTab[W-1].c&&_t(ae,Z,T,d,_,W,s),f=0;f<=Z;f++)qr[d+f]=T.d;E=W,w[T.d]={o:T.o,h:T.h,l:T.l,c:T.c,i:W}}for(null!=E&&(T=r.QuoteTab[E],w[0]={o:T.o,h:T.h,l:T.l,c:T.c,i:E,d:T.d}),o.v1||ae.stroke(),ae.strokeStyle=o.color2,ae.beginPath(),W=1;W<J;W++)null!=(T=r.QuoteTab[W])&&(d=Math.round(W*y+l)-_,T.c>=T.o&&T.c<r.QuoteTab[W-1].c&&_t(ae,Z,T,d,_,W,s));for(o.v2||ae.stroke(),ae.strokeStyle=o.color3,ae.fillStyle=o.color,ae.beginPath(),W=1;W<J;W++)null!=(T=r.QuoteTab[W])&&(d=Math.round(W*y+l)-_,T.c<=T.o&&T.c>=r.QuoteTab[W-1].c&&_t(ae,Z,T,d,_,W,s));for(o.v1||(ae.stroke(),ae.fill()),ae.fillStyle=o.color2,ae.beginPath(),W=1;W<J;W++)null!=(T=r.QuoteTab[W])&&(d=Math.round(W*y+l)-_,T.c<=T.o&&T.c<r.QuoteTab[W-1].c&&_t(ae,Z,T,d,_,W,s));o.v2||(ae.stroke(),ae.fill())}if(K.Bars[0]=w,1!=Lr.histoLength||Lr.set.noVeilleIntra||(ae.save(),D=Xe(e.qv.c,s),ae.strokeStyle=Lr.set.veilleColor,ae.lineWidth=Lr.set.veilleWidth||1,1==ae.lineWidth&&(D+=.5),!Lr.set.veilleStyle&&ae.setLineDash&&ae.setLineDash([5,4]),ae.beginPath(),ae.moveTo(Lr.paddingLeft,D),ae.lineTo(Lr.widthGraph-Lr.paddingRight,D),ae.stroke(),ae.restore()),0!=J&&null!=w[0]&&(Lr.set.nohighlow||Lr.isCompare||($e(ae,ee,r.High,te,"rgba(0, 128, 0, 1)",!0,s),$e(ae,ee,r.Low,te,"rgba(192, 0, 0, 1)",!0,s)),Lr.set.nosticky||$e(ae,ee,w[0].c,te,null,!0,s)),t||a||VGP.chartSimple||(R="","perf"!=Lr.mainChart.type&&(R=Qe(Lr.chartPeriod<0).toFixed(2)),A="",VGP.noCommand||(A='<span class="mci-p"></span>'),H='<div><span class="eod_param" data-name="'+Lr.mainChart.type+'">'+A+lang.l_cours+"</span>",q=e.QuoteTab[e.QuoteTab.length-1],Lr.chartPeriod<0?(B=Dr.qd).dt=m(q.d,2):(B=q).dt=g(q.d,1),B.var=R,"function"==typeof extGetQuotesHover&&extGetQuotesHover(B),b.idhtml(et("eod_mainchartinfos-"),H)),"perf"!=Lr.mainChart.type){for(G=Lr.mainChart.indicators.length,W=0;W<G;W++)switch((N=Lr.mainChart.indicators[W]).type){case"compare":ft(N,l,0,W);break;case"sar":yt(N,l,0,W,0,s);break;case"phpb":vt(N,l,0,W,0,s);break;case"ichimoku":mt(N,l,0,W,0,s);break;case"pivots":ht(N,0,W,0,s);break;case"supertrend":gt(N,l,0,W,0,s);break;default:Ue(N,l,0,W,0,s)}if(Lr.newsConfig&&(0==Yr.fiEvt.length&&"no"!=Yr.fiEvt?ut(l,W):xt(l,0,W)),""!=Lr.searchConfig){switch($=r.QuoteTab,Lr.searchConfig){case"gaps":Y="G",O=n.computeGAP($);break;case"dojis":Y="D",O=n.computeDOJI($,Lr.chartPeriod);break;case"keyr":Y="K",O=n.computeKEYR($);break;case"englob":Y="E",O=n.computeEnglobante($);break;case"marteau":Y=lang.l_m,O=n.computeMarteau($);break;case"pendu":Y=lang.l_p,O=n.computePendu($);break;case"pinces":Y=lang.l_p,O=n.computePinces($);break;case"marubozu":Y=lang.l_m,O=n.computeMarubozu($);break;case"soldiers":Y=lang.l_s,O=n.computeSoldiers($);break;case"harami":Y="H",O=n.computeHarami($)}for(X=O.Values.length,W=0;W<X;W++)0!=O.Values[W].v1?(ae.beginPath(),ae.arc(Math.round(O.Values[W].i*y+l),Xe(O.Values[W].v1,s)+20,8,0,2*Math.PI),ae.fillStyle="#008000",ae.fill()):0!=O.Values[W].v2&&(ae.beginPath(),ae.arc(Math.round(O.Values[W].i*y+l),Xe(O.Values[W].v2,s)-20,8,0,2*Math.PI),ae.fillStyle="#ff0000",ae.fill());for(ae.fillStyle="#fff",W=0;W<X;W++)0!=O.Values[W].v1?ae.fillText(Y,Math.round(O.Values[W].i*y+l)-4,Xe(O.Values[W].v1,s)+24):0!=O.Values[W].v2&&ae.fillText(Y,Math.round(O.Values[W].i*y+l)-4,Xe(O.Values[W].v2,s)-16)}}VGP.chartSimple||t||(Q=document.querySelectorAll(et("#eod_topinfo-")+" span")).length>1&&("perf"==Lr.mainChart.type?Q[1].innerHTML=lang.l_varperiod+" : "+Ct(r.QuoteTab,1).c.toFixed(2)+"%":Lr.set.noVarPeriod||(U=100*(Ct(r.QuoteTab,1).c-r.QuoteTab[0].c)/r.QuoteTab[0].c,Q[1].innerHTML=lang.l_varperiod+" : "+(U>0?"+":"")+U.toFixed(2)+"%")),Et(Rr[0]),F()}}function Ne(e){if(null==e)return e;for(var t=[],a=Hr.minX,r=Hr.maxX,n=a;n<=r;n++)t.push(e[n]);return t}function Ye(e,t,a,r){var n,o,i,l,s,c=Lr,d=Math.round((c.innerWidth-2*c.padBarCandle)/80),u=Hr.maxX-Hr.minX,h=Math.round(u/d);if(h<=0&&(h=1),(o=e.ctx).beginPath(),o.save(),o.strokeStyle=c.set.gridColor,!c.set.gridLine&&o.setLineDash&&o.setLineDash([3]),t&&(Vr.ctxback.fillStyle=c.set.txtColor),l=c.heightGraph-6,r)for(n=h;n<u;n+=h)null!=a[n]&&(i=Math.round(a[n].cu-a[0].cu+c.paddingLeft)+.5,c.set.gridV&&(o.moveTo(i,0),o.lineTo(i,e.HeightPx)),s=a[n].d,c.chartPeriod>=0?c.histoLength>365?Vr.ctxback.fillText(g(s,4),i-18,l):Vr.ctxback.fillText(g(s,3),i-18,l):c.histoLength>2?Vr.ctxback.fillText(m(s),i-18,l):Vr.ctxback.fillText(m(s,1),i-18,l));else for(n=h;n<u;n+=h)i=Math.round(n*Rr[0].PxPointX+c.paddingLeft+c.padBarCandle)+.5,c.set.gridV&&(o.moveTo(i,0),o.lineTo(i,e.HeightPx)),t&&(s=null==a[n]?Le(n+1-Br[Br.length-1].i):a[n].d,c.chartPeriod>=0?c.histoLength>365?Vr.ctxback.fillText(g(s,4),i-18,l):Vr.ctxback.fillText(g(s,3),i-18,l):c.histoLength>2?Vr.ctxback.fillText(m(s),i-18,l):Vr.ctxback.fillText(m(s,1),i-18,l));o.stroke(),o.restore()}function Oe(e,t,a,r,n,o,i){var l,s,c,d,u,h,m,f="";r>=1e5&&(r/=1e3,n*=1e3,f="K"),i&&(c=Lr.logData),e.save(),e.beginPath(),!Lr.set.gridLine&&e.setLineDash&&e.setLineDash([3]),e.strokeStyle=Lr.set.gridColor,e.font=Lr.set.fontSize+"px Arial",e.fillStyle=Lr.set.txtColor,d=t/n,u=35,t<120&&(u=20);var g,v,y,b=Math.round(t/u),x=d/(b-1),w=Math.ceil(Math.log10(x)-1),T=Math.pow(10,w),C=Math.ceil(x/T)*T,k=Math.ceil((r-d)/C)*C;for(Lr.mainChart.typedef.nolinearX||(y=Dr.QuoteTab[Hr.minX].c),h=Lr.widthGraph-Lr.paddingRight,m=a-Lr.padBarCandle,l=0;l<=b&&(g=k+l*C,!((v=i?Xe(g,c):Math.round((r-g)*n))<=5));l++)Lr.set.gridH&&(e.moveTo(m,v+.5),e.lineTo(h,v+.5)),s=o||"perf"==Lr.mainChart.type?"perf"==Lr.mainChart.type?p(g,!0):p(100*(g-y)/y,!0):p(g)+f,Lr.set.yaxis?e.fillText(s,2,v+2):e.fillText(s,h+5,v+2);e.stroke(),e.restore()}function $e(e,t,a,r,n,o,i){var l,s,d,u,h,m,f=Lr;a=parseFloat(a),o?l=Xe(a,i):(l=Math.round(t-a*r))<t+7&&(l-=7),null==n&&(n="rgba(51, 102, 255, 1)"),e.fillStyle=c(n),e.font=f.set.fontSize+"px Arial",d=f.widthGraph-f.paddingRight,u=f.paddingRight,f.set.yaxis&&(d=-2,u=f.paddingLeft-1),h=f.set.fontSize-11,e.fillRect(d+2,l-7,u,15+h),e.fillStyle=St(n),o&&f.isCompare&&!f.mainChart.typedef.nolinearX&&"perf"!=f.mainChart.type?(a=100*(a-(s=Dr.QuoteTab[Hr.minX].c))/s,e.fillText(a.toFixed(2),d+5,l+4+h)):(m="",a>=1e5&&(a=Math.round(a/1e3),m="K"),e.fillText(p(a)+m,d+5,l+4+h))}function Xe(e,t){return null==t?Math.round((Rr[0].V0-e)*Rr[0].PxPointY):Rr[0].HeightPx-Math.round((Math.log10(e)/Math.log10(10)-t.floor)/t.range*Rr[0].HeightPx)}function Fe(e,t){var a=Rr[0];return null==t?(a.V0*a.PxPointY-e)/a.PxPointY:Math.pow(10,Math.log10(10)*((a.HeightPx-e)*t.range/a.HeightPx+t.floor))}function Qe(e){if(e)return null!=Dr.qv?100*(Ct(Dr.QuoteTab,1).c-Dr.qv.c)/Dr.qv.c:0;var t=Ct(Dr.QuoteTab,2).c;return 100*(Ct(Dr.QuoteTab,1).c-t)/t}function Ue(e,t,a,r,o,i){var l,s,c,d,u={},h=Rr[0];switch(h.Bars[r+1]={},s=null!=e.source?e.source:"c",e.type){case"mm":l=n.computeMovingAverage(Dr.QuoteTab,e.param1,s);break;case"zig zag":l=n.computeZigZag(Dr.QuoteTab,e.param1/100,s);break;case"mmt":l=n.computeMovingAverageT(Dr.QuoteTab,e.param1,s);break;case"mmp":l=n.computeMovingAverageP(Dr.QuoteTab,e.param1,s);break;case"mmh":l=n.computeMovingAverageHull(Dr.QuoteTab,e.param1,s);break;case"double EMA":l=n.computeDoubleEMA(Dr.QuoteTab,e.param1,s);break;case"triple EMA":l=n.computeTripleEMA(Dr.QuoteTab,e.param1,s);break;case"linearc":l=n.computeLinearCurve(Dr.QuoteTab,e.param1,1,s);break;case"lineard":c=function(e,t,a,r){var n,o=e.length;if(o<=t)return null;var i,l=0,s=0,c=0,d=0,u=0;for(n=1;n<=t;n++)l+=n*(i=v(e[o-n],r)),s+=n,c+=i,d+=n*n,u+=i*i;var h=(l*t-s*c)/(t*d-s*s),p=(c-h*s)/t,m=p+h*t,f=p+h,g=Math.pow((t*u-c*c)/(t*(t-1)),.5);return{p0:new Se(e[o-t].d,m,Dr.QuoteTab[Hr.minX].d),p1:new Se(e[o-1].d,f,Dr.QuoteTab[Hr.minX].d),et:g,id:a}}(Dr.QuoteTab,e.param1,e,s);break;case"supres":Pr(Dr,e.param1,e);break;case"mme":l=n.computeMovingAverageE(Dr.QuoteTab,e.param1,s);break;case"boll":null==e.param2&&(e.param2=2),l=n.computeBollinger(Dr.QuoteTab,e.param1,e.param2,s);break;case"donchian":l=n.computeDonchian(Dr.QuoteTab,e.param1);break;case"keltner":l=n.computeKeltner(Dr.QuoteTab,e.param1,e.param2,e.param3);break;case"evmm":l=n.computeEVMM(Dr.QuoteTab,e.param1,e.param2,s);break;case"alligator":l=n.computeAlligator(Dr.QuoteTab,e.param1,e.param2,e.param3);break;case"gmma":l=n.computeGMMA(Dr.QuoteTab)}if("lineard"!=e.type){if("supres"!=e.type&&null!=l){if(l.Values=Ne(l.Values),"alligator"==e.type)return void function(e,t,a,r,n,o){for(var i,l,s,c,d,u,h=t.Values.length,p=e.ctx,m=e.PxPointX,f={},g=1;g<4;g++){for(s="v"+g,p.save(),p.strokeStyle=1==g?r[s]?"transparent":r.color:r[s]?"transparent":r["color"+g],p.beginPath(),br(p,r,g),xr(p,g,r),u=!1,l=1;l<h;l++)null!=(d=t.Values[l])&&null!=d[s]&&(i=Math.round(l*m+a),u||(p.moveTo(i,Xe(d[s],n)+.5),u=!0),p.lineTo(i+.5,Xe(d[s],n)+.5),3==g&&(c=l,f[d.d]=[d.v1,d.v2,d.v3]));p.stroke(),p.restore()}d=t.Values[c],f[0]=[d.v1,d.v2,d.v3],e.Bars[o+1]=f}(h,l,t,e,i,r);if("gmma"==e.type)return void function(e,t,a,r,n){for(var o,i,l,s=t.Values.length,c=e.ctx,d=e.PxPointX,u=1;u<13;u++){for(c.save(),c.strokeStyle=u<7?r.v1?"transparent":r.color:r.v2?"transparent":r.color2,c.beginPath(),u<7&&br(c,r,1),u>=7&&br(c,r,2),br(c,r,u),xr(c,u<7?1:2,r),l=!1,i=1;i<s;i++)null!=t.Values[i]&&(o=Math.round(i*d+a),l||(c.moveTo(o,Xe(t.Values[i]["v"+u],n)+.5),l=!0),c.lineTo(o+.5,Xe(t.Values[i]["v"+u],n)+.5));c.stroke(),c.restore()}}(h,l,t,e,i);var p,m,f,g,y=l.Values.length,b=h.ctx,x=t-1,w=h.PxPointX;if(b.strokeStyle=e.v1?"transparent":e.color,null==l.Values[0]&&(l.Values[0]={v1:Dr.QuoteTab[Hr.minX].c,d:Dr.QuoteTab[Hr.minX].d}),null==l.Values[0].v2){for(b.save(),b.beginPath(),b.moveTo(t,Xe(l.Values[0].v1,i)+.5),br(b,e,1),xr(b,1,e),m=1;m<y;m++)null!=l.Values[m]&&((p=Math.round(m*w+t))-x>=2&&(b.lineTo(p+.5,Xe(l.Values[m].v1,i)+.5),x=p),u[l.Values[m].d]=l.Values[m].v1,g=m);return null!=g&&(u[0]=l.Values[g].v1),h.Bars[r+1]=u,b.stroke(),void b.restore()}for(b.beginPath(),d=!1,m=y-1;m>=0;m--)null!=l.Values[m]&&(f=Xe(l.Values[m].v1,i),d?(p=Math.round(m*w+t),b.lineTo(p+.5,Math.round(f)+.5)):(b.moveTo(Math.round(m*w+t)+.5,f+.5),d=!0));for(f=Xe(l.Values[0].v1,i),b.lineTo(Lr.paddingLeft+1,f+.5),f=Xe(l.Values[0].v2,i),b.lineTo(Lr.paddingLeft+1,f+.5),m=0;m<y;m++)null!=l.Values[m]&&(p=Math.round(m*w+t),f=Xe(l.Values[m].v2,i),b.lineTo(p+.5,f+.5),u[l.Values[m].d]=[l.Values[m].v1,l.Values[m].v2],g=m);u[0]=[l.Values[g].v1,l.Values[g].v2],b.save(),br(b,e,1),xr(b,1,e),b.stroke(),b.restore(),e.v2||(b.fillStyle=e.color2,b.fill()),h.Bars[r+1]=u}}else!function(e,t){var a,r,n,o;if(e.save(),a=Lr.paddingLeft,null!=t){for(o=t.id.param2*t.et*Rr[0].PxPointY,r=1;r<4;r++)if(!t.id["v"+r]){switch(e.strokeStyle=1==r?t.id.color:t.id["color"+r],r){case 1:n=0;break;case 2:n=-o;break;case 3:n=o}e.lineWidth=null!=t.id["w"+r]?t.id["w"+r]:1,e.beginPath(),e.moveTo(t.p0.mx+a,t.p0.my+n),e.lineTo(t.p1.mx+a,t.p1.my+n),e.stroke()}e.restore()}}(h.ctx,c)}function We(e){var t,a,r,o=e.Indicator,i=Dr.QuoteTab,l=null!=o.source?o.source:"c";switch(o.type){case"volume":je(n.computeVolume(i,Hr),e);break;case"accDist":ze(n.computeAccDist(i),e,"curve",0);break;case"obv":ze(n.computeOBV(i),e,"curve",0);break;case"bollb":Je(n.computeBollingerB(i,o.param1,2,l),e);break;case"bollw":Je(n.computeBollingerBandwith(i,o.param1,o.param2,l),e);break;case"perfi":ze(n.computePERFORMANCE(Dr,!0),e,"curve",0);break;case"rsi":Je(n.computeRSI(i,o.param1,l),e);break;case"cmo":Je(n.computeCMO(i,o.param1),e);break;case"fr":if(Lr.isCompare){for(r=Lr.mainChart.indicators,t=0;t<r.length;t++)if("compare"==r[t].type&&r[t].datas2){a=r[t].datas2.QuoteTab;break}ze(n.computeFR(i,a),e,"curve",0)}break;case"ultimate":Je(n.computeUltimateOsc(i,o.param1,o.param2,o.param3),e);break;case"atr":Je(n.computeATR(i,o.param1,"pma"),e);break;case"cci":Je(n.computeCCI(i,o.param1),e);break;case"eom":ze(n.computeEaseOfMovement(i,o.param1),e,"curve",0);break;case"cmf":ze(n.computeCMF(i,o.param1),e,"curve",0);break;case"dpo":ze(n.computeDPO(i,o.param1),e,"curve",0);break;case"mom":ze(n.computeMomentum(i,o.param1,l),e,"curve",0);break;case"asi":ze(n.computeASI(i),e,"curve",0);break;case"coppock":ze(n.computeCoppock(i,o.param1,o.param2,o.param3,l),e,"curve",0);break;case"nvi":Je(n.computeNVIPVI(i,l,"nvi"),e);break;case"pvi":Je(n.computeNVIPVI(i,l,"pvi"),e);break;case"macd":Je(n.computeMACD(i,o.param1,o.param2,o.param3,"macd",l),e);break;case"macdzl":Je(n.computeMACDZL(i,o.param1,o.param2,o.param3),e);break;case"wto":Je(n.computeWaveTrendOsc(i,o.param1,o.param2),e);break;case"dmi":Je(n.computeDMI(i,o.param1,"dmi"),e);break;case"aroon":Je(n.ComputeAroon(i,o.param1),e);break;case"adx":Je(n.computeDMI(i,o.param1,"adx"),e);break;case"vortex":Je(n.computeVortex(i,o.param1),e);break;case"macdh":ze(n.computeMACD(i,o.param1,o.param2,o.param3,"macdh",l),e,"bar");break;case"awesome":ze(n.computeAwesomeIndicator(i,o.param1,o.param2),e,"awesome");break;case"bop":ze(n.computeBOP(i),e,"bop");break;case"qstick":ze(n.computeQStick(i,o.param1),e,"bar");break;case"roc":Je(n.computeROC(i,o.param1,l,!0),e);break;case"std":Je(n.computeSTD(i,o.param1,l),e);break;case"ulcer":Je(n.computeUlcerIndex(i,o.param1,l),e);break;case"sto":Je(n.computeSTOCH(i,o.param1,o.param2,o.param3),e);break;case"di":Je(n.computeDI(i,o.param1),e);break;case"sto rsi":Je(n.computeStochRSI(i,o.param1,o.param2,o.param3,o.param4,l),e);break;case"smi":Je(n.computeSMI(i,o.param1,o.param2,o.param3,o.param4),e);break;case"tsi":Je(n.computeTSI(i,o.param1,o.param2,o.param3),e);break;case"kvo":Je(n.computeKVO(i),e);break;case"kst":Je(n.computeKST(i,o.param1,o.param2,o.param3,o.param4,l),e);break;case"trix":Je(n.computeTRIX(i,o.param1,l),e);break;case"mass index":Je(n.computeMassIndex(i,o.param1),e);break;case"vroc":Je(n.computeVROC(i,o.param1),e);break;case"ac will":ze(n.computeWILAC(i),e,"curve",0);break;case"will r":Je(n.computeWILR(i,o.param1),e);break;case"mfi":Je(n.computeMFI(i,o.param1),e);break;case"linearo":ze(n.computeLinearCurve(i,o.param1,2,l),e,"curve",0);break;case"moonphase":Lr.chartPeriod>=0&&ze(n.computeMoonPhase(i),e,"curve",0);break;case"elderbull":ze(n.computeElderRay(i,o.param1,"bull"),e,"bar");break;case"elderbear":ze(n.computeElderRay(i,o.param1,"bear"),e,"bar");break;case"forceindex":ze(n.computeForceIndex(i,o.param1,l),e,"curve",0)}}function ze(e,t,a,r){var o,i,l,s,c,d,u,h,p,m,f,g=t.ctx;if(Ye(t),null!=e){null!=(i=(o=t.Indicator).mm)&&0!=i&&(e.Values=n.computeMM(e.Values,i)),e.Values=Ne(e.Values);var v,y,b,x,w,T=e.High,C=e.Low,k=e.Values.length,S=5;if("moonphase"==o.type&&(S=0),t.PxPointY=(t.HeightPx-17-S)/(T-C),l=Rr[0].PxPointX,s=Lr.paddingLeft+Lr.padBarCandle,Oe(g,t.HeightPx,s,T+17/t.PxPointY,t.PxPointY),c=s-1,t.V0=Math.round(t.PxPointY*T)+17,d=t.V0-Math.round(r*t.PxPointY),t.Bars={},"curve"==a){for(g.strokeStyle=o.v1?"transparent":o.color,g.beginPath(),g.moveTo(s,d),v=0;v<k;v++)null!=e.Values[v]&&((y=Math.round(v*l+s))-c>=2&&(g.lineTo(y,t.V0-Math.round(e.Values[v].v1*t.PxPointY)),c=y),w=v,t.Bars[e.Values[v].d]=e.Values[v].v1);null!=w&&(t.Bars[0]=e.Values[w].v1),g.save(),br(g,o,1),xr(g,1,o),g.stroke(),g.restore(),g.lineTo(c,d),g.lineTo(s,d),o.v2||(g.fillStyle=o.color2,g.fill())}if("bar"==a){for(0!=Lr.padBarCandle?((m=Math.floor(Lr.innerWidth/k)-1)<1&&(m=1),s=Lr.paddingLeft+Lr.padBarCandle-Math.round(m/2)):(s=Lr.paddingLeft,m=2),h=o.v1?"transparent":o.color,p=o.v2?"transparent":o.color2,v=0;v<k;v++)null!=e.Values[v]&&(y=Math.round(v*l+s),u=Math.round(-e.Values[v].v1*t.PxPointY),y-c>=1&&(g.fillStyle=u<=0?h:p,g.fillRect(y,t.V0,m,u),c=y),w=v,t.Bars[e.Values[v].d]=e.Values[v].v1);null!=w&&(t.Bars[0]=e.Values[w].v1)}if("awesome"==a||"bop"==a){for(0!=Lr.padBarCandle?((m=Math.floor(Lr.innerWidth/k)-1)<1&&(m=1),s=Lr.paddingLeft+Lr.padBarCandle-Math.round(m/2)):(s=Lr.paddingLeft,m=2),w=0,b=1;b<4&&(x="v"+b,3!=b||"bop"==a);b++)for(g.fillStyle=1==b?o.v1?"transparent":o.color:o[x]?"transparent":o["color"+b],v=0;v<k;v++)null!=e.Values[v]&&null!=e.Values[v][x]&&(y=Math.round(v*l+s),u=Math.round(-e.Values[v][x]*t.PxPointY),g.fillRect(y,t.V0,m,u),t.Bars[e.Values[v].d]=e.Values[v][x],v>w&&(w=v,f=x));0!=w&&(t.Bars[0]=e.Values[w][f])}kt(g,t,e.Values,s,l),Lr.set.nosticky||$e(g,t.V0,t.Bars[0]||"",t.PxPointY,o.color),Et(t)}else Et(t)}function je(t,a){var r,o,i,l,s,c,d,u,h=a.ctx,p=t.High;Ye(a),null!=(o=(r=a.Indicator).mm)&&0!=o&&(t.Values=n.computeMM(t.Values,o)),t.Values=Ne(t.Values);var m,f=t.Values.length,g=!1;for(a.PxPointY=(a.HeightPx-20)/p,a.V0=Math.round(a.PxPointY*p)+20,i=Rr[0].PxPointX,(l=Math.floor(Lr.innerWidth/f)-2)%2==0&&l++,l>21?l=21:l<0?l=1:l<2&&(l=2),s=Lr.paddingLeft+Lr.padBarCandle-Math.round(l/2),Oe(h,a.HeightPx,s,p+20/a.PxPointY,a.PxPointY),a.Bars={},h.fillStyle=r.v1?"transparent":r.color,h.beginPath(),u=Lr.innerWidth+Lr.paddingLeft,m=0;m<f;m++)null!=t.Values[m]&&(1==t.Values[m].v2&&(g=Math.round(m*i+s))<u&&(d=g+l>u?u-g:l,g<Lr.paddingLeft&&(d=l-(Lr.paddingLeft-g),g=Lr.paddingLeft),h.rect(g,a.HeightPx,d,-t.Values[m].v1*a.PxPointY)),a.Bars[t.Values[m].d]=t.Values[m].v1,c=m);for(h.fill(),h.fillStyle=r.v2?"transparent":r.color2||e(r.type).color2,h.beginPath(),m=0;m<f;m++)null!=t.Values[m]&&1!=t.Values[m].v2&&(g=Math.round(m*i+s))<u&&(d=g+l>u?u-g:l,g<Lr.paddingLeft&&(d=l-(Lr.paddingLeft-g),g=Lr.paddingLeft),h.rect(g,a.HeightPx,d,-t.Values[m].v1*a.PxPointY));h.fill(),null!=c&&(a.Bars[0]=t.Values[c].v1),kt(h,a,t.Values,s,i),Lr.set.nosticky||$e(h,a.HeightPx,a.Bars[0]||"",a.PxPointY,r.color),Et(a)}function Je(t,a){var r,o,i,l,s,d,h,p,m,f,g,v,y,b=a.ctx;if(Ye(a),Et(a),null!=t){var x=a.Indicator,w=x.type,T=x.mm;null!=T&&0!=T&&(t.Values=n.computeMM(t.Values,T)),r=17,o=5,("rsi"==w||"ultimate"==w)&&(r=0,o=0),t.Values=Ne(t.Values);var C=t.High,k=t.Low,S=t.Values.length;if(a.PxPointY=(a.HeightPx-r-o)/(C-k),i=Rr[0].PxPointX,l=Lr.paddingLeft+Lr.padBarCandle,Oe(b,a.HeightPx,l,C+r/a.PxPointY,a.PxPointY),h=l-1,a.V0=Math.round(a.PxPointY*C)+r,a.Bars={},"roc"==w||"rsi"==w||"di"==w){switch(b.beginPath(),b.strokeStyle="#99ccff",w){case"roc":m=100;break;case"rsi":m=50;break;case"di":m=0}b.moveTo(Lr.paddingLeft,a.V0-Math.round(m*a.PxPointY)+.5),b.lineTo(Lr.widthGraph-Lr.paddingRight,a.V0-Math.round(m*a.PxPointY)+.5),b.stroke()}for("wto"==w&&(b.beginPath(),b.strokeStyle="rgba(255,0,0,0.7)",b.moveTo(Lr.paddingLeft,a.V0-Math.round(53*a.PxPointY)+.5),b.lineTo(Lr.widthGraph-Lr.paddingRight,a.V0-Math.round(53*a.PxPointY)+.5),b.stroke(),b.beginPath(),b.strokeStyle="rgba(0,128,0,0.7)",b.moveTo(Lr.paddingLeft,a.V0-Math.round(-53*a.PxPointY)+.5),b.lineTo(Lr.widthGraph-Lr.paddingRight,a.V0-Math.round(-53*a.PxPointY)+.5),b.stroke()),b.strokeStyle=x.v1?"transparent":x.color,b.beginPath(),f=0,b.moveTo(l,a.V0-Math.round(t.Values[0].v1*a.PxPointY)),s=1;s<S;s++)null!=t.Values[s]&&null!=t.Values[s].v1&&((d=Math.round(s*i+l))-h>=2&&(b.lineTo(d,a.V0-Math.round(t.Values[s].v1*a.PxPointY)),h=d),a.Bars[t.Values[s].d]="aroon"==w?[t.Values[s].v1,t.Values[s].v2]:t.Values[s].v1,p=s);if(null!=p&&(a.Bars[0]=t.Values[p].v1),b.save(),br(b,x,1),xr(b,1,x),b.stroke(),b.restore(),null!=t.Values[0].v2){for(h=l-1,b.strokeStyle=x.v2?"transparent":x.color2,b.beginPath(),b.moveTo(l,a.V0-Math.round(t.Values[0].v2*a.PxPointY)),s=1;s<S;s++)null!=t.Values[s]&&((d=Math.round(s*i+l))-h>=2&&(b.lineTo(d,a.V0-Math.round(t.Values[s].v2*a.PxPointY)),h=d),f=t.Values[s].v2);b.save(),br(b,x,2),xr(b,2,x),b.stroke(),b.restore()}if("dmi"==w){for(b.strokeStyle=x.v3?"transparent":x.color3,b.beginPath(),b.moveTo(l,a.V0-Math.round(t.Values[0].v3*a.PxPointY)),s=0;s<S;s++)null!=t.Values[s]&&(d=Math.round(s*i+l),b.lineTo(d,a.V0-Math.round(t.Values[s].v3*a.PxPointY)));for(b.save(),br(b,x,3),xr(b,3,x),b.stroke(),b.restore(),a.Bars={},s=0;s<S;s++)null!=t.Values[s]&&(a.Bars[t.Values[s].d]=[t.Values[s].v1,t.Values[s].v2,t.Values[s].v3],p=s);null!=p&&(a.Bars[0]=t.Values[p].v1)}if("macd"==w||"macdzl"==w||"wto"==w){for(h=l-1,b.beginPath(),b.moveTo(l,a.V0),g=x.v3?"transparent":null!=x.color3?x.color3:g=u(c(x.color2),.5),b.strokeStyle=g,a.Bars={},s=0;s<S;s++)null!=t.Values[s]&&((d=Math.round(s*i+l))-h>=2&&(b.lineTo(d,a.V0-Math.round((t.Values[s].v1-t.Values[s].v2)*a.PxPointY)),h=d),p=s,a.Bars[t.Values[s].d]=t.Values[s].v1-t.Values[s].v2);null!=p&&(a.Bars[0]=t.Values[p].v1),b.stroke(),b.lineTo(d,a.V0),b.lineTo(l,a.V0),b.fillStyle=g,b.fill()}kt(b,a,t.Values,l,i),null!=e(x.type).sb&&(v=null!=x.sh?x.sh:e(x.type).sh,y=null!=x.sb?x.sb:e(x.type).sb,9999!=x.sh&&(b.beginPath(),3==x.shs&&(b.lineWidth=3),b.strokeStyle="rgba(255,0,0,0.5)",b.moveTo(Lr.paddingLeft,Math.round(a.V0-v*a.PxPointY)+.5),b.lineTo(Lr.widthGraph-Lr.paddingRight,Math.round(a.V0-v*a.PxPointY)+.5),b.stroke(),(null==x.shs||1==x.shs)&&(b.fillStyle="rgba(255,0,0,0.15)",b.fillRect(Lr.paddingLeft,1,Lr.innerWidth,a.V0-Math.round(v*a.PxPointY)))),9999!=x.sb&&(b.beginPath(),b.lineWidth=3==x.sbs?3:1,b.strokeStyle="rgba(0,128,0,0.5)",b.moveTo(Lr.paddingLeft,Math.round(a.V0-y*a.PxPointY)+.5),b.lineTo(Lr.widthGraph-Lr.paddingRight,Math.round(a.V0-y*a.PxPointY)+.5),b.stroke(),(null==x.sbs||1==x.sbs)&&(b.fillStyle="rgba(0,128,0,0.15)",b.fillRect(Lr.paddingLeft,a.V0-Math.round(y*a.PxPointY),Lr.innerWidth,a.V0-Math.round(y*a.PxPointY)))),b.lineWidth=1),Lr.set.nosticky||(0!=f?($e(b,a.V0,f,a.PxPointY,x.color2),$e(b,a.V0,a.Bars[0]||"",a.PxPointY,x.color)):$e(b,a.V0,a.Bars[0]||"",a.PxPointY,x.color))}}function Ke(){var e,t=Lr.histoLength;switch(t<=20?t=t+" JOUR"+(1!=t?"S":""):t<365?(t=Math.round(t/30),t+=" MOIS"):t=(t=Math.round(t/365))+" AN"+(1!=t?"S":""),e=Lr.chartPeriod){case 0:e="JOUR";break;case 7:e="HEBDO";break;case 30:e="MENSUEL";break;case 91:e="TRIMESTRIEL";break;case 365:e="ANNUEL";break;default:e=e>=-60?Math.abs(e)+" MINUTE"+(-1!=e?"S":""):Math.round(e/-60)+" HEURES"}b.qstxt(et("#eod_topinfo-")+" span:last-child",t+" - "+e)}function Ze(e){qr={},Rr=[],Gt(),e||"function"==typeof stopTimers&&stopTimers()}function et(e){return e+Vr.callID}function tt(a,r){var n,i,l,s,c;if(n=r?a.type:a,Yr.flagSave=!0,Lt(),Lr.mainChart.typedef.nolinearX){if(Hr.maxX=0,Hr.minX=0,null==Dr.Low&&y(Dr),Hr.minY=Dr.Low,Hr.maxY=Dr.High,Lr.isCompare&&qe(Dr.High,Dr.Low,Dr.QuoteTab[0].c),Lr.mainChart.type=n,Lr.mainChart.typedef=e(n),r&&(Lr.mainChart=t(Lr.mainChart,a)),Rr.length>1&&Rr.splice(0,1),Lr.mainChart.typedef.nolinearX)return void Pt();for(1!=Lr.histoLength||Lr.set.noVeilleIntra||((i=Dr.qv.c)>Hr.maxY&&(Hr.maxY=i),i<Hr.minY&&(Hr.minY=i)),s=Rr.length,l=0;l<s;l++)Rr[l].Bars=0==l?[]:{},delete Rr[l].canvas,delete Rr[l].ctx;return c=o(Rr),Ze(!0),De(c),Ke(),$(),void P()}Lr.mainChart.type=n,Lr.mainChart.typedef=e(n),r&&(Lr.mainChart=t(Lr.mainChart,a)),Lr.mainChart.typedef.nolinearX?Pt():$()}function at(e){var t,a,r;Gt(),Gr.sens=e,Gr.last=Rr[0].Bars[0][0].c,t="buy"==e?.98*Gr.last:1.02*Gr.last,Gr.popup=b.gi("orderzn"),null==Vr.doc.querySelector("orderzn")&&Vr.doc.appendChild(Gr.popup),Gr.cvs=b.gi(et("overlay-")),Gr.ctx=Gr.cvs.getContext("2d"),Gr.oft=l(b.gi(et("rodgraph-"))),a=Gr.popup.querySelector("div:nth-of-type(2)"),r=window.getComputedStyle(a).backgroundColor,Gr.ctx.strokeStyle=r,Gr.ctx.lineWidth=2,Gr.ctx.setLineDash&&Gr.ctx.setLineDash([]);var n=window.getComputedStyle(Gr.popup).width.replace("px",""),o=parseInt((Lr.widthGraph-n)/2);Gr.popup.style.left=o+"px",Gr.popup.style.display="block",ct(t),Gr.isMove=!1,["touchstart","mousedown"].forEach((function(e){b.gi("ordertype").addEventListener(e,ot)})),Vr.clickHandler.forEach((function(e){b.qs(".closeorder").addEventListener(e,rt)})),b.gi("orderlevel").addEventListener("keydown",nt)}function rt(e){e.preventDefault(),st(),Gr.ctx.clearRect(0,0,Gr.cvs.width,Gr.cvs.height)}function nt(e){var t;13==(e.which?e.which:e.keyCode)&&(t=this.value,ct(parseFloat(t.replace(/,/g,"."))))}function ot(e){e.preventDefault(),Gr.isMove=!0,["touchmove","mousemove"].forEach((function(e){document.addEventListener(e,it)})),["touchend","mouseup"].forEach((function(e){b.gi("ordertype").addEventListener(e,lt),document.addEventListener(e,lt)}))}function it(e){e.preventDefault(),Gr.isMove&&function(e){var t=s(e),a=parseInt(t.y-Gr.oft.top),r=parseInt(t.x-Gr.oft.left);a<Lr.paddingTop||a>Rr[0].HeightPx+Lr.paddingTop||ct(new oa(r,a-Lr.paddingTop).y)}(e)}function lt(e){e.preventDefault(),Gr.isMove=!1,["touchmove","mousemove"].forEach((function(e){document.removeEventListener(e,it)})),["touchend","mouseup"].forEach((function(e){b.gi("ordertype").removeEventListener(e,lt),document.removeEventListener(e,lt)}))}function st(){var e=b.gi("orderzn");null!=e&&null!=e.offsetParent&&(Gr.ctx.clearRect(0,0,Gr.cvs.width,Gr.cvs.height),["touchstart","mousedown"].forEach((function(e){b.gi("ordertype").removeEventListener(e,ot)})),["touchend","mouseup"].forEach((function(e){document.removeEventListener(e,lt)})),b.gi("orderlevel").removeEventListener("keydown",nt),Vr.clickHandler.forEach((function(e){b.qs(".closeorder").removeEventListener(e,rt)})),Gr.popup.style.display="none",Vr.doc.parentNode.insertBefore(Gr.popup,Vr.doc.nextSibling),P())}function ct(e){var t,a,r,n,o;Gr.ctx.clearRect(0,0,Gr.cvs.width,Gr.cvs.height),t=e,e>Hr.maxY&&(e=Hr.maxY),e<Hr.minY&&(e=Hr.minY),r=(a=Xe(e,Lr.logData)+Lr.paddingTop)+1,Gr.ctx.beginPath(),Gr.ctx.moveTo(Lr.paddingLeft,a),Gr.ctx.lineTo(Gr.cvs.width-Lr.paddingRight,a),Gr.ctx.stroke(),Gr.popup.style.top=r+"px",b.gi("orderlevel").value=p(t),n=function(e,t,a){var r={t:"limité",c:"limit"},n={t:"seuil de déclenchement",c:"stop"};return"buy"==a?e>=t?r:n:e<=t?r:n}(Gr.last,e,Gr.sens),null!=(o=b.gi("ordertype"))&&(o.textContent=n.t,o.setAttribute("order",n.c))}function dt(){var e=new XMLHttpRequest;e.open("POST",VGP.urlWS+"TraceDeleteSymbol",!0),e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.send(JSON.stringify({userid:VGP.userID,symbol:Lr.symbol}))}function ut(e,t){var a,r=VGP.urlWS+"GetEvtList";"GET"==VGP.callType&&(r=r+"?symbol="+Lr.symbol+"&length="+Lr.histoLength+"&isIntraday="+(Lr.chartPeriod<0)),Gt(),(a=new XMLHttpRequest).open(VGP.callType,r,!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.onload=function(){if(a.status>=200&&a.status<400){var r=JSON.parse(a.responseText);null!=r&&null!=r.d?(Yr.fiEvt=r.d,xt(e,0,t)):Yr.fiEvt="no",P()}},a.send(JSON.stringify({symbol:Lr.symbol,isIntraday:Lr.chartPeriod<0,length:Lr.histoLength}))}function ht(e,t,a,r,n){var o,i,l;if(Rr[0].Bars[a+1]=null,!(Lr.chartPeriod>=0)&&null!=Hr.qv&&null!=Hr.qd){var s,c,d=new Date,u=60*d.getHours()+d.getMinutes(),p=d.getFullYear().toString().substring(2,4)+h(d.getMonth()+1,"00")+h(d.getDate(),"00")+h(u,"0000")-Dr.QuoteTab[Dr.QuoteTab.length-1].d;if(c=p<30?Hr.qv:p>240||u>1080?Hr.qd:Hr.qv,(i=Dr.QuoteTab.length)<3)l=Dr.QuoteTab[0].d;else for(o=i-1;o>0;o--)if(Dr.QuoteTab[o].d-Dr.QuoteTab[o-1].d>480){l=Dr.QuoteTab[o].d;break}null==l&&(l=Dr.QuoteTab[0].d),s=new Se(l,0,0);var m=Rr[0].ctx,f=(c.h+c.l+c.c)/3,g=2*f-c.l,v=f+(c.h-c.l),y=2*f-c.h,b=f-(c.h-c.l),x=s.mx+Lr.paddingLeft;m.save(),e.v1||pt(m,e.color,x,f,1,n),e.v2||(pt(m,e.color2,x,y,1,n),pt(m,e.color2,x,b,2,n)),e.v3||(pt(m,e.color3,x,g,1,n),pt(m,e.color3,x,v,2,n)),m.restore()}}function pt(e,t,a,r,n,o){var i=Xe(r,o)+.5*n,l=Lr;e.lineWidth=n,e.beginPath(),e.strokeStyle=t,e.moveTo(a,i),e.lineTo(l.widthGraph-l.paddingRight,i),e.fillStyle=c(t),e.fillText(r.toFixed(2),l.widthGraph-l.paddingRight-47,i-3),e.stroke()}function mt(e,t,a,r,o,i){var l,s,d,h,p,m,f,g,v,y,b,x={},w=Rr[0];if(w.Bars[r+1]={},null!=(l=n.computeIchimoku(Dr.QuoteTab,e.param1,e.param2,Lr.chartPeriod))){for(l.Values=Ne(l.Values),s=l.Values.length,d=w.ctx,f=1;f<6;f++)if(!e[g="v"+f]){for(d.save(),d.strokeStyle=1==f?e.color:e["color"+f],5==f?null!=e.s5?xr(d,5,e):xr(d,3):xr(d,f,e),d.beginPath(),br(d,e,f),m=Xe(l.Values[0][g],i),d.moveTo(t,m+.5),p=1;p<s;p++)null!=(y=l.Values[p])&&null!=y[g]&&(h=Math.round(p*w.PxPointX+t),m=Xe(y[g],i),d.lineTo(h+.5,m+.5),1==f&&(x[y.d]=[y.v1,y.v2],v=p));d.stroke(),d.restore()}if(null!=v&&(y=l.Values[v],x[0]=[y.v1,y.v2]),w.Bars[r+1]=x,!e.v6){for(d.save(),null!=e.color6?(d.strokeStyle=e.color6,d.fillStyle=e.color6):(d.strokeStyle=u(c(e.color4),.3),d.fillStyle=u(c(e.color4),.3)),d.beginPath(),b=!1,p=s-1;p>=0;p--)null!=l.Values[p]&&null!=l.Values[p].v6&&(m=Xe(l.Values[p].v6,i),b?(h=Math.round(p*w.PxPointX+t),d.lineTo(h+.5,m+.5)):(d.moveTo(Math.round(p*w.PxPointX+t)+.5,m+.5),b=!0));for(p=0;p<s;p++)null!=l.Values[p]&&(h=Math.round(p*w.PxPointX+t),m=Xe(l.Values[p].v7,i),d.lineTo(h+.5,m+.5));d.closePath(),d.stroke(),d.fill(),d.restore()}}}function ft(e,t,a,r){var n,o,i,l,s,c,d,u,h,p,m,f,g={},v=Rr[0];if(v.Bars[r+1]={},e.datas2&&(n=e.datas2.QuoteTab,!e.v1)){for(o=n.length,(i=v.ctx).strokeStyle=e.color,i.save(),i.beginPath(),c=v.PxPointY*Dr.QuoteTab[Hr.minX].c,d=Math.round((v.V0-Dr.QuoteTab[Hr.minX].c)*v.PxPointY),i.moveTo(t,d),br(i,e,1),xr(i,1,e),u=0,s=0;s<o;s++)null!=n[s]&&null!=v.Bars[0][n[s].d]&&(p=v.Bars[0][n[s].d].i,l=Math.round(p*v.PxPointX+t),0==u?u=n[s].c:(h=(n[s].c-u)/u,i.lineTo(l+.5,d-h*c),g[n[s].d]=n[s].c,m=s));null!=m&&(g[0]=n[m].c),v.Bars[r+1]=g,i.stroke(),i.restore(),Lr.set.nosticky||0==o||(f=v.V0-(d-h*c)/v.PxPointY,$e(i,v.V0,f,v.PxPointY,e.color,!0,null))}}function gt(e,t,a,r,o,i){var l,s={},c=Rr[0];if(c.Bars[r+1]={},(l=n.computeSupertrend(Dr.QuoteTab,e.param1,e.param2)).Values=Ne(l.Values),null!=l.Values){for(var d,u,h,p,m,f,g,v=l.Values.length,y=c.ctx,b=0,x=1;x<3;x++)if(m="v"+x,p=!0,!e["v"+x]){for(y.save(),y.beginPath(),h=Xe(l.Values[0][m],i),y.moveTo(t,h+.5),br(y,e,x),y.strokeStyle=1==x?e.color:e.color2,u=1;u<v;u++)null!=(f=l.Values[u])&&(0==f[m]?(p&&y.stroke(),p=!1):(s[f.d]=f[m],d=Math.round(u*c.PxPointX+t),h=Xe(f[m],i),p?y.lineTo(d+.5,h+.5):(y.beginPath(),y.moveTo(d+.5,h+.5),p=!0),u>b&&(b=u,g=m)));p&&y.stroke(),y.restore()}b>0&&(s[0]=l.Values[b][g]),c.Bars[r+1]=s}}function vt(e,t,a,r,o,i){var l,s,c,d,u,h,p,m,f,g=n.computeHighLow(Dr.QuoteTab,e.param1),v={},y=Rr[0];if(y.Bars[r+1]={},null==g)return null;for(l=y.ctx,g.Values=Ne(g.Values),f=g.Values.length,u=1;u<3;u++)if(!e[h="v"+u])for(l.fillStyle=1==u?e.color:e.color2,c=0;c<f;c++)null!=g.Values[c]&&(s=Math.round(c*y.PxPointX+t),0!=g.Values[c][h]&&(l.beginPath(),d=Xe(g.Values[c][h],i),l.arc(s,d,3,0,2*Math.PI),l.fill(),v[g.Values[c].d]=g.Values[c][h],p=c,m=h));null!=p&&(v[0]=g.Values[p][m]),y.Bars[r+1]=v}function yt(e,t,a,r,o,i){var l,s,c,d,u,h,p,m,f,g=n.computeSAR(Dr.QuoteTab,e.param1,e.param2),v={},y=Rr[0];if(y.Bars[r+1]={},g.Values=Ne(g.Values),!((l=g.Values.length)<5)){for(s=y.ctx,m=0,h=1;h<3;h++)if(!e[p="v"+h])for(s.fillStyle=1==h?e.color:e.color2,d=5;d<l;d++)null!=g.Values[d]&&(c=Math.round(d*y.PxPointX+t),0!=g.Values[d][p]&&(s.beginPath(),u=Xe(g.Values[d][p],i),s.arc(c,u,2,0,2*Math.PI),s.fill(),v[g.Values[d].d]=g.Values[d][p],d>m&&(m=d,f=p)));m>0&&(v[0]=g.Values[m][f]),y.Bars[r+1]=v}}function bt(e,t,a,r,n,o){var i,l,s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("class","svginfofi"),s.setAttribute("width","22"),s.setAttribute("height","22"),s.setAttribute("data-id",n),s.setAttribute("data-seq",o),(i=document.createElementNS("http://www.w3.org/2000/svg","circle")).setAttributeNS(null,"cx",11),i.setAttributeNS(null,"cy",11),i.setAttributeNS(null,"r",11),i.setAttributeNS(null,"fill",a),s.appendChild(i),(l=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttributeNS(null,"x",7),l.setAttributeNS(null,"y",15),l.textContent=r,s.appendChild(l),s.style.top=t+"px",s.style.left=e-10+"px",Vr.doc.appendChild(s)}function xt(e,t,a){var r,n,o,i,l,s,c,d,u,h,p,m,f,g;if(b.clrem(["svginfofi"]),"no"!=Yr.fiEvt){if(0==Yr.fiEvt.length)return void(Yr.fiEvt="no");r=[],(i=Rr[0]).Bars[a+1]=[];var v=Dr.QuoteTab[Hr.minX].d,y=Dr.QuoteTab[Dr.QuoteTab.length-1].d,x=Yr.fiEvt.length;for(n=0;n<x;n++){if(Yr.fiEvt[n].d>v&&Yr.fiEvt[n].d<=y)if(null!=i.Bars[0][Yr.fiEvt[n].d])r[i.Bars[0][Yr.fiEvt[n].d].i]={i:n,data:Yr.fiEvt[n]};else for(o=Hr.minX;o<=Hr.maxX;o++)if(null!=Dr.QuoteTab[o]&&Dr.QuoteTab[o].d>=Yr.fiEvt[n].d){r[i.Bars[0][Dr.QuoteTab[o].d].i]={i:n,data:Yr.fiEvt[n]};break}Yr.fiEvt[n].d>v&&Yr.fiEvt[n].d>y&&null!=i.Bars[0][y]&&(l=Yr.fiEvt[n].d-Dr.QuoteTab[Dr.QuoteTab.length-1].d,l=0!=Lr.chartPeriod?Math.round(l/Lr.chartPeriod):Math.round(5*l/7),(s=i.Bars[0][y].i+l)<=Hr.maxX-l+2&&(r[s]={i:n,data:Yr.fiEvt[n]}))}for(u=r.length,p={},n=0;n<Lr.newsConfig.length;n++)p[Lr.newsConfig[n]]=!0;if(null!=u)for(n=1;n<u;n++)if(null!=r[n])for(c=Math.round(n*i.PxPointX+e),d=i.HeightPx-10,m=r[n].data.tabEvents.length,h=0;h<m&&!(p[r[n].data.tabEvents[h].evt]&&(f=r[n].i,g=h,c<Lr.widthGraph-Lr.paddingRight&&c>Lr.paddingLeft&&bt(c,d,r[n].data.tabEvents[h].c,r[n].data.tabEvents[h].evt,f,g),d-=22,h>=5));h++);[].forEach.call(b.qsa(".svginfofi"),(function(e){e.addEventListener("mouseenter",wt)}))}}function wt(){var e,t,a,r,n=this.getAttribute("data-id"),o=this.getAttribute("data-seq"),i=Yr.fiEvt[n].tabEvents[o],l=parseInt(this.style.left.replace("px","")),s=parseInt(this.style.top.replace("px","")),c=b.gi(et("eod_infofi-"));null==c&&((c=document.createElement("div")).id=et("eod_infofi-"),Vr.doc.appendChild(c)),c.setAttribute("class","eod_infofi"),e=Lr.chartPeriod<0?m(Yr.fiEvt[n].d):g(Yr.fiEvt[n].d,1),t=null!=i.u&&""!=i.u?'<a href="'+i.u+'" target = "_blank" > '+i.s+"</a>":i.s,t+="</br>"+e,c.innerHTML=t,c.style.display="block",a=c.clientWidth,r=c.clientHeight,l=l>a+20?l-(a+2):l+22,c.style.top=s-Math.round(r/2)+"px",c.style.left=l+"px",c.addEventListener("mouseleave",Tt)}function Tt(){b.clhide("eod_infofi")}function Ct(e,t){var a,r=e.length-t;for(r<0&&(r=0),a=r;a>=0;a--)if(null!=e[a])return e[a]}function kt(e,t,a,r,n){if(null!=a[0].vm){var o,i,l=r-1,s=a.length,c=t.V0;for("volume"==t.Indicator.type&&(c=t.HeightPx),e.strokeStyle=t.Indicator.mmColor,e.beginPath(),e.moveTo(r,c-Math.round(a[0].vm*t.PxPointY)),i=1;i<s;i++)null!=a[i]&&(o=Math.round(i*n+r))-l>=2&&(e.lineTo(o,c-Math.round(a[i].vm*t.PxPointY)),l=o);e.stroke()}}function St(e){var t,a;return-1!=e.indexOf("#")?3==(t=e.substring(1)).length&&(t+=t):t=c(e).substring(1),.2126*((a=parseInt(t,16))>>16&255)+.7152*(a>>8&255)+.0722*(a>>0&255)>130?"#000":"#fff"}function Pt(){var e,t,a,r;for(b.idempty(et("")),t=Rr.length,qr={},e=0;e<t;e++)Rr[e].Bars=0==e?[]:{},delete Rr[e].canvas,delete Rr[e].ctx;for(Gt(),Hr.maxY=Dr.High,Hr.minY=Dr.Low,Ee("rodgraph",Vr.doc),Vr.ctxback=b.gi(et("rodgraph-")).getContext("2d"),Ve(),VGP.chartSimple||(Ee("topinfo",Vr.doc),Ee("mainci",Vr.doc)),a=o(Rr),Rr=[],new qt(0,1,Lr.mainChart.type,"main",0).Create(),r=a.length,e=0;e<r;e++)Rr.push(a[e]);Rr[0].DrawEncadre(),VGP.chartSimple||(Ee("overlay",Vr.doc),Ee("trace",Vr.doc),b.qstxt(et("#eod_topinfo-")+" span",Dr.Name)),Ke(),Mt(!0),Be(),P()}function Mt(e){var t,a,r,n,o,i,l,s,d,h,p,m,f,g,y,x,w,T,C,k,S,P,M,_,E,V=Lr,L=V.mainChart.typedef,I=L.param1,D="",R=Rr[0];switch(qr={},a="c",null!=L.source&&(a=L.source),V.mainChart.type){case"renko":if(null==I&&(I=+((Dr.High-Dr.Low)/20).toFixed(2)),D=I,!(t=Mr(Dr,I,a)))return;(t.QuoteTab.length>700||t.QuoteTab.length<5)&&(I=+((Dr.High-Dr.Low)/20).toFixed(2),t=Mr(Dr,I,a));break;case"line break":(I>5||I<1||null==I)&&(I=2),D=I,t=function(e,t,a){function r(e,a){var r;if(1==e)for(r=Math.min(p[a-1].l,p[a-2].l),r=p[a-t].l,d=1;d<t;d++)p[a-d].l<r&&(r=p[a-d].l);else for(r=p[a-t].h,d=1;d<t;d++)p[a-d].h>r&&(r=p[a-d].h);return r}var n,o,i,l,s,c,d,u,h={QuoteTab:e.QuoteTab},p=[],m=h.QuoteTab.length;if(t>5&&(t=5),t>m-5)return!1;for(i=v(h.QuoteTab[0],a),l=v(h.QuoteTab[0],a),n=1;n<t;n++)v(h.QuoteTab[n],a)>l&&(l=v(h.QuoteTab[n],a)),v(h.QuoteTab[n],a)<i&&(i=v(h.QuoteTab[n],a));for(v(h.QuoteTab[t-1],a)>v(h.QuoteTab[0],a)?(o=1,s=i):(o=0,s=l),n=0;n<t;n++)p.push({d:h.QuoteTab[n].d,l:i,h:l,s:o,c:h.QuoteTab[n].c});for(n=t;n<m;n++)if(c=p.length,u=h.QuoteTab[n],0==o){if(s=r(0,c),v(u,a)>s){o=1,p.push({d:u.d,l:p[c-1].h,h:v(u,a),s:1,c:u.c});continue}if(u.c<p[c-1].l){o=0,p.push({d:u.d,l:v(u,a),h:p[c-1].l,s:0,c:u.c});continue}}else{if(s=r(1,c),v(u,a)<s){o=0,p.push({d:u.d,l:v(u,a),h:p[c-1].l,s:0,c:u.c});continue}if(v(u,a)>p[c-1].h){o=1,p.push({d:u.d,l:p[c-1].h,h:v(u,a),s:1,c:u.c});continue}}return p.splice(0,t-1),1==p.length&&(p=[]),{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:p}}(Dr,I,a);break;case"kagi":null==I&&(I=+((Dr.High-Dr.Low)/30).toFixed(2)),t=function(e,t,a){var r,n,o,i,l,s,c,d,u,h,p={QuoteTab:e.QuoteTab},m=[],f=p.QuoteTab.length;if(f<5)return!1;for(v(p.QuoteTab[1],a)>v(p.QuoteTab[0],a)?(o=v(p.QuoteTab[0],a),i=v(p.QuoteTab[1],a),m.push({d:p.QuoteTab[0].d,l1:o,h1:i,c:p.QuoteTab[0].c,s:1}),n=1,l=!0,s=v(p.QuoteTab[0],a)):(o=v(p.QuoteTab[1],a),i=v(p.QuoteTab[0],a),m.push({d:p.QuoteTab[0].d,l2:o,h2:i,c:p.QuoteTab[0].c,s:0}),n=0,l=!1,c=v(p.QuoteTab[0],a)),r=2;r<f;r++)u=v(p.QuoteTab[r],a),h=m.length-1,1==n&&l?((d=u-m[h].h1)>0&&(m[h].h1=u,i=u),d<0&&d<-t&&(c=i,m.push({d:p.QuoteTab[r].d,l1:Math.max(u,s),h1:i,c:u,s:0}),u<s&&(m[m.length-1].l2=u,m[m.length-1].h2=s,n=0),l=!1,o=u)):1!=n||l?0!=n||l?0==n&&l&&((d=u-m[h].h2)<-t&&(m.push({d:p.QuoteTab[r].d,l2:u,h2:i,c:u,s:0}),n=0,l=!1,o=u,c=i),d>0&&(m[h].h2=Math.min(u,c),u>c&&(m[h].l1=c,m[h].h1=u,n=1),i=u)):((d=u-m[h].l2)<0&&(m[h].l2=u,o=u),d>0&&d>t&&(s=o,m.push({d:p.QuoteTab[r].d,l2:o,h2:Math.min(u,c),c:u,s:1}),u>c&&(m[m.length-1].l1=c,m[m.length-1].h1=u,n=1),l=!0,i=u)):((d=u-m[h].l1)>t&&(m.push({d:p.QuoteTab[r].d,l1:o,h1:u,c:u,s:1}),n=1,l=!0,s=o,i=u),d<0&&(m[h].l1=Math.max(u,s),u<s&&(m[h].l2=u,m[h].h2=s,n=0),o=u));return{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:m}}(Dr,I,a),D=I;break;case"equivolume":t=Dr;break;case"point figure":null==I&&(I=((Dr.High-Dr.Low)/50).toFixed(2)),null==(r=L.param2)&&(r=3),t=function(e,t,a,r){var n,o,i,l={QuoteTab:e.QuoteTab},s=[],c=l.QuoteTab.length;if(c<3||t<=0||a<=1)return!1;var d,u=v(l.QuoteTab[0],r),h=!0,p=l.QuoteTab[0].d;for(n=1;n<c;n++){if((d=v(l.QuoteTab[n],r)-u)>=t){h=!0;break}if(d<=-t){h=!1;break}}for(o=1,n=1;n<c;n++)i=(v(l.QuoteTab[n],r)-u)/t,h?(i>=1&&(u+=Math.floor(i)*t,o+=Math.floor(i)),i<=-a&&(s.push({d:p,f:!0,n:o,c:u}),p=l.QuoteTab[n].d,u+=Math.ceil(i)*t,h=!1,o=Math.floor(Math.abs(i)))):i>=a?(s.push({d:p,f:!1,n:o,c:u-t}),p=l.QuoteTab[n].d,u+=Math.floor(i)*t,h=!0,o=Math.floor(Math.abs(i))):i<=-1&&(u+=Math.ceil(i)*t,o+=Math.floor(Math.abs(i)));return 1!=o&&s.push({d:p,f:h,n:o,c:u}),{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:s}}(Dr,I,r,a),D=I+", "+r}if(VGP.chartSimple||b.idhtml(et("eod_mainchartinfos-"),'<div><span class="eod_param" data-name="'+V.mainChart.type+'"><span class="mci-p"></span> '+V.mainChart.type.toUpperCase()+" ("+D+")</span></div>"),null!=(n={Name:t.Name,High:t.High,Low:t.Low,QuoteTab:t.QuoteTab}).QuoteTab&&0!=n.QuoteTab.length){Hr.maxNL=n.QuoteTab.length,(0==Hr.maxX&&0==Hr.minX||e)&&(Hr.maxX=n.QuoteTab.length-1,Hr.minX=0),n.QuoteTab=Ne(t.QuoteTab);var A,H=n.High,B=n.Low,q=n.QuoteTab.length;0==Hr.maxY&&0==Hr.minY?(Hr.maxY=H,Hr.minY=B):(H=Hr.maxY,B=Hr.minY),R.PxPointY=(R.HeightPx-57)/(H-B),R.V0=H+37/R.PxPointY;var G=R.V0,N=R.PxPointY,Y=R.ctx;if(0!=q){switch((o=Math.floor(V.innerWidth/q)-1)%2==0&&o++,V.padBarCandle=o,i=V.paddingLeft+V.padBarCandle,Oe(Y,R.HeightPx,i,G,N),d=(V.innerWidth-2*V.padBarCandle)/(q-1),R.PxPointX=d,"equivolume"==V.mainChart.type?Ye(R,!0,(n=function(e,t){for(var a,r,n,o={QuoteTab:e.QuoteTab},i=[],l=o.QuoteTab.length,s=0,c=0,d=0;d<l;d++)null!=o.QuoteTab[d]&&(c+=o.QuoteTab[d].v);for(c+=1e3*c,d=0;d<l;d++)null!=(r=o.QuoteTab[d])&&(a=Math.round(1e3*r.v/c*t),n=r.c>=r.o,i.push({d:r.d,l:r.l,h:r.h,s:n,w:a,c:r.c,cu:s,o:r.o}),s+=a);return{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:i}}(n,V.innerWidth-5)).QuoteTab,!0):Ye(R,!0,n.QuoteTab),Br=[],R.Bars[0]={},h={},Y.save(),V.mainChart.type){case"equivolume":for(l=V.paddingLeft,A=0;A<q;A++)if(null!=(p=n.QuoteTab[A])){for(f=Math.round((G-p.l)*N),g=Math.round((G-p.h)*N),y=Math.round((G-p.c)*N),x=Math.round((G-p.o)*N),p.s?(Y.fillStyle=u(c(L.color),.4),Y.strokeStyle=L.color):(Y.fillStyle=u(c(L.color2),.4),Y.strokeStyle=L.color2),(L.v1||!p.s)&&(L.v2||p.s)||(Y.beginPath(),Y.rect(l+.5,g+.5,p.w,f-g),Y.stroke(),Y.fill()),Y.fillStyle=p.s?u(c(L.color),.8):u(c(L.color2),.8),(L.v1||!p.s)&&(L.v2||p.s)||(Y.beginPath(),Y.rect(l+.5,Math.max(y,x),p.w,-Math.abs(y-x)),Y.fill()),h[p.d]={c:p.c.toFixed(2),i:A},m=A,Br[Math.floor(l+p.w/2)]={d:p.d,i:A},s=l;s<=l+p.w;s++)qr[s]=p.d;l+=p.w}p=n.QuoteTab[m],h[0]={c:p.c.toFixed(2),i:m,d:p.d};break;case"point figure":for(w=Math.floor(o/2),C=Math.round(d),k=I*N,A=0;A<q;A++)if(null!=(p=n.QuoteTab[A])){if(T=Math.round((G-p.c)*N),l=Math.round(A*d+i)-w,p.f){for(Y.strokeStyle=L.color,Y.beginPath(),s=0;s<p.n;s++)T+=k,L.v1||(Y.moveTo(l,T),Y.lineTo(l+C,T-k),Y.moveTo(l+C,T),Y.lineTo(l,T-k));Y.stroke()}else for(Y.strokeStyle=L.color2,s=0;s<p.n;s++)T-=k,L.v2||(Y.save(),Y.beginPath(),Y.translate(l,T),Y.scale(C/2,k/2),Y.arc(1,1,1,0,2*Math.PI,!1),Y.restore(),Y.stroke());for(h[p.d]={c:p.c.toFixed(2),i:A},m=A,Br[Math.floor(l+w)-V.paddingLeft]={d:p.d,i:A},s=0;s<=C;s++)qr[l+s]=p.d}null!=m&&(p=n.QuoteTab[m],h[0]={c:p.c.toFixed(2),i:m,d:p.d});break;case"renko":case"line break":if(Y.strokeStyle=L.color3,w=Math.floor(o/2),!L.v1){for(Y.beginPath(),Y.fillStyle=L.color,A=0;A<q;A++)if(null!=(p=n.QuoteTab[A]))for(l=Math.round(A*d+i)-w,1==p.s&&(f=Math.round((G-p.l)*N),g=Math.round((G-p.h)*N),Y.rect(l+.5,g+.5,Math.round(d),f-g)),h[p.d]={c:p.c.toFixed(2),i:A},m=A,Br[Math.floor(l+w)-V.paddingLeft]={d:p.d,i:A},s=-w;s<=w;s++)qr[l+s]=p.d;p=n.QuoteTab[m],h[0]={c:p.c.toFixed(2),i:m,d:p.d},L.v3&&(Y.strokeStyle=L.color),Y.stroke(),Y.fill()}if(!L.v2){for(Y.beginPath(),Y.fillStyle=L.color2,A=0;A<q;A++)null!=(p=n.QuoteTab[A])&&(l=Math.round(A*d+i)-w,0==p.s&&(f=Math.round((G-p.l)*N),g=Math.round((G-p.h)*N),Y.rect(l+.5,g+.5,Math.round(d),f-g)));L.v3&&(Y.strokeStyle=L.color2),Y.stroke(),Y.fill()}break;case"kagi":for(Y.lineWidth=3,A=0;A<q;A++)if(null!=(p=n.QuoteTab[A]))for(E=Math.round(A*d+i)-o+.5,l=Math.round((A+1)*d+i)-o+.5,S=Math.round((G-p.l1)*N)+.5,P=Math.round((G-p.h1)*N)+.5,M=Math.round((G-p.l2)*N)+.5,_=Math.round((G-p.h2)*N)+.5,null!=p.l1&&null!=p.l2&&(1==p.s?(L.v2||(Y.beginPath(),Y.strokeStyle=L.color2,Y.moveTo(E,M),Y.lineTo(l,M),Y.lineTo(l,_-1),Y.stroke()),L.v1||(Y.beginPath(),Y.strokeStyle=L.color,Y.moveTo(l,S),Y.lineTo(l,P-1.5),Y.stroke())):(L.v1||(Y.beginPath(),Y.strokeStyle=L.color,Y.moveTo(E,P),Y.lineTo(l,P),Y.lineTo(l,S+1),Y.stroke()),L.v2||(Y.beginPath(),Y.strokeStyle=L.color2,Y.moveTo(l,_),Y.lineTo(l,M+1.5),Y.stroke()))),null==p.l2&&(L.v1||(Y.beginPath(),Y.strokeStyle=L.color,1==p.s?(Y.moveTo(E,S),Y.lineTo(l,S),Y.lineTo(l,P-1.5)):(Y.moveTo(E,P),Y.lineTo(l,P),Y.lineTo(l,S+1.5)),Y.stroke())),null==p.l1&&(L.v2||(Y.beginPath(),Y.strokeStyle=L.color2,1==p.s?(Y.moveTo(E,M),Y.lineTo(l,M),Y.lineTo(l,_-1.5)):(Y.moveTo(E,_),Y.lineTo(l,_),Y.lineTo(l,M+1.5)),Y.stroke())),h[p.d]={c:p.c.toFixed(2),i:A},m=A,Br[Math.floor(l-.5)-V.paddingLeft]={d:p.d,i:A},s=E-.5;s<=l-.5;s++)qr[s]=p.d;p=n.QuoteTab[m],h[0]={c:p.c.toFixed(2),i:m,d:p.d}}Y.restore(),R.Bars[0]=h,0!=q&&null!=h[0]&&"point figure"!=V.mainChart.type&&(V.set.nohighlow||($e(Y,G,n.High,N,"rgba(0, 128, 0, 1)",!0),$e(Y,G,n.Low,N,"rgba(192, 0, 0, 1)",!0)),V.set.nosticky||$e(Y,G,h[0].c,N,null,!0))}}}function _t(e,t,a,r,n,o,i){var l,s=Xe(a.l,i),c=Xe(a.h,i),d=Xe(a.o,i),u=Xe(a.c,i);e.rect(r+.5,u+.5,t-1,d-u),l=r+.5+n,Lr.mainChart.typedef.v3||(e.moveTo(l,c),e.lineTo(l,u),e.moveTo(l,d),e.lineTo(l,s)),Br[Math.floor(l)-Lr.paddingLeft]={d:a.d,i:o}}function Et(e){var t,a,r,n;if(!("none"==Lr.set.splitStyle||Lr.histoLength>20||Lr.histoLength<=1)){for(a=Dr.QuoteTab.length,r=[],t=1;t<a;t++)Dr.QuoteTab[t].d-Dr.QuoteTab[t-1].d>480&&r.push(Dr.QuoteTab[t].d);if(!((n=r.length)<1)){var o,i,l,s=Lr.set.splitColor,h=Lr.paddingLeft+Lr.padBarCandle,p=e.ctx;for(l=Lr.paddingLeft,p.save(),p.beginPath(),"band"==Lr.set.splitStyle?p.fillStyle=1==d(s)?u(c(s),.2):s:(p.strokeStyle=c(s),xr(p,2)),t=0;t<n;t++)null!=Rr[0].Bars[0][r[t]]&&(o=Rr[0].Bars[0][r[t]].i,i=Math.round(o*Rr[0].PxPointX+h)+.5,"band"==Lr.set.splitStyle?(t%2==0&&(p.fillStyle=u(c(s),.2),p.fillRect(l,0,i-l,e.HeightPx)),l=i):(p.moveTo(i,0),p.lineTo(i,e.HeightPx)));"band"==Lr.set.splitStyle&&t%2==0&&p.fillRect(l,0,Lr.widthGraph-Lr.paddingRight-l,e.HeightPx),p.stroke(),p.restore()}}}function Vt(e,t,a,r,n){var o,i,l,s=document.createElement("div");for(s.setAttribute("class","infoindic"),s.style.left=a+"px",s.style.top=r+"px",null!=n&&(s.style.width=n+"px"),s.id="infoindic-"+e,11!=Lr.set.fontSize&&(s.style.fontSize=Lr.set.fontSize+"px"),l=["closelayericon","indicname","eodupdown"],VGP.chartSimple&&(l=["indicname"]),o=0;o<l.length;o++)(i=document.createElement("span")).setAttribute("class",l[o]),"#606060"!=Lr.set.txtColor&&(i.style.color=Lr.set.txtColor),"indicname"==l[o]&&(i.textContent=t),s.appendChild(i);return s}function Lt(){Ut(),st();var e=document.querySelector(".linemodif");null!=e&&(document.removeEventListener("keydown",ea),document.removeEventListener("keydown",Zt),e.getAttribute("cid")==Vr.callID&&(la(),b.gi(et("trace-")).removeEventListener("touchend",na),b.gi(et("trace-")).removeEventListener("mousedown",na),b.clrem(["linemodif","resizehandler"]),P(),Lr.chartPeriod>=0&&Yr.flagSave&&!VGP.noAutoSaveTrace&&It())),Yr.flagSave=!1}function It(e){var t,a;return!!r()&&("[]"==(t=localStorage.getItem(Lr.symbol))||null==t?(dt(),delete VGP.drawings[Lr.symbol],!1):e?t:((a=new XMLHttpRequest).open("POST",VGP.urlWS+"TraceSaveSymbol",!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),void a.send(JSON.stringify({userid:VGP.userID,symbol:Lr.symbol,content:t}))))}function Dt(){var e,t,a,r,n,o=Lr.heightGraph-Lr.paddingBottom-Lr.paddingTop,i=Rr.length;for(i>1&&(o-=Lr.marginInter*(Rr.length-1)),Lr.usableHeight=o,t=[0,.25,.2,.1666,.15,.13,.12][i-1],e=r=[1,.75,.6,.5002,.4,.35,.28][i-1],Rr[0].Resize(0,r,0),a=1;a<i;a++)n=Math.round(e*Lr.usableHeight)+Lr.paddingTop+Lr.marginInter*a+5,Rr[a].Resize(e,t,a*Lr.marginInter),b.idcss(et("infoindic-")+a,"top",n+"px"),e+=t,i>2&&Rt(a,a==i-1);b.gi(et("trace-")).height=Rr[0].HeightPx}function Rt(e,t){var a;a=t?'<span class="eodmoveup"/></span>':e>1?'<span class="eodmoveup" /></span><span class="eodmovedown" /></span>':'<span class="eodmovedown" /></span>',b.qshtml(et("#infoindic-")+e+" .eodupdown",a)}function At(e){var t,a,r,n,o=Rr.length;new qt(0,0,e,et("indic-")+o).Create(),(t=b.gi(et("overlay-"))).parentNode.insertBefore(b.gi(et("indic-")+o),t),a=Vt(Vr.callID+o,e.type,Lr.paddingLeft+5,Rr[o].RealY+5),o>1&&null!=(r=a.querySelector(".eodupdown"))&&((n=document.createElement("span")).setAttribute("class","eodmoveup"),r.appendChild(n)),Vr.doc.appendChild(a),Dt(),$()}function Ht(e){var t,a,r,n;for(b.idrem(et("indic-")+e),b.idrem(et("infoindic-")+e),(t=[])[0]=Rr[0],a=1,n=Rr.length,r=1;r<n;r++)r!=e&&(t[a]=Rr[r],b.gi(et("indic-")+r).setAttribute("id",et("indic-")+a),b.gi(et("infoindic-")+r).setAttribute("id",et("infoindic-")+a),b.qsaempty(et("#infoindic-")+a+" .eodupdown"),a++);Rr=t,Dt(),$()}function Bt(e,t,a,r,n,o,i,l,s,c,d,u){this.x0=e,this.y0=t,this.x1=a,this.y1=r,this.color=n,this.type=c,this.width=null!=l?l:1,this.style=null!=s?s:1,null!=d&&(this.h=d),null!=u&&(this.color2=u),Lr.set.semilog&&null!=Lr.logData&&0!=t&&2e4!=r?(this.RealY0=Xe(t,Lr.logData),this.RealY1=Xe(r,Lr.logData)):(this.RealY0=Math.round((Rr[0].V0-t)*Rr[0].PxPointY),this.RealY1=Math.round((Rr[0].V0-r)*Rr[0].PxPointY)),0==e&&0==a?(this.RealX0=0,this.RealX1=Lr.widthGraph-Lr.paddingRight):0==a?(this.RealX1=Lr.widthGraph-Lr.paddingRight,this.RealX0=o):(this.RealX0=o,this.RealX1=i)}function qt(e,t,a,r,n){this.Y=e,this.RealY=Math.round(e*Lr.usableHeight)+Lr.paddingTop+n,this.Height=t,this.HeightPx=Math.round(t*Lr.usableHeight),this.PxPointY=0,this.PxPointX=0,this.V0=0,this.id=r,this.Indicator=a,this.Bars=[]}function Gt(){var e,t;null!=Vr.doc&&(Vr.doc.removeEventListener("mousewheel",O),Vr.doc.removeEventListener("DOMMouseScroll",O),Vr.doc.removeEventListener("mouseleave",E),Vr.doc.removeEventListener("touchmove",L),Vr.doc.removeEventListener("mousemove",L),Vr.doc.removeEventListener("mouseup",R),Vr.doc.removeEventListener("mousedown",D),Vr.doc.removeEventListener("touchstart",D),Vr.doc.removeEventListener("touchend",R),(e=b.gi("indicList"))&&(e.removeEventListener("mousedown",I),e.removeEventListener("touchstart",I))),la(),(t=b.gi(et("trace-")))&&(t.removeEventListener("touchend",na),t.removeEventListener("mousedown",na)),Yr.eventsActive=!1}function Nt(e){b.gi("param1Automatic").addEventListener("change",(function(){this.checked&&(Lr.mainChart.typedef["param"+e]=null,$(!1,!0),b.gi("mperiod"+e).value="")}))}function Yt(a,r,n){var o,i,l,s,d,h,p,m,f,g,v,y,x,w,T,C,k,S,P,M;if(0==b.qsa(".params_zone").length){if(Gt(),(i=document.createElement("div")).id=et("uParams-"),i.setAttribute("class","uParams"),i.style.height="100%",i.innerHTML='<div style="top:'+Lr.paddingTop+"px;left:"+Lr.paddingLeft+'px" class="params_zone"><div class="params_zone_in clearfix"><img class="closeparams" /></div><div class="params_content"></div></div>',Vr.doc.appendChild(i),null!=n&&(r=Rr[n].Indicator.type),l=e(r),null!=n?Rr[n].Indicator=t(l,Rr[n].Indicator):null!=a?Lr.mainChart.indicators[a]=t(l,Lr.mainChart.indicators[a]):Lr.mainChart.typedef=t(l,Lr.mainChart.typedef),null!=l.params.p)for(d=l.params.p.length,s=0;s<d;s++){if(h=10,null==(h=null!=n?Rr[n].Indicator["param"+(s+1)]:null!=a?Lr.mainChart.indicators[a]["param"+(s+1)]:Lr.mainChart.typedef["param"+(s+1)])&&(h=""),(p=document.createElement("div")).setAttribute("class","clearfix pad5"),o='<div class="eod_pname">'+l.params.p[s]+'</div><input value="'+h+'" class="eod_inp" onkeypress="return isNumberLetterKey(event)" id="mperiod'+(s+1)+'" type="text" />',["renko","line break","kagi","point figure"].indexOf(r)<0){var _=2,E=100,V=1;switch(r){case"zig zag":_=.1,E=20,V=.1;break;case"sar":_=.02,E=.06,V=.01;break;case"evmm":s+1==2&&(_=.1,E=15,V=.1);break;case"boll":s+1==2&&(_=.1,E=10,V=.1);break;case"lineard":s+1==2&&(_=.1,E=10,V=.1)}p.innerHTML=o+'<div class="eod_slider"><div id="slider'+(s+1)+'" class="sliderout" min="'+_+'" max="'+E+'" step="'+V+'" value="'+h+'"></div></div>',b.qs(".params_content").appendChild(p),Qt(s+1,a,n)}else"point figure"==r&&1==s?(p.innerHTML=o+"</div>",b.qs(".params_content").appendChild(p)):(p.innerHTML=o+'<input id="param1Automatic" type="checkbox"><span>'+lang.l_automatic+"</span>",b.qs(".params_content").appendChild(p),""==h&&(b.gi("param1Automatic").checked=!0),Nt(s+1));Ot(s+1,a,r,n)}if(null!=l.params.c){for(m=l.params.c.length,s=0;s<m;s++){if(f="",null!=l.params.w){switch(l.params.w[s]){case"sw":f='<div id="w'+(s+1)+'" class="widthSelect w1"></div><div id="s'+(s+1)+'" class="styleSelect s2"></div>';break;case"s":f='<div id="s'+(s+1)+'" class="styleSelect s2">';break;case"w":f='<div id="w'+(s+1)+'" class="widthSelect w1">';break;case"o":f='<div id="o'+(s+1)+'" class="opSelect">'}f+="</div>"}g="",v=!1,null!=n?Rr[n].Indicator["v"+(s+1)]&&(v=!0):null!=a?Lr.mainChart.indicators[a]["v"+(s+1)]&&(v=!0):Lr.mainChart.typedef["v"+(s+1)]&&(v=!0),v||(g='checked="true"'),o='<input class="eod_cbv" id="v'+(s+1)+'" type="checkbox" '+g+' /><div class="eod_cname">'+l.params.c[s]+'</div><input id="color'+(s+1)+'" type="text" />'+f,(y=document.createElement("div")).setAttribute("class","clearfix pad5"),y.innerHTML=o,b.qs(".params_content").appendChild(y),w=s+1==1?"color":"color"+(s+1),x=c(null!=n?Rr[n].Indicator[w]:null!=a?Lr.mainChart.indicators[a][w]:Lr.mainChart.typedef[w]),Ft(s+1,a,n,x,l.type)}!function(e,t,a){function r(t){if(t.preventDefault(),""==this.innerHTML){b.qsarem(".widthSelect ul"),b.qsarem(".styleSelect ul");var r=this.id,n=parseInt(r.slice(-1)),o=document.createElement("div");o.setAttribute("class","opContent"),o.innerHTML='<div class="sliderout" id="sliderO" min="0" max="100" step="1">',this.appendChild(o),function(e,t,a){var r=1==t?"color":"color"+t;new Slider({wrapperEl:"#sliderO",value:50,onSlide:function(t){var n;t/=100,n=null!=e?Rr[e].Indicator[r]:null!=a?Lr.mainChart.indicators[a][r]:Lr.mainChart.typedef[r],Xt(e,r,u(c(n),t),a),X(null==e?0:e)}})}(a,n,e)}else this.innerHTML=""}function n(t){if(t.preventDefault(),"LI"==t.target.nodeName){var r=parseInt(t.target.className.slice(-1));return Xt(a,this.id,r,e),this.innerHTML="",void X(null==a?0:a)}""==this.innerHTML?(b.qsarem(".styleSelect ul"),b.qsarem(".widthSelect ul"),this.innerHTML=$t("w")):this.innerHTML=""}function o(t){if(t.preventDefault(),"LI"==t.target.nodeName){var r=parseInt(t.target.className.slice(-1));return Xt(a,this.id,r,e),this.innerHTML="",void X(null==a?0:a)}""==this.innerHTML?(b.qsarem(".styleSelect ul"),b.qsarem(".widthSelect ul"),this.innerHTML=$t("s")):this.innerHTML=""}[].forEach.call(b.qsa(".opSelect"),(function(e){Vr.clickHandler.forEach((function(t){e.addEventListener(t,r)}))})),[].forEach.call(b.qsa(".widthSelect"),(function(e){Vr.clickHandler.forEach((function(t){e.addEventListener(t,n)}))})),[].forEach.call(b.qsa(".styleSelect"),(function(e){Vr.clickHandler.forEach((function(t){e.addEventListener(t,o)}))})),[].forEach.call(b.qsa(".eod_cbv"),(function(t){t.addEventListener("change",(function(){var t=this.id,r=this.checked;null==a?(null==e?r?delete Lr.mainChart.typedef[t]:Lr.mainChart.typedef[t]=!0:r?delete Lr.mainChart.indicators[e][t]:Lr.mainChart.indicators[e][t]=!0,X(0)):(r?delete Rr[a].Indicator[t]:Rr[a].Indicator[t]=!0,X(a))}))}))}(a,0,n)}if(null!=n){if(null!=e(Rr[n].Indicator.type).sb){var L='<option value="1">'+lang.l_zone+'</option><option value="2">'+lang.l_traitfi+'</option><option value="3">'+lang.l_traitep+"</option>",I='<input id="cbSeuilH" checked="checked" type="checkbox" /><div class="eod_cname">'+lang.l_upperb+'</div><input id="valSeuilH" type="text" onkeypress="return isNumberLetterKey(event)" /><select id="stylSeuilH">'+L+"</select>",D='<input id="cbSeuilB" checked="checked" type="checkbox" /><div class="eod_cname">'+lang.l_lowerb+'</div><input id="valSeuilB" type="text" onkeypress="return isNumberLetterKey(event)" /><select id="stylSeuilB">'+L+"</select>",R=document.createElement("div");R.setAttribute("class","clearfix pad5"),R.innerHTML=I,(T=document.createElement("div")).setAttribute("class","clearfix pad5"),T.innerHTML=D,(C=b.qs(".params_content")).appendChild(R),C.appendChild(T),null==Rr[n].Indicator.sh?b.gi("valSeuilH").value=e(Rr[n].Indicator.type).sh:9999==Rr[n].Indicator.sh?(b.gi("cbSeuilH").checked=!1,b.gi("valSeuilH").disabled=!0,b.gi("stylSeuilH").disabled=!0):(b.gi("valSeuilH").value=Rr[n].Indicator.sh,null!=Rr[n].Indicator.shs&&(b.gi("stylSeuilH").value=Rr[n].Indicator.shs)),null==Rr[n].Indicator.sb?b.gi("valSeuilB").value=e(Rr[n].Indicator.type).sb:9999==Rr[n].Indicator.sb?(b.gi("cbSeuilB").checked=!1,b.gi("valSeuilB").disabled=!0,b.gi("stylSeuilB").disabled=!0):(b.gi("valSeuilB").value=Rr[n].Indicator.sb,null!=Rr[n].Indicator.sbs&&(b.gi("stylSeuilB").value=Rr[n].Indicator.sbs)),b.gi("cbSeuilH").addEventListener("change",(function(){var t,a=b.gi("valSeuilH"),r=b.gi("stylSeuilH");this.checked?(9999==(t=e(Rr[n].Indicator.type).sh)&&(t=90),Rr[n].Indicator.sh=t,a.disabled=!1,a.value=t,r.disabled=!1):(Rr[n].Indicator.sh=9999,a.disabled=!0,r.disabled=!0),X(n)})),b.gi("cbSeuilB").addEventListener("change",(function(){var t,a=b.gi("valSeuilB"),r=b.gi("stylSeuilB");this.checked?(9999==(t=e(Rr[n].Indicator.type).sb)&&(t=10),Rr[n].Indicator.sb=t,a.disabled=!1,a.value=t,r.disabled=!1):(Rr[n].Indicator.sb=9999,a.disabled=!0,r.disabled=!0),X(n)})),b.gi("stylSeuilH").addEventListener("change",(function(){Rr[n].Indicator.shs=this.value,X(n)})),b.gi("stylSeuilB").addEventListener("change",(function(){Rr[n].Indicator.sbs=this.value,X(n)})),b.gi("valSeuilH").addEventListener("keyup",(function(){Rr[n].Indicator.sh=parseInt(this.value.replace(",",".")),X(n)})),b.gi("valSeuilB").addEventListener("keyup",(function(){Rr[n].Indicator.sb=parseInt(this.value.replace(",",".")),X(n)}))}["macd","macdzl","wto","dmi","adx","macdh","sto","aroon","qstick","ewo","ppo","moonphase","awesome","vortex","kst","kvo","bop","tsi","smi","sto rsi","equity","forceindex"].indexOf(Rr[n].Indicator.type)<0&&((k=document.createElement("div")).setAttribute("class","clearfix pad5"),k.innerHTML='<input id="cbMM" type="checkbox" /><div class="eod_cname">'+lang.l_moymob+'</div><input id="colorMM" type="text" name="colorMM" value="#fe0000" /><input id="valMM" value="5" type="text" onkeypress="return isIntNumberKey(event)" />',b.qs(".params_content").appendChild(k),S=new ColorPicker({wrapperEl:"#colorMM",value:"#fe0000",onChange:function(e){Rr[n].Indicator.mmColor=e,X(n)}}),null!=Rr[n].Indicator.mm&&(b.gi("cbMM").checked=!0,b.gi("valMM").value=Rr[n].Indicator.mm,S.change(Rr[n].Indicator.mmColor)),b.gi("cbMM").addEventListener("change",(function(){var e,t=b.gi("valMM");if(this.checked){if(t.disabled=!1,e=parseInt(t.value),isNaN(e))return;Rr[n].Indicator.mm=e,Rr[n].Indicator.mmColor=b.gi("colorMM").value}else delete Rr[n].Indicator.mm,delete Rr[n].Indicator.mmColor,t.disabled=!0;X(n)})),b.gi("valMM").addEventListener("keyup",(function(){var e=parseInt(this.value);isNaN(e)||(Rr[n].Indicator.mm=e,X(n))})))}["line","line2","renko","kagi","line break","mm","mme","mmp","mmh","double EMA","triple EMA","trix","bollw","bollb","boll","lineard","linearc","linearo","roc","kst","coppock","zig zag","mmt","evmm","rsi","mom","pvi","nvi","macd","macdh","std","sto rsi","point figure","ulcer"].indexOf(l.type)>=0&&((P=document.createElement("div")).innerHTML=lang.l_datasource,b.qs(".params_content").appendChild(P),null!=l.source&&b.qs("#datasource option[value='"+l.source+"']").setAttribute("selected","selected"),b.gi("datasource").addEventListener("change",(function(){Xt(n,"source",this.value,a),X(null==n?0:n)}))),(null!=n||null!=a)&&((M=document.createElement("div")).setAttribute("class","mtb10"),M.innerHTML='<span class="lnkmsg suppressMainIndic">'+lang.l_suppindic+"</span>",b.qs(".params_content").appendChild(M)),b.qs(".params_zone").style.display="block",Wt(a,n)}}function Ot(e,t,a,r){b.qs(".params_zone #mperiod"+e).addEventListener("keyup",(function(){var n=this.value.trim().replace(",",".");if(n=parseFloat(n),!isNaN(n)&&0!=n){switch(e){case 1:"sar"!=a&&"zig zag"!=a&&"renko"!=a&&"kagi"!=a&&"point figure"!=a&&(n=parseInt(n));break;case 2:"boll"!=a&&"evmm"!=a&&"lineard"!=a&&(n=parseInt(n));break;default:n=parseInt(n)}Xt(r,"param"+e,n,t),null==r?X(0,!0):X(r)}}))}function $t(e){for(var t="<ul>",a=1;a<5;a++)t=t+'<li class="'+e+a+'"></li>';return t+"</ul>"}function Xt(e,t,a,r){null==e?null==r?Lr.mainChart.typedef[t]=a:Lr.mainChart.indicators[r][t]=a:Rr[e].Indicator[t]=a}function Ft(t,a,r,n,o){var i=e(o);b.gi("color"+t)&&new ColorPicker({wrapperEl:"#color"+t,value:n,onChange:function(e){var n=1==t?"color":"color"+t,o=d(i[n]);null==o&&(o=1),e=u(e,o),Xt(r,n,e,a),X(null==r?0:r)}})}function Qt(e,t,a){var r=b.gi("mperiod"+e);new Slider({wrapperEl:"#slider"+e,onSlide:function(n){Math.round(n)-n!=0&&(n=n.toFixed(2)),r.value=n,Xt(a,"param"+e,+n,t),null==a?X(0,!0):X(a)}})}function Ut(){null!=b.gi(et("uParams-"))&&(b.idrem(et("uParams-")),P())}function Wt(e,t){function a(e){e.preventDefault(),e.stopPropagation(),Ut()}function r(e){"uParams"==e.target.className&&Ut()}function n(a){var r,n,o,i;if(a.preventDefault(),null==t){if(r=Lr.mainChart.indicators[e].type,Lr.mainChart.indicators.splice(e,1),Rr[0].Bars.splice(parseInt(e)+1,1),"compare"==r){for(o=Lr.mainChart.indicators.length,i=0,n=0;n<o;n++)"compare"==Lr.mainChart.indicators[n].type&&i++;if(0==i)for(Lr.isCompare=!1,n=1;n<Rr.length;n++)"fr"==Rr[n].Indicator.type&&Ht(n)}Lr.newsConfig&&(Yr.fiEvt=[],b.clrem(["svginfofi"])),X(0)}else Ht(t);Ut()}Vr.clickHandler.forEach((function(e){var t=b.qs(".closeparams");t&&t.addEventListener(e,a)})),Vr.clickHandler.forEach((function(e){b.gi(et("uParams-")).addEventListener(e,r)})),Vr.clickHandler.forEach((function(e){var t=b.qs(".suppressMainIndic");t&&t.addEventListener(e,n)}))}function zt(e,t){var a,r,n,i,l=parseInt(t.parentNode.parentNode.id.slice(-1)),s=Rr[l];for("up"==e?(a=Rr[l-1].Y,Rr[l]=Rr[l-1],Rr[l-1]=s,Rr[l-1].Y=a,Rr[l].Y=a+Rr[l-1].Height):(a=Rr[l].Y,Rr[l]=Rr[l+1],Rr[l+1]=s,Rr[l].Y=a,Rr[l+1].Y=a+Rr[l].Height),n=Rr.length,r=0;r<n;r++)Rr[r].Bars=0==r?[]:{},delete Rr[r].canvas,delete Rr[r].ctx;i=o(Rr),Ze(!0),De(i),$(),P()}function jt(e,t){return e>=0&&e<=Lr.innerWidth&&t>=0&&t<Rr[0].HeightPx+Lr.paddingTop-7}function Jt(e,t,a,r){for(var n=document.createElement("div"),o=a.length,i=0;i<o;i++)n.setAttribute(a[i].n,a[i].v);r&&(n.id=r),n.setAttribute("class","resizehandler"),n.style.left=e+"px",n.style.top=t+"px",Vr.doc.appendChild(n)}function Kt(e){var t,a,r,n,o,i,l,s,c,d,u,h,p,m,f,g,v,y,b,x,T,C;if(Lt(),y=Lr,w(),b=Ar[e],(x=document.createElement("div")).setAttribute("cid",Vr.callID),x.setAttribute("onmousedown","mydragg.startMoving(this,'trace-"+Vr.callID+"',event);"),x.setAttribute("onmouseup","mydragg.stopMoving('trace-"+Vr.callID+"');"),x.setAttribute("class","linemodif"),x.setAttribute("name",e),x.style.left=y.paddingLeft+4+"px",x.style.top=y.paddingTop+4+"px",T='<div class="spg delLine" title="'+lang.l_supprimer+'"></div><input id="color1" type="text" name="color1" value="#000000" />',["t","rf","r","m","fa","ef","c","arrdw","arrup","arrrt","arrlt","p","wf"].indexOf(b.type)>=0&&(T=T+'<span class="eod_sp10">&nbsp;</span><input id="color2" type="text" name="color2" value="'+(null!=b.color2?b.color2:"#ffffff")+'" />'),"a"!=b.type&&(T=T+'<div class="widthSelect w'+b.width+'"></div>',["rf","r","m","t","fa","arrup","arrdw","arrrt","arrlt","sm1","sm2","ewi","ewc","wf"].indexOf(b.type)<0&&(T=T+'<div class="styleSelect s'+b.style+'"></div>')),"sr"==b.type&&(VGP.isSms&&(T=T+'<div class="spg eod_alert" title="'+lang.l_createalert+'"></div>'),T=T+'<input class="textSR" onkeypress="return isNumberKey(event)" id="srTxt" type="text" value="'+b.y0.toFixed(2)+'" /><input class="btnSR" id="srBtn" type="button" value="ok" />'),"a"==b.type&&(T=T+'<div class="fontSelect">'+b.style+'</div><input id="annotationTxt" type="text"/><input id="annotationBtn" class="btnSR" type="button" value="ok" />'),["fa","cf","mv","ewi","ewc","wf"].indexOf(b.type)<0&&(T=T+'<div class="spg eod_copy" title="'+lang.l_dupliquer+'"></div>'),x.innerHTML=T,Vr.doc.appendChild(x),"fa"==b.type)return g=y.paddingTop-9,v=y.paddingLeft-9,t=b.RealX0+v,a=b.RealY0+g,r=b.h.B.mx+v,n=b.h.B.my+g,i=b.h.C.mx+v,o=b.h.C.my+g,jt(t,a)&&Jt(t,a,[{n:"name",v:e},{n:"pt",v:"A"}],"handlerfaA"),jt(r,n)&&Jt(r,n,[{n:"name",v:e},{n:"pt",v:"B"}],"handlerfaB"),jt(i,o)&&Jt(i,o,[{n:"name",v:e},{n:"pt",v:"C"}],"handlerfaC"),void ra();if("ewi"!=b.type&&"ewc"!=b.type)if("t"!=b.type&&"wf"!=b.type){if("ef"==b.type&&Jt(b.RealX1+b.h+y.paddingLeft-6,b.RealY1+y.paddingTop-8,[{n:"name",v:e}],"handlerEF"),"v"==b.type)return Jt(b.RealX0+y.paddingLeft-10,Math.round(Rr[0].HeightPx/2),[{n:"name",v:e}],"handlerV"),void ra();if("sr"==b.type)return Jt(b.RealX0+y.paddingLeft-15,b.RealY0+y.paddingTop-9,[{n:"name",v:e}],"handlerSR"),void ra();if("c"==b.type)return p=b.RealX0+y.paddingLeft-6,m=b.RealY0+y.paddingTop-10,f=b.RealX1+y.paddingLeft-9,jt(p,m)&&Jt(p,m,[{n:"name",v:e}],"handler2oblic"),jt(f,m)&&Jt(f,m,[{n:"name",v:e}],"handlerEllipse"),void ra();0==b.x0&&0==b.x1?Jt(Math.round(y.innerWidth/2),b.RealY0+y.paddingTop-9,[{n:"name",v:e}],"handlerH"):(g=y.paddingTop-9,v=y.paddingLeft-9,l=b.RealX0+v,d=b.RealY0+g,s=b.RealX1+v,u=b.RealY1+g,["a","arrup","arrdw","arrrt","arrlt","sm1","sm2"].indexOf(b.type)<0&&("an"!=b.type&&jt(l,d)&&Jt(l,d,[{n:"name",v:e}],"handler0oblic"),jt(s,u)&&Jt(s,u,[{n:"name",v:e}],"handler1oblic")),"p"==b.type?jt(c=Math.round(b.RealX0+(b.RealX1-b.RealX0)/2)+v,h=Math.round(b.RealY1+(b.RealY0-b.RealY1)/2)+g+Math.round(b.h*Rr[0].PxPointY))&&Jt(c,h,[{n:"name",v:e}],"handlerPara"):jt(c=Math.round(b.RealX0+(b.RealX1-b.RealX0)/2)+v,h=Math.round(b.RealY1+(b.RealY0-b.RealY1)/2)+g)&&Jt(c,h,[{n:"name",v:e}],"handler2oblic")),ra()}else{if(g=y.paddingTop-8,v=y.paddingLeft-8,t=b.RealX0+v,a=b.RealY0+g,r=b.RealX1+v,n=b.RealY1+g,i=b.h.C.mx+v,o=b.h.C.my+g,"wf"==b.type)jt(t,a)&&Jt(t,a,[{n:"name",v:e}],"handler2oblic"),jt(r,n)&&Jt(r,n,[{n:"name",v:e},{n:"pt",v:"B"}],"handlerWFB"),jt(i,o)&&Jt(i,o,[{n:"name",v:e},{n:"pt",v:"C"}],"handlerWFC");else{jt(t,a)&&Jt(t,a,[{n:"name",v:e},{n:"pt",v:"A"}],"handlerTA"),jt(r,n)&&Jt(r,n,[{n:"name",v:e},{n:"pt",v:"B"}],"handlerTB"),jt(i,o)&&Jt(i,o,[{n:"name",v:e},{n:"pt",v:"C"}],"handlerTC");var k=Math.max(t,r,i),S=Math.min(t,r,i),P=Math.max(a,n,o),M=Math.min(a,n,o);jt(c=S+(k-S)/2,h=M+(P-M)/2)&&Jt(c,h,[{n:"name",v:e}],"handler2oblic")}ra()}else{for(C=0;C<b.h.length;C++)jt(t=b.h[C].mx+y.paddingLeft-8,a=b.h[C].my+y.paddingTop-8)&&Jt(t,a,[{n:"name",v:e},{n:"pt",v:C}],"handlerEW"+C);ra()}}function Zt(e){"srTxt"!=e.target.id&&"annotationTxt"!=e.target.id&&(46==e.keyCode||8==e.keyCode)&&(e.preventDefault(),ta())}function ea(e){if("srTxt"!=e.target.id&&"annotationTxt"!=e.target.id)switch(e.keyCode){case 38:e.preventDefault(),aa(0,-1);break;case 40:e.preventDefault(),aa(0,1);break;case 37:e.preventDefault(),aa(-(Math.floor(Rr[0].PxPointX)+1),0);break;case 39:e.preventDefault(),aa(1,0);break;case 46:case 8:e.preventDefault(),ta()}}function ta(){var e=b.qsga(".linemodif","name");Ar.splice(e,1),F(),Me(Lr.symbol,Ar),Yr.flagSave=!0,Lt()}function aa(e,t){var a,r=b.qsga(".linemodif","name"),n=o(Ar[r]);(0!=t||"h"!=n.type)&&(0!=e||"v"!=n.type)&&(a=yr(),Ar.splice(r,1),F(),gr(n,ur(a.ctx,n,e,t)))}function ra(){function e(e,t){1==t?Ar[y].color=e:Ar[y].color2=e,F(),Me(Lr.symbol,Ar)}function t(e){var t,a;e.preventDefault(),0==(t=parseFloat(b.gi("srTxt").value.replace(",",".")))||isNaN(t)||(Ar[y].y0=t,Ar[y].y1=t,a=Lr.set.semilog&&null!=Lr.logData?Xe(t,Lr.logData):Rr[0].V0*Rr[0].PxPointY-t*Rr[0].PxPointY,Ar[y].RealY0=a,Ar[y].RealY1=a,b.gi("handlerSR").style.top=a+Lr.paddingTop-6+"px",F(),Me(Lr.symbol,Ar))}function r(e){e.preventDefault();var t=Dr.Name+";"+Lr.symbol+";"+Ar[y].y0.toFixed(3);sessionStorage.setItem("vartemp",t),Yr.flagSave=!0,Lt(),loadPopupHelp("graph_setalert6.aspx")}function n(e){var t,a;e.preventDefault(),t=o(Ar[y]),"v"==Ar[y].type?(a=new oa(t.RealX0+20,0),t.x0=a.x,t.x1=a.x):(t.y0=t.y0+20/Rr[0].PxPointY,t.y1=t.y1+20/Rr[0].PxPointY),Ar.push(t),Lt(),F(),Me(Lr.symbol,Ar),Kt(Ar.length-1)}function i(e){return e.preventDefault(),l(),!1}function l(){var e=b.gi("annotationTxt").value.trim();if(""==e)return!1;e=e.replace(/,/g,"."),Ar[y].h=a(e),F(),Me(Lr.symbol,Ar),Lt()}function c(e){if(e.preventDefault(),"LI"==e.target.nodeName){var t=parseInt(e.target.className.slice(-1));return Ar[y].width=t,F(),Me(Lr.symbol,Ar),this.setAttribute("class","widthSelect w"+t),void(this.innerHTML="")}""==this.innerHTML?(b.qsarem(".styleSelect ul"),b.qsarem(".widthSelect ul"),this.innerHTML=$t("w")):this.innerHTML=""}function d(e){if(e.preventDefault(),"LI"==e.target.nodeName){var t=parseInt(e.target.className.slice(-1));return Ar[y].style=t,F(),Me(Lr.symbol,Ar),this.setAttribute("class","styleSelect s"+t),void(this.innerHTML="")}""==this.innerHTML?(b.qsarem(".styleSelect ul"),b.qsarem(".widthSelect ul"),this.innerHTML=$t("s")):this.innerHTML=""}function u(e){var t,a,r,n,o;if(e.preventDefault(),t=this.innerHTML,"LI"==e.target.nodeName)return a=parseInt(e.target.getAttribute("data-name")),Ar[y].style=a,F(),Me(Lr.symbol,Ar),void(this.innerHTML=a);if(this.innerHTML.length>2)this.innerHTML=t;else{for(b.qsarem(".styleSelect ul"),b.qsarem(".fontSelect ul"),r=[0,12,16,20,24,28,32,48],n="<ul>",o=1;o<8;o++)n=n+'<li data-name="'+r[o]+'">'+r[o]+"</li>";n+="</ul>",this.innerHTML=n}}function h(e){e.preventDefault(),ta()}function p(e){var t=e.target.id,a=o(Ar[y]);switch(t){case"handlerfaA":case"handlerfaB":case"handlerfaC":sa(a,e.target.getAttribute("pt"));break;case"handlerEW0":case"handlerEW1":case"handlerEW2":case"handlerEW3":case"handlerEW4":case"handlerEW5":ma(a,e.target.getAttribute("pt"));break;case"handlerTA":case"handlerTB":case"handlerTC":case"handlerWFB":case"handlerWFC":ua(a,e.target.getAttribute("pt"));break;case"handlerEF":$a(a);break;case"handlerV":case"handlerSR":case"handlerH":Ia(a);break;case"handlerEllipse":rr(a);break;case"handlerPara":za(a);break;case"handler0oblic":case"handler1oblic":var r=Ar[y].RealX1,n=Ar[y].RealY1,i=Ar[y].x1;"handler1oblic"==t&&(r=Ar[y].RealX0,n=Ar[y].RealY0,i=Ar[y].x0),"p"==Ar[y].type?Ka(Ar[y].color,r,n,i,Ar[y].width,Ar[y].style,Ar[y].h,Ar[y].color2):"rf"==Ar[y].type||"r"==Ar[y].type||"m"==Ar[y].type?qa(Ar[y],Ar[y].type,e.target.id):Qa(a,r,n,i);break;case"handler2oblic":var l=s(e),c=yr(),d=parseInt(l.y-c.offset.top);Aa(a,parseInt(l.x-c.offset.left),d)}b.clhide("resizehandler"),Ar.splice(y,1)}var m,f,g,v,y=b.qsga(".linemodif","name");for(new ColorPicker({wrapperEl:"#color1",value:Ar[y].color,onChange:function(t){e(t,1)}}),null!=b.gi("color2")&&(m=new ColorPicker({wrapperEl:"#color2",onChange:function(t){e(t,2)}}),null!=Ar[y].color2&&m.change(Ar[y].color2)),Gt(),(f=b.gi(et("overlay-"))).getContext("2d").clearRect(0,0,f.width,f.height),"sr"==Ar[y].type&&Vr.clickHandler.forEach((function(e){b.gi("srBtn").addEventListener(e,t)})),Vr.clickHandler.forEach((function(e){var t=b.qs(".eod_alert");t&&t.addEventListener(e,r)})),Vr.clickHandler.forEach((function(e){var t=b.qs(".eod_copy");t&&t.addEventListener(e,n)})),"a"==Ar[y].type&&(b.gi("annotationTxt").value=unescape(Ar[y].h),Vr.clickHandler.forEach((function(e){b.gi("annotationBtn").addEventListener(e,i)})),b.gi("annotationTxt").addEventListener("keyup",(function(e){if(13==e.keyCode)return l(),!1;Ar[y].h=a(this.value),F()}))),[].forEach.call(b.qsa(".widthSelect"),(function(e){Vr.clickHandler.forEach((function(t){e.addEventListener(t,c)}))})),[].forEach.call(b.qsa(".styleSelect"),(function(e){Vr.clickHandler.forEach((function(t){e.addEventListener(t,d)}))})),[].forEach.call(b.qsa(".fontSelect"),(function(e){Vr.clickHandler.forEach((function(t){e.addEventListener(t,u)}))})),[].forEach.call(b.qsa(".delLine"),(function(e){Vr.clickHandler.forEach((function(t){e.addEventListener(t,h)}))})),v=b.qsa(".resizehandler"),g=0;g<v.length;g++)["touchstart","mousedown"].forEach((function(e){v[g].addEventListener(e,p)}));null!=b.gi("handler2oblic")||"sr"==Ar[y].type||"v"==Ar[y].type||"h"==Ar[y].type?document.addEventListener("keydown",ea):document.addEventListener("keydown",Zt),b.gi(et("trace-")).addEventListener("touchend",na),b.gi(et("trace-")).addEventListener("mousedown",na)}function na(e){Yr.flagSave=!0,e.preventDefault(),Lt()}function oa(e,t){var a,r;for(this.mx=e,this.my=t,this.y=Lr.set.semilog&&null!=Lr.logData?Math.round(1e4*Fe(t,Lr.logData))/1e4:Math.round(1e4*(Rr[0].V0*Rr[0].PxPointY-t)/Rr[0].PxPointY)/1e4,r=Br.length,a=e;a<r;a++)if(e<=a&&null!=Br[a]){this.x=Br[a].d,this.mx=a;break}if(e>r-1){var n=r-1,o=e-n,i=Math.round(o/Rr[0].PxPointX),l=Math.round(i*Rr[0].PxPointX)+n;if(Dr.Xperiod<0)i=-i*Dr.Xperiod;else switch(Dr.Xperiod){case 7:i*=7;break;case 30:i*=30;break;case 91:i*=91;break;case 365:i*=365;break;default:i*=1.4}this.mx=l,this.x=Br[r-1].d+Math.round(i)}}function ia(e,t){Yr.evtList.push({ev:e,f:t})}function la(){for(var e=Yr.evtList.length,t=0;t<e;t++)Vr.doc.removeEventListener(Yr.evtList[t].ev,Yr.evtList[t].f);Yr.evtList=[]}function sa(e,t){w("c"),Nr={c:yr(),A:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},B:e.h.B,C:e.h.C,D:null,line:e,pt:t},["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,ca)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,da)})),ia("mouseup",ca),ia("mousemove",da),ia("touchend",ca),ia("touchmove",da)}function ca(e){e.preventDefault(),Ar.push(new Bt(Nr.A.x,Nr.A.y,Nr.D.x,Nr.D.y,Nr.line.color,Nr.A.mx,Nr.D.mx,Nr.line.width,null,"fa",{B:Nr.B,C:Nr.C},Nr.line.color2)),Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}function da(e){var t;e.preventDefault();var a,r=s(e),n=parseInt(r.x-Nr.c.offset.left),o=parseInt(r.y-Nr.c.offset.top),i=Nr.line;if(!(o<0||o>Rr[0].HeightPx)){switch(t=new oa(n,o),F(),Nr.pt){case"A":a=oe(Nr.c.ctx,t,Nr.B,Nr.C,i.color,i.color2,i.width),Nr.A=t;break;case"B":a=oe(Nr.c.ctx,Nr.A,t,Nr.C,i.color,i.color2,i.width),Nr.B=t;break;case"C":a=oe(Nr.c.ctx,Nr.A,Nr.B,t,i.color,i.color2,i.width),Nr.C=t}Nr.D=new oa(a.Dx,a.Dy)}}function ua(e,t){w("c"),"t"==e.type||"wf"==e.type&&"B"==t?Nr={line:e,pt:t,c:yr(),A:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},B:{mx:e.RealX1,my:e.RealY1,x:e.x1,y:e.y1},C:e.h.C}:"wf"==e.type&&"C"==t&&(Nr={line:e,pt:t,c:yr(),A:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},C:{mx:e.RealX1,my:e.RealY1,x:e.x1,y:e.y1},B:e.h.C}),["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,ha)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,pa)})),ia("mouseup",ha),ia("mousemove",pa),ia("touchend",ha),ia("touchmove",pa)}function ha(e){e.preventDefault(),Ar.push(new Bt(Nr.A.x,Nr.A.y,Nr.B.x,Nr.B.y,Nr.line.color,Nr.A.mx,Nr.B.mx,Nr.line.width,null,Nr.line.type,{C:Nr.C},Nr.line.color2)),Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}function pa(e){var t,a;e.preventDefault();var r=s(e),n=parseInt(r.x-Nr.c.offset.left),o=parseInt(r.y-Nr.c.offset.top);if(!(o<0||o>Rr[0].HeightPx)){if(t=new oa(n,o),F(),"wf"==Nr.line.type)Nr.B=t;else switch(Nr.pt){case"A":Nr.A=t;break;case"B":Nr.B=t;break;case"C":Nr.C=t}"t"==Nr.line.type?ce(Nr.c.ctx,Nr.A,Nr.B,Nr.C,Nr.line.color,Nr.line.color2,Nr.line.width):"wf"==Nr.line.type&&(a=Ta(Nr.c.ctx,Nr.A,Nr.B,Nr.C,Nr.line.color,Nr.line.color2,Nr.line.width),Nr.C=new oa(a.mx,a.my))}}function ma(e,t){w("c"),Nr={line:e,pt:t,c:yr()},["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,fa)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,ga)})),ia("mouseup",fa),ia("mousemove",ga),ia("touchend",fa),ia("touchmove",ga)}function fa(e){e.preventDefault();var t=Nr.line;Ar.push(new Bt(null,null,null,null,t.color,null,null,t.width,null,t.type,t.h)),Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}function ga(e){var t;e.preventDefault();var a=s(e),r=parseInt(a.x-Nr.c.offset.left),n=parseInt(a.y-Nr.c.offset.top);n<0||n>Rr[0].HeightPx||(t=new oa(r,n),F(),Nr.pt=parseInt(Nr.pt),Nr.line.h[Nr.pt]=t,se(Nr.c.ctx,Nr.line.h,Nr.line.color,Nr.line.width))}function va(e){e.preventDefault(),mr(Nr.type,Nr.color,Nr.pt)}function ya(e){e.preventDefault(),Nr.pt=dr(Nr.type,e,Nr.c.offset,Nr.c.ctx,Nr.color)}function ba(e,t){w("c"),Nr={c:yr(),tabPoints:[],color:La(),nbPoints:t,type:e},["touchstart","click"].forEach((function(e){Vr.doc.addEventListener(e,xa)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,wa)})),ia("click",xa),ia("mousemove",wa),ia("touchstart",xa),ia("touchmove",wa)}function xa(e){var t;e.preventDefault();var a=s(e),r=parseInt(a.x-Nr.c.offset.left),n=parseInt(a.y-Nr.c.offset.top);if(!(n<0||n>Rr[0].HeightPx)){if(Nr.tabPoints.length<Nr.nbPoints-1)return void Nr.tabPoints.push(new oa(r,n));switch(Nr.tabPoints.push(new oa(r,n)),F(),Nr.type){case"t":ce(Nr.c.ctx,Nr.tabPoints[0],Nr.tabPoints[1],Nr.tabPoints[2],Nr.color),Ar.push(new Bt(Nr.tabPoints[0].x,Nr.tabPoints[0].y,Nr.tabPoints[1].x,Nr.tabPoints[1].y,Nr.color,Nr.tabPoints[0].mx,Nr.tabPoints[1].mx,null,null,Nr.type,{C:Nr.tabPoints[2]}));break;case"ewi":case"ewc":se(Nr.c.ctx,Nr.tabPoints,Nr.color),Ar.push(new Bt(null,null,null,null,Nr.color,null,null,null,null,Nr.type,Nr.tabPoints));break;case"wf":t=Ta(Nr.c.ctx,Nr.tabPoints[0],Nr.tabPoints[1],Nr.tabPoints[2],Nr.color,null,1),Nr.tabPoints[2]=new oa(t.mx,t.my),Ar.push(new Bt(Nr.tabPoints[0].x,Nr.tabPoints[0].y,Nr.tabPoints[1].x,Nr.tabPoints[1].y,Nr.color,Nr.tabPoints[0].mx,Nr.tabPoints[1].mx,null,null,Nr.type,{C:Nr.tabPoints[2]}))}Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}}function wa(e){var t,a,r,n;if(e.preventDefault(),0!=(t=Nr.tabPoints).length){var o=Nr.c.ctx,i=s(e),l=parseInt(i.x-Nr.c.offset.left),c=parseInt(i.y-Nr.c.offset.top);if(!(c<0||c>Rr[0].HeightPx)){switch(F(),a=[],Nr.type){case"ewi":a=["1","2","3","4","5"];break;case"ewc":a=["a","b","c"]}if("wf"!=Nr.type){for(o.lineWidth=1,o.strokeStyle=Nr.color,o.beginPath(),o.moveTo(t[0].mx,t[0].my),n=1;n<t.length;n++)o.lineTo(t[n].mx,t[n].my),"t"!=Nr.type&&(r=t[n].my<t[n-1].my?-7:16,o.fillText(a[n-1],t[n].mx-4,t[n].my+r));o.lineTo(l,c),o.stroke()}else null==t[1]?(o.beginPath(),o.moveTo(t[0].mx,t[0].my),o.lineTo(l,c),o.strokeStyle=Nr.color,o.stroke()):null==t[2]&&Ta(o,t[0],t[1],{mx:l,my:c},Nr.color,null,1);return}}}function Ta(e,t,a,r,n,o,i){var l,s;e.lineWidth=i,e.strokeStyle=n,e.beginPath(),e.moveTo(t.mx,t.my),e.lineTo(a.mx,a.my);var c=Math.atan2(t.my-a.my,a.mx-t.mx),d=Math.atan2(t.my-r.my,r.mx-t.mx),h=!1,p=!1,m=!1;Math.abs(c-d)>Math.PI&&(h=!0,p=!0),c<d&&(h=!0,m=!0),p&&m&&(h=!1),l=Math.sqrt(Math.pow(Math.abs(t.my-a.my),2)+Math.pow(Math.abs(t.mx-a.mx),2)),e.arc(t.mx,t.my,1.618*l,-c,-d,h),e.closePath(),null!=o&&(e.fillStyle=u(o,.15),e.fill()),e.stroke(),e.beginPath(),e.arc(t.mx,t.my,l,-c,-d,h),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,.786*l,-c,-d,h),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,.618*l,-c,-d,h),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,.5*l,-c,-d,h),e.moveTo(t.mx,t.my),e.arc(t.mx,t.my,.236*l,-c,-d,h),e.stroke(),s=(c+d)/2,e.fillStyle=n,e.font="12px Arial",e.save(),e.translate(t.mx,t.my);var f=Math.PI/2-s,g=-3;return f>93*Math.PI/180?(f=-s-Math.PI/2,g=11):l=-l,(p&&!m||p&&m)&&(l=-l),e.rotate(f),e.fillText("1.618",-12,1.618*l+g),e.fillText("1",-3,l+g),e.fillText("0.786",-12,.786*l+g),e.fillText("0.618",-12,.618*l+g),e.fillText("0.5",-7,.5*l+g),e.fillText("0.236",-12,.236*l+g),e.restore(),{mx:Math.round(t.mx+Math.cos(d)*Math.abs(l)),my:Math.round(t.my-Math.sin(d)*Math.abs(l))}}function Ca(e){e.preventDefault();var t=s(e),a=parseInt(t.x-Nr.c.offset.left),r=parseInt(t.y-Nr.c.offset.top);if(!(r<0||r>Rr[0].HeightPx)){if(null==Nr.A)return void(Nr.A=new oa(a,r));if(null==Nr.B)return void(Nr.B=new oa(a,r));null==Nr.C&&(Nr.C=new oa(a,r),Nr.D=new oa(Nr.D.Dx,Nr.D.Dy),Ar.push(new Bt(Nr.A.x,Nr.A.y,Nr.D.x,Nr.D.y,Nr.color,Nr.A.mx,Nr.D.mx,null,null,"fa",{B:Nr.B,C:Nr.C},Nr.color2)),Me(Lr.symbol,Ar),la(),Kt(Ar.length-1))}}function ka(e){if(e.preventDefault(),null!=Nr.A){var t=Nr.c.ctx,a=s(e),r=parseInt(a.x-Nr.c.offset.left),n=parseInt(a.y-Nr.c.offset.top);if(!(n<0||n>Rr[0].HeightPx)){if(null==Nr.B)return F(),t.lineWidth=1,t.strokeStyle=La(),t.beginPath(),t.moveTo(Nr.A.mx,Nr.A.my),t.lineTo(r,n),void t.stroke();null==Nr.C&&(F(),Nr.D=oe(t,Nr.A,Nr.B,{mx:r,my:n},Nr.color,Nr.color2))}}}function Sa(e){var t=s(e),a=parseInt(t.x-Nr.c.offset.left+Lr.paddingLeft),r=parseInt(t.y-Nr.c.offset.top+Lr.paddingTop);Nr.idLine=B(a,r,Ie(a,r))}function Pa(e){e.preventDefault(),999!=Nr.idLine?(Ar.splice(Nr.idLine,1),F(),Me(Lr.symbol,Ar),0==Ar.length&&Ma()):Ma()}function Ma(){la(),P()}function _a(e){var t,a;if(e.preventDefault(),null==b.qs(".linemodif")){var r=Nr.c.ctx,n=Nr.t,o=s(e),i=parseInt(o.x-Nr.c.offset.left),l=parseInt(o.y-Nr.c.offset.top);if(!(l<0||l>Rr[0].HeightPx)){switch(t=new oa(i,l),n){case"arrup":le(r,t,a="#008000",n,a,1);break;case"arrdw":le(r,t,a="#c00000",n,a,1);break;case"arrrt":case"arrlt":le(r,t,a="#3366ff",n,a,1);break;case"sm1":ie(r,t,a="#008000",n,1);break;case"sm2":ie(r,t,a="#c00000",n,1)}Ar.push(new Bt(t.x,t.y,t.x,t.y,a,t.mx,t.mx,1,null,n,null,a)),Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}}}function Ea(e){function t(e){e.preventDefault(),Va(Nr.c.ctx,o,i,Nr.color)}var a,r;if(e.preventDefault(),null==b.qs(".linemodif")){var n=s(e),o=parseInt(n.x-Nr.c.offset.left),i=parseInt(n.y-Nr.c.offset.top);i<0||i>Rr[0].HeightPx||(a=Ar.length,(r=document.createElement("div")).setAttribute("cid",Vr.callID),r.setAttribute("onmousedown","mydragg.startMoving(this,'trace-"+Vr.callID+"',event);"),r.setAttribute("onmouseup","mydragg.stopMoving('trace-"+Vr.callID+"');"),r.setAttribute("class","linemodif"),r.setAttribute("name",a),r.style.left=Lr.paddingLeft+4+"px",r.style.top=Lr.paddingTop+4+"px",r.innerHTML='<input id="annotationTxt" type="text"/><input id="annotationBtn" class="btnSR" type="button" value="ok" />',Vr.doc.appendChild(r),b.gi("annotationTxt").focus(),Gt(),b.gi("annotationTxt").addEventListener("keyup",(function(e){e.preventDefault(),13==(e.which?e.which:e.keyCode)?(F(),Va(Nr.c.ctx,o,i,Nr.color)):(F(),be(Nr.c.ctx,new oa(o,i),"12",Nr.color,this.value))})),Vr.clickHandler.forEach((function(e){b.gi("annotationBtn").addEventListener(e,t)})))}}function Va(e,t,r,n){var o,i,l;if(null!=t||null!=r){if(""==(o=(o=b.gi("annotationTxt").value.trim()).replace(/,/g,".")))return b.clrem(["linemodif"]),P(),!1;l=be(e,i=new oa(t,r),"12",n,o),Ar.push(new Bt(i.x,i.y,i.x,i.y,n,i.mx,l,null,"12","a",a(o))),Me(Lr.symbol,Ar),b.clrem(["linemodif"]),Kt(Ar.length-1)}}function La(){return null==Lr.set.traceColor?St(Lr.set.bkcolor):Lr.set.traceColor}function Ia(e){Nr={c:yr(),pt:null,line:e},["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,Da)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,Ra)})),ia("touchend",Da),ia("mouseup",Da),ia("mousemove",Ra),ia("touchmove",Ra)}function Da(e){e.preventDefault();var t=Nr.line;null==Nr.pt&&(Nr.pt=dr(t.type,e,Nr.c.offset,Nr.c.ctx,t.color,t.style,t.width)),mr(t.type,t.color,Nr.pt,t.style,t.width)}function Ra(e){e.preventDefault();var t=Nr.line;Nr.pt=dr(t.type,e,Nr.c.offset,Nr.c.ctx,t.color,t.style,t.width)}function Aa(e,t,a){Nr={c:yr(),pt:null,line:e,x0:t,y0:a},["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,Ba)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,Ha)})),ia("touchend",Ba),ia("mouseup",Ba),ia("mousemove",Ha),ia("touchmove",Ha)}function Ha(e){e.preventDefault(),F();var t=s(e),a=parseInt(t.x-Nr.c.offset.left)-Nr.x0,r=parseInt(t.y-Nr.c.offset.top)-Nr.y0;Nr.pt=ur(Nr.c.ctx,Nr.line,a,r)}function Ba(e){e.preventDefault(),null!=Nr.pt&&gr(Nr.line,Nr.pt)}function qa(e,t,a){var r="handler0oblic"==a?{x:e.x1,y:e.y1,mx:e.RealX1,my:e.RealY1}:{x:e.x0,y:e.y0,mx:e.RealX0,my:e.RealY0};Nr={c:yr(),line:e,type:t,ptb:r,target:a},["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,Ga)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,Na)})),ia("touchend",Ga),ia("mouseup",Ga),ia("mousemove",Na),ia("touchmove",Na)}function Ga(e){e.preventDefault(),null!=Nr.pte&&vr(Nr.line.color,Nr.line.color2,Nr.type,Nr.pte,Nr.target,Nr.ptb,Nr.line.width)}function Na(e){e.preventDefault(),Nr.pte=pr(e,Nr.c.offset,Nr.c.ctx,Nr.line.color,Nr.line.color2,Nr.type,Nr.target,Nr.ptb,Nr.line.width)}function Ya(e){e.preventDefault(),null==Nr.ptb&&(Nr.ptb=cr(e,Nr.c.offset)),null!=Nr.pte&&vr(Nr.color,null,Nr.type,Nr.pte,null,Nr.ptb)}function Oa(e){e.preventDefault(),null!=Nr.ptb&&(Nr.pte=pr(e,Nr.c.offset,Nr.c.ctx,Nr.color,null,Nr.type,null,Nr.ptb))}function $a(e){w("c"),Nr={c:yr(),line:e,ptb:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},pte:{mx:e.RealX1,my:e.RealY1,x:e.x1,y:e.y1},x1:Math.max(e.RealX1,e.RealX0)},["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,Xa)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,Fa)})),ia("touchend",Xa),ia("mouseup",Xa),ia("mousemove",Fa),ia("touchmove",Fa)}function Xa(e){e.preventDefault();var t=Nr.line;fr(t.color,Nr.pte,t.width,t.style,t.type,t.color2,Nr.move,Nr.ptb)}function Fa(e){var t,a,r;e.preventDefault(),t=s(e),a=parseInt(t.x-Nr.c.offset.left),Nr.move=a-Nr.x1,Nr.move<100||(F(),r=Nr.line,xe(Nr.c.ctx,r.type,r.color,r.style,r.width,Nr.move,Nr.ptb,Nr.pte,r.color2))}function Qa(e,t,a,r){var n;n=Lr.set.semilog&&null!=Lr.logData?Fe(a,Lr.logData):(Rr[0].V0*Rr[0].PxPointY-a)/Rr[0].PxPointY,Nr={ptb:{x:r,mx:t,my:a,y:n},pte:null,line:e,c:yr()},["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,Ua)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,Wa)})),ia("touchend",Ua),ia("mouseup",Ua),ia("mousemove",Wa),ia("touchmove",Wa)}function Ua(e){e.preventDefault();var t=Nr.line;null!=Nr.pte&&fr(t.color,Nr.pte,t.width,t.style,t.type,t.color2,t.h,Nr.ptb)}function Wa(e){e.preventDefault();var t=Nr.line;"f"==t.type&&t.x1<t.x0?t.h=-1:"f"==t.type&&t.x1>=t.x0&&(t.h=1),Nr.pte=hr(e,Nr.c.offset,Nr.c.ctx,t.color,t.width,t.style,t.h,t.type,t.color2,Nr.ptb)}function za(e){la(),Nr={c:yr(),line:e},["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,Ja)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,ja)})),ia("touchend",Ja),ia("mouseup",Ja),ia("mousemove",ja),ia("touchmove",ja)}function ja(e){e.preventDefault();var t=Nr.line,a=s(e),r=parseInt(a.y-Nr.c.offset.top+(t.RealY1-t.RealY0)/2);Nr.rh=t.RealY1-r,F(),xe(Nr.c.ctx,"p",t.color,t.style,t.width,-Nr.rh,{mx:t.RealX0,my:t.RealY0},{mx:t.RealX1,my:t.RealY1},t.color2)}function Ja(e){e.preventDefault();var t=Nr.line,a=Nr.rh/Rr[0].PxPointY,r=t.y0,n=t.y1;a>0&&(r+=a,n+=a),Ar.push(new Bt(t.x0,r,t.x1,n,t.color,t.RealX0,t.RealX1,t.width,t.style,"p",Math.abs(a),t.color2)),Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}function Ka(e,t,a,r,n,o,i,l){Nr={c:yr(),ptb:{mx:t,my:a,x:r},style:o,height:i*Rr[0].PxPointY,color2:l,width:n},["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,Za)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,er)})),ia("touchend",Za),ia("mouseup",Za),ia("mousemove",er),ia("touchmove",er)}function Za(e){var t,a,r,n;e.preventDefault(),t=Nr.pte,a=Nr.ptb,null!=t&&(r=Lr.set.semilog&&null!=Lr.logData?Fe(a.my,Lr.logData):(Rr[0].V0*Rr[0].PxPointY-a.my)/Rr[0].PxPointY,n=Nr.height/Rr[0].PxPointY,t.mx<a.mx?Ar.push(new Bt(t.x,t.y,a.x,r,Nr.color,t.mx,a.mx,Nr.width,Nr.style,"p",n,Nr.color2)):Ar.push(new Bt(a.x,r,t.x,t.y,Nr.color,a.mx,t.mx,Nr.width,Nr.style,"p",n,Nr.color2)),Me(Lr.symbol,Ar),la(),Kt(Ar.length-1))}function er(e){e.preventDefault(),Nr.pte=hr(e,Nr.c.offset,Nr.c.ctx,Nr.color,Nr.width,Nr.style,Nr.height,"p",Nr.color2,Nr.ptb)}function tr(e){if(e.preventDefault(),null!=Nr.ptb)if(null==Nr.pte||null!=Nr.rh){var t=Nr.ptb.y,a=Nr.rh/Rr[0].PxPointY;a>0&&(t+=a,Nr.pte.y=Nr.pte.y+a),a=Math.abs(a),Nr.pte.mx<Nr.ptb.mx?Ar.push(new Bt(Nr.pte.x,Nr.pte.y,Nr.ptb.x,t,Nr.color,Nr.pte.mx,Nr.ptb.mx,1,null,"p",a)):Ar.push(new Bt(Nr.ptb.x,t,Nr.pte.x,Nr.pte.y,Nr.color,Nr.ptb.mx,Nr.pte.mx,1,null,"p",a)),Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}else Nr.step1=!0;else Nr.ptb=cr(e,Nr.c.offset)}function ar(e){if(e.preventDefault(),null!=Nr.ptb){if(null!=Nr.ptb&&!Nr.step1)return void(Nr.pte=hr(e,Nr.c.offset,Nr.c.ctx,null,null,null,null,"p",null,Nr.ptb));var t=Nr.c.ctx,a=s(e),r=parseInt(a.y-Nr.c.offset.top);Nr.rh=Nr.pte.my-r,F(),t.strokeStyle=Nr.color,t.lineWidth=1,t.beginPath(),t.moveTo(Nr.ptb.mx,Nr.ptb.my),t.lineTo(Nr.pte.mx,Nr.pte.my),t.moveTo(Nr.ptb.mx,Nr.ptb.my-Nr.rh),t.lineTo(Nr.pte.mx,Nr.pte.my-Nr.rh),t.stroke()}}function rr(e){Nr={line:e,ptb:{mx:e.RealX0,my:e.RealY0,x:e.x0,y:e.y0},pte:null,c:yr()},["touchend","mouseup"].forEach((function(e){Vr.doc.addEventListener(e,or)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,nr)})),ia("touchend",or),ia("mouseup",or),ia("mousemove",nr),ia("touchmove",nr)}function nr(e){e.preventDefault(),F();var t=Nr.line,a=s(e),r=parseInt(a.y-Nr.c.offset.top),n=parseInt(a.x-Nr.c.offset.left);r=sr(r),Nr.pte=new oa(n,r),fe(Nr.c.ctx,t.color,t.style,t.width,Nr.ptb,Nr.pte,t.color2)}function or(e){e.preventDefault();var t=Nr.line;null!=Nr.pte&&(Ar.push(new Bt(Nr.ptb.x,Nr.ptb.y,Nr.pte.x,Nr.pte.y,t.color,Nr.ptb.mx,Nr.pte.mx,t.width,t.style,"c",null,t.color2)),Me(Lr.symbol,Ar),la(),Kt(Ar.length-1))}function ir(e){var t;e.preventDefault();var a=Nr.ptb,r=Nr.type,n=Nr.color,o=Nr.c.ctx;if(null!=a){F();var i=s(e),l=parseInt(i.y-Nr.c.offset.top),c=parseInt(i.x-Nr.c.offset.left);switch(l=sr(l),Nr.pte=new oa(c,l),"mv"==r&&(Nr.pte.mx=a.mx,Nr.pte.x=a.x),"mh"==r&&(Nr.pte.my=a.my,Nr.pte.y=a.y),r){case"an":t=Math.atan2(a.my-Nr.pte.my,Nr.pte.mx-a.mx),pe(o,n,null,null,a,Nr.pte,t);break;case"af":me(o,n,null,null,a,Nr.pte);break;case"c":fe(o,n,null,null,a,Nr.pte);break;case"gg":he(o,n,null,null,a,Nr.pte);break;case"ga":ue(o,n,null,null,a,Nr.pte);break;case"cf":ne(o,n,null,null,a,Nr.pte);break;case"ff":de(o,n,null,null,a,Nr.pte);break;case"o":case"f":case"ef":case"mv":case"mh":xe(o,r,n,null,null,null,a,Nr.pte)}}}function lr(e){var t,a=Nr.pte,r=Nr.ptb,n=Nr.type;if(null!=r){if(null==a)return la(),void P();switch(t=null,"ef"==n&&(t=250),"an"==n&&(t=Math.atan2(r.my-a.my,a.mx-r.mx)),n){case"o":case"f":case"ef":a.mx<r.mx?Ar.push(new Bt(a.x,a.y,r.x,r.y,Nr.color,a.mx,r.mx,null,null,n,"f"==n?-1:t)):Ar.push(new Bt(r.x,r.y,a.x,a.y,Nr.color,r.mx,a.mx,null,null,n,"f"==n?1:t));break;default:Ar.push(new Bt(r.x,r.y,a.x,a.y,Nr.color,r.mx,a.mx,null,null,n,t))}Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}else Nr.ptb=cr(e,Nr.c.offset)}function sr(e){return e<0&&(e=0),e>Rr[0].HeightPx&&(e=Rr[0].HeightPx),e}function cr(e,t){var a=s(e);return new oa(parseInt(a.x-t.left),parseInt(a.y-t.top))}function dr(e,t,a,r,n,o,i){var l;F();var c=s(t),d=parseInt(c.y-a.top),u=parseInt(c.x-a.left);switch(d<0&&(d=1),d>Rr[0].HeightPx&&(d=Rr[0].HeightPx-1),l=new oa(u,d),e){case"sr":ge(r,l,o,i,n);break;case"v":ve(r,l,o,i,n,!0);break;default:ye(r,l,o,i,n,!0)}return l}function ur(e,t,a,r){var n=new oa(t.RealX0+a,t.RealY0+r),o=new oa(t.RealX1+a,t.RealY1+r),i=null;switch(t.type){case"t":ce(e,n,o,i=new oa(t.h.C.mx+a,t.h.C.my+r),t.color,t.color2,t.width);break;case"wf":Ta(e,n,o,i=new oa(t.h.C.mx+a,t.h.C.my+r),t.color,t.color2,t.width);break;case"a":be(e,n,t.style,t.color,unescape(t.h));break;case"r":Ce(e,t.color,t.color2,n,o,t.type,null,t.width);break;case"m":Ce(e,t.color,t.color2,n,o,t.type,t.h,t.width);break;case"rf":ke(e,t.color,t.color2,n,o,t.width);break;case"c":fe(e,t.color,t.style,t.width,n,o,t.color2);break;case"an":pe(e,t.color,t.style,t.width,n,o,t.h);break;case"af":me(e,t.color,t.style,t.width,n,o);break;case"cf":ne(e,t.color,t.style,t.width,n,o);break;case"gg":he(e,t.color,t.style,t.width,n,o);break;case"ga":ue(e,t.color,t.style,t.width,n,o);break;case"ff":de(e,t.color,t.style,t.width,n,o);break;case"sr":ge(e,n,t.style,t.width,t.color);break;case"v":ve(e,n,t.style,t.width,t.color,!0);break;case"h":ye(e,n,t.style,t.width,t.color,!0);break;case"arrup":case"arrdw":case"arrrt":case"arrlt":le(e,n,t.color,t.type,t.color2,t.width);break;case"sm1":case"sm2":ie(e,n,t.color,t.type,t.width);break;default:xe(e,t.type,t.color,t.style,t.width,t.h,n,o,t.color2)}return{ptb:n,pte:o,C:i}}function hr(e,t,a,r,n,o,i,l,c,d){var u,h;F();var p=s(e),m=parseInt(p.x-t.left),f=parseInt(p.y-t.top);switch(u=new oa(m,f=sr(f)),"mv"==l&&(u.mx=d.mx,u.x=d.x),"mh"==l&&(u.my=d.my,u.y=d.y),l){case"an":h=Math.atan2(d.my-u.my,u.mx-d.mx),u.mx=pe(a,r,o,n,d,u,h);break;case"af":me(a,r,o,n,d,u);break;case"gg":he(a,r,o,n,d,u);break;case"ga":ue(a,r,o,n,d,u);break;case"ff":de(a,r,o,n,d,u);break;case"cf":ne(a,r,o,n,d,u);break;default:xe(a,l,r,o,n,i,d,u,c)}return u}function pr(e,t,a,r,n,o,i,l,c){var d;F();var u=s(e),h=parseInt(u.x-t.left),p=parseInt(u.y-t.top);return d=new oa(h,p=sr(p)),"rf"==o&&ke(a,r,n,l,d,c,"handler0oblic"==i),("r"==o||"m"==o)&&Ce(a,r,n,l,d,o,l.my>d.my?1:0,c),d}function mr(e,t,a,r,n){switch(e){case"sr":Ar.push(new Bt(a.x,a.y,0,a.y,t,a.mx,null,n,r,e));break;case"v":Ar.push(new Bt(a.x,0,a.x,2e4,t,a.mx,a.mx,n,r,e));break;default:Ar.push(new Bt(0,a.y,0,a.y,t,null,null,n,r,"h"))}Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}function fr(e,t,a,r,n,o,i,l){switch(null==e&&(e=La()),"ef"==n&&null==i&&(i=250),n){case"an":i=Math.atan2(l.my-t.my,t.mx-l.mx),Ar.push(new Bt(l.x,l.y,t.x,t.y,e,l.mx,t.mx,a,r,n,i));break;case"af":case"cf":Ar.push(new Bt(l.x,l.y,t.x,t.y,e,l.mx,t.mx,a,r,n));break;default:t.mx<l.mx?Ar.push(new Bt(t.x,t.y,l.x,l.y,e,t.mx,l.mx,a,r,n,"f"==n?-1:i,o)):Ar.push(new Bt(l.x,l.y,t.x,t.y,e,l.mx,t.mx,a,r,n,"f"==n?1:i,o))}Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}function gr(e,t){null==e.color&&(e.color=La());var a=t.ptb,r=t.pte,n=t.C,o=a.y,i=a.x,l=r.y,s=r.x;switch(e.type){case"t":case"wf":Ar.push(new Bt(i,o,s,l,e.color,a.mx,r.mx,e.width,null,e.type,{C:n},e.color2));break;case"a":Ar.push(new Bt(i,o,i,o,e.color,a.mx,r.mx,e.width,e.style,e.type,e.h));break;case"r":case"rf":Ar.push(new Bt(i,o,s,l,e.color,a.mx,r.mx,e.width,null,e.type,null,e.color2));break;case"ef":case"m":Ar.push(new Bt(i,o,s,l,e.color,a.mx,r.mx,e.width,e.style,e.type,e.h,e.color2));break;case"c":Ar.push(new Bt(i,o,s,l,e.color,a.mx,r.mx,e.width,e.style,e.type,null,e.color2));break;case"an":case"f":Ar.push(new Bt(i,o,s,l,e.color,a.mx,r.mx,e.width,e.style,e.type,e.h));break;case"mv":case"mh":case"af":case"gg":case"ga":case"ff":case"cf":Ar.push(new Bt(i,o,s,l,e.color,a.mx,r.mx,e.width,e.style,e.type));break;case"sr":Ar.push(new Bt(i,a.y,0,a.y,e.color,a.mx,null,e.width,e.style,e.type));break;case"v":Ar.push(new Bt(i,0,t.x,2e4,e.color,a.mx,a.mx,e.width,e.style,e.type));break;case"h":Ar.push(new Bt(0,a.y,0,a.y,e.color,null,null,e.width,e.style,"h"));break;case"arrup":case"arrdw":case"arrrt":case"arrlt":Ar.push(new Bt(i,a.y,i,a.y,e.color,a.mx,a.mx,e.width,null,e.type,null,e.color2));break;case"sm1":case"sm2":Ar.push(new Bt(i,a.y,i,a.y,e.color,a.mx,a.mx,e.width,null,e.type,null,null));break;default:Ar.push(new Bt(i,o,s,l,e.color,a.mx,r.mx,e.width,e.style))}Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}function vr(e,t,a,r,n,o,i){var l=o.y,s=r.y,c=Math.min(o.x,r.x),d=Math.max(o.x,r.x),u=Math.min(o.mx,r.mx),h=Math.max(o.mx,r.mx),p=0;switch(o.my>r.my&&(p=1),a){case"r":case"m":Ar.push(new Bt(c,Math.max(l,s),d,Math.min(l,s),e,u,h,i,null,a,"r"==a?null:p,t));break;case"rf":"handler0oblic"==n?Ar.push(new Bt(c,s,d,l,e,u,h,i,null,a,null,t)):Ar.push(new Bt(c,l,d,s,e,u,h,i,null,a,null,t))}Me(Lr.symbol,Ar),la(),Kt(Ar.length-1)}function yr(){var e=b.gi(et("trace-"));return{offset:l(e),ctx:e.getContext("2d")}}function br(e,t,a){var r="w"+a;null!=t[r]&&(e.lineWidth=t[r])}function xr(e,t,a){var r,n;if(e.setLineDash)switch(null!=a?null!=a[n="s"+t]&&(r=a[n]):r=t,r){case 2:e.setLineDash([2,2]);break;case 3:e.setLineDash([4]);break;case 4:e.setLineDash([7,2,2,2])}}function wr(e,t,a){var r=function(e,t,a){return e+a*(t-e)},n=e.RealX1-e.RealX0,o=e.RealY1-e.RealY0,i=((t-e.RealX0)*n+(a-e.RealY0)*o)/(n*n+o*o);return{x:r(e.RealX0,e.RealX1,i),y:r(e.RealY0,e.RealY1,i)}}function Tr(e,t,a){if(("arrrt"==a.type||"arrlt"==a.type)&&t>=a.RealY0-5&&t<=a.RealY0+5)switch(a.type){case"arrrt":if(e>=a.RealX0-16&&e<=a.RealX0)return!0;break;case"arrlt":if(e<=a.RealX0+16&&e>=a.RealX0)return!0}if(e>=a.RealX0-5&&e<=a.RealX0+5)switch(a.type){case"arrup":if(t>=a.RealY0&&t<=a.RealY0+16)return!0;break;case"arrdw":if(t<=a.RealY0&&t>=a.RealY0-16)return!0;break;case"sm1":case"sm2":if(t>=a.RealY0-10&&t<=a.RealY0+10)return!0}return!1}function Cr(e,t,a){var r=Math.abs(a.RealX1-a.RealX0),n=Math.abs(a.RealY0-a.RealY1),o=!1;return Math.pow(e-a.RealX0,2)/Math.pow(r+5,2)+Math.pow(t-a.RealY0,2)/Math.pow(n+5,2)<=1&&(o=!0),Math.pow(e-a.RealX0,2)/Math.pow(r-5,2)+Math.pow(t-a.RealY0,2)/Math.pow(n-5,2)<=1&&(o=!1),o}function kr(e,t,a){for(var r,n,o,i,l,s=a.h.length,c=1;c<s;c++)if(i=a.h[c-1],l=a.h[c],e>Math.min(i.mx,l.mx)&&e<Math.max(i.mx,l.mx)&&(n=e-(r=wr({RealX0:i.mx,RealY0:i.my,RealX1:l.mx,RealY1:l.my},e,t)).x,o=t-r.y,Math.abs(Math.sqrt(n*n+o*o))<4))return!0;return!1}function Sr(e,t,a){var r,n,o,i,l,s=[{RealX0:a.RealX0,RealY0:a.RealY0,RealX1:a.RealX1,RealY1:a.RealY1},{RealX0:a.RealX0,RealY0:a.RealY0,RealX1:a.h.C.mx,RealY1:a.h.C.my}];for("t"==a.type&&s.push({RealX0:a.RealX1,RealY0:a.RealY1,RealX1:a.h.C.mx,RealY1:a.h.C.my}),l=s.length,r=0;r<l;r++)if(e>Math.min(s[r].RealX0,s[r].RealX1)-3&&e<Math.max(s[r].RealX0,s[r].RealX1)+3&&(o=e-(n=wr(s[r],e,t)).x,i=t-n.y,Math.abs(Math.sqrt(o*o+i*i))<5))return!0;return!1}function Pr(e,t,a){for(var r,n,i,l,s,c,d,u,h,p=o(e.QuoteTab),m=(p=Ne(p)).length,f=0,g=999999,v=0;v<m;v++)null!=p[v]&&(p[v].h>f&&(f=p[v].h),p[v].l<g&&(g=p[v].l));for(r=(f-g)*t/100,(i=[])[0]={h:p[0].v,b:0},v=1;v<m;v++)null!=p[v]&&(n=Math.floor((p[v].c-g)/r),l=p[v].c>=p[v-1].c,null!=i[n]?l?i[n].h=i[n].h+p[v].v:i[n].b=i[n].b+p[v].v:i[n]=l?{h:p[v].v,b:0}:{h:0,b:p[v].v});for(s=0,c=i.length,v=0;v<c;v++)null!=i[v]&&i[v].h+i[v].b>s&&(s=i[v].h+i[v].b);(u=(d=Rr[0]).ctx).strokeStyle=Lr.set.gridColor,u.save();var y=Lr.paddingLeft,b=s/(Lr.innerWidth/2),x=Math.floor((f-g)*d.PxPointY/c);for(x=x<2?2:x-2,h=0,v=0;v<c;v++)null!=i[v]&&(a.v1||(u.fillStyle=a.color,h=i[v].h/b,u.fillRect(y,Math.round((d.V0-(g+v*r))*d.PxPointY),h,-x)),a.v2||(u.fillStyle=a.color2,u.fillRect(h+y,Math.round((d.V0-(g+v*r))*d.PxPointY),i[v].b/b,-x)));u.restore()}function Mr(e,t,a){var r,n,o,i,l,s,c={QuoteTab:e.QuoteTab},d=[],u=c.QuoteTab.length,h=v(c.QuoteTab[0],a),p=v(c.QuoteTab[0],a);if(u<3)return!1;for(v(c.QuoteTab[1],a)>=v(c.QuoteTab[0],a)?p+=t:h-=t,r=2;r<u;r++){if(i=v(s=c.QuoteTab[r],a)-p-t,l=v(s,a)-h+t,i>0){for(o=(i+t)/t>>0,n=0;n<o;n++)d.push({d:s.d,l:h+t*(n+1),h:p+t*(n+1),s:1,c:s.c});p+=t*o,h+=t*o}if(l<0){for(o=Math.abs((l-t)/t>>0),n=0;n<o;n++)d.push({d:s.d,l:h-t*(n+1),h:p-t*(n+1),s:0,c:s.c});p-=t*o,h-=t*o}}return 1==d.length&&(d=[]),{Name:e.Name,High:e.High,Low:e.Low,QuoteTab:d}}this.clickHandler=["click"],this.callID=x.callID,this.doc=b.gi(this.callID),("ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0)&&(this.clickHandler=["touchend","click"]),null==VGP.callType&&(VGP.callType="POST"),null==x.symbol&&(x.symbol="PX1p");var _r=window.getComputedStyle(this.doc),Er={widthGraph:parseInt(_r.width),heightGraph:parseInt(_r.height),paddingTop:17,paddingLeft:10,paddingBottom:20,paddingRight:45,histoLength:365,chartPeriod:0,padBarCandle:0,searchConfig:"",mainChart:{type:"line",indicators:[]},indicators:[],set:{bkcolor:"#fff",txtColor:"#606060",gridV:!0,gridH:!0,gridLine:!0,gridColor:"#e0e0e0",isEncadre:!0,yaxis:!1,nosticky:!1,reticColor:"#114257",semilog:!1,cadreColor:"#e0e0e0",traceColor:null,noVeilleIntra:!1,veilleStyle:!1,veilleColor:"#fe0000",fontSize:11,splitStyle:"band",splitColor:"rgba(153,153,153,1)"},cursor:"r"},Vr=this,Lr=t(Er,x),Ir=Lr.set.fontSize-11;Lr.paddingBottom+=Ir,Lr.paddingTop+=Ir,Lr.paddingRight+=4*Ir,Lr.paddingLeft+=4*Ir;var Dr,Rr=[],Ar=[],Hr={maxY:0,minY:0,maxX:null,minX:0},Br=[],qr={},Gr={},Nr={},Yr={initViewBegin:0,initViewEnd:0,initMaxY:0,initMinY:0,lineNumber:999,evtList:[],cursorState:!1,moveZoomX:0,moveZoomY:0,moveLayer:!1,activeLayer:null,flagSave:!1,fiEvt:[],tmp1:null,tmp2:null};this.hideShowTrace=function(){Lr.hideTrace=!Lr.hideTrace,function(){if(Lr.hideTrace){var e=document.createElement("div");e.id=et("hst-"),e.setAttribute("class","spg hst_icon"),e.setAttribute("style","top:"+(Lr.paddingTop+3)+"px;right:"+(Lr.paddingRight+5)+"px"),Vr.doc.appendChild(e),Vr.clickHandler.forEach((function(e){b.gi(et("hst-")).addEventListener(e,Vr.hideShowTrace)}))}else b.idrem(et("hst-"))}(),$()},this.duree_menu=function(e,t){if(""!=e&&(e=parseInt(e),t=null!=t?parseInt(t):Lr.chartPeriod,e!=Lr.histoLength||t!=Lr.chartPeriod)){Yr.fiEvt=[],b.clrem(["svginfofi"]),Yr.flagSave=!0,Lt();var a={chartPeriod:Lr.chartPeriod,histoLength:Lr.histoLength};t<0&&e>20&&(t=0),t>=0&&e<=20&&(t=-1),Lr.chartPeriod=t,Lr.histoLength=e,Ae(!0,a)}},this.period_menu=function(e,t){(e=parseInt(e))!=Lr.chartPeriod&&((t=null!=t?parseInt(t):Lr.histoLength)!=Lr.histoLength||e!=Lr.chartPeriod)&&(Yr.flagSave=!0,Lt(),e<0&&t>20&&(t=1,Yr.fiEvt=[],b.clrem(["svginfofi"])),e>=0&&t<=20&&(t=365,Yr.fiEvt=[],b.clrem(["svginfofi"])),Lr.chartPeriod=e,Lr.histoLength=t,Ae(!0))},this.settings_changeFont=function(e){var t=e-Lr.set.fontSize;0!=t&&(Lr.paddingBottom+=t,Lr.paddingTop+=t,Lr.paddingRight+=4*t,Lr.paddingLeft+=4*t,Lr.set.fontSize=e,this.set_screenSize())},this.style_menu_template=function(e){null!=Dr&&tt(e,!0)},this.style_menu=function(e){null!=Dr&&e!=Lr.mainChart.type&&tt(e)},this.indic1_menu=function(t){if(null!=Dr&&"perf"!=Lr.mainChart.type&&!Lr.mainChart.typedef.nolinearX&&null!=t){var a,r=Lr.mainChart.indicators.length;if("sar"==t||"ichimoku"==t||"pivots"==t)for(a=0;a<r;a++)if(Lr.mainChart.indicators[a].type==t)return;if(("pivots"==t||"VWAP"==t)&&Lr.chartPeriod>=0)return void DisplayAlert("Cet indicateur n'est disponible qu'en vision intraday");Lr.mainChart.indicators.push(e(t)),X(0)}},this.indics_menu=function(t){if(null!=Dr&&!Lr.mainChart.typedef.nolinearX&&null!=t){if(!Lr.isCompare&&"fr"==t)return void("function"==typeof DisplayAlert&&DisplayAlert("La Force Relative ne peut être appliquée que quand 2 valeurs sont comparées"));if(5==Rr.length&&"function"==typeof DisplayAlert)return void DisplayAlert(lang.l_msg1,1);At(e(t))}},this.loadDefautChart=function(a){b.idempty(Vr.callID),Ze(),Yr.fiEvt=[],b.clrem(["svginfofi"]),delete Lr.newsConfig,a.indicators||(a.indicators=[]);for(var r=a.indicators.length,n=[],o=0;o<r;o++)"object"==i(a.indicators[o])?n.push(t(e(a.indicators[o].type),a.indicators[o])):n.push(e(a.indicators[o]));a.indicators=n,M(a),Re(!1)},this.loadTemplateJSON=function(e,t){var a,r;b.idempty(Vr.callID),Ze(),Yr.fiEvt=[],b.clrem(["svginfofi"]),delete(a=JSON.parse(e)).logData,_(a);var n,o=[],i=JSON.parse(t),l=i.length;if(l>1){for(n=1;n<l;n++)o.push(i[n].Indicator);a.indicators=o}else a.indicators=[];for(null!=Lr&&null!=Lr.symbol&&(a.symbol=Lr.symbol),M(a,i),r=b.qsa(".indicname"),n=0;n<r.length;n++)r[n].removeAttribute("style");Re(!1)},this.loadTemplate=function(e){var a;Yr.flagSave=!0,Lt(),b.idempty(Vr.callID),Ze(),Yr.fiEvt=[],b.clrem(["svginfofi"]),delete(a=JSON.parse(e.Parametres)).logData,_(a),a.set=t({bkcolor:"#fff",txtColor:"#606060",gridV:!0,gridH:!0,gridLine:!0,gridColor:"#e0e0e0",isEncadre:!0,yaxis:!1,nosticky:!1,reticColor:"#114257",semilog:!1,cadreColor:"#e0e0e0",traceColor:null,noVeilleIntra:!1,veilleStyle:!1,veilleColor:"#fe0000",fontSize:11,splitStyle:"band",splitColor:"rgba(153,153,153,1)"},a.set);var r,n,o=[],i=JSON.parse(e.Layers),l=i.length;if(l>1){for(n=1;n<l;n++)o.push(i[n].Indicator);a.indicators=o}else a.indicators=[];switch(null!=Lr&&null!=Lr.symbol&&(a.symbol=Lr.symbol),delete Lr.indicators,delete Lr.mainChart,delete Lr.newsConfig,M(a,i),Lr.mainChart.type){case"heikin ashi":r="heikin";break;case"line break":r="linebreak";break;case"point figure":r="pnf";break;default:r=Lr.mainChart.type}return Re(!1),r},this.change_symbol=function(e){Yr.fiEvt=[],b.clrem(["svginfofi"]),Lr.symbol=e,Re(!0)},this.set_screenSize=function(){var e,t,a,r;if(Yr.flagSave=!0,Lt(),Vr.doc=b.gi(Vr.callID),e=window.getComputedStyle(Vr.doc),Lr.widthGraph=parseInt(e.width),Lr.heightGraph=parseInt(e.height),Lr.innerWidth=Lr.widthGraph-Lr.paddingLeft-Lr.paddingRight,Lr.usableHeight=Lr.heightGraph-Lr.paddingTop-Lr.paddingBottom-Lr.indicators.length*Lr.marginInter,t=Rr.length,Lr.mainChart.typedef.nolinearX)return t>1&&Rr.splice(0,1),void Pt();for(a=0;a<t;a++)Rr[a].Bars=0==a?[]:{},delete Rr[a].canvas,delete Rr[a].ctx;r=o(Rr),Ze(!0),De(r),null!=Dr&&($(),VGP.chartSimple||(P(),Ke()))},this.saveTemplate=function(e){var t,a,r,n,i,l,s;if(null!=Dr){for(a=o(Lr),r=["widthGraph","heightGraph","paddingTop","paddingLeft","paddingBottom","paddingRight","indicators","usableHeight","marginInter","innerWidth","symbol","padBarCandle","cursor","logData","hideTrace","compare","isIntraday","callID"],t=0;t<r.length;t++)delete a[r[t]];for(delete a.mainChart.typedef.params,a=function(e){for(var t={bkcolor:"#fff",txtColor:"#606060",gridV:!0,gridH:!0,gridLine:!0,gridColor:"#e0e0e0",isEncadre:!0,yaxis:!1,nosticky:!1,reticColor:"#114257",semilog:!1,cadreColor:"#e0e0e0",traceColor:null,noVeilleIntra:!1,veilleStyle:!1,veilleColor:"#fe0000",fontSize:11,splitStyle:"band",splitColor:"rgba(153,153,153,1)"},a=Object.keys(t),r=a.length,n=0;n<r;n++)e.set[a[n]]==t[a[n]]&&delete e.set[a[n]];return e}(a),t=0;t<a.mainChart.indicators.length;t++)delete a.mainChart.indicators[t].params,delete a.mainChart.indicators[t].datas2;for(t=0;t<a.mainChart.indicators.length;t++)delete a.mainChart.indicators[t].params;for(n=Rr.length,t=0;t<n;t++)Rr[t].Bars=0==t?[]:{};for(t=0;t<n;t++)delete Rr[t].canvas,delete Rr[t].ctx;for(i=o(Rr),t=0;t<i.length;t++)delete i[t].Bars,delete i[t].RealY,delete i[t].PxPointX,delete i[t].PxPointY,delete i[t].V0,delete i[t].id,delete i[t].HeightPx,delete i[t].Indicator.params;if(l=o(Rr),Lr.mainChart.typedef.nolinearX&&(i.splice(1),a.mainChart.indicators=[],l.splice(1)),Ze(!0),De(l),$(),Ke(),P(),null==e)return{l:JSON.stringify(i),p:JSON.stringify(a)};(s=new XMLHttpRequest).open("POST",VGP.urlWS+"UpdateConfigEOD",!0),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.send(JSON.stringify({configname:escape(e),parametres:JSON.stringify(a),layers:JSON.stringify(i)}))}},this.SynchronizeLines=function(){Ar=_e(Lr.symbol),F()},this.get_symbol=function(){return Lr.symbol},this.delete_chart=function(){b.idempty(Vr.callID),Ze()},this.get_id=function(){return Vr.callID},this.get_name=function(){return null==Dr?"":Dr.Name},this.get_chartType=function(){return Lr.mainChart.type},this.get_parametres=function(){return Lr},this.settings_setdefaut=function(){null!=Dr&&(Lr.set={bkcolor:"#fff",txtColor:"#606060",gridV:!0,gridH:!0,gridLine:!0,gridColor:"#e0e0e0",isEncadre:!0,yaxis:!1,nosticky:!1,reticColor:"#114257",semilog:!1,cadreColor:"#e0e0e0",traceColor:null,noVeilleIntra:!1,veilleStyle:!1,veilleColor:"#fe0000",fontSize:11,splitStyle:"band",splitColor:"rgba(153,153,153,1)"},Lr.paddingLeft=10,Lr.paddingRight=45,Lr.paddingTop=17,Lr.paddingBottom=20,this.set_screenSize())},this.settings_setAxis=function(e){var t=4*(Lr.set.fontSize-11);"left"==e?(Lr.set.yaxis=!0,Lr.paddingLeft=45+t,Lr.paddingRight=10+t):(Lr.set.yaxis=!1,Lr.paddingLeft=10+t,Lr.paddingRight=45+t),b.idcss(et("eod_mainchartinfos-"),"left",Lr.paddingLeft+2+"px"),b.clcss("infoindic","left",Lr.paddingLeft+5+"px"),b.idcss(et("trace-"),"left",Lr.paddingLeft+"px"),$()},this.settings_setAxisLog=function(e){e?Lr.set.semilog=!0:(Lr.set.semilog=!1,delete Lr.logData),$()},this.settings_setSticky=function(e){Lr.set.nosticky=e,$()},this.settings_setHLSticky=function(e){Lr.set.nohighlow=e,$()},this.stop_events=function(){Gt()},this.set_events=function(){P()},this.settings_setNoVeilleIntra=function(e){if(Lr.set.noVeilleIntra=e,1==Lr.histoLength){if(Hr.minX=0,Hr.maxX=Dr.QuoteTab.length-1,Hr.maxY=Dr.High,Hr.minY=Dr.Low,!Lr.set.noVeilleIntra){var t=Dr.qv.c;t>Hr.maxY&&(Hr.maxY=t),t<Hr.minY&&(Hr.minY=t)}$()}},this.settings_setTraceColor=function(e){null!=Dr&&(Lr.set.traceColor=e)},this.settings_setVeilleStyle=function(e){Lr.set.veilleStyle=e,$()},this.settings_setVeilleColor=function(e){Lr.set.veilleColor=e,$()},this.settings_getTraceColor=function(){return La()},this.settings_setGridlineShow=function(e){Lr.set.gridLine=e,$()},this.settings_setGridlineH=function(e){Lr.set.gridH=e,$()},this.settings_setGridlineV=function(e){Lr.set.gridV=e,$()},this.settings_setSplitdayStyle=function(e){Lr.set.splitStyle=e,$()},this.settings_setSplitdayColor=function(e){Lr.set.splitColor=u(e,1),$()},this.settings_setGridColor=function(e){null!=Dr&&(Lr.set.gridColor=e,$())},this.settings_setCadreColor=function(e){null!=Dr&&(Lr.set.cadreColor=e,$())},this.settings_setReticuleColor=function(e){null!=Dr&&(Lr.set.reticColor=e,b.gi(et("overlay-")).getContext("2d").strokeStyle=Lr.set.reticColor)},this.settings_setEncadreShow=function(e){Lr.set.isEncadre=e,$()},this.settings_setBackColor=function(e){null!=Dr&&(Lr.set.bkcolor=e,b.idcss(et("rodgraph-"),"background-color",e))},this.settings_setTextColor=function(e){null!=Dr&&(b.clcss("indicname","color",e),b.idcss(et("eod_mainchartinfos-"),"color",e),b.idcss(et("eod_topinfo-"),"color",e),Lr.set.txtColor=e,$())},this.updateQuoteEODrefresh=function(e){var t=Dr.QuoteTab[Dr.QuoteTab.length-1],a=t.d;0==Lr.chartPeriod?((t=e).d=a,Dr.QuoteTab[Dr.QuoteTab.length-1]=t):(e.h>t.h&&(t.h=e.h),e.l<t.l&&(t.l=e.l),t.c=e.c,t.v=e.v),$()},this.updateQuoteIntraRefresh=function(e){var t=Dr.QuoteTab.length-1,a=Dr.QuoteTab[t].d,r=0,n=e.qt;if(null==n)return!1;for(var o=Hr.maxY,i=Hr.minY,l=n.length-1;l>=0;l--)n[l].d>=a&&(n[l].d==a?Dr.QuoteTab[t]=n[l]:(Dr.QuoteTab.push(n[l]),r++),n[l].h>o&&(o=n[l].h),n[l].l<i&&(i=n[l].l),n[l].h>Dr.High&&(Dr.High=n[l].h),n[l].l<Dr.Low&&(Dr.Low=n[l].l));Dr.qd&&(Dr.qd.h=e.h,Dr.qd.l=e.l,Dr.qd.c=e.c,Dr.qd.v=e.v),Hr.maxY=o,Hr.minY=i,Hr.maxX=Hr.maxX+r,$()},this.stopGomme=function(){Ma()},this.stopMZoom=function(){T()},this.zoom=function(e){Yr.flagSave=!0,Lt(),e?q(3):G(3)},this.order_level=function(e,t){"perf"!=Lr.mainChart.type?(Lt(),at(e)):DisplayAlert("Le passage d'ordre n'est pas disponible en mode 'performance'")},this.tools_menu=function(e){if(null!=Dr)switch(e){case"g":if(0==Ar.length)return;Gt(),Nr={c:yr(),idLine:999},["touchstart","mousedown"].forEach((function(e){Vr.doc.addEventListener(e,Pa)})),Vr.doc.addEventListener("mousemove",Sa),ia("mousemove",Sa),ia("mousedown",Pa),ia("touchstart",Pa);break;case"r":la(),P(),Lr.cursor="r";break;case"m":la(),P(),Lr.cursor="m";break;case"z":Gt(),w("zi"),Vr.doc.addEventListener("mousedown",C),Vr.doc.addEventListener("touchstart",C),ia("mousedown",C),ia("touchstart",C),Vr.doc.addEventListener("touchmove",k),Vr.doc.addEventListener("mousemove",k),ia("touchmove",k),ia("mousemove",k)}},this.setNews=function(e){null==Dr||Lr.mainChart.typedef.nolinearX||(null==e||0==e.length?(Yr.fiEvt=[],b.clrem(["svginfofi"]),delete Lr.newsConfig):Lr.newsConfig=e,Lt(),$())},this.addSearch=function(e){null==Dr||Lr.mainChart.typedef.nolinearX||null==e||(Lr.searchConfig=e,Yr.flagSave=!0,Lt(),$())},this.removeSearch=function(){null!=Dr&&(Lr.searchConfig="",$())},this.closeToolsParams=function(){Yr.flagSave=!0,Lt()},this.CloseTools=function(e){e||(Yr.flagSave=!0),Lt()},this.saveTrace=function(){It()},this.saveTraceFull=function(){var e=It(!0),t=this.saveTemplate();return{Traces:e,Parametres:t.p,Layers:t.l,Symbol:Lr.symbol}},this.readTraceFull=function(e){if(null!=e){if(null!=e.Symbol&&(Lr.symbol=e.Symbol),null!=e.Traces){var t=e.Traces;Me(Lr.symbol,JSON.parse(t)),VGP.drawings[Lr.symbol]=1,Ar=JSON.parse(t)}this.loadTemplate(e)}},this.readTrace=function(){N(!1,!0,!1)},this.screenCapture=function(e){var t,a,r,n,o,i,l,s,c,d,u,h,p;if(null!=Dr){if(Yr.flagSave=!0,Lt(),(t=document.createElement("canvas")).id="canvasflatten",t.width=Lr.widthGraph,t.height=Lr.heightGraph,Vr.doc.parentNode.insertBefore(t,Vr.doc.nextSibling),(a=t.getContext("2d")).fillStyle=Lr.set.bkcolor,a.fillRect(0,0,t.width,t.height),a.font="11px Arial",r=b.gi(et("rodgraph-")),a.drawImage(r,0,0),a.drawImage(Rr[0].canvas,0,Lr.paddingTop),null==Ar.length||"perf"==Lr.mainChart.type||Lr.mainChart.typedef.nolinearX||(n=b.gi(et("trace-")),a.drawImage(n,Lr.paddingLeft,Lr.paddingTop)),!Lr.mainChart.typedef.nolinearX)for(o=1;o<Rr.length;o++)a.drawImage(Rr[o].canvas,0,Rr[o].RealY),a.fillStyle=Rr[o].Indicator.color,i=Rr[o].Indicator.type.toUpperCase(),null!=Rr[o].Indicator.param1&&(i+=" ("+Rr[o].Indicator.param1,null!=Rr[o].Indicator.param2&&(i+=", "+Rr[o].Indicator.param2,null!=Rr[o].Indicator.param3&&(i+=", "+Rr[o].Indicator.param3)),i+=")"),a.fillText(i,Lr.paddingLeft+5,Rr[o].RealY+13);if(a.fillStyle="#808080",e=null!=e?" - "+e:"",a.fillText(Dr.Name.toUpperCase()+e,Lr.paddingLeft,13),null!=(s=document.querySelector(".eod_topinfo span:last-child"))&&(l=s.textContent),c=a.measureText(l).width,a.fillText(l,Lr.widthGraph-Lr.paddingRight-c,13),!Lr.mainChart.typedef.nolinearX)for(d=Lr.paddingLeft+5,o=0;o<Lr.mainChart.indicators.length;o++)u=Lr.mainChart.indicators[o],a.fillStyle=u.color,h="",null!=u.param1&&(h+=" ("+u.param1,null!=u.param2&&(h+=", "+u.param2),h+=")"),h="compare"==u.type?u.datas2?u.datas2.Name:"NC":u.type.toUpperCase()+h,a.fillText(h,d,Lr.paddingTop+12),d+=a.measureText(h).width+15;return p=(p=t.toDataURL("image/png")).replace("data:image/png;base64,",""),b.idrem("canvasflatten"),p}},this.daysToDate=function(e,t){return Lr.histoLength<=20?m(e):g(e,t)},this.trace_menu=function(e){if(null!=Dr&&!Lr.mainChart.typedef.nolinearX)switch(Gt(),e){case"ewi":ba(e,6);break;case"ewc":ba(e,4);break;case"t":case"wf":ba(e,3);break;case"a":Nr={c:yr(),color:La()},w("c"),["touchstart","mousedown"].forEach((function(e){Vr.doc.addEventListener(e,Ea)})),ia("touchstart",Ea),ia("mousedown",Ea);break;case"fa":w("c"),Nr={c:yr(),color:La(),color2:"#4040ff"},["touchstart","click"].forEach((function(e){Vr.doc.addEventListener(e,Ca)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,ka)})),ia("click",Ca),ia("mousemove",ka),ia("touchstart",Ca),ia("touchmove",ka);break;case"arrup":case"arrdw":case"arrrt":case"arrlt":case"sm1":case"sm2":!function(e){w("c"),Nr={c:yr(),t:e},["touchstart","mousedown"].forEach((function(e){Vr.doc.addEventListener(e,_a)})),ia("mousedown",_a),ia("touchstart",_a)}(e);break;case"h":case"v":case"sr":!function(e){Nr={type:e,c:yr(),pt:null,color:La()},["touchend","mousedown"].forEach((function(e){Vr.doc.addEventListener(e,va)})),["touchstart","touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,ya)})),ia("mousedown",va),ia("mousemove",ya),ia("touchend",va),ia("touchstart",ya),ia("touchmove",ya)}(e);break;case"p":w("c"),Nr={c:yr(),color:La(),step1:!1},["touchstart","touchend","mousedown"].forEach((function(e){Vr.doc.addEventListener(e,tr)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,ar)})),ia("touchend",tr),ia("touchstart",tr),ia("mousedown",tr),ia("mousemove",ar),ia("touchmove",ar);break;case"rf":case"r":case"m":!function(e){w("c"),Nr={c:yr(),type:e,color:La()},["touchstart","mousedown"].forEach((function(e){Vr.doc.addEventListener(e,Ya)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,Oa)})),ia("touchstart",Ya),ia("mousedown",Ya),ia("mousemove",Oa),ia("touchmove",Oa)}(e);break;case"e":Ar=[],r()&&(Lr.chartPeriod<0?sessionStorage.removeItem(Lr.symbol):(localStorage.removeItem(Lr.symbol),VGP.noAutoSaveTrace||(dt(),delete VGP.drawings[Lr.symbol]))),F(),P();break;default:!function(e){w("c"),Nr={type:e,c:yr(),color:La()},["touchstart","touchend","mousedown"].forEach((function(e){Vr.doc.addEventListener(e,lr)})),["touchmove","mousemove"].forEach((function(e){Vr.doc.addEventListener(e,ir)})),ia("touchend",lr),ia("touchstart",lr),ia("mousedown",lr),ia("mousemove",ir),ia("touchmove",ir)}(e)}},this.compare=function(t){var a,r,n,o,i;if(null!=Dr&&!Lr.mainChart.typedef.nolinearX&&"perf"!=Lr.mainChart.type){for(r=Lr.mainChart.indicators.length,n=0,a=0;a<r;a++)"compare"==Lr.mainChart.indicators[a].type&&n++;if(n>=4)return void DisplayAlert("Vous avez atteint le maximum de valeurs en comparaison");o=VGP.urlWS+"GetTicksEOD","GET"==VGP.callType&&(o=o+"?symbol="+t+"&length="+Lr.histoLength+"&period="+Lr.chartPeriod+"&guid="+b.gigt("guid")),(i=new XMLHttpRequest).open(VGP.callType,o,!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.onload=function(){var a,r;if(i.status>=200&&i.status<400){if(null==(a=JSON.parse(i.responseText))||null==a.d)return;switch(r=e("compare"),n){case 1:r.color="rgba(0,128,0,1)";break;case 2:r.color="rgba(0,95,192,1)";break;case 3:r.color="rgba(127,0,255,1)"}r.datas2=a.d,r.symbol=t,Lr.mainChart.indicators.push(r),Lr.isCompare=!0,qe(Dr.High,Dr.Low,Dr.QuoteTab[0].c),X(0)}},i.send(JSON.stringify({symbol:t,length:Lr.histoLength,period:Lr.chartPeriod,guid:b.gigt("guid")}))}},qt.prototype.Create=function(){this.canvas=document.createElement("canvas"),this.canvas.width=Lr.widthGraph,this.canvas.height=this.HeightPx,this.canvas.style.top=this.RealY+"px",this.canvas.id=this.id,Vr.doc.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),Rr.push(this)},qt.prototype.Resize=function(e,t,a){this.Y=e,this.RealY=Math.round(e*Lr.usableHeight)+Lr.paddingTop+a,this.Height=t,this.HeightPx=Math.round(t*Lr.usableHeight),this.canvas.style.top=this.RealY+"px",this.canvas.height=this.HeightPx},qt.prototype.Move=function(e,t,a){this.RealY=e,this.HeightPx=this.HeightPx+t,this.Y=(this.RealY-Lr.paddingTop-Lr.marginInter*a)/Lr.usableHeight,this.Height=this.HeightPx/Lr.usableHeight,this.canvas.style.top=this.RealY+"px",this.canvas.height=this.HeightPx},qt.prototype.DrawEncadre=function(){this.ctx.clearRect(0,0,Lr.widthGraph,this.HeightPx),Lr.set.isEncadre&&(this.ctx.strokeStyle=Lr.set.cadreColor,this.ctx.strokeRect(Lr.paddingLeft+.5,.5,Lr.innerWidth,this.HeightPx-1))}},window.RODGraph=x}(),r={move:function(e,t,a){e.style.left=t+"px",e.style.top=a+"px"},startMoving:function(e,t,a){var n,o;if("linemodif"!=a.target.className)return!1;var i=(a=a||window.event).clientX,l=a.clientY,s=e.style.top,c=e.style.left,d=e.clientWidth,u=e.clientHeight,h=document.getElementById(t).clientWidth,p=document.getElementById(t).clientHeight;s=s.replace("px",""),c=c.replace("px",""),n=i-c,o=l-s,document.onmousemove=function(t){var a=(t=t||window.event).clientX,i=t.clientY,l=a-n,s=i-o;l<10&&(l=10),s<18&&(s=18),l+d>h-6&&(l=h-d-6),s+u>p+12&&(s=p-u+12),r.move(e,l,s)}},stopMoving:function(){document.onmousemove=function(){}}},n=new function(){function e(e){var t,a,r,n,o,i,l,s,c,d,u,h,p=function(e){return e-Math.floor(e)},m=e.getJulian(),f=e.getFullYear(),g=3.14159265/180;for(o=2415020+29*(t=Math.floor(12.3685*(f-1900))),i=1178e-7*(r=(a=(f-1899.5)/100)*a)-155e-9*(n=a*a*a)+(.75933+.53058868*t)-(837e-6*a+335e-6*r),l=360*p(.08084821133*t)+359.2242-333e-7*r-347e-8*n,s=360*p(.07171366128*t)+306.0253+.0107306*r+1236e-8*n,c=360*p(.08519585128*t)+21.2964-.0016528*r-239e-8*n,u=0,h=0;h<m;){var v=i+1.530588*u,y=(l+29.10535608*u)*g,b=(s+385.81691806*u)*g,x=(c+390.67050646*u)*g;v-=.4068*Math.sin(b)+(.1734-393e-6*a)*Math.sin(y),v+=.0161*Math.sin(2*b)+.0104*Math.sin(2*x),v-=.0074*Math.sin(y-b)-.0051*Math.sin(y+b),v+=.0021*Math.sin(2*y)+.001*Math.sin(2*x-b),v+=.5/1440,d=h,h=o+28*u+Math.floor(v),u++}return(m-d)/29.53059}this.computeMovingAverage=function(e,t,a){for(var r=[],n=e.length,o=0,i=0;i<n;i++)i<t?(o+=v(e[i],a),r[i]={d:e[i].d,v1:o/(i+1)}):(o=o+v(e[i],a)-v(e[i-t],a),r[i]={d:e[i].d,v1:o/t});return{Values:r}},this.computeFR=function(e,t){for(var a,r=[],n=e.length,o=t.length,i=0,l=-100,s=0,c=999999,d=[],u=0;u<o;u++)d[t[u].d]=t[u];for(u=0;u<n;u++)null!=d[e[u].d]&&(-100==l?(l=e[u].c,a=d[e[u].d].c):((i=100*((e[u].c-l)/l-(d[e[u].d].c-a)/a))>s&&(s=i),i<c&&(c=i))),r[u]={d:e[u].d,v1:i};return{High:s,Low:c,Values:r}},this.computeCMO=function(e,t){var a,r,n=[],o=e.length,i=0,l=0,s=[];for(s[0]=0,a=1;a<o;a++)s[a]=100*(e[a].c-e[a-1].c)/e[a-1].c;for(n[0]={d:e[0].d,v1:0},a=1;a<o;a++)a<t?s[a]>=0?i+=s[a]:l-=s[a]:s[a]>=0?(i+=s[a],s[a-t]>=0?i-=s[a-t]:l+=s[a-t]):(l-=s[a],s[a-t]>=0?i-=s[a-t]:l+=s[a-t]),r=100*(i-l)/(i+l),r=isNaN(r)?0:r,n[a]={d:e[a].d,v1:r};return{High:100,Low:-100,Values:n}},this.computeHighLow=function(e,t){var a,r,n,o,i,l=e.length;if(l<t)return null;for(i=[],a=0;a<t;a++)i[a]={d:e[a].d,v1:0,v2:0};for(a=t;a<l;a++){for(n=0,o=9999999,r=1;r<t&&!(a-r<0);r++)e[a-r].h>n&&(n=e[a-r].h),e[a-r].l<o&&(o=e[a-r].l);i[a]=n<e[a].h?{d:e[a].d,v1:e[a].h,v2:0}:o>e[a].l?{d:e[a].d,v1:0,v2:e[a].l}:{d:e[a].d,v1:0,v2:0}}return{Values:i}},this.computeSupertrend=function(e,t,a){var r,n,o,i,l,s,c=[],d=e.length,u=this.computeATR(e,t,"pma");if(null==u)return!1;for(r=(o=(e[0].h+e[0].l)/2)+a*u.Values[0].v1,n=o-a*u.Values[0].v1,c[0]={d:e[0].d,v1:r,v2:n},(s=[])[0]={u:r,d:n},l=1;l<d;l++)r=(o=(e[l].h+e[l].l)/2)+a*u.Values[l].v1,n=o-a*u.Values[l].v1,s[l]={u:r,d:n};for(l=1;l<d;l++)e[l].c>s[l-1].u?i=1:e[l].c<s[l-1].d&&(i=-1),-1==i?(s[l].u>s[l-1].u&&(s[l].u=s[l-1].u),c[l]={d:e[l].d,v1:s[l].u,v2:0}):(s[l].d<s[l-1].d&&(s[l].d=s[l-1].d),c[l]={d:e[l].d,v1:0,v2:s[l].d});return{Values:c}},this.computeVolume=function(e,t){var a,r=[],n=0,o=9999999999999,i=e.length;for(r[0]={d:e[0].d,v1:e[0].v,v2:1},t.minX<=0&&(e[0].v>n&&(n=e[0].v),e[0].v<o&&(o=e[0].v)),a=1;a<i;a++)r[a]=e[a].c-e[a-1].c>=0?{d:e[a].d,v1:e[a].v,v2:1}:{d:e[a].d,v1:e[a].v,v2:-1},a>=t.minX&&a<=t.maxX&&(e[a].v>n&&(n=e[a].v),e[a].v<o&&(o=e[a].v));return{High:n,Low:o,Values:r}},this.computeBollingerBandwith=function(e,t,a,r){for(var n=e.length,o=0,i=999999,l=[],s=this.computeBollinger(e,t,a,r),c=this.computeMovingAverage(e,t,r),d=0,u=0;u<n;u++)d=100*(s.Values[u].v1-s.Values[u].v2)/c.Values[u].v1,l[u]={d:e[u].d,v1:d},d>o&&(o=d),d<i&&(i=d);return{High:o,Low:i,Values:l}},this.computeVortex=function(e,t){var a,r=e.length;if(r<t+2)return null;var n=[],o=[],i=0,l=999999,s=[];for(n[0]={p:Math.abs(e[0].h-e[0].l),m:Math.abs(e[0].l-e[0].h)},o[0]=e[0].h-e[0].l,a=1;a<r;a++)n[a]={p:Math.abs(e[a].h-e[a-1].l),m:Math.abs(e[a].l-e[a-1].h)},o[a]=Math.max(e[a].h-e[a].l,Math.abs(e[a].h-e[a-1].c),Math.abs(e[a].l-e[a-1].c));var c,d,u=0,h=0,p=0;for(a=0;a<r;a++)a<t?(h+=n[a].p,c=(u+=n[a].m)/(a+1)/(p+=o[a]),d=h/(a+1)/p):(h=h+n[a].p-n[a-t].p,u=u+n[a].m-n[a-t].m,(d=h/t/(p=p+o[a]-o[a-t]))>i&&(i=d),d<l&&(l=d),(c=u/t/p)>i&&(i=c),c<l&&(l=c)),s[a]={d:e[a].d,v1:d,v2:c};for(a=0;a<t;a++)s[a]={d:e[a].d,v1:s[t].v1,v2:s[t].v2};return{High:i,Low:l,Values:s}},this.computeMFI=function(e,t){var a,r=e.length,n=[],o=[],i=[];for(i[0]={p:0,n:0},o[0]=(e[0].h+e[0].l+e[0].c)/3,a=1;a<r;a++)o[a]=(e[a].h+e[a].l+e[a].c)/3,i[a]=o[a]>=o[a-1]?{p:o[a]*e[0].v,n:0}:{p:0,n:o[a]*e[0].v};var l=0,s=0,c=[];for(a=0;a<r;a++)a<t?(l+=i[a].p,s+=i[a].n,c[a]={p:l/(a+1),n:s/(a+1)}):(l=l+i[a].p-i[a-t].p,s=s+i[a].n-i[a-t].n,c[a]={p:l/t,n:s/t}),n[a]=0==c[a].n?{d:e[a].d,v1:0}:{d:e[a].d,v1:100-100/(1+c[a].p/c[a].n)};return{High:100,Low:0,Values:n}},this.computeOBV=function(e){var t,a,r=-1e5,n=9999999999,o=e.length,i=[],l=0;for(i[0]={d:e[0].d,v1:0},t=1;t<o;t++)e[t].c>e[t-1].c&&(l+=e[t].v),e[t].c<e[t-1].c&&(l-=e[t].v),a=l/1e3,i[t]={d:e[t].d,v1:a},a>r&&(r=a),a<n&&(n=a);return{High:r,Low:n,Values:i}},this.computeAccDist=function(e){var t,a,r=[],n=-1e6,o=9999999999,i=e.length,l=0;for(r[0]={d:e[0].d,v1:0},t=1;t<i;t++)0!=(a=e[t].h-e[t].l)&&(l+=(e[t].c-e[t].l-(e[t].h-e[t].c))*(e[t].v/1e3)/a),r[t]={d:e[t].d,v1:l},l>n&&(n=l),l<o&&(o=l);return{High:n,Low:o,Values:r}},this.computeBollinger=function(e,t,a,r){for(var n,o,i,l,s,c,d,u,h=[],p=e.length,m=this.computeMovingAverage(e,t,r),f=[],g=0,y=0;y<p;y++)n=v(e[y],r),y<t?(g+=n*n,f[y]=g*t/(y+1)):(g=g+n*n-(o=v(e[y-t],r))*o,f[y]=g);for(i=[],l=0,y=0;y<p;y++)n=v(e[y],r),y<t?(s=(l+=n)*t/(y+1),i[y]=s*s):(l=l+n-(o=v(e[y-t],r)),i[y]=l*l);for(d=t*(t-1),y=0;y<p;y++)c=(u=t*f[y]-i[y])<0?0:Math.pow(u/d,.5)*a,h[y]={d:e[y].d,v1:m.Values[y].v1+c,v2:m.Values[y].v1-c};return{Values:h}},this.computeBollingerB=function(e,t,a,r){for(var n,o,i=this.computeBollinger(e,t,a,r),l=[],s=i.Values.length,c=0,d=100,u=0;u<s;u++)0==(o=i.Values[u].v1-i.Values[u].v2)&&(o=1),n=100*(v(e[u],r)-i.Values[u].v2)/o,l[u]={d:e[u].d,v1:n},n>c&&(c=n),n<d&&(d=n);return{High:c,Low:d,Values:l}},this.computeDMI=function(e,t,a){var r,n,o,i,l=[],s=e.length,c=0;if(s<2*t)return null;var d=[],u=[],h=[],p=[],m=0,f=0,g=0,v=[],y=[],b=[];for(d[0]={p:0,m:0},u[0]=1,r=1;r<s;r++)n=e[r].h-e[r-1].h,o=e[r-1].l-e[r].l,u[r]=Math.max(Math.abs(e[r].h-e[r].l),Math.abs(e[r].h-e[r-1].c),Math.abs(e[r].l-e[r-1].c)),d[r]=n>o?{p:Math.max(0,n),m:0}:{p:0,m:0},o>n&&(d[r].m=Math.max(0,o));for(r=1;r<=t;r++)g+=u[r],m+=d[r].p,f+=d[r].m;for(h[t]=g,p[t]={p:m,m:f},v[t]={p:100*p[t].p/h[t],m:100*p[t].m/h[t]},y[t]=Math.abs(p[t].p-p[t].m)/(p[t].p+p[t].m)*100,b[t]=y[t],l[t]="dmi"==a?{d:e[t].d,v1:v[t].p,v2:v[t].m,v3:b[t]}:{d:e[t].d,v1:b[t],v2:b[t]},r=t+1;r<s;r++)h[r]=h[r-1]-h[r-1]/t+u[r],m=p[r-1].p-p[r-1].p/t+d[r].p,f=p[r-1].m-p[r-1].m/t+d[r].m,p[r]={p:m,m:f},v[r]={p:100*p[r].p/h[r],m:100*p[r].m/h[r]},y[r]=Math.abs(p[r].p-p[r].m)/(p[r].p+p[r].m)*100,b[r]=(b[r-1]*(t-1)+y[r])/t,"dmi"==a&&(v[r].p>c&&(c=v[r].p),v[r].m>c&&(c=v[r].m),l[r]={d:e[r].d,v1:v[r].p,v2:v[r].m,v3:b[r]}),b[r]>c&&(c=b[r]);if(c>100&&(c=90),"dmi"==a)for(i=(l[t+1].v1+l[t+1].v2+l[t+1].v3)/3,r=0;r<=t;r++)l[r]={d:e[r].d,v1:i,v2:i,v3:i};if("adx"==a&&s>2*t){for(r=t+1;r<2*t;r++)l[r]={d:e[r].d,v1:b[r],v2:(b[t]+b[r])/2};for(r=2*t;r<s;r++)l[r]={d:e[r].d,v1:b[r],v2:(b[r-t]+b[r])/2};for(r=0;r<=t;r++)l[r]={d:e[r].d,v1:l[t].v1,v2:l[t].v2}}return{High:c,Low:0,Values:l}},this.computeLinearCurve=function(e,t,a,r){var n,o,i,l,s,c,d,u,h=[],p=e.length;if(p<=t)return null;if(1==a)for(n=0;n<=t;n++)h[n]={d:e[n].d,v1:v(e[n],r)};else for(n=0;n<=t;n++)h[n]={d:e[n].d,v1:0};for(i=-100,l=100,n=p-1;n>t;n--){var m=0,f=0,g=0,y=0;for(o=t;o>=1;o--)m+=o*(c=v(e[n-(t-o)],r)),f+=o,g+=c,y+=o*o;d=(g-(u=(m*t-f*g)/(t*y-f*f))*f)/t,1==a?h[n]={d:e[n].d,v1:d+u*t}:((s=v(e[n],r)-(d+u*t))>i&&(i=s),s<l&&(l=s),h[n]={d:e[n].d,v1:s})}return 1==a?{Values:h}:{High:i,Low:l,Values:h}},this.computeUlcerIndex=function(e,t,a){for(var r,n,o,i,l=[],s=0,c=e.length,d=0,u=[],h=0;h<c;h++){for(r=0;r<t&&!(h-r<0);r++)v(e[h-r],a)>d&&(d=v(e[h-r],a));n=(v(e[h],a)-d)/d*100,u[h]={d:e[h].d,c:n*n},d=0}for(i=this.computeMovingAverage(u,t,"c"),h=0;h<c;h++)o=Math.pow(i.Values[h].v1,.5),l[h]={d:e[h].d,v1:o},o>s&&(s=o);return{High:s,Low:0,Values:l}},this.computeCCI=function(e,t){for(var a,r,n,o,i,l,s,c,d=[],u=e.length,h=0,p=0,m=[],f=0,g=0;g<u;g++)m[g]=(e[g].h+e[g].l+e[g].c)/3;for(a=[],g=0;g<u;g++)g<t?(f+=m[g],a[g]=f/(g+1)):(f=f+m[g]-m[g-t],a[g]=f/t);for(r=[],n=0,g=0;g<u;g++)o=m[g],g<t?(n+=o*o,r[g]=n*t/(g+1)):(n=n+o*o-(i=m[g-t])*i,r[g]=n);for(l=[],s=0,g=0;g<u;g++)o=m[g],g<t?(c=(s+=o)*t/(g+1),l[g]=c*c):(s=s+o-(i=m[g-t]),l[g]=s*s);d[0]={d:e[0].d,v1:0};var v=[],y=0,b=t*(t-1);for(g=1;g<u;g++)o=t*r[g]-l[g],v[g]=o<0?0:Math.pow(o/b,.5),y=(m[g]-a[g])/(.015*v[g]),d[g]={d:e[g].d,v1:y},y>h&&(h=y),y<p&&(p=y);return{High:h,Low:p,Values:d}},this.computeMM=function(e,t){for(var a=e.length,r=0,n=0;n<a;n++)n<t?(r+=e[n].v1,e[n].vm=r/(n+1)):(r=r+e[n].v1-e[n-t].v1,e[n].vm=r/t);return e},this.computeUltimateOsc=function(e,t,a,r){var n,o,i,l=[],s=e.length,c=[],d=[];for(c[0]=e[0].c-e[0].l,d[0]=e[0].h-e[0].l,n=1;n<s;n++)i=Math.min(e[n].l,e[n-1].c),c[n]=e[n].c-i,d[n]=Math.max(e[n].h,e[n-1].c)-i;var u,h,p=[],m=[],f=[];for(n=0;n<s;n++){for(u=0,h=0,o=0;o<t&&!(n-o<0);o++)u+=c[n-o],h+=d[n-o];p[n]=u/h}for(n=0;n<s;n++){for(u=0,h=0,o=0;o<a&&!(n-o<0);o++)u+=c[n-o],h+=d[n-o];m[n]=u/h}for(n=0;n<s;n++){for(u=0,h=0,o=0;o<r&&!(n-o<0);o++)u+=c[n-o],h+=d[n-o];f[n]=u/h}for(n=0;n<s;n++)l[n]={d:e[n].d,v1:100*(4*p[n]+2*m[n]+f[n])/7};return{High:95,Low:5,Values:l}},this.computeDI=function(e,t){var a,r,n,o,i;if(e.length<2*t+2)return null;for(var l,s=[],c=[],d=e.length,u=[],h=[],p=[],m=[],f=[],g=[],v=[],y=[],b=[],x=[],w=[],T=80,C=-80,k=0;k<d;k++)c[k]=(e[k].h+e[k].l+2*e[k].c)/4;for(u[0]={d:e[0].d,c:0},k=1;k<d;k++)u[k]={d:e[k].d,c:Math.max(e[k-1].c,e[k].h)-Math.min(e[k-1].c,e[k].l)},h[k]=(c[k]-c[k-1])/Math.min(c[k-1],c[k]);for(l=this.computeMovingAverage(u,t),a=0,k=0;k<t;k++)a+=e[k].v;for(p[t-1]=a/t,k=t;k<d;k++)p[k]=(p[k-1]*(t-1)+e[k].v)/t;for(k=t-1;k<d;k++)m[k]=e[k].v/p[k];for(k=t;k<d;k++)r=3*c[k]/l.Values[k].v1*Math.abs(h[k]),f[k]=r>88?88:r,g[k]=m[k]/Math.exp(f[k]),v[k]=h[k]>0?m[k]:g[k],y[k]=h[k]<0?m[k]:g[k];for(n=0,o=0,k=t;k<2*t;k++)n+=v[k],o+=y[k];for(b[2*t-1]=o/t,x[2*t-1]=n/t,k=2*t;k<d;k++)b[k]=(b[k-1]*(t-1)+y[k])/t,x[k]=(x[k-1]*(t-1)+v[k])/t,w[k]=b[k]>x[k]?-x[k]/b[k]:b[k]/x[k],(i=w[k]<0?100*(-1-w[k]):100*(1-w[k]))>T&&(T=i),i<C&&(C=i),s[k]={d:e[k].d,v1:i};for(k=0;k<2*t;k++)s[k]={d:e[k].d,v1:0};return{High:T,Low:C,Values:s}},this.computeKST=function(e,t,a,r,n,o){for(var i,l=[],s=e.length,c=0,d=999999,u=this.computeROC(e,t,null,o),h=this.computeROC(e,a,null,o),p=this.computeROC(e,r,null,o),m=this.computeROC(e,n,null,o),f=this.computeMM(u.Values,10),g=this.computeMM(h.Values,10),v=this.computeMM(p.Values,10),y=this.computeMM(m.Values,15),b=[],x=0;x<s;x++)b[x]={v1:f[x].vm+2*g[x].vm+3*v[x].vm+4*y[x].vm},b[x].v1>c&&(c=b[x].v1),b[x].v1<d&&(d=b[x].v1);for(i=this.computeMM(b,9),x=0;x<s;x++)l[x]={d:e[x].d,v1:b[x].v1,v2:i[x].vm};return{High:c,Low:d,Values:l}},this.computeZigZag=function(e,t,a){var r,n,o,i,l=[],s=e.length,c=0,d=v(e[0],a),u=e[0].d;for(l[0]={d:e[0].d,v1:d},o="h",r=0;r<s;r++)n=((i=v(e[r],a))-d)/d,"h"==o?n>0?(d=i,u=e[r].d,c=r):Math.abs(n)>=t&&(l[c]={d:u,v1:d},d=i,u=e[r].d,o="b",c=r):n<0?(d=i,u=e[r].d,c=r):Math.abs(n)>=t&&(l[c]={d:u,v1:d},d=i,u=e[r].d,o="h",c=r);return l[s-1]={d:e[s-1].d,v1:e[s-1].c},{Values:l}},this.computeMovingAverageT=function(e,t,a){t=Math.round((t+1)/2);for(var r=this.computeMovingAverage(e,t,a),n=[],o=r.Values.length,i=0,l=0;l<o;l++)l<t?(i+=r.Values[l].v1,n[l]={d:r.Values[l].d,v1:i/(l+1)}):(i=i+r.Values[l].v1-r.Values[l-t].v1,n[l]={d:r.Values[l].d,v1:i/t});return{Values:n}},this.computeEVMM=function(e,t,a,r){var n,o=[],i=e.length,l=0;for(a/=100,n=0;n<i;n++)n<t?(l+=v(e[n],r),o[n]={d:e[n].d,v1:l/(n+1)*(1+a),v2:l/(n+1)*(1-a)}):(l=l+v(e[n],r)-v(e[n-t],r),o[n]={d:e[n].d,v1:l/t*(1+a),v2:l/t*(1-a)});return{Values:o}},this.computeDPO=function(e,t){var a,r,n,o,i=[],l=0,s=9999,c=e.length;if(t+1>c)return null;for(r=this.computeMovingAverage(e,t),(o=Math.round(t/2-1))<1&&(o=1),a=0;a<o;a++)i[a]={d:e[a].d,v1:0};for(a=o;a<c;a++)(n=e[a].c-r.Values[a-o].v1)>l&&(l=n),n<s&&(s=n),i[a]={d:e[a].d,v1:n};return{High:l,Low:s,Values:i}},this.computeCMF=function(e,t){var a,r,n,o,i,l=[],s=e.length,c=0,d=0,u=9999;for(l[0]={d:e[0].d,v1:0},a=1;a<s;a++){for(c=0,n=0,r=0;r<t&&!(a-r<0);r++)0!=(i=e[a-r].h-e[a-r].l)&&(n+=e[a-r].v*(e[a-r].c-e[a-r].l-(e[a-r].h-e[a-r].c))/i),c+=e[a-r].v;(o=n/c)>d&&(d=o),o<u&&(u=o),l[a]={d:e[a].d,v1:o}}return{High:d,Low:u,Values:l}},this.computeBOP=function(e){var t,a,r,n,o=[],i=e.length;for(n=0!=(r=e[0].h-e[0].l)?(e[0].c-e[0].o)/r:0,o[0]=n<0?{d:e[0].d,v2:n}:{d:e[0].d,v1:n},t=1;t<i;t++)a=0!=(r=e[t].h-e[t].l)?(e[t].c-e[t].o)/r:0,o[t]=a>=0&&n>=0?a>=n?{d:e[t].d,v1:a}:{d:e[t].d,v3:a}:a<0&&n<0?a<=n?{d:e[t].d,v2:a}:{d:e[t].d,v3:a}:a<0?{d:e[t].d,v2:a}:{d:e[t].d,v1:a},n=a;return{High:1.2,Low:-1.05,Values:o}},this.computeAwesomeIndicator=function(e,t,a){for(var r,n,o=[],i=e.length,l=[],s=0;s<i;s++)r=(e[s].h+e[s].l)/2,l[s]={d:e[s].d,c:r};var c,d=this.computeMovingAverage(l,t,"c"),u=this.computeMovingAverage(l,a,"c"),h=0,p=99999;for(c=d.Values[0].v1-u.Values[0].v1,o[0]={d:e[0].d,v1:c},n=c,s=1;s<i;s++)(c=d.Values[s].v1-u.Values[s].v1)>h&&(h=c),c<p&&(p=c),o[s]=c>=n?{d:e[s].d,v1:c}:{d:e[s].d,v2:c},n=c;return{High:h,Low:p,Values:o}},this.computeGMMA=function(e){for(var t,a=[],r=[],n=e.length,o=[3,5,8,10,12,15,30,35,40,45,50,60],i=o.length,l=0;l<i;l++)r[l]=this.computeMovingAverageE(e,o[l]);for(l=0;l<n;l++)for(a[l]={d:e[l].d},t=0;t<12;t++)a[l]["v"+(t+1)]=r[t].Values[l].v1;return{Values:a}},this.computeAlligator=function(e,t,a,r){var n,o=[],i=e.length,l=0,s=[],c=[],d=[],u=0,h=Math.max(t,a,r);if(i<h+1||h<13)return null;for(n=0;n<t;n++)l+=v(e[n],"m"),s[n]=l/(n+1);for(u=l,n=t;n<i;n++)u=u+v(e[n],"m")-s[n-1],s[n]=u/t;for(l=0,n=0;n<a;n++)l+=v(e[n],"m"),c[n]=l/(n+1);for(u=l,n=a;n<i;n++)u=u+v(e[n],"m")-c[n-1],c[n]=u/a;for(l=0,n=0;n<r;n++)l+=v(e[n],"m"),d[n]=l/(n+1);for(u=l,n=r;n<i;n++)u=u+v(e[n],"m")-d[n-1],d[n]=u/r;for(n=h;n<i;n++)o[n]={d:e[n].d,v1:s[n-8],v2:c[n-5],v3:d[n-3]};return{Values:o}},this.computeMovingAverageHull=function(e,t,a){var r,n,o=e.length,i=Math.floor(t/2);i<1&&(i=1),(n=Math.floor(Math.sqrt(t)))<1&&(n=1);var l=this.computeMovingAverageP(e,i,a),s=this.computeMovingAverageP(e,t,a),c=[];for(r=0;r<o;r++)c[r]={d:l.Values[r].d,c:2*l.Values[r].v1-s.Values[r].v1};return{Values:this.computeMovingAverageP(c,n).Values}},this.computeMovingAverageP=function(e,t,a){var r,n,o,i,l,s=[],c=e.length;for(s[0]={d:e[0].d,v1:v(e[0],a)},r=1;r<c;r++){for(o=0,n=0;n<t&&!(r-n<0);n++)l=v(e[r-n],a),o=r<t?o+(r-n+1)*l:o+(t-n)*l;i=(n+1)*n*.5,s[r]={d:e[r].d,v1:o/i}}return{Values:s}},this.computeMovingAverageE=function(e,t,a){var r,n=[],o=e.length;n[0]={d:e[0].d,v1:v(e[0],a)};var i=v(e[0],a),l=2/(t+1),s=1-l;for(r=1;r<o;r++)i=v(e[r],a)*l+i*s,n[r]={d:e[r].d,v1:i};return{Values:n}},this.computeDoubleEMA=function(e,t,a){var r,n,o,i=this.computeMovingAverageE(e,t,a),l=[],s=i.Values.length;for(l[0]={d:i.Values[0].d,v1:i.Values[0].v1},n=i.Values[0].v1,o=2/(t+1),r=1;r<s;r++)n=i.Values[r].v1*o+n*(1-o),l[r]={d:i.Values[r].d,v1:2*i.Values[r].v1-n};return{Values:l}},this.computeTripleEMA=function(e,t,a){var r,n=this.computeMovingAverageE(e,t,a),o=[],i=n.Values.length;o[0]={d:n.Values[0].d,v1:n.Values[0].v1};var l=n.Values[0].v1,s=n.Values[0].v1,c=2/(t+1);for(r=1;r<i;r++)s=(l=n.Values[r].v1*c+l*(1-c))*c+s*(1-c),o[r]={d:n.Values[r].d,v1:3*n.Values[r].v1-3*l+s};return{Values:o}},this.computeTSI=function(e,t,a,r){var n,o,i,l,s,c,d,u,h,p,m,f,g=[],v=e.length,y=-100,b=100;if(v<a)return null;for((o=[])[0]=0,n=1;n<v;n++)o[n]=e[n].c-e[n-1].c;for(i=o[0],(l=[])[0]=i,s=2/(a+1),n=1;n<v;n++)i=o[n]*s+i*(1-s),l[n]=i;for(i=l[0],(c=[])[0]=i,d=2/(t+1),n=1;n<v;n++)i=l[n]*d+i*(1-d),c[n]=i;for(i=Math.abs(o[0]),(u=[])[0]=i,n=1;n<v;n++)i=Math.abs(o[n])*s+i*(1-s),u[n]=i;for(i=u[0],h=[],u[0]=i,n=1;n<v;n++)i=u[n]*d+i*(1-d),h[n]=i;for((p=[])[0]=0,n=1;n<v;n++)p[n]=100*c[n]/h[n];for(n=15;n<v;n++)p[n]>y&&(y=p[n]),p[n]<b&&(b=p[n]);for(m=[],i=p[0],m[0]=i,f=2/(r+1),n=1;n<v;n++)i=p[n]*f+i*(1-f),m[n]=i;for(n=0;n<15;n++)g[n]={d:e[n].d,v1:0,v2:0};for(n=15;n<v;n++)g[n]={d:e[n].d,v1:p[n],v2:m[n]};return{High:y,Low:b,Values:g}},this.computeMassIndex=function(e,t){var a,r,n,o,i,l,s,c=[],d=e.length,u=[],h=0,p=9999;if(d<9||d<t)return null;for(a=0;a<d;a++)u[a]=e[a].h-e[a].l;for(n=u[0],(o=[])[0]=n,a=1;a<d;a++)n=.2*u[a]+.8*n,o[a]=n;for(n=o[0],(i=[])[0]=n,a=1;a<d;a++)n=.2*o[a]+.8*n,i[a]=n;for(l=[],a=0;a<d;a++)l[a]=o[a]/i[a];for(s=0,a=0;a<d;a++){for(s=0,r=0;r<t;r++){if(a-r<0){s=s*t/r;break}s+=l[a-r]}s>h&&(h=s),s<p&&(p=s),c[a]={d:e[a].d,v1:s}}return{High:h,Low:p,Values:c}},this.computeRSI=function(e,t,a){var r;if(t<2)return null;var n,o,i,l,s=[],c=e.length,d=[],u=[];for(d[0]={h:0,b:0},u[0]={mmh:0,mmb:0},s[0]={d:e[0].d,v1:50},r=t-1,o=1;o<c;o++)n=v(e[o],a)-v(e[o-1],a),d[o]=0==n?{h:0,b:0}:n>0?{h:n,b:0}:{h:0,b:-1*n},i=(u[o-1].mmh*r+d[o].h)/t,l=(u[o-1].mmb*r+d[o].b)/t,u[o]={mmh:i,mmb:l},s[o]=0==l?{d:e[o].d,v1:100}:{d:e[o].d,v1:100-100/(1+i/l)};return{High:100,Low:0,Values:s}},this.computeForceIndex=function(e,t,a){var r,n,o,i=e.length,l=[],s=-9999,c=9999;for(l[0]={d:e[0].d,c:0},r=1;r<i;r++)l[r]={d:e[r].d,c:e[r].v*(v(e[r],a)-v(e[r-1],a))};for(o=(n=this.computeMovingAverageE(l,t,"c")).Values.length,r=0;r<o;r++)n.Values[r].v1>s&&(s=n.Values[r].v1),n.Values[r].v1<c&&(c=n.Values[r].v1);return{High:s,Low:c,Values:n.Values}},this.computeElderRay=function(e,t,a){var r,n,o=this.computeMovingAverageE(e,t,"c"),i=[],l=o.Values.length,s=-1e3,c=1e3;if("bear"==a)for(r=0;r<l;r++)(n=e[r].l-o.Values[r].v1)>s&&(s=n),n<c&&(c=n),i[r]={d:e[r].d,v1:n};else for(r=0;r<l;r++)(n=e[r].h-o.Values[r].v1)>s&&(s=n),n<c&&(c=n),i[r]={d:e[r].d,v1:n};return{High:s,Low:c,Values:i}},this.computeQStick=function(e,t){for(var a,r,n=[],o=-1e3,i=1e3,l=e.length,s=[],c=0;c<l;c++)s[c]=e[c].c-e[c].o;for(c=0;c<l;c++){for(a=0,r=0;r<t&&!(c-r<0);r++)a+=s[c-r];(a/=r)>o&&(o=a),a<i&&(i=a),n[c]={d:e[c].d,v1:a}}return{High:o,Low:i,Values:n}},this.computeATR=function(e,t,a){var r,n,o,i,l=[],s=0,c=9999,d=e.length,u=0,h=0,p=0,m=[];if(d<t+1)return null;for(m[0]=e[0].h-e[0].l,l[0]={d:e[0].d,v1:m[0]},r=1;r<d;r++)u=e[r].h-e[r].l,h=Math.abs(e[r-1].c-e[r].h),p=Math.abs(e[r-1].c-e[r].l),m[r]=Math.max(u,h,p);if(o=0,"ema"==a)for(o=m[0],i=2/(t+1),r=1;r<d;r++)(o=m[r]*i+o*(1-i))>s&&(s=o),o<c&&(c=o),l[r]={d:e[r].d,v1:o};if("pma"==a)for(o=m[0],r=1;r<d;r++)(o=(o*(t-1)+m[r])/t)>s&&(s=o),o<c&&(c=o),l[r]={d:e[r].d,v1:o};if("sma"==a){for(r=1;r<t;r++){for(n=0;n<=r;n++)o+=m[n];(o/=n)>s&&(s=o),o<c&&(c=o),l[r]={d:e[r].d,v1:o},o=0}for(r=t;r<d;r++){for(n=0;n<t;n++)o+=m[r-n];o/=t,l[r]={d:e[r].d,v1:o},o>s&&(s=o),o<c&&(c=o),o=0}}return{High:s,Low:c,Values:l}},this.computeEaseOfMovement=function(e,t){var a,r,n,o=[],i=0,l=999999,s=e.length,c=0,d=[];for(d[0]=0,a=1;a<s;a++)c=0!=e[a].v?((e[a].h+e[a].l)/2-(e[a-1].h+e[a-1].l)/2)/(e[a].v/(e[a].h-e[a].l)):0,d[a]=1e6*c,c=0;for(o[0]={d:e[0].d,v1:0},r=0,n=2/(t+1),a=1;a<s;a++)r=d[a]*n+r*(1-n),o[a]={d:e[a].d,v1:r},r>i&&(i=r),r<l&&(l=r);return{High:i,Low:l,Values:o}},this.computeIchimoku=function(e,t,a,r){var n,o,i,l=[],s=e.length,c=0,d=999999;if(s<2*t+1)return null;for(n=0;n<t;n++){for(o=n;o>=0;o--)e[o].h>c&&(c=e[o].h),e[o].l<d&&(d=e[o].l);l[n]={d:e[n].d,v1:(c+d)/2},c=0,d=999999}for(n=t;n<s;n++){for(o=0;o<t;o++)e[n-o].h>c&&(c=e[n-o].h),e[n-o].l<d&&(d=e[n-o].l);l[n]={d:e[n].d,v1:(c+d)/2},c=0,d=999999}for(c=0,d=999999,n=0;n<a;n++){for(o=n;o>=0;o--)e[o].h>c&&(c=e[o].h),e[o].l<d&&(d=e[o].l);l[n].v2=(c+d)/2,c=0,d=999999}for(n=a;n<s;n++){for(o=0;o<a;o++)e[n-o].h>c&&(c=e[n-o].h),e[n-o].l<d&&(d=e[n-o].l);l[n].v2=(c+d)/2,c=0,d=999999}for(n=0;n<s-t;n++)l[n].v3=e[n+t].c;for(n=t;n<s;n++)l[n].v4=(l[n-t].v1+l[n-t].v2)/2;for(i=e[s-1].d,n=0;n<t;n++)l[s+n]={d:i+(n+1)*r,v4:(l[s+n-t].v1+l[s+n-t].v2)/2};for(c=0,d=999999,n=0;n<2*t;n++){for(o=n;o>=0;o--)e[o].h>c&&(c=e[o].h),e[o].l<d&&(d=e[o].l);l[n+t].v5=(c+d)/2,c=0,d=999999}for(n=2*t;n<s;n++){for(o=0;o<2*t;o++)e[n-o].h>c&&(c=e[n-o].h),e[n-o].l<d&&(d=e[n-o].l);l[n+t].v5=(c+d)/2,c=0,d=999999}for(n=t;n<s+t;n++)l[n].v4>l[n].v5?(l[n].v6=l[n].v4,l[n].v7=l[n].v5):(l[n].v6=l[n].v5,l[n].v7=l[n].v4);return{Values:l}},this.computeKVO=function(e){var t,a,r=[],n=0,o=999999,i=e.length,l=[],s=[];for(s[0]={d:e[0].d,c:e[0].v},l[0]=(e[0].c+e[0].l+e[0].h)/3,t=1;t<i;t++)l[t]=(e[t].c+e[t].l+e[t].h)/3,s[t]=l[t]>=l[t-1]?{d:e[t].d,c:e[t].v}:{d:e[t].d,c:-1*e[t].v};var c=this.computeMovingAverageE(s,34,"c"),d=this.computeMovingAverageE(s,55,"c"),u=[];for(t=0;t<i;t++)u[t]={d:e[t].d,c:c.Values[t].v1-d.Values[t].v1},u[t].c>n&&(n=u[t].c),u[t].c<o&&(o=u[t].c);for(a=this.computeMovingAverageE(u,13,"c"),t=0;t<i;t++)r[t]={d:e[t].d,v1:u[t].c,v2:a.Values[t].v1};return{High:n,Low:o,Values:r}},this.computeMomentum=function(e,t,a){var r,n,o,i=[],l=0,s=999999,c=e.length;if(c<t+1)return null;for(o=v(e[0],a),r=0;r<t;r++)n=v(e[r],a)-o,i[r]={d:e[r].d,v1:n},n>l&&(l=n),n<s&&(s=n);for(r=t;r<c;r++)n=v(e[r],a)-v(e[r-t],a),i[r]={d:e[r].d,v1:n},n>l&&(l=n),n<s&&(s=n);return{High:l,Low:s,Values:i}},this.computeNVIPVI=function(e,t,a){var r,n,o,i=[],l=0,s=999999,c=e.length,d=1;for(i[0]={d:e[0].d,v1:d},r=1;r<c;r++)0==e[r].v?i[r]={d:e[r].d,v1:d}:(o=v(e[r-1],t),n=v(e[r],t),"nvi"==a?e[r].v<e[r-1].v?(d+=(n-o)*d/o,i[r]={d:e[r].d,v1:d}):i[r]={d:e[r].d,v1:d}:e[r].v>e[r-1].v?(d+=(n-o)*d/o,i[r]={d:e[r].d,v1:d}):i[r]={d:e[r].d,v1:d}),d>l&&(l=d),d<s&&(s=d);return{High:l,Low:s,Values:i}},this.computeWaveTrendOsc=function(e,t,a){var r,n,o,i,l,s,c,d=[],u=e.length;if(t>=u||a>u)return null;for(n=this.computeMovingAverageE(e,t,"m2"),o=[],r=0;r<u;r++)o[r]={d:e[r].d,c:Math.abs(v(e[r],"m2")-n.Values[r].v1)};for(i=this.computeMovingAverageE(o,t),l=[],r=0;r<u;r++)l[r]=0!=i.Values[r].v1?{d:e[r].d,c:(v(e[r],"m2")-n.Values[r].v1)/(.015*i.Values[r].v1)}:{d:e[r].d,c:0};for(s=this.computeMovingAverageE(l,a),c=this.computeMM(s.Values,4),r=0;r<u;r++)d[r]={d:e[r].d,v1:s.Values[r].v1,v2:c[r].vm};return{High:85,Low:-90,Values:d}},this.computeMACDZL=function(e,t,a,r){var n,o,i=[],l=0,s=999999,c=e.length;if(t>=c||a>c||r>c)return null;var d,u=this.computeDoubleEMA(e,t),h=this.computeDoubleEMA(e,a),p=[];for(n=0;n<c;n++)d=u.Values[n].v1-h.Values[n].v1,p[n]={c:d,d:u.Values[n].d},d>l&&(l=d),d<s&&(s=d);for(o=this.computeDoubleEMA(p,r),n=0;n<c;n++)i[n]={d:e[n].d,v1:p[n].c,v2:o.Values[n].v1};return{High:l,Low:s,Values:i}},this.computeMACD=function(e,t,a,r,n,o){var i,l,s,c=[],d=0,u=999999,h=e.length,p=[],m=[];if(t>=h||a>h||r>h)return null;p[0]=v(e[0],o),m[0]=v(e[0],o),s=[],(l=[])[0]=0,s[0]=0;var f,g,y=2/(t+1),b=2/(a+1),x=2/(r+1);for(i=1;i<h;i++)f=v(e[i],o),p[i]=f*y+p[i-1]*(1-y),m[i]=f*b+m[i-1]*(1-b),l[i]=p[i]-m[i],s[i]=l[i]*x+s[i-1]*(1-x);if("macd"==n)for(i=0;i<h;i++)c[i]={d:e[i].d,v1:l[i],v2:s[i]},l[i]>d&&(d=l[i]),l[i]<u&&(u=l[i]);else for(i=0;i<h;i++)g=l[i]-s[i],c[i]={d:e[i].d,v1:g},g>d&&(d=g),g<u&&(u=g);return{High:d,Low:u,Values:c}},this.computeCoppock=function(e,t,a,r,n){var o,i=0,l=999999;if(e.length<r+5)return null;var s,c=this.computeROC(e,t,null,n),d=this.computeROC(e,a,null,n),u=c.Values.length,h=[];for(o=1;o<u;o++)(s=c.Values[o].v1+d.Values[o].v1)>i&&(i=s),s<l&&(l=s),h[o]={d:c.Values[o].d,c:s};return h[0]={d:c.Values[0].d,c:h[1].c},{High:i,Low:l,Values:this.computeMovingAverageP(h,r,"c").Values}},this.computeROC=function(e,t,a,r){var n,o,i=[],l=0,s=999999,c=0,d=e.length,u=v(e[0],a);if(r)for(i[0]={d:e[0].d,v1:100},n=1;n<d;n++)(c=n-t<0?100*v(e[n],a)/u:100*v(e[n],a)/v(e[n-t],a))>l&&(l=c),c<s&&(s=c),i[n]={d:e[n].d,v1:c};else for(i[0]={d:e[0].d,v1:0},n=1;n<d;n++)n-t<0?c=100*(v(e[n],a)-u)/u:(o=v(e[n-t],a),c=100*(v(e[n],a)-o)/o),c>l&&(l=c),c<s&&(s=c),i[n]={d:e[n].d,v1:c};return{High:l,Low:s,Values:i}},this.computeSTD=function(e,t,a){for(var r,n,o=[],i=0,l=e.length,s=0,c=this.computeMovingAverage(e,t,a),d=0;d<l;d++){for(r=0;r<t&&!(d-r<0);r++)s+=(n=v(e[d-r],a)-c.Values[d].v1)*n;s=Math.sqrt(s/r),o[d]={d:e[d].d,v1:s},s>i&&(i=s),s=0}return{High:i,Low:0,Values:o}},this.computeSMI=function(e,t,a,r,n){var o,i=[],l=e.length;if(l<t+1)return null;for(var s,c=[],d=[],u=e[0].l,h=e[0].h,p=0;p<l;p++){for(s=0;s<t&&!(p-s<0);s++)e[p-s].h>h&&(h=e[p-s].h),e[p-s].l<u&&(u=e[p-s].l);d[p]={h:h,l:u},c[p]={d:e[p].d,c:e[p].c-(h+u)/2},h=0,u=999999}var m=this.computeMovingAverageE(c,a,"c"),f=this.computeMovingAverageE(m.Values,r,"v1"),g=[];for(p=0;p<l;p++)g[p]={d:e[p].d,c:d[p].h-d[p].l};var v=this.computeMovingAverageE(g,a,"c"),y=this.computeMovingAverageE(v.Values,r,"v1"),b=[];for(p=0;p<l;p++)b[p]=100*f.Values[p].v1/(y.Values[p].v1/2);for(o=0,p=0;p<l;p++){for(o=0,s=0;s<n&&!(p-s<0);s++)o+=b[p-s];i[p]={d:e[p].d,v1:b[p],v2:o/s}}return{High:110,Low:-100,Values:i}},this.computeASI=function(e){var t,a=[],r=e.length;if(r<3)return null;var n,o,i,l,s,c,d=0,u=0,h=999999;for(a[0]={d:e[0].d,v1:0},t=1;t<r;t++)i=Math.abs(e[t].h-e[t-1].c),l=Math.abs(e[t].l-e[t-1].c),s=e[t].h-e[t].l,c=Math.abs(e[t-1].c-e[t-1].o),i>l&&i>s&&(n=i-.5*l+.25*c),l>i&&l>s&&(n=l-.5*i+.25*c),s>i&&s>l&&(n=s+.25*c),null==n&&(n=s+.25*c),o=Math.max(i,l),0!=n&&(d+=(e[t].c-e[t-1].c+.5*(e[t].c-e[t].o)+.25*(e[t-1].c-e[t-1].o))/n*50*(o/300)),d>u&&(u=d),d<h&&(h=d),a[t]={d:e[t].d,v1:d};return{High:u,Low:h,Values:a}},this.computeStochRSI=function(e,t,a,r,n,o){var i,l,s,c;if(e.length<n+1||null==(l=this.computeRSI(e,n,o)))return null;for(s=[],c=l.Values.length,i=0;i<c;i++)s[i]={d:l.Values[i].d,h:l.Values[i].v1,l:l.Values[i].v1,c:l.Values[i].v1};return this.computeSTOCH(s,t,a,r)},this.computeSTOCH=function(e,t,a,r){var n,o,i=[],l=e.length,s=0,c=9999;if(l<t+1)return null;var d,u,h=[],p=e[0].l,m=e[0].h,f=m-p;for(h[0]=0!=f?100*(e[0].c-p)/f:0,d=1;d<t;d++){for(u=0;u<=d;u++)e[u].h>m&&(m=e[u].h),e[u].l<p&&(p=e[u].l);f=m-p,h[d]=0==f?0:100*(e[d].c-p)/f,m=0,p=999999}for(d=t;d<l;d++){for(u=0;u<t;u++)e[d-u].h>m&&(m=e[d-u].h),e[d-u].l<p&&(p=e[d-u].l);f=m-p,h[d]=0==f?0:100*(e[d].c-p)/f,m=0,p=999999}for(n=[],d=0;d<l;d++){for(o=0,u=0;u<a&&!(d-u<0);u++)o+=h[d-u];n[d]=o/u,n[d]>s&&(s=n[d]),n[d]<c&&(c=n[d])}for(null==r&&(r=3),d=0;d<l;d++){for(o=0,u=0;u<r&&!(d-u<0);u++)o+=n[d-u];i[d]={d:e[d].d,v1:n[d],v2:o/u}}return{High:s,Low:c,Values:i}},this.computeTRIX=function(e,t,a){var r,n,o,i,l,s=this.computeMovingAverageE(e,t,a),c=[],d=s.Values.length,u=0,h=999999;for(c[0]={d:s.Values[0].d,v1:0},n=s.Values[0].v1,(o=[])[0]=s.Values[0].v1,i=0,l=2/(t+1),r=1;r<d;r++)n=s.Values[r].v1*l+n*(1-l),o[r]=n*l+o[r-1]*(1-l),i=100*(o[r]-o[r-1])/o[r-1],c[r]={d:s.Values[r].d,v1:i},i>u&&(u=i),i<h&&(h=i);return{High:u,Low:h,Values:c}},this.computeVROC=function(e,t){var a,r,n=[],o=0,i=999999,l=e.length;if(l<=t)return null;for(a=0;a<t;a++)n[a]={d:e[a].d,v1:0};for(r=0,a=t;a<l;a++)0!=e[a].v?((r=100*e[a].v/e[a-1].v)<100&&(r*=-1),n[a]={d:e[a].d,v1:r},r>o&&(o=r),r<i&&(i=r)):n[a]={d:e[a].d,v1:0},r=0;return{High:o,Low:i,Values:n}},this.computeWILAC=function(e){var t=[],a=0,r=999999,n=e.length;t[0]={d:e[0].d,v1:0};for(var o=0,i=99999,l=0,s=1;s<n;s++)o=Math.max(e[s-1].c,e[s].h),i=Math.min(e[s-1].c,e[s].l),e[s].c==e[s-1].c?t[s]={d:e[s].d,v1:l}:e[s].c>e[s-1].c?(l=l+e[s].c-i,t[s]={d:e[s].d,v1:l}):(l=l+e[s].c-o,t[s]={d:e[s].d,v1:l}),l>a&&(a=l),l<r&&(r=l),o=0,i=99999;return{High:a,Low:r,Values:t}},this.computeKeltner=function(e,t,a,r){var n,o,i=this.computeMovingAverageE(e,t,"c"),l=[],s=i.Values.length,c=this.computeATR(e,r,"sma");if(null==c)return null;for(n=0;n<s;n++)o=a*c.Values[n].v1,l[n]={d:i.Values[n].d,v1:i.Values[n].v1+o,v2:i.Values[n].v1-o};return{Values:l}},this.computeDonchian=function(e,t){var a,r,n,o,i,l=e.length;if(l<t)return null;for(i=[],a=0;a<l;a++){for(n=0,o=999999,r=0;r<t&&!(a-r<0);r++)e[a-r].h>n&&(n=e[a-r].h),e[a-r].l<o&&(o=e[a-r].l);i[a]={d:e[a].d,v1:n,v2:o}}return{Values:i}},this.ComputeAroon=function(e,t){var a,r,n=e.length;if(n<t)return null;var o=[],i=0,l=999999,s=0,c=0;for(a=0;a<t;a++){for(r=0;r<=a;r++)e[a-r].h>i&&(i=e[a-r].h,s=r),e[a-r].l<l&&(l=e[a-r].l,c=r);o[a]={d:e[a].d,v1:(t-s)/t*100,v2:(t-c)/t*100},i=0,l=999999}for(a=t;a<n;a++){for(r=0;r<=t;r++)e[a-r].h>i&&(i=e[a-r].h,s=r),e[a-r].l<l&&(l=e[a-r].l,c=r);o[a]={d:e[a].d,v1:(t-s)/t*100,v2:(t-c)/t*100},i=0,l=999999}return{High:110,Low:-5,Values:o}},this.computeWILR=function(e,t){var a=e.length;if(a<t)return null;for(var r,n=9999999,o=0,i=[],l=0;l<t+1;l++)i[l]={d:e[l].d,v1:0};for(l=t+1;l<a;l++){for(r=0;r<t;r++)e[l-r].h>o&&(o=e[l-r].h),e[l-r].l<n&&(n=e[l-r].l);i[l]=o-n==0?{d:e[l].d,v1:0}:{d:e[l].d,v1:-100*(o-e[l].c)/(o-n)},o=0,n=999999}return{High:0,Low:-100,Values:i}},this.computeMarteau=function(e){for(var t,a,r,n=[],o=e.length,i=2;i<o;i++)null!=e[i-2]&&null!=e[i-1]&&null!=e[i]&&e[i-2].l>e[i-1].l&&e[i-1].l>e[i].l&&(t=Math.min(e[i].o,e[i].c),a=Math.max(e[i].o,e[i].c),r=t-e[i].l,(e[i].h-a)/(e[i].h-e[i].l)<.04&&r>=a-t&&n.push({i:i,d:e[i].d,v1:e[i].l,v2:0}));return{Values:n}},this.computePinces=function(e){for(var t=[],a=e.length,r=3;r<a;r++)null!=e[r-3]&&null!=e[r-2]&&null!=e[r-1]&&null!=e[r]&&(e[r-3].h<e[r-2].h&&e[r-2].h<e[r-1].h&&100*Math.abs(1-e[r-1].h/e[r].h)<.05&&t.push({i:r,d:e[r-1].d,v1:0,v2:e[r].h}),e[r-3].l>e[r-2].l&&e[r-2].l>e[r-1].l&&100*Math.abs(1-e[r-1].l/e[r].l)<.05&&t.push({i:r,d:e[r-1].d,v1:e[r].l,v2:0}));return{Values:t}},this.computeMarubozu=function(e){for(var t,a,r=[],n=e.length,o=1;o<n;o++)null!=e[o]&&Math.abs(100*(e[o].c-e[o].o)/e[o].c)>1.2&&(t=Math.abs(100*(e[o].l-e[o].o)/e[o].c),a=Math.abs(100*(e[o].h-e[o].c)/e[o].c),t<.05&&a<.05&&r.push({i:o,d:e[o-1].d,v1:0,v2:e[o].h}),t=Math.abs(100*(e[o].l-e[o].c)/e[o].c),a=Math.abs(100*(e[o].h-e[o].o)/e[o].c),t<.05&&a<.05&&r.push({i:o,d:e[o-1].d,v1:e[o].l,v2:0}));return{Values:r}},this.computeSoldiers=function(e){for(var t=[],a=e.length,r=3;r<a;r++)if(null!=e[r-2]&&null!=e[r-1]&&null!=e[r])if(e[r-2].c<e[r-1].c&&e[r-1].c<e[r].c){if(e[r-2].o<e[r-1].o&&e[r-1].o<e[r].o&&e[r-2].h<e[r-1].h&&e[r-1].h<e[r].h){if(e[r-2].c-e[r-2].o<=0||e[r-1].c-e[r-1].o<=0||e[r].c-e[r].o<=0)continue;t.push({i:r,d:e[r-1].d,v1:0,v2:e[r].h})}}else if(e[r-2].c>e[r-1].c&&e[r-1].c>e[r].c&&e[r-2].o>e[r-1].o&&e[r-1].o>e[r].o&&e[r-2].l>e[r-1].l&&e[r-1].l>e[r].l){if(e[r-2].c-e[r-2].o>=0||e[r-1].c-e[r-1].o>=0||e[r].c-e[r].o>=0)continue;t.push({i:r,d:e[r-1].d,v1:e[r].l,v2:0})}return{Values:t}},this.computePendu=function(e){for(var t,a,r,n=[],o=e.length,i=2;i<o;i++)null!=e[i-2]&&null!=e[i-1]&&null!=e[i]&&e[i-2].h<e[i-1].h&&e[i-1].h<e[i].h&&(t=Math.min(e[i].o,e[i].c),a=Math.max(e[i].o,e[i].c),r=t-e[i].l,(e[i].h-a)/(e[i].h-e[i].l)<.04&&r>=a-t&&n.push({i:i,d:e[i-1].d,v1:0,v2:e[i].h}));return{Values:n}},this.computeHarami=function(e){for(var t=[],a=e.length,r=1;r<a;r++)null!=e[r-1]&&null!=e[r]&&(e[r].l>e[r-1].c&&e[r].h<e[r-1].o&&e[r-1].o>e[r-1].c?t.push({i:r,d:e[r-1].d,v1:e[r].l,v2:0}):e[r].l>e[r-1].o&&e[r].h<e[r-1].c&&e[r-1].o<e[r-1].c&&t.push({i:r,d:e[r-1].d,v1:0,v2:e[r].h}));return{Values:t}},this.computeEnglobante=function(e){for(var t=[],a=e.length,r=1;r<a;r++)null!=e[r-1]&&null!=e[r]&&(e[r].c>e[r-1].o&&e[r].o<e[r-1].c&&e[r-1].o>e[r-1].c?t.push({i:r,d:e[r].d,v1:e[r].l,v2:0}):e[r].c<e[r-1].o&&e[r].o>e[r-1].c&&e[r-1].o<e[r-1].c&&t.push({i:r,d:e[r].d,v1:0,v2:e[r].h}));return{Values:t}},this.computeGAP=function(e){for(var t=[],a=e.length,r=1;r<a;r++)null!=e[r-1]&&null!=e[r]&&(e[r-1].h<e[r].l?t.push({i:r,d:e[r].d,v1:e[r-1].l,v2:0}):e[r-1].l>e[r].h&&t.push({i:r,d:e[r].d,v1:0,v2:e[r-1].h}));return{Values:t}},this.computeDOJI=function(e,t){var a,r=[],n=e.length,o=.05;for(t<0&&(o=.002),a=0;a<n;a++)null!=e[a]&&Math.abs(100*(e[a].o-e[a].c)/e[a].o)<o&&e[a].h>e[a].c&&e[a].l<e[a].c&&r.push({i:a,d:e[a].d,v1:e[a].l,v2:0});return{Values:r}},this.computeKEYR=function(e){for(var t=[],a=e.length,r=2;r<a;r++)if(null!=e[r-2]&&null!=e[r-1]&&null!=e[r]){if(e[r-2].h<e[r-1].h&&e[r-1].h<e[r].h){e[r].o>e[r-1].c&&e[r].c<e[r-1].l&&t.push({i:r,d:e[r].d,v1:0,v2:e[r-1].h});continue}e[r-2].l>e[r-1].l&&e[r-1].l>e[r].l&&e[r].o<e[r-1].c&&e[r].c>e[r-1].h&&t.push({i:r,d:e[r].d,v1:e[r-1].l,v2:0})}return{Values:t}},this.computePERFORMANCE=function(e,t){var a={QuoteTab:e.QuoteTab},r=[],n=0,o=9999999;r[0]=t?{d:a.QuoteTab[0].d,v1:0}:{d:a.QuoteTab[0].d,c:0};for(var i,l=0,s=a.QuoteTab.length,c=a.QuoteTab[0].c,d=1;d<s;d++)null!=(i=a.QuoteTab[d])&&(l=100*(i.c-c)/c,r[d]=t?{d:i.d,v1:l}:{d:i.d,c:l},l>n&&(n=l),l<o&&(o=l));return t?{High:n,Low:o,Values:r}:{Name:e.Name,High:n,Low:o,QuoteTab:r}},this.computeSAR=function(e,t,a){var r,n=[],o=[],i=[],l=[],s=[],c=e.length,d=0,u=0;for(i[0]=e[0].c>e[0].l,o[0]=e[0].c,l[0]=t,s[0]=e[0].c,s[1]=i[0]?e[1].l:e[0].h,l[1]=t,o[1]=l[1]*(s[1]-s[0])+s[0],i[1]=i[0]?o[1]>e[0].h:o[1]>e[0].c,r=2;r<c;r++)s[r]=i[r-1]==i[r-2]?i[r-1]?e[r].l<s[r-1]?e[r].l:s[r-1]:e[r].h>s[r-1]?e[r].h:s[r-1]:i[r-1]?e[r].l:e[r].h,l[r]=i[r-1]==i[r-2]?s[r-1]==s[r]?l[r-1]:l[r-1]<a?l[r-1]+t:a:t,o[r]=i[r-1]==i[r-2]?l[r]*(s[r]-o[r-1])+o[r-1]:l[r]*(s[r]-s[r-1])+s[r-1],i[r]=i[r-1]?o[r]>e[r].h:o[r]>e[r].l,i[r]?(d=0,u=i[r]==i[r-1]?o[r]:s[r]):(u=0,d=i[r]==i[r-1]?o[r]:s[r]),n[r]={d:e[r].d,v1:u,v2:d};return{Values:n}},this.computeMoonPhase=function(t){for(var a,r,n=[],o=t.length,i=0;i<o;i++)a=new Date(864e5*t[i].d),(r=e(new Date(a.getFullYear(),a.getMonth(),a.getDate())))>.5&&(r=1-r),n[i]={d:t[i].d,v1:2*r};return a=new Date(864e5*t[o-1].d),new Date(a.getFullYear(),a.getMonth()+1,a.getDate()),{High:1,Low:0,Values:n}},Date.prototype.getJulian=function(){return this/864e5-this.getTimezoneOffset()/1440+2440587.5}},(o=function(e){if(this.wrapperEl="#color1",this.value="#ffffff",this.onChange=function(){},this.colors=["ffaaaa","ff5656","ff0000","bf0000","7f0000","ffffff","ffd4aa","ffaa56","ff7f00","bf5f00","7f3f00","e5e5e5","ffffaa","ffff56","ffff00","bfbf00","7f7f00","cccccc","aaffaa","56ff56","00ff00","00bf00","008000","999999","aaffff","56ffff","00ffff","00bfbf","007f7f","666666","aad4ff","56aaff","007fff","005fbf","003f7f","4c4c4c","aaaaff","5656ff","0000ff","0000bf","00007f","333333","d4aaff","aa56ff","7f00ff","5f00bf","3f007f","191919","ffaaff","ff56ff","ff00ff","bf00bf","7f007f","000000"],e)for(var t in e)this[t]=e[t];this.init()}).prototype={init:function(){function e(){var t=document.querySelector(".palette");null!=t&&(t.parentNode.removeChild(t),document.removeEventListener("mousedown",e))}var t=this;this.input=document.querySelector(this.wrapperEl),this.input.style.display="none",this.wrapper=document.createElement("div"),this.wrapper.setAttribute("class","colorPicker-picker"),this.wrapper.style.backgroundColor=t.value,this.input.parentNode.insertBefore(this.wrapper,this.input.nextSibling),this.wrapper.addEventListener("mousedown",(function(a){var r,n,o,i,l;if(a.stopPropagation(),null!=(r=document.querySelector(".palette")))return"palettein"==a.target.className&&(n=window.getComputedStyle(a.target).backgroundColor,t.wrapper.style.backgroundColor=n,t.input.setAttribute("value",n),t.onChange(c(n))),r.parentNode.removeChild(r),void document.removeEventListener("mousedown",e);for((r=document.createElement("div")).setAttribute("class","palette"),i=t.colors.length,l="",o=0;o<i;o++)l=l+'<div class="palettein" style="background-color:#'+t.colors[o]+'" ></div>';r.innerHTML=l,t.wrapper.appendChild(r),document.addEventListener("mousedown",e)}))},change:function(e){this.wrapper.style.backgroundColor=e,this.input.setAttribute("value",e)}},window.ColorPicker=o,function(){var e=function(e){if(this.wrapperEl="#slidercontainer",this.value=0,this.onSlide=function(){},this.isMove=!1,e)for(var t in e)this[t]=e[t];this.init()};e.prototype={init:function(){function e(e){e.preventDefault(),u.isMove=!0,["touchmove","mousemove"].forEach((function(e){document.addEventListener(e,t)})),["touchend","mouseup"].forEach((function(e){document.addEventListener(e,a)}))}function t(e){var t,a,r;if(e.preventDefault(),u.isMove){var i=l(u.wrapper),c=s(e),d=parseInt(c.x-i.left)-20;d<0&&(d=0),d>u.width-20&&(d=u.width-20),o.style.left=d+"px",n.style.width=d+5+"px",(t=d/(u.width-20))<0&&(t=0),a=u.max-u.min,r=u.min+a*t,r=1==u.increment?Math.round(r):Math.round(r/u.increment)*u.increment,u.onSlide(r)}}function a(e){e.preventDefault(),["touchmove","mousemove"].forEach((function(e){document.removeEventListener(e,t)})),["touchend","mouseup"].forEach((function(e){document.removeEventListener(e,a)})),u.isMove=!1}var r,n,o,i,c,d,u=this;this.wrapper=document.querySelector(this.wrapperEl),(r=document.createElement("div")).setAttribute("class","sliderbar"),(n=document.createElement("div")).setAttribute("class","sliderin"),this.divIn=n,r.appendChild(n),(o=document.createElement("div")).setAttribute("class","sliderpointer"),this.divCursor=o,this.wrapper.appendChild(r),this.wrapper.appendChild(o),i=window.getComputedStyle(this.wrapper.parentNode).width,this.width=i.replace("px",""),this.min=parseFloat(this.wrapper.getAttribute("min")),this.max=parseFloat(this.wrapper.getAttribute("max")),this.increment=parseFloat(this.wrapper.getAttribute("step")),(c=this.wrapper.getAttribute("value"))&&(this.value=parseFloat(c)),(d=(u.value-this.min)/(this.max-this.min)*(this.width-20))<0&&(d=0),this.divCursor.style.left=d+"px",this.divIn.style.width=d+5+"px",["touchstart","mousedown"].forEach((function(t){u.divCursor.addEventListener(t,e)}))},set:function(e){var t=this,a=(e-t.min)/(t.max-t.min)*(t.width-20);a<0&&(a=0),t.divCursor.style.left=a+"px",t.divIn.style.width=a+5+"px"}},window.Slider=e}(),a(695),a(5591),a(8873),a(3120),a(9689),a(43),a(9826),function(e,t,a){var r="currenciesParity";function n(t,a){this.$element=e(t),this.options=e.extend({},e.fn[r].defaults,this.$element.data(),a),this._name=r,this.method="GET",this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={refreshableLoader:!1},n.prototype.instance=function(){return this},n.prototype.init=function(){var t=this;t.$selectedCurrency="EUR",t.$selectedLetter="",t.$element.find("[data-currency-change]").change((function(){var a=e(this).val().split("#");t.$selectedCurrency=a[0],t.$selectedLetter=t.$element.find("[data-brs-custom-select-letter].is-selected").data("brsCustomSelectLetter"),t.refresh()})),t.$element.find("[data-brs-custom-select-letter]").click((function(){t.$selectedLetter=e(this).data("brsCustomSelectLetter"),t.$selectedCurrency=t.$element.find("[data-currency-change]").val().split("#")[0],t.refresh()}))},n.prototype.refresh=function(){var t=this,r=t.$element.find("[data-currency-change]").data("urlCurrenciesParity");r+="/"+t.$selectedCurrency,r+=t.$selectedLetter?"/"+t.$selectedLetter:"",t.$element.find("[data-loader]").brsLoader().data("plugin_brsLoader").showLoader(),t.$element.load(r,(function(r,n,o){"error"==n&&(t.$element.find("[data-parity-table]").empty(),t.$element.find("[data-alert-parity]").find("[data-alert-text]").text("Aucune information disponible pour ces valeurs"),t.$element.find("[data-alert-parity]").data("plugin_brsAlertEffect").showAlertBox()),e(a).trigger("load",t.$element)}))}}(a(9755),window,document),a(7327),a(6699),a(2023),function(e,t,a){var r="updateUnderlying";function n(t,a){this.element=e(t),this.options=e.extend(!0,{},e.fn[r].defaults,this.element.data(),a),this._name=r,this.lastSelected=[],this.options.brsDerivUnderlyingRadio&&(this.element=this.element.find("input[type=radio]")),this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={underlyingId:void 0,underlyingElem:void 0,ajaxUrl:"",defaultOptions:[],brsDerivUnderlyingRadio:!1},n.prototype.instance=function(){return this},n.prototype.saveDefaultOptions=function(){this.options.defaultOptions=this.options.underlyingElem.contents().clone()},n.prototype.restoreDefaultOptions=function(){var t=this;this.clearSelect(),this.options.defaultOptions.each((function(){t.lastSelected.includes(this.value)?e(this).prop("selected",!0):e(this).prop("selected",!1)})),this.options.underlyingElem.html(this.options.defaultOptions),this.options.brsDerivUnderlyingRadio||this.options.underlyingElem.siblings(".c-select").children(".c-select__listbox-container").children(".c-select__textbox").children("input").val("Tous les sous-jacents")},n.prototype.setOptions=function(t){var a=[];for(var r in this.clearSelect(),t.underlyingName)""===r&&!this.options.brsDerivUnderlyingRadio||this.lastSelected.includes(r)?a.push(e('<option value="'+r+'">'+t.underlyingName[r]+"</option>").prop("selected",!0)):""!==r&&a.push(e('<option value="'+r+'">'+t.underlyingName[r]+"</option>"));var n=this.options.underlyingElem.siblings(".c-select").hasClass("is-expanded");n&&this.options.underlyingElem.selectability("closeCombobox"),this.options.underlyingElem.html(a),this.options.underlyingElem.siblings(".c-select").children(".c-select__listbox-container").children(".c-select__textbox").children("input").val(t.underlyingName[""]),n&&this.options.underlyingElem.selectability("openCombobox")},n.prototype.clearSelect=function(){var t=this.options.underlyingElem.siblings(".c-select").children(".c-select__listbox-container"),a=this;this.lastSelected=[],this.options.underlyingElem.find("option").each((function(){e(this).is(":selected")&&a.lastSelected.push(this.value)})),t.children(".c-select__textbox").children("input").val(""),t.children(".c-select__listbox").empty()},n.prototype.updateUnderlyingElem=function(){this.options.underlyingElem=e("[data-brs-deriv-underlying-target="+this.options.underlyingId+"]")},n.prototype.init=function(){this.element.trigger(r+":"),this.updateUnderlyingElem(),this.saveDefaultOptions(),this.handleTypeChange(!1);var e=this;this.element.on("change",(function(){e.handleTypeChange(!0)}))},n.prototype.handleTypeChange=function(t){var a,r,n,o=this;n=o.options.brsDerivUnderlyingRadio?(a=o.element.filter(":checked"))&&""!==a.val()&&a.is(":checked"):(a=e(o.element).children("option:selected"))&&""!==a.val(),a&&(o.options.underlyingElem.prop("disabled","disabled"),n?(r=o.options.brsDerivUnderlyingRadio?a.siblings("label").text().trim():a.text(),e.ajax({url:o.options.ajaxUrl,method:"GET",data:{underlyingType:r}}).done((function(e){o.setOptions(JSON.parse(e)),o.options.underlyingElem.prop("disabled",!1),t&&o.options.underlyingElem.trigger("change")})).catch((function(e){o.restoreDefaultOptions(),o.options.underlyingElem.prop("disabled",!1),t&&o.options.underlyingElem.trigger("change")}))):(o.restoreDefaultOptions(),o.options.underlyingElem.prop("disabled",!1),t&&o.options.underlyingElem.trigger("change")))}}(a(9755),window,document),function(e,t,a){var r="brsOrderframeBroker";function n(a,n){this.$element=e(a),this.options=e.extend({},e.fn[r].defaults,this.$element.data(),n),this._name=r,e(t).on("brsOrderframeBroker:launch",this.init)}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={},n.prototype.instance=function(){return this},n.prototype.init=function(t,a){var r=null,n=e("[data-brs-order-frame-app-id]"),o=n.parents("[data-off-canvas]").data("plugin_brsOffCanvas");o.open(),void 0===n.data("plugin_brsOrderFrame")&&((r=o.$element.find("[data-off-canvas-content]").brsLoader().data("plugin_brsLoader")).showLoader(),n.on("brsOrderFrame:loaded",(function(e,t){r.hideLoader(),t.getApp().on("exit:app",(function(){o.close()}))})),n.brsOrderFrame()),n.data("plugin_brsOrderFrame").appCommand("goToOrder",a)}}(a(9755),window,document),a(9575),a(8309),a(2472),a(2990),a(8927),a(3105),a(5035),a(4345),a(7174),a(2846),a(4731),a(7209),a(6319),a(8867),a(7789),a(3739),a(9368),a(4483),a(2056),a(3462),a(678),a(7462),a(1994),a(5021),a(2974),a(5016),a(2564),function(e,t,a){var r="brsQuoteChart";function n(t,a){this.element=e(t),this.options=e.extend({},e.fn[r].defaults,a),this._name=r,this.init(a)}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={elements:{pointerMenu:"[data-brs-quote-chart-pointer-menu]",periodMenu:"[data-brs-quote-chart-period-menu]",indicatorMenu:"[data-brs-quote-chart-indicator-menu]",styleMenu:"[data-brs-quote-chart-style-menu]",newsMenu:"[data-brs-quote-chart-news-menu]",saveMenu:"[data-brs-quote-chart-save-menu]",drawMenu:"[data-brs-quote-chart-draw-menu]",indicatorBtn:"[data-brs-quote-chart-indicator-btn]",periodBtn:"[data-brs-quote-chart-period-btn]",pointerBtn:"[data-brs-quote-chart-pointer-btn]",saveBtn:"[data-brs-quote-chart-save-btn]",shareBtn:"[data-brs-quote-chart-share-btn]",styleBtn:"[data-brs-quote-chart-style-btn]",newsBtn:"[data-brs-quote-chart-news-btn]",drawBtn:"[data-brs-quote-chart-draw-btn]",drawListBtn:"[data-brs-quote-chart-draw-list-btn]",fullscreenBtn:"[data-brs-quote-chart-fullscreen-btn]",bigFullscreenBtnContainer:"[data-brs-quote-chart-fullscreen-big-btn-container]",fullFeatures:"[data-brs-quote-chart-full-feature]",quickCommands:"[data-brs-quote-chart-quick-commands]",bigFullscreenBtn:"[data-brs-quote-chart-fullscreen-big-btn]",eodContainer:"[data-brs-quote-chart-eod-container]",durations:"[data-brs-quote-chart-durations]",commands:"[data-brs-quote-chart-commands]",compareTrigger:"[data-brs-quote-chart-compare-trigger]",settingsTrigger:"[data-brs-quote-chart-settings-trigger]",saveDrawingTrigger:"[data-brs-quote-chart-save-drawing-trigger]",indexCompareBtn:"[data-brs-quote-chart-index-compare]",symbolCompareBtn:"[data-brs-quote-chart-symbol-compare]",twoSymbolsCompareBtn:"[data-brs-quote-chart-two-symbols-compare]",compareFirstSymbol:"[data-brs-quote-chart-compare-first-symbol]",compareSecondSymbol:"[data-brs-quote-chart-compare-second-symbol]",sectorCompareBtn:"[data-brs-quote-chart-sector-compare]",orderBtn:"[data-brs-quote-chart-order-btn]",compareBtn:"[data-brs-quote-chart-compare-btn]",settingsBtn:"[data-brs-quote-chart-settings-btn]",saveImageAsBtn:"[data-brs-quote-chart-save-image-as-btn]",downloadBtn:"[data-brs-quote-chart-download-btn]",orderBtnGroup:"[data-brs-quote-chart-order-btn-group]",orderSendBtn:"[data-brs-quote-chart-order-send-btn]",orderQuantity:"[data-brs-quote-chart-order-quantity]",orderLevel:"[data-brs-quote-chart-order-level]",orderType:"[data-brs-quote-chart-order-type]",infoArea:"[data-brs-quote-chart-info-area]",showFiveDaysLink:"[data-brs-show-five-days]",hideFiveDaysLink:"[data-brs-hide-five-days]",fiveDaysHistory:"[data-brs-five-days-history]",fiveDaysBlock:"[data-brs-five-days-block]",templateSelect:"[data-brs-quote-chart-template]",templateForm:"[data-brs-quote-chart-template-form]",templateInputName:"[data-brs-quote-chart-template-input-name]",templateSaveBtn:"[data-brs-quote-chart-template-save]",templateSaveSuccess:"[data-brs-quote-chart-template-save-success]",templateSaveFailure:"[data-brs-quote-chart-template-save-failure]",templateDeleteBtn:"[data-brs-quote-chart-template-delete]",templateDeleteSuccess:"[data-brs-quote-chart-template-delete-success]",templateSaveListBtn:"[data-brs-quote-chart-template-list-save]",templateTable:"[data-brs-quote-chart-template-table]",defaultTemplateRadio:"[data-brs-quote-chart-default-template-radio]",noTemplateAlert:"[data-brs-quote-chart-no-template-alert]",drawingSelect:"[data-brs-quote-chart-drawing]",drawingForm:"[data-brs-quote-chart-drawing-form]",drawingInputName:"[data-brs-quote-chart-drawing-input-name]",openDrawingSaveBtn:"[data-brs-quote-chart-open-drawing-save]",drawingSaveBtn:"[data-brs-quote-chart-drawing-save]",drawingSaveSuccess:"[data-brs-quote-chart-drawing-save-success]",drawingSaveWarning:"[data-brs-quote-chart-drawing-save-warning]",drawingSaveFailure:"[data-brs-quote-chart-drawing-save-failure]",drawingDeleteBtn:"[data-brs-quote-chart-drawing-delete]",drawingDeleteSuccess:"[data-brs-quote-chart-drawing-delete-success]",drawingSaveListBtn:"[data-brs-quote-chart-drawing-list-save]",drawingTable:"[data-brs-quote-chart-drawing-table]",drawingExistsAlert:"[data-brs-quote-chart-drawing-exists-alert]"},stickyMarketValue:"[data-sticky-market-value]",stickyMarketValueBreakPoint:1e3,fullscreenBackground:"[data-fullscreen-background]",rchartMobileMaxWidth:767},n.prototype.instance=function(){return this},n.prototype.init=function(r){var n=this;this.VGP=r.VGP,Object.keys(this.options.elements).forEach((function(t){n["$"+t]=e(n.element).find(n.options.elements[t])})),this.$pointerMenuItem=this.$pointerMenu.find("[data-pointer]"),this.$periodMenuItem=this.$periodMenu.find("[data-period]"),this.$styleMenuItem=this.$styleMenu.find("[data-style]"),this.$newsMenuItem=this.$newsMenu.find("[data-news-type]"),this.$mainIndicatorItem=this.$indicatorMenu.find("[data-main-indicator]"),this.$secondaryIndicatorItem=this.$indicatorMenu.find("[data-secondary-indicator]"),this.$detectIndicatorItem=this.$indicatorMenu.find("[data-detect-indicator]"),this.$stickyMarketValue=e(this.options.stickyMarketValue),this.stickyMarketValueBreakPoint=this.options.stickyMarketValueBreakPoint,this.$fullscreenBackground=e(this.options.fullscreenBackground),this.rchartMobileMaxWidth=this.options.rchartMobileMaxWidth,this.isFullscreen=!1,this.resizeChart=r.resizeChart||!0,this.defaultTemplate=r.defaultTemplate,this.candleTemplate=r.candleTemplate,this.lineTemplate=r.lineTemplate,this.barcolorTemplate=r.barcolorTemplate,this.userTemplates=[],this.userTemplatesToDelete=[],this.selectedDefaultTemplate=void 0,this.userDrawings=[],this.userDrawingsToDelete=[],this.currentUserTemplate="",this.currentUserDrawing=void 0,this.showDrawing=r.showDrawing,this.quoteDownloadUrl="",this.isCanvasSupported()&&(this.VGP.graph=new RODGraph({callID:this.$eodContainer.attr("id"),symbol:this.VGP.symbol}),this.VGP.userID="42",r.enableRemoteSave?e.when(e.ajax(n.VGP.urlWS+"template"),e.ajax(n.VGP.urlWS+"drawing")).done((function(e,t){for(var a=e[0],r=0;r<a.length;r++){var o={Layers:a[r].Layers,Parametres:a[r].Parametres,isDefault:parseInt(a[r].isDefault)};n.userTemplates[a[r].configname]=o,a[r].isDefault&&(n.currentUserTemplate=o)}var i=t[0];for(r=0;r<i.length;r++){var l={name:i[r].name,symbol:i[r].symbol,instrumentName:i[r].instrumentName};VGP.drawings[i[r].symbol]=0,n.userDrawings.push(l),i[r].symbol===VGP.symbol&&(n.toggleDrawingExistsAlert(),n.currentUserDrawing={Symbol:VGP.symbol,Traces:i[r].content,Parametres:i[r].parameters,Layers:i[r].layers})}n.loadChart()})).fail((function(){n.loadChart()})):this.loadChart()),e("body").on("touchmove",(function(){n.VGP.dragging=!0})),e("body").on("touchstart",(function(){n.VGP.dragging=!1})),this.resizeChart&&e(t).on("resize",(function(){n.isFullscreen?n.enterFullscreen():n.resize()})),this.$fullscreenBtn.bind(this.VGP.clickHandler,(function(e){e.preventDefault(),n.isFullscreen?n.leaveFullscreen():n.enterFullscreen()})),this.$bigFullscreenBtn.bind(this.VGP.clickHandler,(function(e){n.leaveFullscreen()})),e(".navig_trace li").bind(this.VGP.clickHandler,(function(t){t.preventDefault(),t.stopPropagation();var a=e(this),r=a.data("drawingTool");if(!r)return!1;try{n.selectDrawingTool(r)}catch(t){console.error(t)}if("e"!==r&&"hst"!==r){var o=a.data("icon");n.$drawBtn.removeClass().addClass("spg eod_b3 eodi_oblic tipt "+o+" c-quote-chart__menu-button")}n.closeMenus()})),this.$periodBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$periodMenu)})),this.$styleBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$styleMenu)})),this.$newsBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$newsMenu)})),this.$pointerBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$pointerMenu)})),this.$indicatorBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$indicatorMenu)})),this.$saveBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$saveMenu)})),this.$drawBtn.bind(this.VGP.clickHandler,(function(t){if(n.endEraser(),t.preventDefault(),n.stopFunctions())return!1;n.closeToolsParams();try{n.selectDrawingTool(e(this).attr("name"))}catch(t){console.error(t)}})),this.$pointerMenuItem.bind(this.VGP.clickHandler,(function(t){t.preventDefault(),t.stopPropagation();var a=e(this).data("pointer");if(a){var r=e(this).data("pointerIcon");try{0!=n.VGP.graph.tools_menu(a)&&e(this).parent().parent().removeClass().addClass("spg eod_b2 tipt "+r+" c-quote-chart__menu-button")}catch(t){console.error(t)}n.closeMenus()}})),this.$periodMenuItem.bind(this.VGP.clickHandler,(function(t){t.preventDefault(),t.stopPropagation();var a=e(this).data("period");if(void 0!==a){try{n.VGP.graph.period_menu(a)}catch(t){console.error(t)}n.updateDownloadLink(a),n.closeMenus()}})),this.$styleMenuItem.bind(this.VGP.clickHandler,(function(t){t.preventDefault(),t.stopPropagation();var a=e(this).data("style");if(a){"candle"===a?n.applyTemplate(n.candleTemplate):"line"===a?n.applyTemplate(n.lineTemplate):"barcolor"===a&&n.applyTemplate(n.barcolorTemplate),n.applyStyle(a);var r=e(this).data("styleIcon");n.$styleBtn.filter(".c-quote-chart__menu-button").removeClass().addClass("spg eod_b2 tipt "+r+" c-quote-chart__menu-button"),n.$styleBtn.filter(".c-quote-chart__quick-command").removeClass().addClass("spg eod_b2 tipt "+r+" c-quote-chart__quick-command c-quote-chart__quick-command--style"),n.closeMenus()}})),this.$newsMenuItem.bind(this.VGP.clickHandler,(function(t){t.preventDefault(),t.stopPropagation();var a=e(this).data("newsType");if(a){var r=n.VGP.graph.get_parametres().newsConfig;if(e(this).hasClass("is-selected")){e(this).removeClass("is-selected"),null!=r&&-1!==r.indexOf(a)&&r.splice(r.indexOf(a),1);try{n.VGP.graph.setNews(r)}catch(t){console.error(t)}}else{e(this).addClass("is-selected"),null==r?(r=[]).push(a):-1===r.indexOf(a)&&r.push(a);try{n.VGP.graph.setNews(r)}catch(t){console.error(t)}}n.closeMenus()}})),this.$compareBtn.bind(this.VGP.clickHandler,(function(e){if(n.endEraser(),e.preventDefault(),n.closeMenus(),n.getChartParameters(),n.closeToolsParams(),n.stopFunctions())return!1;n.$compareTrigger.click()})),this.$settingsBtn.bind(this.VGP.clickHandler,(function(e){if(n.endEraser(),e.preventDefault(),n.closeMenus(),n.closeToolsParams(),n.stopFunctions())return!1;n.initSettingsPopin(),n.$settingsTrigger.click()})),this.$drawListBtn.bind(this.VGP.clickHandler,(function(e){n.openMenu(e,n.$drawMenu)})),e(".eodi_zoom").bind(this.VGP.clickHandler,(function(e){e.preventDefault();try{n.VGP.graph.tools_menu("z")}catch(e){console.error(e)}})),e(".eodi_zp").bind(this.VGP.clickHandler,(function(e){e.preventDefault();try{n.VGP.graph.zoom(!0)}catch(e){console.error(e)}})),e(".eodi_zm").bind(this.VGP.clickHandler,(function(e){e.preventDefault();try{n.VGP.graph.zoom(!1)}catch(e){console.error(e)}})),e("[data-brs-quote-chart-duration-length]").on("click",(function(){n.selectDuration(e(this)),n.changeDuration(e(this).data("brs-quote-chart-duration-length"))})),this.$showFiveDaysLink.on("click",(function(){n.$fiveDaysHistory.removeClass("u-hidden"),n.$showFiveDaysLink.addClass("u-hidden"),n.$hideFiveDaysLink.removeClass("u-hidden")})),this.$hideFiveDaysLink.on("click",(function(){n.$fiveDaysHistory.addClass("u-hidden"),n.$showFiveDaysLink.removeClass("u-hidden"),n.$hideFiveDaysLink.addClass("u-hidden")})),this.$templateSaveBtn.on("click",(function(){if(n.$templateInputName.get(0).checkValidity()){var e=n.$templateInputName.val().toUpperCase(),t=Object.keys(n.userTemplates).length;if(!n.userTemplates[e]&&t>=5)return n.$templateSaveFailure.removeClass("u-hidden"),void setTimeout((function(){n.$templateSaveFailure.addClass("u-hidden")}),3e3);n.$templateSaveBtn.prop("disabled",!0);try{VGP.graph.saveTemplate(e)}catch(e){console.error(e)}n.$noTemplateAlert.hide(),setTimeout((function(){n.$templateSaveBtn.prop("disabled",!1)}),1e3),n.$templateSaveSuccess.removeClass("u-hidden"),setTimeout((function(){n.$templateSaveSuccess.addClass("u-hidden"),n.refreshTemplate(e)}),3e3)}})),this.$templateDeleteBtn.on("click",(function(){var t=String(e(this).data("templateName"));t&&n.prepareDeleteTemplate(t)})),this.$templateSaveListBtn.on("click",(function(){n.$templateSaveListBtn.prop("disabled",!0);for(var e=0;e<n.userTemplatesToDelete.length;e++)n.deleteTemplate(n.userTemplatesToDelete[e]);n.userTemplatesToDelete=[],setTimeout((function(){n.$templateSaveListBtn.prop("disabled",!1),n.$templateDeleteSuccess.removeClass("u-hidden"),setTimeout((function(){n.$templateDeleteSuccess.addClass("u-hidden")}),3e3),null!=n.selectedDefaultTemplate&&(n.changeDefaultTemplate(n.selectedDefaultTemplate,(function(){location.reload()})),n.selectedDefaultTemplate=void 0)}),1e3)})),this.$templateSelect.on("click",(function(){n.selectTemplate(e(this).data("templateName"))})),this.$defaultTemplateRadio.on("change",(function(){n.selectedDefaultTemplate=e(this).data("templateName")})),this.$openDrawingSaveBtn.on("click",(function(){var e=n.getChartParameters();e&&!e.isIntraday?n.$saveDrawingTrigger.click():t.DisplayAlert("Les sauvegardes d'analyses techniques ne sont pas possibles en mode intraday (1 et 5 jours)")})),this.$drawingSelect.on("click",(function(){n.selectDrawing(e(this).data("drawingName"))})),this.$drawingSaveBtn.on("click",(function(){if(n.$drawingInputName.get(0).checkValidity()){for(var t=n.$drawingInputName.val().toUpperCase(),a=n.userDrawings.length,r=!1,o=0;o<a;o++)if(n.userDrawings[o].symbol===n.VGP.symbol){r=!0,n.userDrawings[o].name=t;break}if(!r&&a>=10)return n.$drawingSaveWarning.removeClass("u-hidden"),void setTimeout((function(){n.$drawingSaveWarning.addClass("u-hidden")}),3e3);n.$drawingSaveBtn.prop("disabled",!0);try{var i=n.VGP.graph.saveTraceFull()}catch(e){return console.error(e),n.$drawingSaveFailure.removeClass("u-hidden"),setTimeout((function(){n.$drawingSaveFailure.addClass("u-hidden")}),3e3),void setTimeout((function(){n.$drawingSaveBtn.prop("disabled",!1)}),1e3)}i.name=t,n.currentUserDrawing=i,e.ajax({type:"POST",url:n.VGP.urlWS+"drawing/"+escape(n.VGP.symbol),data:JSON.stringify(i),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){n.$drawingSaveSuccess.removeClass("u-hidden"),setTimeout((function(){if(n.closePopin(),n.$drawingSaveSuccess.addClass("u-hidden"),r){var e=n.$drawingTable.find("[data-drawing-symbol='"+n.VGP.symbol+"']").parent().parent().children();e.get(0).textContent=t,e.get(2).textContent=n.formatDate(new Date),n.$drawingSelect.data("drawingName",t),n.$drawingSelect.text(t)}else n.userDrawings.push({symbol:n.VGP.symbol,name:t}),n.refreshDrawing(t,n.VGP.symbol);n.$drawingSaveBtn.prop("disabled",!1)}),3e3),setTimeout((function(){n.toggleDrawingExistsAlert()}),4e3)},error:function(){n.$drawingSaveFailure.removeClass("u-hidden"),setTimeout((function(){n.$drawingSaveFailure.addClass("u-hidden")}),3e3),setTimeout((function(){n.$drawingSaveBtn.prop("disabled",!1)}),1e3)}})}})),this.$drawingDeleteBtn.on("click",(function(){n.prepareDeleteDrawing(e(this).data("drawingSymbol"))})),this.$drawingSaveListBtn.on("click",(function(){n.$drawingSaveListBtn.prop("disabled",!0);for(var e=0;e<n.userDrawingsToDelete.length;e++)n.deleteDrawing(n.userDrawingsToDelete[e]);n.userDrawingsToDelete=[],setTimeout((function(){n.$drawingSaveListBtn.prop("disabled",!1),n.$drawingDeleteSuccess.removeClass("u-hidden"),setTimeout((function(){n.$drawingDeleteSuccess.addClass("u-hidden")}),3e3)}),1e3)})),this.$mainIndicatorItem.bind(this.VGP.clickHandler,(function(a){if(a.stopPropagation(),a.preventDefault(),!n.VGP.dragging){var r=e(this).data("mainIndicator");if(n.$indicatorMenu.hide(),"actu"===r){var o=n.getChartParameters();if(n.resizeFullScreen(),o&&o.isIntraday)return void t.DisplayAlert("Les actualités ne sont pas disponibles en intraday.")}try{n.VGP.graph.indic1_menu(r)}catch(a){console.error(a)}n.resizeFullScreen()}})),this.$secondaryIndicatorItem.bind(this.VGP.clickHandler,(function(t){if(t.stopPropagation(),t.preventDefault(),!n.VGP.dragging){var a=e(this).data("secondaryIndicator");n.$indicatorMenu.hide();try{n.VGP.graph.indics_menu(a)}catch(t){console.error(t)}}})),this.$detectIndicatorItem.bind(this.VGP.clickHandler,(function(t){if(t.stopPropagation(),t.preventDefault(),!n.VGP.dragging){var a=e(this);if(n.$indicatorMenu.hide(),a.hasClass("is-selected")){a.removeClass("is-selected");try{n.VGP.graph.removeSearch()}catch(t){console.error(t)}}else{n.$detectIndicatorItem.removeClass("is-selected"),a.addClass("is-selected");try{n.VGP.graph.addSearch(a.data("detectIndicator"))}catch(t){console.error(t)}}}})),this.$indexCompareBtn.on("click",(function(){var t=e("[data-select-comparable-index]").val();n.compare(t)})),this.$sectorCompareBtn.on("click",(function(){var t=e("[data-select-sector]").val();n.compare(t)})),this.$symbolCompareBtn.on("click",(function(){var t=e("[data-autocomplete]").data("autocompleteValue");n.compare(t)})),this.$twoSymbolsCompareBtn.on("click",(function(){var e=n.$compareFirstSymbol.val(),t=n.$compareSecondSymbol.val();n.VGP.symbol!=e?(n.VGP.symbol=e,n.VGP.graph=new RODGraph({callID:n.$eodContainer.attr("id"),symbol:n.VGP.symbol}),n.defaultTemplate.isCompare=t,n.loadChart()):n.compare(t)})),this.$orderBtn.bind(this.VGP.clickHandler,(function(t){n.endEraser(),t.preventDefault(),n.closeMenus(),n.currentOrderSide="sell",e(this).data("brsQuoteChartBuyBtn")&&(n.currentOrderSide="buy"),e(".eod_order_left").removeClass().addClass("eod_order_left "+n.currentOrderSide+"_order_left"),e(".eod_order_right").removeClass().addClass("eod_order_right "+n.currentOrderSide+"_order_right"),e(".eod_order_middle").removeClass().addClass("eod_order_middle "+n.currentOrderSide+"_order_middle");try{n.VGP.graph.order_level(n.currentOrderSide)}catch(t){console.error(t)}})),this.$orderSendBtn.bind(this.VGP.clickHandler,(function(t){if(t.preventDefault(),n.$orderQuantity.val()){var a=e("#ordertype").attr("order"),r="";"limit"===a?r="LIM":"stop"===a&&(r="STP");var o=n.$orderLevel.val()?parseFloat(n.$orderLevel.val()):void 0;n.element.trigger("order",{order:{symbol:n.VGP.symbol,side:n.currentOrderSide,quantity:parseFloat(n.$orderQuantity.val()),limPx:"LIM"===r?o:void 0,stopPx:"STP"===r?o:void 0,orderType:r}})}})),this.$shareBtn.bind(this.VGP.clickHandler,(function(a){n.endEraser(),a.preventDefault(),n.closeMenus(),n.closeToolsParams();var r=n.screenCapture();if(r){var o=n.VGP.tabCache.symbol;o||(o=n.VGP.symbol),e.ajax({type:"POST",url:n.VGP.urlWS+"SendCapture",data:'{"symbol": "'+o+'", "image": "'+r+'"}',contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){e.url&&(t.location=e.url,t.DisplayAlert("Vous allez être redirigés vers la création de votre analyse technique."))},error:function(e){e&&e.responseJSON&&e.responseJSON.errorMessage?t.DisplayAlert(e.responseJSON.errorMessage):t.DisplayAlert("Service temporairement indisponible.")}})}})),this.$saveImageAsBtn.bind(this.VGP.clickHandler,(function(r){n.endEraser(),r.preventDefault(),n.closeMenus(),n.closeToolsParams();var o=n.screenCapture();if(o){var i="analyse.png";if("function"==typeof t.navigator.msSaveBlob){for(var l=atob(o),s=new Array(l.length),c=0;c<l.length;c++)s[c]=l.charCodeAt(c);var d=new Uint8Array(s),u=new Blob([d]);t.navigator.msSaveBlob(u,i)}else{if(e("html").hasClass("lt-ie10"))return;var h=a.createElement("a"),p="data:image/png;base64,"+o;h.setAttribute("href",p),h.setAttribute("download",i),h.style.display="none",a.body.appendChild(h),h.click(),a.body.removeChild(h)}}})),this.$downloadBtn.bind(this.VGP.clickHandler,(function(e){n.endEraser(),e.preventDefault(),n.closeMenus(),n.closeToolsParams(),n.quoteDownloadUrl&&t.open(n.quoteDownloadUrl)})),e("[data-brs-quote-chart-defaultSet]").bind(VGP.clickHandler,(function(e){return e.preventDefault(),e.stopPropagation(),n.settingsReset(),n.closePopin(),!1})),e("[data-brs-quote-chart-rbaxisyleft]").change((function(){n.settingsSetAxis("left")})),e("[data-brs-quote-chart-rbaxisyright]").change((function(){n.settingsSetAxis("right")})),e("[data-brs-quote-chart-rbaxisylinear]").change((function(){n.settingsSetAxisLog(!1)})),e("[data-brs-quote-chart-rbaxisylog]").change((function(){n.settingsSetAxisLog(!0)})),e("[data-brs-quote-chart-chkSticky]").change((function(){n.settingsSetSticky(!e(this).prop("checked"))})),e("[data-brs-quote-chart-rbgridContinu]").change((function(){n.settingsSetGrid(e(this).prop("checked"))})),e("[data-brs-quote-chart-rbgridPoint]").change((function(){n.settingsSetGrid(!e(this).prop("checked"))})),e("[data-brs-quote-chart-chkGridH]").change((function(){n.settingsSetGridH(e(this).prop("checked"))})),e("[data-brs-quote-chart-chkGridV]").change((function(){n.settingsSetGridV(e(this).prop("checked"))})),e("[data-brs-quote-chart-chkEncadre]").change((function(){n.settingsSetEncadre(e(this).prop("checked"))})),e("[data-brs-quote-chart-chkIndicValues]").change((function(){n.settingsSetIndicsValues(e(this).prop("checked"))})),this.updateDownloadLink(-2)},n.prototype.loadChart=function(){this.currentUserDrawing&&this.showDrawing?(this.loadTemplate(this.currentUserDrawing,!0),this.showDrawing=!1):this.currentUserTemplate?this.loadTemplate(this.currentUserTemplate):(this.VGP.graph.loadDefautChart(this.defaultTemplate),this.refreshPeriodState(this.defaultTemplate.histoLength)),this.refreshParametersModal()},n.prototype.selectTemplate=function(e){var t=this.userTemplates[e];if(t&&t.Parametres&&t.Layers){var a=JSON.parse(t.Parametres);a.indicators||(a.indicators=[],t.Parametres=JSON.stringify(a)),this.currentUserTemplate=t,this.loadTemplate(t)}},n.prototype.reloadWith=function(e){var t=this;t.VGP.symbol=e,t.VGP.graph=new RODGraph({callID:t.$eodContainer.attr("id"),symbol:t.VGP.symbol}),t.loadChart()},n.prototype.selectDrawing=function(){if(this.currentUserDrawing)if(this.currentUserDrawing.Parametres&&this.currentUserDrawing.Layers){var t=JSON.parse(this.currentUserDrawing.Parametres),a=e("[data-brs-quote-chart-duration-length="+t.histoLength+"]");a.length>0&&this.selectDuration(a);try{this.VGP.graph.loadTemplate(this.currentUserDrawing),this.VGP.graph.readTraceFull(this.currentUserDrawing)}catch(e){console.error(e)}}else try{this.VGP.graph.readTrace(this.currentUserDrawing)}catch(e){console.error(e)}},n.prototype.loadTemplate=function(t,a){var r=JSON.parse(t.Parametres),n=e("[data-brs-quote-chart-duration-length="+r.histoLength+"]");if(n.length>0)this.selectDuration(n);else{var o=e("[data-brs-quote-chart-duration-length].is-selected").data("brsQuoteChartDurationLength");r.histoLength=o,t.Parametres=JSON.stringify(r),this.refreshPeriodState(o)}try{this.VGP.graph.loadTemplate(t)}catch(e){console.error(e)}if(!0===a)try{this.VGP.graph.readTraceFull(t)}catch(e){console.error(e)}},n.prototype.openMenu=function(e,t){this.endEraser(),e.stopPropagation(),e.preventDefault(),t.is(":visible")?t.hide():(this.closeToolsParams(),this.closeMenus(),t.show())},n.prototype.refreshTemplate=function(t){var r=this;e.ajax({type:"GET",url:this.VGP.urlWS+"template/"+escape(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){if(t){var n=!!r.userTemplates[t.configname],o=String(t.configname);if(r.userTemplates[o]={Layers:t.Layers,Parametres:t.Parametres},!n){var i=a.createElement("div");i.setAttribute("class","c-quote-chart__submenu-item"),i.setAttribute("data-brs-quote-chart-template",""),i.setAttribute("data-template-name",o),i.textContent=o,r.$saveMenu.find(".c-quote-chart__menu-title")[0].after(i),i.onclick=function(){r.selectTemplate(o)};var l=a.createElement("tr");l.setAttribute("class","c-table__row");var s=a.createElement("td");s.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),s.textContent=o;var c=r.$defaultTemplateRadio.parent().closest("td").get(0).cloneNode(!0),d=Math.floor(1e6*Math.random());c.childNodes[1].removeAttribute("checked"),c.childNodes[1].setAttribute("data-template-name",o),c.childNodes[1].setAttribute("id",d),c.childNodes[2].setAttribute("for",d),c.childNodes[2].setAttribute("title",o),c.onchange=function(){r.selectedDefaultTemplate=o};var u=a.createElement("td");u.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-right");var h=a.createElement("i");h.setAttribute("class","c-table__icon c-table__icon--right u-cursor-pointer u-color-cerulean c-icon c-icon--cross"),h.setAttribute("data-brs-quote-chart-template-delete",""),h.setAttribute("data-template-name",o),h.onclick=function(){r.prepareDeleteTemplate(o)},u.appendChild(h),l.appendChild(s),l.appendChild(c),l.appendChild(u);var p=r.$templateTable.find("tr");e(p).get(p.length-1).after(l)}}}})},n.prototype.refreshDrawing=function(t,r){var n=this,o=a.createElement("tr");o.setAttribute("class","c-table__row");var i=a.createElement("td");i.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),i.textContent=t;var l=a.createElement("td");l.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),l.textContent=e(".c-faceplate__company-link").text();var s=a.createElement("td");s.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-left"),s.textContent=n.formatDate(new Date);var c=a.createElement("td");c.setAttribute("class","c-table__cell c-table__cell--dotted u-nopadding-right");var d=a.createElement("i");d.setAttribute("class","c-table__icon c-table__icon--right u-cursor-pointer u-color-cerulean c-icon c-icon--cross"),d.setAttribute("data-brs-quote-chart-drawing-delete",""),d.setAttribute("data-drawing-name",t),d.setAttribute("data-drawing-symbol",r),d.onclick=function(){n.prepareDeleteDrawing(r)},c.appendChild(d),o.appendChild(i),o.appendChild(l),o.appendChild(s),o.appendChild(c);var u=this.$drawingTable.find("tr");e(u).get(u.length-1).after(o);var h=a.createElement("div");h.setAttribute("class","c-quote-chart__submenu-item"),h.setAttribute("data-brs-quote-chart-drawing",""),h.setAttribute("data-drawing-name",t),h.textContent=t,n.$saveMenu.find(".c-quote-chart__menu-title")[1].after(h),h.onclick=function(){n.selectDrawing(t)}},n.prototype.formatDate=function(e){var t=function(e){return e<10?"0"+e:e},a=t(e.getHours()),r=t(e.getMinutes());return"le "+t(e.getDate())+"/"+t(e.getMonth())+"/"+e.getFullYear()+" à "+a+"h"+r},n.prototype.prepareDeleteTemplate=function(e){delete this.userTemplates[e],this.userTemplatesToDelete.push(e),this.$templateTable.find("[data-template-name='"+e.replace("'","\\'")+"']").closest("tr").fadeOut()},n.prototype.deleteTemplate=function(t){var a=this;e.ajax({type:"DELETE",url:this.VGP.urlWS+"template/"+escape(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){a.$templateSelect.each((function(){e(this).data("templateName")===t&&e(this).remove()}))}})},n.prototype.changeDefaultTemplate=function(t,a){var r="",n="";t?(r="template/"+escape(t),n="PUT"):(r="template/reset-default/",n="POST"),e.ajax({type:n,url:this.VGP.urlWS+r,contentType:"application/json; charset=utf-8",dataType:"json",success:a})},n.prototype.prepareDeleteDrawing=function(e){this.userDrawingsToDelete.push(e),this.$drawingTable.find("[data-drawing-symbol="+e+"]").closest("tr").fadeOut()},n.prototype.deleteDrawing=function(t){var a=this;e.ajax({type:"DELETE",url:this.VGP.urlWS+"drawing/"+escape(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){for(var r=0;r<a.userDrawings.length;r++)if(a.userDrawings[r].symbol===t){a.userDrawings.splice(r,1);break}a.toggleDrawingExistsAlert(),a.$drawingSelect.each((function(){e(this).remove()}))}})},n.prototype.toggleDrawingExistsAlert=function(){for(var e=0;e<this.userDrawings.length;e++)if(this.userDrawings[e].symbol===this.VGP.symbol)return void this.$drawingExistsAlert.removeClass("u-hidden");this.$drawingExistsAlert.addClass("u-hidden")},n.prototype.isCanvasSupported=function(){var e=a.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},n.prototype.stopFunctions=function(e){try{var t=this.VGP.graph.get_chartType()}catch(e){return console.error(e),!1}return!(2==e&&"perf"==t||"perf"!=t&&"renko"!=t&&"line break"!=t&&"kagi"!=t)},n.prototype.closeMenus=function(){this.$pointerMenu.hide(),this.closeToolsParams(),this.$periodMenu.hide(),this.$styleMenu.hide(),this.$newsMenu.hide(),this.$indicatorMenu.hide(),this.$saveMenu.hide(),this.$drawMenu.hide()},n.prototype.selectDuration=function(t){t.hasClass("is-selected")||(e(".c-quote-chart__length.is-selected").removeClass("is-selected"),t.addClass("is-selected"),this.isFullscreen||(5==t.data("brsQuoteChartDurationLength")?(this.$fiveDaysHistory.removeClass("u-hidden"),this.$showFiveDaysLink.addClass("u-hidden"),this.$hideFiveDaysLink.removeClass("u-hidden")):(this.$fiveDaysHistory.addClass("u-hidden"),this.$showFiveDaysLink.removeClass("u-hidden"),this.$hideFiveDaysLink.addClass("u-hidden"))),this.refreshPeriodState(t.data("brsQuoteChartDurationLength")))},n.prototype.endEraser=function(){if(this.$pointerBtn.hasClass("eodi_gomme")){this.$pointerBtn.removeClass().addClass("spg eod_b2 tipt eodi_cross");try{this.VGP.graph.stopGomme()}catch(e){console.error(e)}}},n.prototype.initSettingsPopin=function(){var t=this;e(".colorPicker-palette").remove(),e(".colorPicker-picker").remove(),[{selector:"[data-brs-quote-chart-colorBK]",setColor:function(e){t.settingsSetBackColor(e)}},{selector:"[data-brs-quote-chart-colorTXT]",setColor:function(e){t.settingsSetTextColor(e)}},{selector:"[data-brs-quote-chart-colorGRID]",setColor:function(e){t.settingsSetGridColor(e)}},{selector:"[data-brs-quote-chart-colorRETIC]",setColor:function(e){t.settingsSetReticuleColor(e)}},{selector:"[data-brs-quote-chart-colorCADRE]",setColor:function(e){t.settingsSetCadreColor(e)}},{selector:"[data-brs-quote-chart-colorTRACE]",setColor:function(e){t.settingsChangeTraceColor(e)}}].forEach((function(t){var a=e(t.selector);new ColorPicker({wrapperEl:t.selector,value:a.val(),onChange:function(e){t.setColor(e),a.val(e)}})}))},n.prototype.closePopin=function(){e("[data-modal-back]").click()},n.prototype.getChartRefresh=function(){var a=this;e.ajax({type:"GET",url:this.VGP.urlWS+"UpdateCharts",data:{symbol:this.VGP.tabCache.symbol,period:this.VGP.tabCache.period},contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){if(null==e.d)return t.stopTimers(),!1;if(null!=e.d[0])if(a.VGP.tabCache.period<0)try{a.VGP.graph.updateQuoteIntraRefresh(e.d[0])}catch(e){console.error(e)}else try{a.VGP.graph.updateQuoteEODrefresh(e.d[0])}catch(e){console.error(e)}},error:function(){t.stopTimers()}})},n.prototype.enterFullscreen=function(){this.isFullscreen=!0,this.$fullscreenBackground.addClass("eod_fullscreen_background"),this.$bigFullscreenBtn.removeClass("u-hidden"),this.$fullscreenBtn.removeClass("eodi_fullscreen").addClass("eodi_fullscreenout"),this.$fullscreenBtn.attr("data-original-title","Quitter"),this.$fiveDaysBlock.hide(),this.$fullFeatures.removeClass("u-hidden"),this.$quickCommands.addClass("u-hidden"),this.resizeFullScreen(),e("[data-brs-quote-chart]").addClass("eod_fullscreen_mode");var t=this;e(a).on("click","[data-authentication-required]",(function(){t.leaveFullscreen()})),this.resize()},n.prototype.resizeFullScreen=function(){if(this.isFullscreen){var a=this.$durations.outerHeight()+this.$commands.outerHeight()+this.$infoArea.outerHeight();t.innerWidth>992&&(a+=this.$bigFullscreenBtnContainer.outerHeight()),t.innerWidth<this.stickyMarketValueBreakPoint&&(a+=this.$stickyMarketValue.outerHeight());var r=t.innerHeight-a-60;this.$eodContainer.height(r+"px"),t.innerWidth<this.stickyMarketValueBreakPoint&&e("[data-brs-quote-chart]").css({bottom:this.$stickyMarketValue.outerHeight()}),this.resize()}},n.prototype.leaveFullscreen=function(){this.isFullscreen=!1,this.$fullscreenBackground.removeClass(),this.$bigFullscreenBtn.addClass("u-hidden"),this.$fullscreenBtn.removeClass("eodi_fullscreenout").addClass("eodi_fullscreen"),this.$fullscreenBtn.attr("data-original-title","Graphique dynamique"),t.innerWidth<this.stickyMarketValueBreakPoint&&e("[data-brs-quote-chart]").css({bottom:"auto"}),this.$fiveDaysBlock.show(),this.$eodContainer.height(""),e("[data-brs-quote-chart]").removeClass("eod_fullscreen_mode"),this.$fullFeatures.addClass("u-hidden"),this.$quickCommands.removeClass("u-hidden"),this.resize()},n.prototype.resize=function(){try{this.VGP.graph.set_screenSize()}catch(e){console.error(e)}},n.prototype.closeToolsParams=function(){try{this.VGP.graph.closeToolsParams()}catch(e){console.error(e)}},n.prototype.selectDrawingTool=function(e){try{"hst"===e?(this.VGP.graph.hideShowTrace(),this.VGP.graph.tools_menu("r")):this.VGP.graph.trace_menu(e)}catch(e){console.error(e)}},n.prototype.applyStyle=function(e){try{this.VGP.graph.style_menu(e)}catch(e){console.error(e)}},n.prototype.applyTemplate=function(e){this.VGP.graph.style_menu_template(e)},n.prototype.getChartParameters=function(){try{return this.VGP.graph.get_parametres()}catch(e){console.error(e)}return null},n.prototype.screenCapture=function(){try{return this.VGP.graph.screenCapture("brs")}catch(e){console.error(e)}return null},n.prototype.updateDownloadLink=function(t){var a=e(".c-quote-chart__length.is-selected").data("brs-quote-chart-duration-length"),r=-1;t?r=t:this.VGP.CCparam.chartPeriod?r=this.VGP.CCparam.chartPeriod:this.VGP.CCparam.histoLength&&this.VGP.CCparam.histoLength>5&&(r=0),this.quoteDownloadUrl=this.VGP.urlWS+"download?length="+a+"&period="+r+"&symbol="+this.VGP.symbol},n.prototype.changeDuration=function(a){this.VGP.graph.duree_menu(a),this.updateDownloadLink(!1),e(".c-quote-chart__error").hide(),e(".eod_chart").show(),t.launchTimers()},n.prototype.compare=function(e){try{this.VGP.graph.compare(e)}catch(e){console.error(e)}this.closePopin()},n.prototype.settingsReset=function(){try{this.VGP.graph.settings_setdefaut()}catch(e){console.error(e)}this.refreshParametersModal()},n.prototype.refreshParametersModal=function(){this.VGP.CCparam=this.getChartParameters(),e("[data-brs-quote-chart-colorBK]").val(this.VGP.CCparam.set.bkcolor).change(),e("[data-brs-quote-chart-colorTXT]").val(this.VGP.CCparam.set.txtColor).change(),e("[data-brs-quote-chart-colorGRID]").val(this.VGP.CCparam.set.gridColor).change(),e("[data-brs-quote-chart-colorRETIC]").val(this.VGP.CCparam.set.reticColor).change(),e("[data-brs-quote-chart-colorCADRE]").val(this.VGP.CCparam.set.cadreColor).change(),e("[data-brs-quote-chart-colorTRACE]").val(this.settingsGetTraceColor()).change(),e("[data-brs-quote-chart-chkGridH]").prop("checked",this.VGP.CCparam.set.gridH),e("[data-brs-quote-chart-chkGridV]").prop("checked",this.VGP.CCparam.set.gridV),e("[data-brs-quote-chart-chkEncadre]").prop("checked",this.VGP.CCparam.set.isEncadre),e("[data-brs-quote-chart-chkIndicValues]").prop("checked",this.VGP.CCparam.set.indicValues),e("[data-brs-quote-chart-rbgridContinu]").prop("checked",this.VGP.CCparam.set.gridLine),e("[data-brs-quote-chart-rbgridPoint]").prop("checked",!this.VGP.CCparam.set.gridLine),e("[data-brs-quote-chart-rbaxisyright]").prop("checked",!this.VGP.CCparam.set.yaxis),e("[data-brs-quote-chart-rbaxisyleft]").prop("checked",this.VGP.CCparam.set.yaxis),e("[data-brs-quote-chart-rbaxisylinear]").prop("checked",!this.VGP.CCparam.set.semilog),e("[data-brs-quote-chart-rbaxisylog]").prop("checked",this.VGP.CCparam.set.semilog),e("[data-brs-quote-chart-chkSticky]").prop("checked",!this.VGP.CCparam.set.nosticky)},n.prototype.refreshPeriodState=function(t){t>5?this.$periodMenuItem.each((function(){e(this).data("period")<0?e(this).addClass("is-disabled"):e(this).removeClass("is-disabled")})):this.$periodMenuItem.each((function(){e(this).data("period")<0?e(this).removeClass("is-disabled"):e(this).addClass("is-disabled")}))},n.prototype.settingsSetAxis=function(e){try{this.VGP.graph.settings_setAxis(e)}catch(e){console.error(e)}},n.prototype.settingsSetAxisLog=function(e){try{this.VGP.graph.settings_setAxisLog(e)}catch(e){console.error(e)}},n.prototype.settingsSetSticky=function(e){try{this.VGP.graph.settings_setSticky(e)}catch(e){console.error(e)}},n.prototype.settingsSetGrid=function(e){try{this.VGP.graph.settings_setGridlineShow(e)}catch(e){console.error(e)}},n.prototype.settingsSetBackColor=function(e){try{this.VGP.graph.settings_setBackColor(e)}catch(e){console.error(e)}},n.prototype.settingsSetGridColor=function(e){try{this.VGP.graph.settings_setGridColor(e)}catch(e){console.error(e)}},n.prototype.settingsSetCadreColor=function(e){try{this.VGP.graph.settings_setCadreColor(e)}catch(e){console.error(e)}},n.prototype.settingsSetTextColor=function(e){try{this.VGP.graph.settings_setTextColor(e)}catch(e){console.error(e)}},n.prototype.settingsSetReticuleColor=function(e){try{this.VGP.graph.settings_setReticuleColor(e)}catch(e){console.error(e)}},n.prototype.settingsChangeTraceColor=function(e){try{this.VGP.graph.settings_setTraceColor(e)}catch(e){console.error(e)}},n.prototype.settingsGetTraceColor=function(){try{return this.VGP.graph.settings_getTraceColor()}catch(e){console.error(e)}return""},n.prototype.settingsSetGridH=function(e){try{this.VGP.graph.settings_setGridlineH(e)}catch(e){console.error(e)}},n.prototype.settingsSetGridV=function(e){try{this.VGP.graph.settings_setGridlineV(e)}catch(e){console.error(e)}},n.prototype.settingsSetIndicsValues=function(e){try{this.VGP.graph.settings_setIndicValues(e)}catch(e){console.error(e)}},n.prototype.settingsSetEncadre=function(e){try{this.VGP.graph.settings_setEncadreShow(e)}catch(e){console.error(e)}}}(a(9755),window,document),function(e,t,a){var r="brsTabsChart";function n(t,a){this.element=e(t),this.tabs=this.element.find("[data-tabs]"),this.options=e.extend({},e.fn[r].defaults,a),this._name=r,this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={},n.prototype.instance=function(){return this},n.prototype.init=function(){this.tabs.find("[data-tabs-link]").on("click",function(a){a.preventDefault(),e(e(a.currentTarget).attr("href")).css("min-height","20rem"),e(a.currentTarget).addClass("is-active"),e(e(a.currentTarget).attr("href")).addClass("is-active");var r=e(e(a.currentTarget)).attr("href"),n=e(r).find("div[id^=eod_container]")[0],o={symbol:e(n).data("brsQuoteChartSymbol"),$graph:[],urlWS:"/bourse/action/graph/ws/",saveTrace:!1,drawings:[],noCommand:!0,callType:"GET",chartSimple:!1};t.VGP=o;var i={resizeChart:!1,VGP:o,defaultTemplate:{histoLength:365,paddingTop:0,paddingLeft:0,paddingBottom:20,paddingRight:45,mainChart:{type:"line",typedef:{color2:"rgba(53,170,227,1)",color3:"rgba(51,99,160,1)",v1:!0}},indicators:[],set:{nohighlow:!0,veilleColor:"#f94aa6",veilleWidth:2,bkcolor:"rgba(0,0,0,0)",txtColor:"#000000",gridV:!1,gridH:!1,gridLine:!0,gridColor:"#263c53",cadreColor:"transparent",nosticky:!0}}};e(n).brsQuoteChart(i)}.bind(this))}}(a(9755),window,document),function(e,t,a){var r="brsHomeTabsChart";function n(t,a){this.element=e(t),this.tabFocus=0,this.$items=this.element.find("[data-brs-home-chart-tabs]"),this.options=e.extend({},e.fn[r].defaults,a),this._name=r,this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={},n.prototype.instance=function(){return this},n.prototype.init=function(){this.$items.on("click",function(e){this.selectChart(e)}.bind(this)),this.element.on("keydown",function(e){this.setKeyboardFocus(e)}.bind(this))},n.prototype.keys={enter:13,space:32,end:35,home:36,left:37,right:39},n.prototype.selectChart=function(t){var a=e(t.currentTarget),r=e("[data-homepage-chart]"),n=a.data("brsHomeChartTabs"),o=e('[data-homepage-chart="'+n+'"]');r.css("opacity",0),o.css("opacity",1),this.$items.removeClass("is-active"),this.$items.attr("aria-selected","false"),this.$items.attr("tabindex","-1"),a.addClass("is-active"),a.attr("aria-selected","true"),a.attr("tabindex","0")},n.prototype.setKeyboardFocus=function(t){if(t.keyCode===this.keys.right||t.keyCode===this.keys.left||t.keyCode===this.keys.home||t.keyCode===this.keys.end){switch(t.preventDefault(),e(this.$items[this.tabFocus]).removeClass("is-active"),e(this.$items[this.tabFocus]).attr("tabindex",-1),t.keyCode){case this.keys.right:this.tabFocus++,this.tabFocus>=this.$items.length&&(this.tabFocus=0);break;case this.keys.left:this.tabFocus--,this.tabFocus<0&&(this.tabFocus=this.$items.length-1);break;case this.keys.home:this.tabFocus=0;break;case this.keys.end:this.tabFocus=this.$items.length-1}e(this.$items[this.tabFocus]).attr("tabindex",0),e(this.$items[this.tabFocus]).addClass("is-active"),e(this.$items[this.tabFocus]).focus()}else t.keyCode!==this.keys.space&&t.keyCode!==this.keys.enter||(t.preventDefault(),this.$items.attr("aria-selected","false"),e(this.$items[this.tabFocus]).attr("aria-selected","true"),this.$items[this.tabFocus].click())}}(a(9755),window,document),a(8343),a(9600),function(e,t,a){var r="brsNewsletterSubscription";function n(t,a){this.element=e(t),this.actionUrl=this.element.attr("action"),this.$alert=e("[data-alert-newsletter]"),this.$icon=this.$alert.find("i"),this.successMessage="Votre demande a bien été prise en compte.",this.fromType=this.toType="",this.options=e.extend({},e.fn[r].defaults,e(t).data(),a),this._name=r,this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={},n.prototype.instance=function(){return this},n.prototype.init=function(){var t=this;e.fn.replaceClass=function(e,t){return this.removeClass(e).addClass(t)},this.element.on("submit",(function(a){a.preventDefault();var r=e(this);e.ajax({method:"POST",url:t.actionUrl,data:r.serialize()}).done((function(e){e.response.error?(t.fromType="success",t.toType="warning",t.$alert.find("[data-alert-text]").html(e.response.error.join("<br />"))):(t.fromType="warning",t.toType="success",t.$alert.find("[data-alert-text]").text(t.successMessage))})).fail((function(){t.fromType="success",t.toType="warning",t.$alert.find("[data-alert-text]").text("Une erreur est survenue")})).always((function(){r.addClass("o-vertical-interval-bottom"),t.$icon.replaceClass("c-icon--alert-"+t.fromType,"c-icon--alert-"+t.toType),t.$alert.replaceClass("c-alert--"+t.fromType,"c-alert--"+t.toType),t.$alert.data("plugin_brsAlertEffect").showAlertBox()}))}))}}(a(9755),window,document),a(2222),a(1249),function(e,t){function a(t,a){this.$element=e(t),this.options=e.extend({},e.fn.brsMyList.defaults,this.$element.data(),a),this._name="brsMyList",this.listDropDownListElement=e(this.$element.find(this.options.listDropDownListSelector)),this.listBodyElement=e(this.$element.find(this.options.listBodySelector)),this.listTableElement=e(this.$element.find(this.options.listTableSelector)),this.listErrorElement=e(this.$element.find(this.options.listErrorSelector)),this.listDropDownListElement&&this.listBodyElement&&this.listTableElement&&this.listErrorElement&&(this.listErrorDefaultHtml=this.listErrorElement.html(),this.init())}e.fn.brsMyList=function(t){var r=arguments;return this.each((function(){e.data(this,"plugin_brsMyList")?"string"===e.type(t)&&e.data(this,"plugin_brsMyList")[t].apply(e.data(this,"plugin_brsMyList"),Array.prototype.slice.call(r,1)):e.data(this,"plugin_brsMyList",new a(this,t))}))},e.fn.brsMyList.defaults={lastSymbolsToAdd:[],historySize:10,localStorageKey:"web_fr_portal_20.last_viwed_symbols",lastViewedSymbolsListId:"lastViewed",listRoute:"/listes/listes",listDropDownListSelector:"select",listBodySelector:".c-block__body",listTableSelector:".c-my-list__table",listErrorSelector:".c-my-list__error"},a.prototype.instance=function(){return this},a.prototype.init=function(){this.symbols=this.getFullHistory(),t.BRS_USER_CONFIG&&t.BRS_USER_CONFIG.USER_HASH&&(this.options.listRoute+="/"+t.BRS_USER_CONFIG.USER_HASH),this.options.lastSymbolsToAdd.length>0&&(this.symbols=this.symbols.concat(this.options.lastSymbolsToAdd),this.symbols.length>this.options.historySize&&(this.symbols=this.symbols.slice(-this.options.historySize)),this.saveFullHistory(this.symbols)),this.listDropDownListElement&&this.listDropDownListElement.val()===this.options.lastViewedSymbolsListId&&this.symbols.length>0&&this.loadList(this.options.lastViewedSymbolsListId,!0);var e=this;this.listDropDownListElement.change((function(){e.loadList(e.listDropDownListElement.val())}))},a.prototype.loadList=function(t,a){var r=this.options.listRoute+"?listId="+t;"lastViewed"===t&&this.symbols.length>0&&(r+="&"+this.symbols.map((function(e){return"symbols[]="+encodeURIComponent(e)})).join("&"),a&&(r+="&pageLoading=1")),this.listBodyElement.addClass("is-loading");var n=this;e.ajax({url:r}).done((function(t){var a=e(e.parseHTML(t));n.listTableElement.html(a.find(n.options.listTableSelector).html()),n.listErrorElement.html(a.find(n.options.listErrorSelector).html()),e(document).trigger("load",n.$element);var r=!a.find(n.options.listTableSelector)||!a.find(n.options.listErrorSelector).hasClass("u-hidden");n.listTableElement[r?"addClass":"removeClass"]("u-hidden"),n.listErrorElement[r?"removeClass":"addClass"]("u-hidden")})).fail((function(){n.listErrorElement.html(n.listErrorDefaultHtml),n.listErrorElement.removeClass("u-hidden"),n.listTableElement.addClass("u-hidden")})).always((function(){n.listBodyElement.removeClass("is-loading"),e("body").trigger("brsListLoaded")}))},a.prototype.saveFullHistory=function(e){t.localStorage&&t.localStorage.setItem(this.options.localStorageKey,JSON.stringify(e))},a.prototype.getFullHistory=function(){if(t.localStorage){try{var e=JSON.parse(t.localStorage.getItem(this.options.localStorageKey))}catch(e){return[]}return(e=Array.isArray(e)?e:[]).filter((function(e){return"string"==typeof e&&e.length>0}))}return[]}}(a(9755),window,document),function(e,t,a){var r="brsSelectChipsAutocomplete";function n(t,a){this.$element=e(t),this.options=e.extend({},e.fn[r].defaults,this.$element.data(),a),this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={brsChipsAutocompletePlaceholder:""},n.prototype.init=function(){this.$element.select2({formatSelection:function(e){return e.id?'<span class="c-filter is-selected">'+e.text+"</span>":e.text},containerCssClass:"c-select-chips-autocomplete",dropdownCssClass:"c-select-chips-autocomplete-dropdown",placeholder:this.options.brsChipsAutocompletePlaceholder,minimumInputLength:1,formatInputTooShort:"Saisissez un premier caractère pour commencer la recherche"})}}(a(9755),window,document);var y=a(9755);window.lang={l_cross:"RETICULE",l_pointer:"POINTEUR",l_eraser:"GOMME",l_1d:"1 JOUR",l_2d:"2 JOURS",l_5d:"5 JOURS",l_10d:"10 JOURS",l_15d:"15 JOURS",l_3m:"3 MOIS",l_6m:"6 MOIS",l_1y:"1 AN",l_2y:"2 ANS",l_5y:"5 ANS",l_10y:"10 ANS",l_15y:"15 ANS",l_20y:"20 ANS",l_25y:"25 ANS",l_1min:"1 MINUTE",l_2min:"2 MINUTES",l_5min:"5 MINUTES",l_10min:"10 MINUTES",l_15min:"15 MINUTES",l_30min:"30 MINUTES",l_1h:"1 HEURE",l_2h:"2 HEURES",l_4h:"4 HEURES",l_day:"JOUR",l_week:"HEBDO",l_month:"MENSUEL",l_area:"AIRE",l_bcc:"BAR CHART COLORÉS",l_candle:"BOUGIES",l_line:"LIGNE",l_season:"SAISONNALITÉ",l_mainind:"INDICATEURS PRINCIPAUX",l_boll:"BANDES DE BOLLINGER",l_keltner:"BANDES DE KELTNER",l_donchian:"CANAL DE DONCHIAN",l_regcurve:"COURBE REGRESSION LINEAIRE",l_regline:"DROITE REGRESSION LINEAIRE",l_envmm:"ENVELOPPE MOYENNE MOBILE",l_fievt:"EVENEMENTS FINANCIERS",l_actus:"ACTUALITES",l_mm:"MOYENNE MOBILE",l_mme:"MOYENNE MOBILE EXPO.",l_mmp:"MOYENNE MOBILE PONDEREE",l_mmt:"MOYENNE TRIANGULAIRE",l_sar:"PARABOLIQUE SAR",l_pivots:"POINTS PIVOTS",l_secind:"INDICATEURS SECONDAIRES",l_coppock:"COURBE DE COPPOCK",l_macdh:"MACD HISTOGRAMME",l_linearo:"OSCILL. REGRESSION LINEAIRE",l_moonphase:"PHASES DE LUNE",l_stoch:"STOCHASTIQUE",l_stochm:"STOCHASTIQUE MOMENTUM",l_stochr:"STOCHASTIQUE RSI",t_volume:"VOLUMES",l_fiboa:"ARCS DE FIBONACCI",l_fiboc:"CYCLES DE FIBONACCI",l_fibof:"FANIONS DE FIBONACCI",l_fiboe:"EXTENSIONS FIBONACCI",l_fibor:"RETRACEMENTS FIBONACCI",l_figures:"FIGURES",l_circle:"ELLIPSE - CERCLE",l_arrup:"FLECHE ACHAT",l_arrdw:"FLECHE VENTE",l_arrrt:"FLECHE DROITE",l_arrlt:"FLECHE GAUCHE",l_icones:"ICONES",l_arrow:"FLECHE",l_pitchf:"FOURCHETTE D'ANDREWS",l_ganng:"GRILLE DE GANN",l_ganna:"ANGLES DE GANN",l_horiz:"HORIZONTALE",l_verti:"VERTICALE",l_mesure:"MESURE",l_mesurev:"MESURE VERTICALE",l_mesureh:"MESURE HORIZONTALE",l_oblic:"OBLIQUE",l_para:"PARALLELES",l_eraseall:"TOUT EFFACER",l_detect:"DETECTIONS",l_marteau:"MARTEAUX",l_pendu:"PENDUS",l_pinces:"PINCES",l_maru:"MARUBOZU",l_soldiers:"3 SOLDATS",l_englob:"ENGLOBANTES",l_compare:"COMPARER",l_thclair:"THEME CLAIR",l_thfonce:"THEME FONCE",l_1g:"1 GRAPHIQUE",l_2g:"2 GRAPHIQUES",l_3g:"3 GRAPHIQUES",l_4g:"4 GRAPHIQUES",l_save:"Enregistrer",l_savenew:"Nouveau...",l_gerer:"Gérer",l_modeles:"Vos modèles de graphiques",l_interface:"Vos interfaces",l_modify:"Modifier",l_infos:"INFOS",l_btnlog:"Connectez-vous pour sauver vos personnalisations",l_mode:"Mode",l_duree:"Durée",l_period:"Période",l_style:"Style des cours",l_indics:"Indicateurs",l_tracet:"Outils de tracés",l_patterns:"Recherche de figures techniques",l_comparer:"Comparer avec une autre valeur",l_capture:"Capturer l'écran et partager",l_reglages:"Réglages",l_dispo:"Disposition de l'écran",l_help:"Aide en ligne",l_backt:"Stratégies",l_alert:"Alertes SMS",l_fullscreen:"Plein écran",l_save2:"Mise à jour du modèle en cours",l_savenew2:"Enregistre un nouveau modèle",l_gerer2:"Gérer vos modèles",l_save3:"Mise à jour de l'interface en cours",l_savenew3:"Enregistre une nouvelle interface",l_gerer3:"Gérer vos interfaces",l_searchsym:"Recherche valeur",l_msg1:"Vous pouvez placer 4 indicateurs au maximum sous le graphique",l_msg2:"Vous pouvez placer 6 indicateurs au maximum sous le graphique",l_msg3:"Graphique indisponible",l_msg4:"Graphique indisponible",l_ptpivot:"Points Pivots",l_fievents:"EVENEMENTS",l_mm2:"MM",l_mmt2:"MM Triang.",l_mmp2:"MM Pondérée",l_regcurve2:"LINEAR REG",l_regline2:"DROITE Reg. Lin.",l_mme2:"MM Expo",l_envmm2:"ENVELOPPE MM",l_seasonleg:"Pourcentage et performance des mois haussiers et baissiers des 10 dernières années",l_months:["Janv.","Févr.","Mars","Avril","Mai","Juin","Juill.","Août","Sept.","Oct.","Nov.","Déc."],l_up:"Hausse",l_down:"Baisse",l_moy:"Moy.",l_cours:"COURS",l_b:"B",l_m:"M",l_p:"P",l_s:"S",l_varperiod:"VAR.",l_automatic:"Automatique",l_upperb:"Seuil haut",l_lowerb:"Seuil bas",l_zone:"Zone",l_traitfi:"Trait fin",l_traitep:"Trait épais",l_moymob:"Moyenne mobile",l_datasource:'<div class="clearfix pad5">Source de données <select id="datasource"><option value="c">Clôture</option><option value="o">Ouverture</option><option value="h">Plus haut</option><option value="l">Plus bas</option><option value="m">(Haut + Bas)/2</option><option value="m2">(Haut + Bas + Clôt)/3</option><option value="m3">(Ouv + Haut + Bas + Clôt)/4</option></select></div>',l_suppindic:"Supprimer cet indicateur",l_resultat:"Résultat ",l_chifaff:"Chiffre d'affaires ",l_dividend:"Détachement dividende</b></br>Montant: ",l_split:"Division du nominal</b></br>Division par: ",l_supprimer:"Supprimer",l_dupliquer:"Dupliquer",l_createalert:"Créer une alerte",l_barres:" barres",l_jours:" jours",l_prd:"Période",l_ec:"Ecart-type",l_trace:"Tracé",l_remplis:"Remplissage",l_droitereg:"Droite régression",l_barrep:"Barre (%)",l_hausses:"Hausses",l_baisses:"Baisses",l_moyenne:"Moyenne",l_moymobile:"Moyenne mobile",l_variation:"Variation (%)",l_moymobp:"Moyenne mob. P",l_moymobe:"Moyenne mob. E",l_moymobt:"Moyenne mob. T",l_ecart:"Ecart(%)",l_coeff:"Coefficient",l_ecart2:"Ecart",l_atrperiod:"Période ATR",l_ombres:"Ombres",l_tboite:"Taille boite",l_border:"Encadrés",l_lines:"Lignes",l_histogram:"Histogramme",l_ascend:"Ascendant",l_descend:"Descendant",l_acheteur:"Acheteur",l_vendeur:"Vendeur",l_neutre:"Neutre",l_stok:"Lissage %K",l_stod:"Lissage %D",l_lissage:"Lissage",l_stochastic:"Stochastique",l_accel:"Accélération",l_lineareg:"Regression linéaire",l_nomvaleur:"Nom de valeur",l_comparewith:"Comparer cette valeur",l_indice:"Avec un indice ",l_aucun:"Aucun",l_titresect:"Avec un titre du secteur ",l_autrevaleur:"Avec une autre valeur "},window.VGP={$graph:[],clickHandler:"click",urlWS:"/bourse/action/graph/ws/",drawings:[],tabCache:[],callType:"GET",noCommand:!1},window.launchTimers=function(e,t,a){window.stopTimers(),VGP.CCparam&&VGP.CCparam.histoLength>5||(VGP.tabCache={symbol:a,period:t},VGP.timer1=setInterval((function(){y("[data-brs-quote-chart]").brsQuoteChart("getChartRefresh",{})}),3e4))},window.stopTimers=function(){clearInterval(VGP.timer1)},window.DisplayAlert=function(e,t){if(y("[data-brs-quote-chart-error] .c-alert__text").text(e),3===t||4===t){var a=function(e){var t=y(e);t&&t[0]&&t[0].getContext("2d").clearRect(0,0,t.width(),t.height())};a("#main-eod_container1"),a("#overlay-eod_container1"),a("#trace-eod_container1"),a("#rodgraph-eod_container1"),y(".eod_mainchartinfos").empty(),y(".c-quote-chart__error").show(),y(".eod_chart").hide(),window.stopTimers()}else y(".c-quote-chart__error").fadeIn(500).delay(3e3).fadeOut(500)},window.setVariationColor=function(e,t){var a="#f11c3a",r="#2cc357",n=(100*(t.l-t.o)).toFixed(1);window.VGP.shouldVariationBeInPercent?t.var<0?r=a:o="+":n<0?r=a:o="+",r="#2cc357";var o="";t.var<0?r="#f11c3a":o="+",e.each((function(e,a){y(a).css("color",r),!1===window.VGP.shouldVariationBeInPercent?y(a).children().length?y(a).children().text(o+n+" BP"):y(a).text(o+n+" BP"):y(a).children().length?y(a).children().text(o+t.var+"%"):y(a).text(o+t.var+"%")}))},window.extGetQuotesHover=function(e){if(e){var t="";if(!0===window.VGP.showPercentChartInfo&&(t+="%"),y("[data-brs-quote-chart-info-last]").length){if(y("[data-brs-quote-chart-info-last]").text(e.c+t),y("[data-brs-quote-chart-info-open]").length&&y("[data-brs-quote-chart-info-open]").text(e.o+t),y("[data-brs-quote-chart-info-high]").length&&y("[data-brs-quote-chart-info-high]").text(e.h+t),y("[data-brs-quote-chart-info-low]").length&&y("[data-brs-quote-chart-info-low]").text(e.l+t),y("[data-brs-quote-chart-info-vol]").length){var a=e.v,r=!1;a>1e5&&(a=Math.round(a/1e3),r=!0),"function"==typeof toLocaleString&&(a=a.toLocaleString(),r&&(a+=" K")),y("[data-brs-quote-chart-info-vol]").text(a)}if(y("[data-brs-quote-chart-info-var]").length){var n=y("[data-brs-quote-chart-info-var]");window.setVariationColor(n,e)}}}},window.extIndicatorsList=function(e){var t,a,r,n,o,i=document.getElementById("indicList");if(i){if(i.innerHTML="",e.ind1)for(t=0;t<e.ind1.length;t++)null!=e.ind1[t]&&((a=document.createElement("div")).setAttribute("class","c-quote-chart-info-area__indicator indicItem"),a.id="mainIndic_"+e.ind1[t].id,"compare"!==e.ind1[t].name?a.textContent=e.ind1[t].name.toUpperCase()+e.ind1[t].param:a.textContent=e.ind1[t].param,a.style.color=e.ind1[t].color,(n=document.createElement("span")).setAttribute("class","manageind1"),n.setAttribute("aria-label",e.ind1[t].name+"_"+e.ind1[t].id),a.appendChild(n),(o=document.createElement("span")).setAttribute("class","closeind1"),o.setAttribute("aria-label",e.ind1[t].name+"_"+e.ind1[t].id),a.appendChild(o),(r=document.createElement("span")).setAttribute("class","value1"),a.appendChild(r),i.appendChild(a));if(e.ind2)for(t=0;t<e.ind2.length;t++)null!=e.ind2[t]&&((a=document.createElement("div")).setAttribute("class","c-quote-chart-info-area__indicator indicItem"),a.id="secondIndic_"+e.ind2[t].id,a.textContent=e.ind2[t].name.toUpperCase()+e.ind2[t].param,a.style.color=e.ind2[t].color,(n=document.createElement("span")).setAttribute("class","manageind2"),a.appendChild(n),(o=document.createElement("span")).setAttribute("class","closeind2"),a.appendChild(o),(r=document.createElement("span")).setAttribute("class","value2"),a.appendChild(r),i.appendChild(a))}},y((function(){if(window.quoteChartTemplates){window.VGP.symbol=quoteChartTemplates.symbol,window.VGP.shouldVariationBeInPercent=!!quoteChartTemplates.shouldVariationBeInPercent,window.VGP.showPercentChartInfo=!!quoteChartTemplates.showPercentChartInfo,window.VGP.noAutoSaveTrace=!0,window.VGP.noAutoReadTrace=!0;var e={VGP:VGP,showDrawing:!!quoteChartTemplates.showDrawing,defaultTemplate:quoteChartTemplates.default,enableRemoteSave:quoteChartTemplates.enableRemoteSave,lineTemplate:quoteChartTemplates.line,candleTemplate:quoteChartTemplates.candle,barcolorTemplate:quoteChartTemplates.barcolor};y("[data-brs-quote-chart]").brsQuoteChart(e)}})),a(4386),a(5827),a(9601),a(6755);var b=a(2077),x=a(7484);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){try{b.register("locale","fr",{delimiters:{thousands:" ",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){return 1===e?"er":"e"},currency:{symbol:"€"}})}catch(e){}b.locale("fr");var t,a,r={transport:null},n=!!sessionStorage.getItem("feedStreaming:debug"),o={login:null,password:null,notificationsJwt:null,notificationsOrigin:null,bufferedRenderingLoopDelay:500,uri:(document.location+"").replace(/^http/,"ws").split("/").slice(0,3).join("/"),highlightDelay:500,restartDelay:3e3,restartLimit:10,highlightClass:"js-feed-streaming-highlight",idleThreshold:18e5,idleInBackgroundThreshold:1e4},i=!1,l={},s={},c={},d={},u=[],h=!1,p=0,m=!1,f={symbols:{}},g={},v=["ask-quantity","ask-price","ask-size","bid-quantity","bid-price","bid-size"],y=["volume","last","variation","instant-variation","currency","high","low","last-trade-datetime","last-transactions","orderbook","variation-indicator"],T=function(e){return e.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}))};e("[data-ist-last-transactions]").each((function(){var t=e(this).data("istLastTransactions");t||(t=10),e(this).on("feedstreaming:update",(function(){e(this).find("[data-ist-transaction]").slice(t).remove()}))})),r.computeLive=function(t,a){var n=l[t],o={};if(void 0!==a.last&&a.last!==n.last&&(void 0===a.factor||isNaN(parseFloat(a.factor))||(a.last*=a.factor),n.variation=(a.last-n.prevClose)/n.prevClose,n.instantVariation+=(a.last-n.last)/n.last,o.variation=n.variation,o.instantVariation=n.instantVariation,o.last=n.last=a.last,a.last>n.high&&(n.high=o.high=a.last),a.last<n.low&&(n.low=o.low=a.last)),void 0!==a.volume&&a.volume!==n.volume&&(n.volume=a.volume,o.volume=a.volume),a.tradeTime&&(n.lastTradeDatetime=a.tradeTime,o.lastTradeDatetime=x(x().format("YYYY-MM-DD ")+a.tradeTime).toDate()),a.tradeVolume&&a.tradeTime&&a.last){o.transactions=o.transactions||[];var i={tradeVolume:a.tradeVolume,lastTradeDatetime:a.tradeTime,last:a.last};o.transactions.push(i),x(n.lastTradeDatetime).format("YYYY-MM-DD HH:mm:ss")<x().format("YYYY-MM-DD ")+a.tradeTime&&(n.lastTradeDatetime=o.lastTradeDatetime=x(x().format("YYYY-MM-DD ")+a.tradeTime).toDate()),e(document).trigger("feedstreaming:newtransaction",Object.assign({symbol:t},i))}return r.computeIntraday(t,a),o},r.computeBook=function(t,a){var r=l[t],n={},o=parseInt(a.bookRow,10);return delete a.bookRow,r.orderbook.lines[o]=e.extend({},r.orderbook.lines[o],a),n.orderbook=[],n.orderbook[o]=r.orderbook.lines[o],-2==n.orderbook[o].askPrice&&(n.orderbook[o].askPrice="MX"),-2==n.orderbook[o].bidPrice&&(n.orderbook[o].bidPrice="MX"),isNaN(n.orderbook[o].askPrice)&&"MX"!==n.orderbook[o].askPrice&&delete n.orderbook[o].askPrice,isNaN(n.orderbook[o].askQuantity)&&delete n.orderbook[o].askQuantity,isNaN(n.orderbook[o].bidPrice)&&"MX"!==n.orderbook[o].bidPrice&&delete n.orderbook[o].bidPrice,isNaN(n.orderbook[o].bidQuantity)&&delete n.orderbook[o].bidQuantity,n},r.computeIntraday=function(e,t){var a,r=l[e];t.tradeTime&&(g[e]=g[e]?g[e]:{volume:0,openingLast:r.last,last:r.last,high:r.last,low:r.last,closeLast:r.last,prevClose:r.prevClose,lastTradeDatetime:null},(a=g[e]).closeLast=t.last,a.high=Math.max(a.last,a.high),a.low=Math.min(a.last,a.low),a.volume+=parseInt(t.tradeVolume,10),a.timestamp=x(t.tradeTime,"HH:mm:ss").format())},r.intradayRenderingLoop=function(){Object.keys(g).forEach((function(t){var a=g[t];delete g[t],e(document).trigger("feedstreaming:intraday",{symbol:t,intraday:a})}))},r.bufferedRendering=function(t,a){var n;return f.symbols[t]||(f.symbols[t]={transactions:[],orderbook:[]}),n=f.symbols[t],a.orderbook&&(e.extend(n.orderbook,a.orderbook),delete a.orderbook),e.extend(n,a),a.transaction&&(n.transactions.push(a.transaction),delete a.transaction,delete n.transaction),!f.isRunning&&(f.isRunning=!0,f.timeoutId=setTimeout((function(){Object.keys(f.symbols).forEach((function(e){r.render(e,f.symbols[e]),delete f.symbols[e]})),f.isRunning=!1}),o.bufferedRenderingLoopDelay),!0)},r.isConnected=function(){return!!r.socket},r.render=function(t,a){var o,i,s,c,d=l[t],u=l[t].elements;if(!d)return n&&console.error("streaming.render","Invalid data for symbol "+t),!1;if(c="0,0."+Array(d.decimals+1).join("0"),e(document).trigger("feedstreaming:render",{symbol:t,changes:a,feedData:l[t]}),o=l[t].elements,n&&console.log("instrument.render",t,a),void 0!==a.volume&&r.highlight(o.volume,a.volume,"0,0"),void 0!==a.tradeTime&&r.highlight(o.lastTradeDatetime,a.lastTradeDatetime,"0,0"),void 0!==a.last&&(r.highlight(o.last,a.last,c,{way:a.instantVariation}),a.variation<0?(o.variation.addClass("u-color-stream-down").removeClass("u-color-stream-up"),o.variationIndicator.addClass("is-negative").removeClass("is-positive")):a.variation>0?(o.variation.addClass("u-color-stream-up").removeClass("u-color-stream-down"),o.variationIndicator.addClass("is-positive").removeClass("is-negative")):(o.variation.removeClass("u-color-stream-up").removeClass("u-color-stream-down"),o.variationIndicator.removeClass("is-negative").removeClass("is-positive")),r.highlight(o.variation,a.variation,"+0.00%",{way:a.instantVariation})),void 0!==a.high&&r.highlight(o.high,a.high,c),void 0!==a.low&&r.highlight(o.low,a.low,c),a.transactions.length){if(!o.lastTransactions)return;var h,p=o.lastTransactions.find("div.data-instrument-currency-symbol"),m=a.transactions.slice(0);for(p=void 0===p?"€":p.text();i=m.shift();)n&&console.log("streaming.add_transaction",i),s=o.lastTransactions.find("tbody"),(h=s.find("[data-ist-transaction]:first").clone()).find("[data-ist-transaction-date]").html(i.lastTradeDatetime),h.find("[data-ist-transaction-volume]").html(b(i.tradeVolume).format()),h.find("[data-ist-transaction-value]").html(b(i.last).format(c)),s.prepend(h),h.addClass("js-feed-streaming-highlight"),window.setTimeout((function(){h.removeClass("js-feed-streaming-highlight")}),400),h.length&&e(document).trigger("load",h);e(document).trigger("feedstreaming:addtransactions",a.transactions),e(o.lastTransactions).trigger("feedstreaming:update",a.transactions)}return a.orderbook&&a.orderbook.length&&(r.computeSumForOrderbook(t),u.orderbook.each((function(){var t=e(this);v.forEach((function(e){var n=T(e),o=e.match(/price/i)?c:"0,0";Object.keys(a.orderbook).forEach((function(a){var i=t.find("[data-ist-orderbook-lines] tr:eq("+a+"), [data-ist-orderbook-line]:eq("+a+")");"MX"!=d.orderbook.lines[a][n]&&d.orderbook.lines[a][n]||(o=!1),r.highlight(i.find("[data-ist-"+e+"]"),d.orderbook.lines[a][n],o)})),r.highlight(t.find("[data-ist-summary-"+e+"]"),d.orderbook.summary[n],o)}))})),d.orderbook.symbol=d.symbol,e(document).trigger("feedstreaming:updateorderbook",d.orderbook),e(u.orderbook).trigger("feedstreaming:update",d.orderbook)),a.lastTradeDatetime&&r.highlight(o.lastTradeDatetime,x(a.lastTradeDatetime).format("DD/MM/YYYY HH:mm:ss")),!0},r.highlight=function(t,a,r,n){var i,l=o.highlightClass;return(n=n||{}).way>0?(l+="-up",i="buy"):n.way<0?(l+="-down",i="sell"):i="neutral",r&&(a=b(a).format(r)),n.suffix&&(a+=""+n.suffix),t.previousValue!=a&&(t.previousValue=a,e([]).add(document).add(t).trigger("feedstreaming:highlight",{elements:e(t),value:a,format:r,infos:n,changeSide:i}),t.addClass(l),window.setTimeout((function(){t.removeClass(l)}),400),t.html(a),!0)},r.stop=function(t){return"FEED_ACCESS_DENIED"===t||"NOTIFICATION_ACCESS_DENIED"===t?(a=e.Deferred(),r.isConnected()&&(i=!0,r.socket.close(),a.resolve("stop")),r.cleanup(),e(document).trigger("FEED_ACCESS_DENIED"===t?"feedstreaming:access_denied":"notificationstreaming:access_denied"),a):(console.info("streaming.stop"),a=e.Deferred(),r.isConnected()?(i=!0,r.socket.close(),a.resolve("stop")):a.resolve("connected"),r.cleanup(),a)},r.cleanup=function(){t=e.Deferred(),s={},u.forEach((function(e){e&&window.clearInterval(e)}))},r.send=function(e,t){if(!i)return n&&console.log("streaming.send",{channel:e,data:t}),r.start(!0).then((function(a,r){a.send(JSON.stringify({channel:e,user:t.connection,data:t}))}))},r.getBookChannelId=function(e){return"#book"+e.exchangeCode+"-"+e.symbol},r.getLiveChannelId=function(e){return"#live"+e.exchangeCode+"-"+e.symbol},r.joinChannel=function(e){return!s[e]&&(s[e]=!0,r.send("feed.streaming.join",{connection:r.getToken(),feed:e}),!0)},r.computeSumForOrderbook=function(e){var t=l[e].orderbook.summary,a=l[e].orderbook.lines;return Object.keys(t).forEach((function(e){t[e]=0})),a.forEach((function(e,a){Object.keys(e).forEach((function(a){t[a]+=e[a]}))})),t},r.registerInstrument=function(t,a){if((a=a||{}).symbol=t,t&&"string"==typeof t){if(l[t]=l[t]||{instantVariation:0,lastTradeDatetime:0,orderbook:{lines:[],summary:{askPrice:0,askQuantity:0,askSize:0,bidSize:0,bidQuantity:0,bidPrice:0}},transactions:[],isStreamingLive:!1,isStreamingBook:!1},l[t].elements||(l[t].elements=y.reduce((function(t,a){return t[T(a)]=e([]),t}),{})),e(document).trigger("feedstreaming:registerinstrument",a),e.each({previousClose:"prevClose",totalVolume:"volume",tradeDate:"lastTradeDatetime"},(function(e,t){a[t]=void 0!==a[e]?a[e]:a[t]})),a.exchangeCode=""+a.exchangeCode,!a.exchangeCode)throw new Error("Invalid exhangeCode",a);a.prevClose=parseFloat(a.prevClose),a.last=parseFloat(a.last),a.high=parseFloat(a.high),a.low=parseFloat(a.low),a.variation=parseFloat(a.variation),a.factor=parseFloat(a.factor),a.decimals=parseInt(a.decimals,10),a.orderbook=a.orderbook||{lines:[]};var n=function(e){v.forEach((function(t){var a=T(t);e[a]=parseFloat(e[a])}))};a.orderbook.lines.forEach((function(e){n(e)})),a.orderbook.summary&&n(a.orderbook.summary),a.orderbook=Object.assign(l[t].orderbook,a.orderbook),a.transactions=Object.assign(l[t].transactions,a.transactions),e.extend(l[t],a),r.computeSumForOrderbook(t)}else console.error("streaming","invalid symbol")},r.register=function(a,o){window.$doc=e(a||document.body),(o=o||[]).forEach||(o=Object.keys(o).map((function(e){return o[e].symbol=e,o[e]}))),o.forEach((function(e){r.registerInstrument(e.symbol,e)})),Object.keys(l).forEach((function(e){r.findListeners(window.$doc,e)})),Object.keys(l).forEach((function(e){var a=l[e];a.isStreamingLive||t.then((function(){n&&console.log("streaming.channel","start live streaming",r.getLiveChannelId(a)),a.isStreamingLive=!0,r.joinChannel(r.getLiveChannelId(a))})),!a.isStreamingBook&&a.elements.orderbook&&a.elements.orderbook.length&&t.then((function(){n&&console.log("streaming.channel","start book streaming",r.getLiveChannelId(a)),a.isStreamingBook=!0,r.joinChannel(r.getBookChannelId(a))}))}))},r.escapeSymbol=function(e){return e.replace(/[^a-z0-9A-Z]/g,"_")},r.findListeners=function(t,a){var n=l[a].elements;if(!window.$doc.data("feed-streaming:listeners:"+a)){window.$doc.data("feed-streaming:listeners:"+a,!0),t=e(t);var o=r.escapeSymbol(a);y.forEach((function(a){var r=T(a);n[r]=e.merge(e(n[r]),t.find([".ist__"+a+".ist__"+o,'[data-ist="'+o+'"] [data-ist-'+a+"]",'[data-ist="'+o+'"][data-ist-'+a+"]"].join(", ")))}))}},r.getToken=function(){return{login:o.login,password:o.password}},r.getJoinNotificationConfig=function(){return{jwt:o.notificationsJwt,origin:o.notificationsOrigin}},r.hasValidNotificationConfig=function(){return!!o.notificationsJwt&&"string"==typeof o.notificationsJwt},r.isListeningTo=function(e){return!!l[e]},r.getOptions=function(){return o},r.onMessage=function(e,t){e.startsWith("notification.amq")?r.handleNotificationStreamingMessage(e,t):r.handleFeedStreamingMessage(e,t)},r.handleFeedStreamingMessage=function(t,a){if(e(document).trigger("feedstreaming:message",{channel:t,message:a}),"feed.streaming.access_denied"===t&&this.stop("FEED_ACCESS_DENIED"),"feed.streaming.error"===t&&(e(document).trigger("feedstreaming:connection_timeout"),e(document).trigger("feedstreaming:error")),"feed.streaming.message"===t)if(r.isListeningTo(a.symbol)){if(n&&console.log("streaming.instrument.onmessage",a.symbol,a.type,a.data),"live"===a.type){var o=r.computeLive(a.symbol,a.data);r.bufferedRendering(a.symbol,o)}"book"===a.type&&(o=r.computeBook(a.symbol,a.data),r.bufferedRendering(a.symbol,o))}else n&&console.log("streaming.message.notListenedSymbol",t,":",a);else n&&console.log("streaming.message",t,":",a)},r.handleNotificationStreamingMessage=function(t,a){"notification.amq.message"===t&&e(document).trigger("notificationstreaming:message",{channel:t,message:a.message}),"notification.amq.modal"===t&&e(document).trigger("notificationstreaming:modal",a),"notification.amq.access_denied"===t&&this.stop("NOTIFICATION_ACCESS_DENIED")},r.sendMessageToRoom=function(e,t){r.start(!0).then((function(){r.send("streaming.amq.message",{route:e,message:t})}))},r.joinRoom=function(e){c[e]=!0,r.send("streaming.amq.join",{route:e})},r.joinNotifications=function(){n&&console.log("Join notifications"),this.hasValidNotificationConfig()?r.send("notification.amq.join",this.getJoinNotificationConfig()):n&&console.log("No or Invalid config: "+JSON.stringify(this.getJoinNotificationConfig()))},r.setUserIdle=function(e){(e=!!e)!==m&&(m=!!e,e&&r.isConnected()?r.stop():e||r.isConnected()||r.start())},r.restart=function(){return r.stop().then((function(){return r.start()})).then((function(){r.register()}))},r.start=function(s){var d;return d=o.uri,r.isConnected()?t:Object.keys(l).length||Object.keys(c).length||!this.has||this.hasValidNotificationConfig()||s?(u.push(window.setInterval((function(){r.intradayRenderingLoop()}),6e4)),r.socket=r.transport=new WebSocket(d,"echo-protocol"),a=e.Deferred(),o.login||o.password||500!=o.bufferedRenderingLoopDelay||(o.bufferedRenderingLoopDelay=1e3*(n?10:45)),r.socket.onerror=function(){e(document).trigger("feedstreaming:connection_error")},r.socket.onopen=function(){e(document).trigger("feedstreaming:connection_open"),e.each(l,(function(e,t){t.isStreamingBook=t.isStreamingLive=!1})),Object.keys(c).forEach((function(e){r.joinRoom(e)})),i=!1,r.socket&&(r.socket.onmessage=function(e){var a;r.debug&&console.log(e.data);try{a=JSON.parse(e.data)}catch(e){return void console.error(e)}"function"!=typeof a.forEach&&(a=[a]),a.forEach((function(e){"streaming.infos.welcome"===e.channel&&t.resolve(r.socket,e.data),r.onMessage(e.channel,e.data||e.body)}))})},r.socket.onclose=function(){e(document).trigger("feedstreaming:connection_close"),r.socket=null,i||setTimeout((function(){r.restart()}),o.restartDelay),r.cleanup(),a.resolve("closed"),e.each(l,(function(e,t){t.isStreamingLive=t.isStreamingBook=!1}))},t.then((function(){r.register(),r.joinNotifications()})),t):(n&&console.log("streaming","no feeds to listen to and no notification token, delay start"),setTimeout((function(){r.start()}),o.restartDelay),t)},r.feeds=l,r.setupIdleWatchers=function(){var e;h||(e=function(e){p=0,m&&r.setUserIdle(!1)},h=setInterval((function(){p+=1e3,(document.hidden&&p>=o.idleInBackgroundThreshold||p>=o.idleThreshold)&&r.setUserIdle(!0)}),1e3),["touchstart","touchmove","mousemove","keypress"].forEach((function(t){document.addEventListener(t,e)})),document.addEventListener("visibilitychange",(function(){document.hidden?p=0:e()}),!1))},e.feedStreaming=function(a){var i=Array.prototype.slice.call(arguments,1);switch("object"===w(a)&&(o=e.extend(o,a)),r.setupIdleWatchers(),t||(t=e.Deferred()),a){case"register":r.register.apply(null,i);break;case"feeds":return l;case"listeners":return d;case"debug":return void 0===i[0]?n:(n=!!i[0],sessionStorage.setItem("feedStreaming:debug",0+n),r);case"stop":return r.stop(),r}return r}}(a(9755));var T=a(9755);T((function(){var e=function(){},t=BRS_CONFIG.debug?console:{info:e,warn:e,log:e,trace:e,error:e},a="feedStreaming:disabled",r=!!sessionStorage.getItem(a),n=T(document).find(".c-faceplate__actions--streaming .c-switch__checkbox");if(window.WebSocket){r?n.removeAttr("checked"):n.attr("checked","checked");var o=function(){n.length?n.is(":checked")?(T.feedStreaming().start(),sessionStorage.removeItem(a)):(T.feedStreaming().stop(),sessionStorage.setItem(a,1)):r?T.feedStreaming().stop():T.feedStreaming().start()},i=function(){return BRS_USER_CONFIG.USER_HASH},l=function(){return BRS_CONFIG.JWT_TOKEN_ID},s=function(){return T.cookie(l())},c=function(e){if("string"!=typeof e)return!1;if(3!==(e=e.split(".")).length)return!1;try{e=JSON.parse(atob(e[1]))}catch(e){return!1}return"string"==typeof e.scopes&&(e.session&&"CUSTOMER"===e.session.level&&e.scopes.split(";").indexOf("ROLE_CUSTOMER")>=0||"MEMBER"===e.session.level&&e.scopes.split(";").indexOf("ROLE_MEMBER")>=0)},d=function(){try{localStorage.removeItem("brs_streaming")}catch(e){}},u=function(e){var t=function(){try{var e=JSON.parse(localStorage.getItem("brs_streaming"));return i()!=e.userHash||l()!=e.sso||!e.created||e.created+36e5<=Date.now()?(d(),null):e.config}catch(e){}}();t?e(t):h((function(t){!function(e){try{var t={config:e,created:Date.now(),sso:l(),userHash:i()};localStorage.setItem("brs_streaming",JSON.stringify(t))}catch(e){}}(t),e(t)}))},h=function(e){T.ajax({url:null!==i()?"/streaming/bootstrap?hash="+i():"/streaming/bootstrap",context:document.body,success:function(t){void 0!==t.config?e(t.config):console.warn("No valid response could be retrieved, streaming won't start")}})};T(document).on("feedstreaming:connection_timeout",(function(){T.feedStreaming().stop().then((function(){setTimeout((function(){T.feedStreaming().start()}),5e3)}))})),T(document).on("feedstreaming:access_denied notificationstreaming:access_denied",(function(){d(),u((function(e){c(s())&&(e.notificationsJwt=s()),T.feedStreaming(e),setTimeout((function(){T.feedStreaming().start()}),e.startOffset)}))})),T(document).on("notificationstreaming:modal",(function(e,t){var a=T("[data-modal-id=streaming-modal]");a.length>0&&(t.content.web?a.data("modal-type","is-ajax").data("modal-url",t.content.web).brsModal("triggerModal"):a.data("modal-type",!1).brsModal("addContent",t.content).brsModal("triggerModal"))}));var p={};T(document).on("notificationstreaming:message",(function(e,t){if(t.message){var a=5e3,r=(t.message||"").match(/data-expire="([^"]+)"/);if(r){var n=Date.parse(r[1]);isNaN(n)||(a=Math.max(a,n-Date.now()))}if(p[t.message])return;p[t.message]=T.toast({heading:"Message de Boursorama",text:t.message,allowToastClose:!0,icon:"success",hideAfter:a,position:"bottom-right",stack:5,loader:!1,afterHidden:function(){delete p[t.message]}})}})),T(document).on("load",(function(e,t){u((function(e){c(s())&&(e.notificationsJwt=s(),e.notificationsOrigin="portal"),function(e,t){T.feedStreaming(e),function(e){if(!e||!e.quotaPeriod||!e.quotaLimit)return!0;var t,a=function(){try{return localStorage.getItem("brs_streaming_start")}catch(e){console.error(e)}return null}(),r=new Date;if(t=new Date(parseInt(a)),null==a||r-t>1e3*e.quotaPeriod)!function(e){try{localStorage.setItem("brs_streaming_start",e)}catch(e){console.error(e)}}(Date.now());else if(r-t>1e3*e.quotaLimit)return!1;return!0}(e)&&setTimeout((function(){var a=T(t).find("[data-feed-streaming-registry]:last").data("feedStreamingRegistry")||{};T(t).find("[data-ist-init]").each((function(e,t){var r=T(t).data("istInit");a[r.symbol]=T.extend({},a[r.symbol],r)})),T.feedStreaming("register",t,function(e,t){if(t.filterExchangeCodes&&0!=t.filterExchangeCodes.length||t.filterSymbols&&0!=t.filterSymbols.length){var a={};for(var r in e)(t.filterExchangeCodes&&-1!=t.filterExchangeCodes.indexOf(e[r].exchangeCode)||t.filterSymbols&&-1!=t.filterSymbols.indexOf(r))&&(a[r]=e[r]);return a}return e}(a,e)),n.on("change",o),o()}),e.startOffset)}(e,t)}))}))}else t.warn("feed.streaming","WebSocket not available, streaming require WebSocket, stop")}));var C=a(9755);C(document).on("load",(function(e,t){C(t).find("[data-brs-deriv-underlying]").updateUnderlying(),C(t).find("[data-parity]").currenciesParity(),C(t).find("[data-brs-letter]").click((function(){var e=C(t).find(C(this).data("brsLetterInputSelector"));e.val(C(this).data("brsLetter")),e.closest("form").submit()})),C(t).find("[data-brs-tabs-chart]").brsTabsChart(),C(t).find("[data-brs-home-chart-tabpanel]").brsHomeTabsChart(),C(t).find("[data-partners-newsletter-form]").brsNewsletterSubscription(),C(t).find("[data-brs-chips-autocomplete]").brsSelectChipsAutocomplete(),C.fn.brsOrderFrame.defaults=C.extend(!0,{},C.fn.brsOrderFrame.defaults,{config:{apiEnv:window.BRS_CONFIG.API_ENV,apiHost:window.BRS_CONFIG.API_HOST,apiPath:window.BRS_CONFIG.API_PATH,enableProfiler:window.BRS_CONFIG.ENABLE_PROFILER,portalHost:window.location.host,env:window.BRS_CONFIG.DEBUG?"development":"production",customerWebsiteHost:window.BRS_CONFIG.app_customer_website_host,logLvl:window.BRS_CONFIG.DEBUG?"trace":"error",crashReport:window.BRS_CONFIG.CRASH_REPORT_AGENT},orderframeJSPath:window.BRS_CONFIG.orderframeJSPath,orderframeCSSPath:window.BRS_CONFIG.orderframeCSSPath}),C(t).find("[data-brs-order-frame-app-id]").brsOrderframeBroker(),C(t).find("[data-order-frame-trigger]").click((function(){C(window).trigger("brsOrderframeBroker:launch",[{side:C(this).data("orderFrameTriggerOrderWay"),symbol:C(this).data("orderFrameTriggerOrderSymbol")}])})),C(t).find("[data-brs-quote-chart]").on("order",(function(e,t){C(window).trigger("brsOrderframeBroker:launch",[t.order])}))})),C((function(){var e=[];C(document).find("[data-faceplate-symbol]").each((function(t,a){e.push(C(a).data("faceplateSymbol"))})),C(document).find(".c-my-list").brsMyList({lastSymbolsToAdd:e}),C(document).find("[data-tabs-link]").on("tab:click",(function(e){e.preventDefault();var t=C(C(e.currentTarget).attr("href")).find("[data-table-flip]");if(t.length>0){var a=t.data("plugin_tableFlip");void 0!==a&&(a.unshapeTable(),a.init())}}))}))},8343:function(e,t,a){"use strict";a(9826),a(7042),function(e,t,a){var r="brsDerivativeForm";function n(t,a){this.$element=e(t),this.$turboRowType=this.$element.find("[data-turbos-form-row-type]"),this.$turboRowMaturity=this.$element.find("[data-turbos-form-row-maturity]"),this.$turboRowMaturitySeparateFilterPlugin=this.$turboRowMaturity.find("[data-separate-filter]").data("plugin_brsSeparateFilter"),this.$leverageShortRowUnderlyingType=this.$element.find("[data-leverage-shorts-form-row-underlying-type]"),this.$leverageShortRowUnderlyingTypeSeparateFiltePlugin=this.$leverageShortRowUnderlyingType.find("[data-separate-filter]").data("plugin_brsSeparateFilter"),this.$leverageShortRowUnderlyingName=this.$element.find("[data-leverage-shorts-form-row-underlying-name]"),this.$leverageShortRowMostUsedUnderlying=this.$element.find("[data-leverage-shorts-form-row-most-used-underlying]"),this.init()}e.fn[r]=function(t){var a=arguments;return this.each((function(){e.data(this,"plugin_"+r)?"string"===e.type(t)&&e.data(this,"plugin_"+r)[t].apply(e.data(this,"plugin_"+r),Array.prototype.slice.call(a,1)):e.data(this,"plugin_"+r,new n(this,t))}))},e.fn[r].defaults={},n.prototype.init=function(){var e=this;this.$turboRowType.find("input").change((function(){e.checkTurboTypeConsistency()})),this.$leverageShortRowMostUsedUnderlying.find("input").change((function(){e.checkLeverageShortFieldsConsistency()}))},n.prototype.checkLeverageShortFieldsConsistency=function(){var t=!1;this.$leverageShortRowMostUsedUnderlying.find("input").each((function(){e(this).is(":checked")&&(t=!0)})),t?(this.$leverageShortRowUnderlyingType.addClass("u-hidden"),this.$leverageShortRowUnderlyingName.addClass("u-hidden"),this.$leverageShortRowUnderlyingType.find("input").prop("checked",!1).trigger("change"),this.$leverageShortRowUnderlyingTypeSeparateFiltePlugin.sortFilters(),this.$leverageShortRowUnderlyingTypeSeparateFiltePlugin.showHideSeparator(),this.$leverageShortRowUnderlyingName.find("select").val([]).trigger("change")):(this.$leverageShortRowUnderlyingType.removeClass("u-hidden"),this.$leverageShortRowUnderlyingName.removeClass("u-hidden"))},n.prototype.checkTurboTypeConsistency=function(){var t="all";switch(this.$turboRowType.find("input").each((function(){!e(this).is(":checked")||"2210"!==this.value&&"2205"!==this.value?e(this).is(":checked")&&"2200"===this.value&&(t="finite"):t="infinite"})),t){case"all":this.$turboRowMaturity.removeClass("u-hidden"),this.$turboRowMaturity.find("[data-filter-id=5]").removeClass("u-hidden"),void 0!==this.$turboRowMaturitySeparateFilterPlugin&&(this.$turboRowMaturitySeparateFilterPlugin.sortFilters(),this.$turboRowMaturitySeparateFilterPlugin.showHideSeparator());break;case"infinite":this.$turboRowMaturity.addClass("u-hidden"),this.$turboRowMaturity.find("input").prop("checked",!1),this.$turboRowMaturitySeparateFilterPlugin.sortFilters(),this.$turboRowMaturitySeparateFilterPlugin.showHideSeparator();break;case"finite":this.$turboRowMaturity.find("[data-filter-id=5]").addClass("u-hidden").find("input").prop("checked",!1),this.$turboRowMaturity.removeClass("u-hidden"),this.$turboRowMaturitySeparateFilterPlugin.sortFilters(),this.$turboRowMaturitySeparateFilterPlugin.showHideSeparator()}}}(a(9755),window,document)}},0,[[4360,3666,9755,7098,1220,1162,2406,47,2467,965]]]);